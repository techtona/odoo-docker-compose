
/*********************************************************************
*  Filepath: /base/static/tests/test_ir_model_fields_translation.js  *
*  Lines: 50                                                         *
*********************************************************************/
odoo.define('@base/../tests/test_ir_model_fields_translation', ['@web/core/registry', '@web_tour/tour_service/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { registry } = require("@web/core/registry");
const { stepUtils } = require("@web_tour/tour_service/tour_utils");
function checkLoginColumn(translation) {
    return [
        stepUtils.showAppsMenuItem(), {
            content: "Settings",
            trigger: 'a[data-menu-xmlid="base.menu_administration"]',
            run: 'click',
        }, {
            content: "Open Users & Companies",
            trigger: '[data-menu-xmlid="base.menu_users"]',
            run: "click",
        }, {
            content: "Open Users",
            trigger: '[data-menu-xmlid="base.menu_action_res_users"]',
            run: "click",
        }, {
            content: `Login column should be ${translation}`,
            trigger: `[data-name="login"] span:contains("${translation}")`,
        }
    ]
}

registry.category("web_tour.tours").add('ir_model_fields_translation_en_tour', {
    url: '/odoo',
    steps: () => checkLoginColumn('Login')
});

registry.category("web_tour.tours").add('ir_model_fields_translation_en_tour2', {
    url: '/odoo',
    steps: () => checkLoginColumn('Login2')
});

registry.category("web_tour.tours").add('ir_model_fields_translation_fr_tour', {
    url: '/odoo',
    steps: () => checkLoginColumn('Identifiant')
});

registry.category("web_tour.tours").add('ir_model_fields_translation_fr_tour2', {
    url: '/odoo',
    steps: () => checkLoginColumn('Identifiant2')
});

return __exports;
});
;

/**********************************************************
*  Filepath: /web/static/tests/legacy/helpers/cleanup.js  *
*  Lines: 124                                             *
**********************************************************/
odoo.define('@web/../tests/legacy/helpers/cleanup', [], function (require) {
'use strict';
let __exports = {};
/** @odoo-module alias=@web/../tests/helpers/cleanup default=false */

// -----------------------------------------------------------------------------
// Cleanup
// -----------------------------------------------------------------------------

const cleanups = [];

/**
 * Register a cleanup callback that will be executed whenever the current test
 * is done.
 *
 * - the cleanups will be executed in reverse order
 * - they will be executed even if the test fails/crashes
 *
 * @param {Function} callback
 */
__exports.registerCleanup = registerCleanup; function registerCleanup(callback) {
    cleanups.push(callback);
}

if (window.QUnit) {
    QUnit.on("OdooAfterTestHook", (info) => {
        if (QUnit.config.debug) {
            return;
        }
        let cleanup;
        // note that this calls the cleanup callbacks in reverse order!
        while ((cleanup = cleanups.pop())) {
            try {
                cleanup(info);
            } catch (error) {
                console.error(error);
            }
        }
    });

    // -----------------------------------------------------------------------------
    // Check leftovers
    // -----------------------------------------------------------------------------

    /**
     * List of elements tolerated in the body after a test. The property "keep"
     * prevents the element from being removed (typically: qunit suite elements).
     */
    const validElements = [
        // always in the body:
        { tagName: "DIV", attr: "id", value: "qunit", keep: true },
        { tagName: "DIV", attr: "id", value: "qunit-fixture", keep: true },
        // shouldn't be in the body after a test but are tolerated:
        { tagName: "SCRIPT", attr: "id", value: "" },
        { tagName: "DIV", attr: "class", value: "o_notification_manager" },
        { tagName: "DIV", attr: "class", value: "tooltip fade bs-tooltip-auto" },
        { tagName: "DIV", attr: "class", value: "tooltip fade bs-tooltip-auto show" },
        { tagName: "DIV", attr: "class", value: "tooltip tooltip-field-info fade bs-tooltip-auto" },
        {
            tagName: "DIV",
            attr: "class",
            value: "tooltip tooltip-field-info fade bs-tooltip-auto show",
        },

        // Due to a Document Kanban bug (already present in 12.0)
        { tagName: "DIV", attr: "class", value: "ui-helper-hidden-accessible" },
        {
            tagName: "UL",
            attr: "class",
            value: "ui-menu ui-widget ui-widget-content ui-autocomplete ui-front",
        },
        {
            tagName: "UL",
            attr: "class",
            value: "ui-menu ui-widget ui-widget-content ui-autocomplete dropdown-menu ui-front", // many2ones
        },
    ];

    /**
     * After each test, we check that there is no leftover in the DOM.
     *
     * Note: this event is not QUnit standard, we added it for this specific use case.
     * As a payload, an object with keys 'moduleName' and 'testName' is provided. It
     * is used to indicate the test that left elements in the DOM, when it happens.
     */
    QUnit.on("OdooAfterTestHook", function (info) {
        if (QUnit.config.debug) {
            return;
        }
        const failed = info.testReport.getStatus() === "failed";
        const toRemove = [];
        // check for leftover elements in the body
        for (const bodyChild of document.body.children) {
            const tolerated = validElements.find(
                (e) => e.tagName === bodyChild.tagName && bodyChild.getAttribute(e.attr) === e.value
            );
            if (!failed && !tolerated) {
                QUnit.pushFailure(
                    `Body still contains undesirable elements:\n${bodyChild.outerHTML}`
                );
            }
            if (!tolerated || !tolerated.keep) {
                toRemove.push(bodyChild);
            }
        }
        // cleanup leftovers in #qunit-fixture
        const qunitFixture = document.getElementById("qunit-fixture");
        if (qunitFixture.children.length) {
            toRemove.push(...qunitFixture.children);
        }
        // remove unwanted elements if not in debug
        for (const el of toRemove) {
            el.remove();
        }
        document.body.classList.remove("modal-open");
    });
}

return __exports;
});

odoo.define(`@web/../tests/helpers/cleanup`, ['@web/../tests/legacy/helpers/cleanup'], function (require) {
                        return require('@web/../tests/legacy/helpers/cleanup');
                        });
;

/********************************************************
*  Filepath: /web/static/tests/legacy/helpers/utils.js  *
*  Lines: 1144                                          *
********************************************************/
odoo.define('@web/../tests/legacy/helpers/utils', ['@web/core/templates', '@web/core/browser/browser', '@web/core/browser/feature_detection', '@web/core/network/download', '@web/core/popover/popover', '@web/core/utils/concurrency', '@web/core/utils/patch', '@web/core/utils/ui', '@web/core/l10n/translation', '@web/../tests/legacy/helpers/cleanup', '@odoo/owl'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module alias=@web/../tests/helpers/utils default=false */

const { getTemplate } = require("@web/core/templates");
const { browser } = require("@web/core/browser/browser");
const { isMacOS } = require("@web/core/browser/feature_detection");
const { download } = require("@web/core/network/download");
const { getPopoverForTarget } = require("@web/core/popover/popover");
const { Deferred } = require("@web/core/utils/concurrency");
const { patch } = require("@web/core/utils/patch");
const { isVisible } = require("@web/core/utils/ui");
const { _t } = require("@web/core/l10n/translation");
const { registerCleanup } = require("@web/../tests/legacy/helpers/cleanup");

const {
    App,
    onError,
    onMounted,
    onPatched,
    onRendered,
    onWillDestroy,
    onWillPatch,
    onWillRender,
    onWillStart,
    onWillUnmount,
    onWillUpdateProps,
    useComponent,
} = require("@odoo/owl");

/**
 * @typedef {keyof HTMLElementEventMap | keyof WindowEventMap} EventType
 *
 * @typedef {Side | `${Side}-${Side}` | { x?: number, y?: number }} Position
 *
 * @typedef {"bottom" | "left" | "right" | "top"} Side
 *
 * @typedef TriggerEventOptions
 * @property {boolean} [skipVisibilityCheck=false]
 * @property {boolean} [sync=false]
 */

/**
 * Patch the native Date object
 *
 * Note that it will be automatically unpatched at the end of the test
 *
 * @param {number} [year]
 * @param {number} [month]
 * @param {number} [day]
 * @param {number} [hours]
 * @param {number} [minutes]
 * @param {number} [seconds]
 * @param {number} [ms=0]
 */
__exports.patchDate = patchDate; function patchDate(year, month, day, hours, minutes, seconds, ms = 0) {
    var RealDate = window.Date;
    var actualDate = new RealDate();

    // By default, RealDate uses the browser offset, so we must replace it with the offset fixed in luxon.
    var fakeDate = new RealDate(year, month, day, hours, minutes, seconds, ms);
    if (!(luxon.Settings.defaultZone instanceof luxon.FixedOffsetZone)) {
        throw new Error("luxon.Settings.defaultZone must be a FixedOffsetZone");
    }
    const browserOffset = -fakeDate.getTimezoneOffset();
    const patchedOffset = luxon.Settings.defaultZone.offset();
    const offsetDiff = patchedOffset - browserOffset;
    const correctedMinutes = fakeDate.getMinutes() - offsetDiff;
    fakeDate.setMinutes(correctedMinutes);

    var timeInterval = actualDate.getTime() - fakeDate.getTime();

    // eslint-disable-next-line no-global-assign
    window.Date = (function (NativeDate) {
        function Date(Y, M, D, h, m, s, ms) {
            var length = arguments.length;
            let date;
            if (arguments.length > 0) {
                date =
                    length == 1 && String(Y) === Y // isString(Y)
                        ? // We explicitly pass it through parse:
                          new NativeDate(Date.parse(Y))
                        : // We have to manually make calls depending on argument
                        // length here
                        length >= 7
                        ? new NativeDate(Y, M, D, h, m, s, ms)
                        : length >= 6
                        ? new NativeDate(Y, M, D, h, m, s)
                        : length >= 5
                        ? new NativeDate(Y, M, D, h, m)
                        : length >= 4
                        ? new NativeDate(Y, M, D, h)
                        : length >= 3
                        ? new NativeDate(Y, M, D)
                        : length >= 2
                        ? new NativeDate(Y, M)
                        : length >= 1
                        ? new NativeDate(Y)
                        : new NativeDate();
                // Prevent mixups with unfixed Date object
                date.constructor = Date;
                return date;
            } else {
                date = new NativeDate();
                var time = date.getTime();
                time -= timeInterval;
                date.setTime(time);
                return date;
            }
        }

        // Copy any custom methods a 3rd party library may have added
        for (var key in NativeDate) {
            Date[key] = NativeDate[key];
        }

        // Copy "native" methods explicitly; they may be non-enumerable
        // exception: 'now' uses fake date as reference
        Date.now = function () {
            var date = new NativeDate();
            var time = date.getTime();
            time -= timeInterval;
            return time;
        };
        Date.UTC = NativeDate.UTC;
        Date.prototype = NativeDate.prototype;
        Date.prototype.constructor = Date;

        // Upgrade Date.parse to handle simplified ISO 8601 strings
        Date.parse = NativeDate.parse;
        return Date;
    })(Date);

    registerCleanup(() => {
        window.Date = RealDate;
    });
}

/**
 * Applies a fixed time zone to luxon based on an offset to the UTC time zone.
 *
 * @param {number} offset the number of minutes ahead or behind the UTC time zone
 *                          +120 => UTC+2
 *                          -120 => UTC-2
 */
__exports.patchTimeZone = patchTimeZone; function patchTimeZone(offset) {
    patchWithCleanup(luxon.Settings, { defaultZone: luxon.FixedOffsetZone.instance(offset) });
}

/**
 *
 * @param {Object} obj object to patch
 * @param {Object} patchValue the actual patch description
 */
__exports.patchWithCleanup = patchWithCleanup; function patchWithCleanup(obj, patchValue) {
    const unpatch = patch(obj, patchValue);
    registerCleanup(() => {
        unpatch();
    });
}

/**
 * @returns {Element}
 */
__exports.getFixture = getFixture; function getFixture() {
    if (!window.QUnit) {
        return document;
    }
    if (QUnit.config.debug) {
        return document.body;
    } else {
        return document.getElementById("qunit-fixture");
    }
}

__exports.nextTick = nextTick; async function nextTick() {
    await new Promise((resolve) => window.requestAnimationFrame(resolve));
    await new Promise((resolve) => setTimeout(resolve));
}

__exports.makeDeferred = makeDeferred; function makeDeferred() {
    return new Deferred();
}

__exports.findElement = findElement; function findElement(el, selector) {
    let target = el;
    if (selector) {
        const els = el.querySelectorAll(selector);
        if (els.length === 0) {
            throw new Error(`No element found (selector: ${selector})`);
        }
        if (els.length > 1) {
            throw new Error(`Found ${els.length} elements, instead of 1 (selector: ${selector})`);
        }
        target = els[0];
    }
    return target;
}

//-----------------------------------------------------------------------------
// Event init attributes mappers
//-----------------------------------------------------------------------------

/** @param {EventInit} [args] */
const mapBubblingEvent = (args) => ({ ...args, bubbles: true });

/** @param {EventInit} [args] */
const mapNonBubblingEvent = (args) => ({ ...args, bubbles: false });

/** @param {EventInit} [args={}] */
const mapBubblingPointerEvent = (args = {}) => ({
    clientX: args.pageX,
    clientY: args.pageY,
    ...args,
    bubbles: true,
    cancelable: true,
    view: window,
});

/** @param {EventInit} [args] */
const mapNonBubblingPointerEvent = (args) => ({
    ...mapBubblingPointerEvent(args),
    bubbles: false,
    cancelable: false,
});

/** @param {EventInit} [args={}] */
const mapCancelableTouchEvent = (args = {}) => ({
    ...args,
    bubbles: true,
    cancelable: true,
    composed: true,
    rotation: 0.0,
    touches: args.touches ? [...args.touches.map((e) => new Touch(e))] : undefined,
    view: window,
    zoom: 1.0,
});

/** @param {EventInit} [args] */
const mapNonCancelableTouchEvent = (args) => ({
    ...mapCancelableTouchEvent(args),
    cancelable: false,
});

/** @param {EventInit} [args] */
const mapKeyboardEvent = (args) => ({
    ...args,
    bubbles: true,
    cancelable: true,
});

/**
 * @template {typeof Event} T
 * @param {EventType} eventType
 * @returns {[T, (attrs: EventInit) => EventInit]}
 */
const getEventConstructor = (eventType) => {
    switch (eventType) {
        // Mouse events
        case "auxclick":
        case "click":
        case "contextmenu":
        case "dblclick":
        case "mousedown":
        case "mouseup":
        case "mousemove":
        case "mouseover":
        case "mouseout": {
            return [MouseEvent, mapBubblingPointerEvent];
        }
        case "mouseenter":
        case "mouseleave": {
            return [MouseEvent, mapNonBubblingPointerEvent];
        }
        // Pointer events
        case "pointerdown":
        case "pointerup":
        case "pointermove":
        case "pointerover":
        case "pointerout": {
            return [PointerEvent, mapBubblingPointerEvent];
        }
        case "pointerenter":
        case "pointerleave": {
            return [PointerEvent, mapNonBubblingPointerEvent];
        }
        // Focus events
        case "focusin": {
            return [FocusEvent, mapBubblingEvent];
        }
        case "focus":
        case "blur": {
            return [FocusEvent, mapNonBubblingEvent];
        }
        // Clipboard events
        case "cut":
        case "copy":
        case "paste": {
            return [ClipboardEvent, mapBubblingEvent];
        }
        // Keyboard events
        case "keydown":
        case "keypress":
        case "keyup": {
            return [KeyboardEvent, mapKeyboardEvent];
        }
        // Drag events
        case "drag":
        case "dragend":
        case "dragenter":
        case "dragstart":
        case "dragleave":
        case "dragover":
        case "drop": {
            return [DragEvent, mapBubblingEvent];
        }
        // Input events
        case "input": {
            return [InputEvent, mapBubblingEvent];
        }
        // Composition events
        case "compositionstart":
        case "compositionend": {
            return [CompositionEvent, mapBubblingEvent];
        }
        // UI events
        case "scroll": {
            return [UIEvent, mapNonBubblingEvent];
        }
        // Touch events
        case "touchstart":
        case "touchend":
        case "touchmove": {
            return [TouchEvent, mapCancelableTouchEvent];
        }
        case "touchcancel": {
            return [TouchEvent, mapNonCancelableTouchEvent];
        }
        // Default: base Event constructor
        default: {
            return [Event, mapBubblingEvent];
        }
    }
};

/**
 * @template {EventType} T
 * @param {Element} el
 * @param {string | null | undefined | false} selector
 * @param {T} eventType
 * @param {EventInit} [eventInit]
 * @param {TriggerEventOptions} [options={}]
 * @returns {GlobalEventHandlersEventMap[T] | Promise<GlobalEventHandlersEventMap[T]>}
 */
__exports.triggerEvent = triggerEvent; function triggerEvent(el, selector, eventType, eventInit, options = {}) {
    const errors = [];
    const target = findElement(el, selector);

    // Error handling
    if (typeof eventType !== "string") {
        errors.push("event type must be a string");
    }
    if (!target) {
        errors.push("cannot find target");
    } else if (!options.skipVisibilityCheck && !isVisible(target)) {
        errors.push("target is not visible");
    }
    if (errors.length) {
        throw new Error(
            `Cannot trigger event${eventType ? ` "${eventType}"` : ""}${
                selector ? ` (with selector "${selector}")` : ""
            }: ${errors.join(" and ")}`
        );
    }

    // Actual dispatch
    const [Constructor, processParams] = getEventConstructor(eventType);
    const event = new Constructor(eventType, processParams(eventInit));
    target.dispatchEvent(event);

    if (window.QUnit && QUnit.config.debug) {
        const group = `%c[${event.type.toUpperCase()}]`;
        console.groupCollapsed(group, "color: #b52c9b");
        console.log(target, event);
        console.groupEnd(group, "color: #b52c9b");
    }

    if (options.sync) {
        return event;
    } else {
        return nextTick().then(() => event);
    }
}

/**
 * @param {Element} el
 * @param {string | null | undefined | false} selector
 * @param {(EventType | [EventType, EventInit])[]} [eventDefs]
 * @param {TriggerEventOptions} [options={}]
 */
__exports.triggerEvents = triggerEvents; function triggerEvents(el, selector, eventDefs, options = {}) {
    const events = [...eventDefs].map((eventDef) => {
        const [eventType, eventInit] = Array.isArray(eventDef) ? eventDef : [eventDef, {}];
        return triggerEvent(el, selector, eventType, eventInit, options);
    });
    if (options.sync) {
        return events;
    } else {
        return nextTick().then(() => events);
    }
}

/**
 * Triggers a scroll event on the given target
 *
 * If the target cannot be scrolled or an axis has reached
 * the end of the scrollable area, the event can be transmitted
 * to its nearest parent until it can be triggered
 *
 * @param {Element} target target of the scroll event
 * @param {Object} coordinates
 * @param {number} coordinates.left coordinates to scroll horizontally
 * @param {number} coordinates.top coordinates to scroll vertically
 * @param {boolean} canPropagate states if the scroll can propagate to a scrollable parent
 */
__exports.triggerScroll = triggerScroll; async function triggerScroll(
    target,
    coordinates = { left: null, top: null },
    canPropagate = true
) {
    const isScrollable =
        (target.scrollHeight > target.clientHeight && target.clientHeight > 0) ||
        (target.scrollWidth > target.clientWidth && target.clientWidth > 0);
    if (!isScrollable && !canPropagate) {
        return;
    }
    if (isScrollable) {
        const canScrollFrom = {
            left:
                coordinates.left > target.scrollLeft
                    ? target.scrollLeft + target.clientWidth < target.scrollWidth
                    : target.scrollLeft > 0,
            top:
                coordinates.top > target.scrollTop
                    ? target.scrollTop + target.clientHeight < target.scrollHeight
                    : target.scrollTop > 0,
        };
        const scrollCoordinates = {};
        Object.entries(coordinates).forEach(([key, value]) => {
            if (value !== null && canScrollFrom[key]) {
                scrollCoordinates[key] = value;
                delete coordinates[key];
            }
        });
        target.scrollTo(scrollCoordinates);
        await triggerEvent(target, null, "scroll");
        if (!canPropagate || !Object.entries(coordinates).length) {
            return;
        }
    }
    target.parentElement
        ? triggerScroll(target.parentElement, coordinates)
        : triggerEvent(window, null, "scroll");
    await nextTick();
}

__exports.click = click; function click(
    el,
    selector,
    { mouseEventInit = {}, skipDisabledCheck = false, skipVisibilityCheck = false } = {}
) {
    if (!skipDisabledCheck && el.disabled) {
        throw new Error("Can't click on a disabled button");
    }
    return triggerEvents(
        el,
        selector,
        [
            "pointerdown",
            "mousedown",
            "focus",
            "focusin",
            "pointerup",
            "mouseup",
            ["click", mouseEventInit],
        ],
        { skipVisibilityCheck }
    );
}

__exports.clickCreate = clickCreate; function clickCreate(htmlElement) {
    if (
        htmlElement.querySelectorAll(
            ".o_control_panel_main_buttons .o_form_button_create"
        ).length
    ) {
        return click(
            htmlElement,
            ".o_control_panel_main_buttons .o_form_button_create"
        );
    } else if (
        htmlElement.querySelectorAll(
            ".o_control_panel_main_buttons .o_list_button_create"
        ).length
    ) {
        return click(
            htmlElement,
            ".o_control_panel_main_buttons .o_list_button_create"
        );
    } else {
        throw new Error("No edit button found to be clicked.");
    }
}

__exports.clickEdit = clickEdit; function clickEdit(htmlElement) {
    if (htmlElement.querySelectorAll(".o_list_button_edit").length) {
        return click(htmlElement, ".o_list_button_edit");
    } else {
        throw new Error("No edit button found to be clicked.");
    }
}

__exports.clickSave = clickSave; async function clickSave(htmlElement) {
    if (htmlElement.querySelectorAll(".o_form_status_indicator").length) {
        await mouseEnter(htmlElement, ".o_form_status_indicator");
    }
    if (htmlElement.querySelectorAll(".o_form_button_save").length) {
        return click(htmlElement, ".o_form_button_save");
    }
    const listSaveButtons = htmlElement.querySelectorAll(".o_list_button_save");
    if (listSaveButtons.length) {
        return listSaveButtons.length >= 2 ? click(listSaveButtons[1]) : click(listSaveButtons[0]);
    } else {
        throw new Error("No save button found to be clicked.");
    }
}

__exports.clickDiscard = clickDiscard; async function clickDiscard(htmlElement) {
    if (htmlElement.querySelectorAll(".o_form_status_indicator").length) {
        await mouseEnter(htmlElement, ".o_form_status_indicator");
    }
    if (htmlElement.querySelectorAll(".o_form_button_cancel").length) {
        return click(htmlElement, ".o_form_button_cancel");
    } else if ($(htmlElement).find(".o_list_button_discard:visible").length) {
        return click($(htmlElement).find(".o_list_button_discard:visible").get(0));
    } else {
        throw new Error("No discard button found to be clicked.");
    }
}

/**
 * Trigger pointerenter and mouseenter events on the given target. If no
 * coordinates are given, the event is located by default
 * in the middle of the target to simplify the test process
 *
 * @param {Element} el
 * @param {string} selector
 * @param {Object} coordinates position of the mouseenter event
 */
__exports.mouseEnter = mouseEnter; async function mouseEnter(el, selector, coordinates) {
    const target = el.querySelector(selector) || el;
    const atPos = coordinates || {
        clientX: target.getBoundingClientRect().left + target.getBoundingClientRect().width / 2,
        clientY: target.getBoundingClientRect().top + target.getBoundingClientRect().height / 2,
    };
    return triggerEvents(target, null, ["pointerenter", "mouseenter"], atPos);
}

/**
 * Trigger pointerleave and mouseleave events on the given target.
 *
 * @param {Element} el
 * @param {string} selector
 */
__exports.mouseLeave = mouseLeave; async function mouseLeave(el, selector) {
    const target = el.querySelector(selector) || el;
    return triggerEvents(target, null, ["pointerleave", "mouseleave"]);
}

__exports.editInput = editInput; async function editInput(el, selector, value) {
    const input = findElement(el, selector);
    if (!(input instanceof HTMLInputElement || input instanceof HTMLTextAreaElement)) {
        throw new Error("Only 'input' and 'textarea' elements can be edited with 'editInput'.");
    }
    if (
        !["text", "textarea", "email", "search", "color", "number", "file", "tel"].includes(
            input.type
        )
    ) {
        throw new Error(`Type "${input.type}" not supported by 'editInput'.`);
    }

    const eventOpts = {};
    if (input.type === "file") {
        const files = Array.isArray(value) ? value : [value];
        const dataTransfer = new DataTransfer();
        for (const file of files) {
            if (!(file instanceof File)) {
                throw new Error(`File input value should be one or several File objects.`);
            }
            dataTransfer.items.add(file);
        }
        input.files = dataTransfer.files;
        eventOpts.skipVisibilityCheck = true;
    } else {
        input.value = value;
    }

    await triggerEvents(input, null, ["input", "change"], eventOpts);

    if (input.type === "file") {
        // Need to wait for the file to be loaded by the input
        await nextTick();
        await nextTick();
    }
}

__exports.editSelect = editSelect; function editSelect(el, selector, value) {
    const select = findElement(el, selector);
    if (select.tagName !== "SELECT") {
        throw new Error("Only select tag can be edited with selectInput.");
    }
    select.value = value;
    return triggerEvent(select, null, "change");
}

__exports.editSelectMenu = editSelectMenu; async function editSelectMenu(el, selector, value) {
    const dropdown = el.querySelector(selector);
    await click(dropdown.querySelector(".dropdown-toggle"));
    for (const item of Array.from(el.querySelectorAll(".o_select_menu_menu .dropdown-item"))) {
        if (item.textContent === value) {
            return click(item);
        }
    }
}

/**
 * Triggers an hotkey properly disregarding the operating system.
 *
 * @param {string} hotkey
 * @param {boolean} addOverlayModParts
 * @param {KeyboardEventInit} eventAttrs
 */
__exports.triggerHotkey = triggerHotkey; async function triggerHotkey(hotkey, addOverlayModParts = false, eventAttrs = {}) {
    eventAttrs.key = hotkey.split("+").pop();

    if (/shift/i.test(hotkey)) {
        eventAttrs.shiftKey = true;
    }

    if (/control/i.test(hotkey)) {
        if (isMacOS()) {
            eventAttrs.metaKey = true;
        } else {
            eventAttrs.ctrlKey = true;
        }
    }

    if (/alt/i.test(hotkey) || addOverlayModParts) {
        if (isMacOS()) {
            eventAttrs.ctrlKey = true;
        } else {
            eventAttrs.altKey = true;
        }
    }

    if (!("bubbles" in eventAttrs)) {
        eventAttrs.bubbles = true;
    }

    const [keydownEvent, keyupEvent] = await triggerEvents(
        document.activeElement,
        null,
        [
            ["keydown", eventAttrs],
            ["keyup", eventAttrs],
        ],
        { skipVisibilityCheck: true }
    );

    return { keydownEvent, keyupEvent };
}

__exports.mockDownload = mockDownload; function mockDownload(cb) {
    patchWithCleanup(download, { _download: cb });
}

const hushConsole = __exports.hushConsole = Object.create(null);
for (const propName of Object.keys(window.console)) {
    hushConsole[propName] = () => {};
}

__exports.mockSendBeacon = mockSendBeacon; function mockSendBeacon(mock) {
    patchWithCleanup(navigator, {
        sendBeacon: (url, blob) => {
            return mock(url, blob) !== false;
        },
    });
}

__exports.mockTimeout = mockTimeout; function mockTimeout() {
    const timeouts = new Map();
    let currentTime = 0;
    let id = 1;
    patchWithCleanup(browser, {
        setTimeout(fn, delay = 0) {
            timeouts.set(id, { fn, scheduledFor: delay + currentTime, id });
            return id++;
        },
        clearTimeout(id) {
            timeouts.delete(id);
        },
    });
    return {
        execRegisteredTimeouts() {
            for (const { fn } of timeouts.values()) {
                fn();
            }
            timeouts.clear();
        },
        async advanceTime(duration) {
            // wait here so all microtasktick scheduled in this frame can be
            // executed and possibly register their own timeout
            await nextTick();
            currentTime += duration;
            for (const { fn, scheduledFor, id } of timeouts.values()) {
                if (scheduledFor <= currentTime) {
                    fn();
                    timeouts.delete(id);
                }
            }
            // wait here to make sure owl can update the UI
            await nextTick();
        },
    };
}

__exports.mockAnimationFrame = mockAnimationFrame; function mockAnimationFrame() {
    const callbacks = new Map();
    let currentTime = 0;
    let id = 1;
    patchWithCleanup(browser, {
        requestAnimationFrame(fn) {
            callbacks.set(id, { fn, scheduledFor: 16 + currentTime, id });
            return id++;
        },
        cancelAnimationFrame(id) {
            callbacks.delete(id);
        },
        performance: { now: () => currentTime },
    });
    return {
        execRegisteredAnimationFrames() {
            for (const { fn } of callbacks.values()) {
                fn(currentTime);
            }
            callbacks.clear();
        },
        async advanceFrame(count = 1) {
            // wait here so all microtasktick scheduled in this frame can be
            // executed and possibly register their own timeout
            await nextTick();
            currentTime += 16 * count;
            for (const { fn, scheduledFor, id } of callbacks.values()) {
                if (scheduledFor <= currentTime) {
                    fn(currentTime);
                    callbacks.delete(id);
                }
            }
            // wait here to make sure owl can update the UI
            await nextTick();
        },
    };
}

__exports.mount = mount; async function mount(Comp, target, config = {}) {
    let { props, env } = config;
    env = env || {};
    const configuration = {
        env,
        getTemplate,
        test: true,
        props,
    };
    if (env.services && "localization" in env.services) {
        configuration.translateFn = _t;
    }
    const app = new App(Comp, configuration);
    registerCleanup(() => app.destroy());
    return app.mount(target);
}

__exports.destroy = destroy; function destroy(comp) {
    comp.__owl__.app.destroy();
}

__exports.findChildren = findChildren; function findChildren(comp, predicate = (e) => e) {
    const queue = [];
    [].unshift.apply(queue, Object.values(comp.__owl__.children));

    while (queue.length > 0) {
        const curNode = queue.pop();
        if (predicate(curNode)) {
            return curNode;
        }
        [].unshift.apply(queue, Object.values(curNode.component.__owl__.children));
    }
}

// partial replacement of t-ref on component
__exports.useChild = useChild; function useChild() {
    const node = useComponent().__owl__;
    const setChild = () => {
        const componentNode = Object.values(node.children)[0];
        node.component.child = componentNode.component;
    };
    onMounted(setChild);
    onPatched(setChild);
}

__exports.useLogLifeCycle = useLogLifeCycle; function useLogLifeCycle(logFn, name = "") {
    const component = useComponent();
    let loggedName = `${component.constructor.name}`;
    if (name) {
        loggedName = `${component.constructor.name} ${name}`;
    }
    onError(() => {
        logFn(`onError ${loggedName}`);
    });
    onMounted(() => {
        logFn(`onMounted ${loggedName}`);
    });
    onPatched(() => {
        logFn(`onPatched ${loggedName}`);
    });
    onRendered(() => {
        logFn(`onRendered ${loggedName}`);
    });
    onWillDestroy(() => {
        logFn(`onWillDestroy ${loggedName}`);
    });
    onWillPatch(() => {
        logFn(`onWillPatch ${loggedName}`);
    });
    onWillRender(() => {
        logFn(`onWillRender ${loggedName}`);
    });
    onWillStart(() => {
        logFn(`onWillStart ${loggedName}`);
    });
    onWillUnmount(() => {
        logFn(`onWillUnmount ${loggedName}`);
    });
    onWillUpdateProps(() => {
        logFn(`onWillUpdateProps ${loggedName}`);
    });
}

/**
 * Returns the list of nodes containing n2 (included) that do not contain n1.
 *
 * @param {Node} n1
 * @param {Node} n2
 * @returns {Node[]}
 */
function getDifferentParents(n1, n2) {
    const parents = [n2];
    while (parents[0].parentNode) {
        const parent = parents[0].parentNode;
        if (parent.contains(n1)) {
            break;
        }
        parents.unshift(parent);
    }
    return parents;
}

/**
 * Helper performing a drag and drop sequence.
 *
 * - 'from' is used to determine the element on which the drag will start;
 * - 'target' will determine the element on which the first one will be dropped.
 *
 * The first element will be dragged by its center, and will be dropped on the
 * bottom-right inner pixel of the target element. This behavior covers both
 * cases of appending the first element to the end of a list (toSelector =
 * target list) or moving it at the position of another element, effectively
 * placing the first element before the second (toSelector = other element).
 *
 * A position can be given to drop the first element above, below, or on the
 * side of the second (default is inside, as specified above).
 *
 * Note that only the last event is awaited, since all the others are
 * considered to be synchronous.
 *
 * @param {Element | string} from
 * @param {Element | string} to
 * @param {Position} [position]
 */
__exports.dragAndDrop = dragAndDrop; async function dragAndDrop(from, to, position) {
    const { drop } = await drag(from);
    await drop(to, position);
}

/**
 * Helper performing a drag.
 *
 * - the 'from' selector is used to determine the element on which the drag will
 *  start;
 * - the 'target' selector will determine the element on which the dragged element will be
 * moved.
 *
 * Returns a drop function
 *
 * @param {Element | string} from
 */
__exports.drag = drag; async function drag(from, pointerType = "mouse") {
    const assertIsDragging = (fn, endDrag) => {
        return {
            async [fn.name](...args) {
                if (dragEndReason) {
                    throw new Error(
                        `Cannot execute drag helper '${fn.name}': drag sequence has been ended by '${dragEndReason}'.`
                    );
                }
                await fn(...args);
                if (endDrag) {
                    dragEndReason = fn.name;
                }
            },
        }[fn.name];
    };

    const cancel = assertIsDragging(async function cancel() {
        await triggerEvent(window, null, "keydown", { key: "Escape" });
    }, true);

    /**
     * @param {Element | string} [to]
     * @param {Position} [position]
     */
    const drop = assertIsDragging(async function drop(to, position) {
        if (to) {
            await moveTo(to, position);
        }
        await triggerEvent(target || source, null, "pointerup", targetPosition);
    }, true);

    /**
     * @param {Element | string} selector
     */
    const getEl = (selector) =>
        selector instanceof Element ? selector : fixture.querySelector(selector);

    /**
     * @param {Position} [position]
     */
    const getTargetPosition = (position) => {
        const tRect = target.getBoundingClientRect();
        const tPos = {
            clientX: Math.floor(tRect.x),
            clientY: Math.floor(tRect.y),
        };
        if (position && typeof position === "object") {
            // x and y coordinates start from the element's initial coordinates
            tPos.clientX += position.x || 0;
            tPos.clientY += position.y || 0;
        } else {
            const positions = typeof position === "string" ? position.split("-") : [];

            // X position
            if (positions.includes("left")) {
                tPos.clientX -= 1;
            } else if (positions.includes("right")) {
                tPos.clientX += Math.ceil(tRect.width) + 1;
            } else {
                tPos.clientX += Math.floor(tRect.width / 2);
            }

            // Y position
            if (positions.includes("top")) {
                tPos.clientY -= 1;
            } else if (positions.includes("bottom")) {
                tPos.clientY += Math.ceil(tRect.height) + 1;
            } else {
                tPos.clientY += Math.floor(tRect.height / 2);
            }
        }
        return tPos;
    };

    /**
     * @param {Element | string} [to]
     * @param {Position} [position]
     */
    const moveTo = assertIsDragging(async function moveTo(to, position) {
        target = getEl(to);
        if (!target) {
            return;
        }

        // Recompute target position
        targetPosition = getTargetPosition(position);

        // Move, enter and drop the element on the target
        await triggerEvent(source, null, "pointermove", { ...targetPosition, button: -1 });

        // "pointerenter" is fired on every parent of `target` that do not contain
        // `from` (typically: different parent lists).
        for (const parent of getDifferentParents(source, target)) {
            triggerEvent(parent, null, "pointerenter", targetPosition);
        }
        await nextTick();

        return dragHelpers;
    }, false);

    const dragHelpers = { cancel, drop, moveTo };
    const fixture = getFixture();

    const source = getEl(from instanceof Element ? from : fixture.querySelector(from));
    const sourceRect = source.getBoundingClientRect();

    let dragEndReason = null;
    let target;
    let targetPosition;

    // Pointer down on main target
    await triggerEvent(source, null, "pointerdown", {
        pointerType,
        clientX: sourceRect.x + sourceRect.width / 2,
        clientY: sourceRect.y + sourceRect.height / 2,
    });

    return dragHelpers;
}

/**
 * Returns the dropdown menu for a specific toggler.
 *
 * @param {HTMLElement} target
 * @param {String|HTMLElement} togglerSelector
 * @returns {HTMLElement|undefined}
 */
__exports.getDropdownMenu = getDropdownMenu; function getDropdownMenu(target, togglerSelector) {
    if (!(target instanceof HTMLElement)) {
        throw new Error(`getDropdownMenu: target is not an HTMLElement.`);
    }
    let el =
        togglerSelector instanceof HTMLElement
            ? togglerSelector
            : target.querySelector(togglerSelector);

    if (el && !el.classList.contains("o-dropdown")) {
        el = el.querySelector(".o-dropdown");
    }
    if (!el) {
        throw new Error(`getDropdownMenu: Could not find element "${togglerSelector}".`);
    }
    return getPopoverForTarget(el);
}

__exports.clickDropdown = clickDropdown; async function clickDropdown(target, fieldName) {
    const dropdownInput = target.querySelector(`[name='${fieldName}'] .dropdown input`);
    dropdownInput.focus();
    await nextTick();
    await click(dropdownInput);
}

__exports.clickOpenedDropdownItem = clickOpenedDropdownItem; async function clickOpenedDropdownItem(target, fieldName, itemContent) {
    const dropdowns = target.querySelectorAll(`[name='${fieldName}'] .dropdown .dropdown-menu`);
    if (dropdowns.length === 0) {
        throw new Error(`No dropdown found for field ${fieldName}`);
    } else if (dropdowns.length > 1) {
        throw new Error(`Found ${dropdowns.length} dropdowns for field ${fieldName}`);
    }
    const dropdownItems = dropdowns[0].querySelectorAll("li");
    const indexToClick = Array.from(dropdownItems)
        .map((html) => html.textContent)
        .indexOf(itemContent);
    if (indexToClick === -1) {
        throw new Error(`The element '${itemContent}' does not exist in the dropdown`);
    }
    await click(dropdownItems[indexToClick]);
}

__exports.selectDropdownItem = selectDropdownItem; async function selectDropdownItem(target, fieldName, itemContent) {
    await clickDropdown(target, fieldName);
    await clickOpenedDropdownItem(target, fieldName, itemContent);
}

__exports.getNodesTextContent = getNodesTextContent; function getNodesTextContent(nodes) {
    return Array.from(nodes).map((n) => n.textContent);
}

/**
 * Click to open the dropdown on a many2one
 */
__exports.clickOpenM2ODropdown = clickOpenM2ODropdown; async function clickOpenM2ODropdown(el, fieldName, selector) {
    const m2oSelector = `${selector || ""} .o_field_many2one[name=${fieldName}] input`;
    const matches = el.querySelectorAll(m2oSelector);
    if (matches.length !== 1) {
        throw new Error(
            `cannot open m2o: selector ${selector} has been found ${matches.length} instead of 1`
        );
    }

    await click(matches[0]);
    return matches[0];
}

/**
 * Click on the active (highlighted) selection in a m2o dropdown.
 */
// TO FIX
__exports.clickM2OHighlightedItem = clickM2OHighlightedItem; async function clickM2OHighlightedItem(el, fieldName, selector) {
    const m2oSelector = `${selector || ""} .o_field_many2one[name=${fieldName}] input`;
    // const $dropdown = $(m2oSelector).autocomplete('widget');
    const matches = el.querySelectorAll(m2oSelector);
    if (matches.length !== 1) {
        throw new Error(
            `cannot open m2o: selector ${selector} has been found ${matches.length} instead of 1`
        );
    }
    // clicking on an li (no matter which one), will select the focussed one
    return click(matches[0].parentElement.querySelector("li"));
}

// X2Many
__exports.addRow = addRow; async function addRow(target, selector) {
    await click(target.querySelector(`${selector ? selector : ""} .o_field_x2many_list_row_add a`));
}

__exports.removeRow = removeRow; async function removeRow(target, index) {
    await click(target.querySelectorAll(".o_list_record_remove")[index]);
}

return __exports;
});

odoo.define(`@web/../tests/helpers/utils`, ['@web/../tests/legacy/helpers/utils'], function (require) {
                        return require('@web/../tests/legacy/helpers/utils');
                        });
;

/************************************************
*  Filepath: /web/static/tests/legacy/utils.js  *
*  Lines: 695                                   *
************************************************/
odoo.define('@web/../tests/legacy/utils', ['@web/core/utils/ui', '@web/../tests/helpers/cleanup', '@web/../tests/helpers/utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module alias=@web/../tests/utils default=false */

const { isVisible } = require("@web/core/utils/ui");
const { registerCleanup } = require("@web/../tests/helpers/cleanup");
const {
    click: webClick,
    getFixture,
    makeDeferred,
    triggerEvents: webTriggerEvents,
} = require("@web/../tests/helpers/utils");

/**
 * Create a fake object 'dataTransfer', linked to some files,
 * which is passed to drag and drop events.
 *
 * @param {Object[]} files
 * @returns {Object}
 */
function createFakeDataTransfer(files) {
    return {
        dropEffect: "all",
        effectAllowed: "all",
        files,
        items: [],
        types: ["Files"],
    };
}

/**
 * Waits until exactly one element matching the given `selector` is present in
 * `options.target` and then clicks on it.
 *
 * @param {string} selector
 * @param {ContainsOptions} [options] forwarded to `contains`
 * @param {boolean} [options.shiftKey]
 */
__exports.click = click; async function click(selector, options = {}) {
    const { shiftKey } = options;
    delete options.shiftKey;
    await contains(selector, { click: { shiftKey }, ...options });
}

/**
 * Waits until exactly one element matching the given `selector` is present in
 * `options.target` and then dragenters `files` on it.
 *
 * @param {string} selector
 * @param {Object[]} files
 * @param {ContainsOptions} [options] forwarded to `contains`
 */
__exports.dragenterFiles = dragenterFiles; async function dragenterFiles(selector, files, options) {
    await contains(selector, { dragenterFiles: files, ...options });
}

/**
 * Waits until exactly one element matching the given `selector` is present in
 * `options.target` and then dragovers `files` on it.
 *
 * @param {string} selector
 * @param {Object[]} files
 * @param {ContainsOptions} [options] forwarded to `contains`
 */
__exports.dragoverFiles = dragoverFiles; async function dragoverFiles(selector, files, options) {
    await contains(selector, { dragoverFiles: files, ...options });
}

/**
 * Waits until exactly one element matching the given `selector` is present in
 * `options.target` and then drops `files` on it.
 *
 * @param {string} selector
 * @param {Object[]} files
 * @param {ContainsOptions} [options] forwarded to `contains`
 */
__exports.dropFiles = dropFiles; async function dropFiles(selector, files, options) {
    await contains(selector, { dropFiles: files, ...options });
}

/**
 * Waits until exactly one element matching the given `selector` is present in
 * `options.target` and then inputs `files` on it.
 *
 * @param {string} selector
 * @param {Object[]} files
 * @param {ContainsOptions} [options] forwarded to `contains`
 */
__exports.inputFiles = inputFiles; async function inputFiles(selector, files, options) {
    await contains(selector, { inputFiles: files, ...options });
}

/**
 * Waits until exactly one element matching the given `selector` is present in
 * `options.target` and then pastes `files` on it.
 *
 * @param {string} selector
 * @param {Object[]} files
 * @param {ContainsOptions} [options] forwarded to `contains`
 */
__exports.pasteFiles = pasteFiles; async function pasteFiles(selector, files, options) {
    await contains(selector, { pasteFiles: files, ...options });
}

/**
 * Waits until exactly one element matching the given `selector` is present in
 * `options.target` and then focuses on it.
 *
 * @param {string} selector
 * @param {ContainsOptions} [options] forwarded to `contains`
 */
__exports.focus = focus; async function focus(selector, options) {
    await contains(selector, { setFocus: true, ...options });
}

/**
 * Waits until exactly one element matching the given `selector` is present in
 * `options.target` and then inserts the given `content`.
 *
 * @param {string} selector
 * @param {string} content
 * @param {ContainsOptions} [options] forwarded to `contains`
 * @param {boolean} [options.replace=false]
 */
__exports.insertText = insertText; async function insertText(selector, content, options = {}) {
    const { replace = false } = options;
    delete options.replace;
    await contains(selector, { ...options, insertText: { content, replace } });
}

/**
 * Waits until exactly one element matching the given `selector` is present in
 * `options.target` and then sets its `scrollTop` to the given value.
 *
 * @param {string} selector
 * @param {number|"bottom"} scrollTop
 * @param {ContainsOptions} [options] forwarded to `contains`
 */
__exports.scroll = scroll; async function scroll(selector, scrollTop, options) {
    await contains(selector, { setScroll: scrollTop, ...options });
}

/**
 * Waits until exactly one element matching the given `selector` is present in
 * `options.target` and then triggers `event` on it.
 *
 * @param {string} selector
 * @param {(import("@web/../tests/helpers/utils").EventType|[import("@web/../tests/helpers/utils").EventType, EventInit])[]} events
 * @param {ContainsOptions} [options] forwarded to `contains`
 */
__exports.triggerEvents = triggerEvents; async function triggerEvents(selector, events, options) {
    await contains(selector, { triggerEvents: events, ...options });
}

function log(ok, message) {
    if (window.QUnit) {
        QUnit.assert.ok(ok, message);
    } else {
        if (ok) {
            console.log(message);
        } else {
            console.error(message);
        }
    }
}

let hasUsedContainsPositively = false;
if (window.QUnit) {
    QUnit.testStart(() => (hasUsedContainsPositively = false));
}
/**
 * @typedef {[string, ContainsOptions]} ContainsTuple tuple representing params of the contains
 *  function, where the first element is the selector, and the second element is the options param.
 * @typedef {Object} ContainsOptions
 * @property {ContainsTuple} [after] if provided, the found element(s) must be after the element
 *  matched by this param.
 * @property {ContainsTuple} [before] if provided, the found element(s) must be before the element
 *  matched by this param.
 * @property {Object} [click] if provided, clicks on the first found element
 * @property {ContainsTuple|ContainsTuple[]} [contains] if provided, the found element(s) must
 *  contain the provided sub-elements.
 * @property {number} [count=1] numbers of elements to be found to declare the contains check
 *  as successful. Elements are counted after applying all other filters.
 * @property {Object[]} [dragenterFiles] if provided, dragenters the given files on the found element
 * @property {Object[]} [dragoverFiles] if provided, dragovers the given files on the found element
 * @property {Object[]} [dropFiles] if provided, drops the given files on the found element
 * @property {Object[]} [inputFiles] if provided, inputs the given files on the found element
 * @property {{content:string, replace:boolean}} [insertText] if provided, adds to (or replace) the
 *  value of the first found element by the given content.
 * @property {ContainsTuple} [parent] if provided, the found element(s) must have as
 *  parent the node matching the parent parameter.
 * @property {Object[]} [pasteFiles] if provided, pastes the given files on the found element
 * @property {number|"bottom"} [scroll] if provided, the scrollTop of the found element(s)
 *  must match.
 *  Note: when using one of the scrollTop options, it is advised to ensure the height is not going
 *  to change soon, by checking with a preceding contains that all the expected elements are in DOM.
 * @property {boolean} [setFocus] if provided, focuses the first found element.
 * @property {boolean} [shadowRoot] if provided, targets the shadowRoot of the found elements.
 * @property {number|"bottom"} [setScroll] if provided, sets the scrollTop on the first found
 *  element.
 * @property {HTMLElement} [target=getFixture()]
 * @property {string[]} [triggerEvents] if provided, triggers the given events on the found element
 * @property {string} [text] if provided, the textContent of the found element(s) or one of their
 *  descendants must match. Use `textContent` option for a match on the found element(s) only.
 * @property {string} [textContent] if provided, the textContent of the found element(s) must match.
 *  Prefer `text` option for a match on the found element(s) or any of their descendants, usually
 *  allowing for a simpler and less specific selector.
 * @property {string} [value] if provided, the input value of the found element(s) must match.
 *  Note: value changes are not observed directly, another mutation must happen to catch them.
 * @property {boolean} [visible] if provided, the found element(s) must be (in)visible
 */
class Contains {
    /**
     * @param {string} selector
     * @param {ContainsOptions} [options={}]
     */
    constructor(selector, options = {}) {
        this.selector = selector;
        this.options = options;
        this.options.count ??= 1;
        this.options.targetParam = this.options.target;
        this.options.target ??= getFixture();
        let selectorMessage = `${this.options.count} of "${this.selector}"`;
        if (this.options.visible !== undefined) {
            selectorMessage = `${selectorMessage} ${
                this.options.visible ? "visible" : "invisible"
            }`;
        }
        if (this.options.targetParam) {
            selectorMessage = `${selectorMessage} inside a specific target`;
        }
        if (this.options.parent) {
            selectorMessage = `${selectorMessage} inside a specific parent`;
        }
        if (this.options.contains) {
            selectorMessage = `${selectorMessage} with a specified sub-contains`;
        }
        if (this.options.text !== undefined) {
            selectorMessage = `${selectorMessage} with text "${this.options.text}"`;
        }
        if (this.options.textContent !== undefined) {
            selectorMessage = `${selectorMessage} with textContent "${this.options.textContent}"`;
        }
        if (this.options.value !== undefined) {
            selectorMessage = `${selectorMessage} with value "${this.options.value}"`;
        }
        if (this.options.scroll !== undefined) {
            selectorMessage = `${selectorMessage} with scroll "${this.options.scroll}"`;
        }
        if (this.options.after !== undefined) {
            selectorMessage = `${selectorMessage} after a specified element`;
        }
        if (this.options.before !== undefined) {
            selectorMessage = `${selectorMessage} before a specified element`;
        }
        this.selectorMessage = selectorMessage;
        if (this.options.contains && !Array.isArray(this.options.contains[0])) {
            this.options.contains = [this.options.contains];
        }
        if (this.options.count) {
            hasUsedContainsPositively = true;
        } else if (!hasUsedContainsPositively) {
            throw new Error(
                `Starting a test with "contains" of count 0 for selector "${this.selector}" is useless because it might immediately resolve. Start the test by checking that an expected element actually exists.`
            );
        }
        /** @type {string} */
        this.successMessage = undefined;
        /** @type {function} */
        this.executeError = undefined;
    }

    /**
     * Starts this contains check, either immediately resolving if there is a
     * match, or registering appropriate listeners and waiting until there is a
     * match or a timeout (resolving or rejecting respectively).
     *
     * Success or failure messages will be logged with QUnit as well.
     *
     * @returns {Promise}
     */
    run() {
        this.done = false;
        this.def = makeDeferred();
        this.scrollListeners = new Set();
        this.onScroll = () => this.runOnce("after scroll");
        if (!this.runOnce("immediately")) {
            this.timer = setTimeout(
                () => this.runOnce("Timeout of 5 seconds", { crashOnFail: true }),
                5000
            );
            this.observer = new MutationObserver((mutations) => {
                try {
                    this.runOnce("after mutations");
                } catch (e) {
                    this.def.reject(e); // prevents infinite loop in case of programming error
                }
            });
            this.observer.observe(this.options.target, {
                attributes: true,
                childList: true,
                subtree: true,
            });
            registerCleanup(() => {
                if (!this.done) {
                    this.runOnce("Test ended", { crashOnFail: true });
                }
            });
        }
        return this.def;
    }

    /**
     * Runs this contains check once, immediately returning the result (or
     * undefined), and possibly resolving or rejecting the main promise
     * (and printing QUnit log) depending on options.
     * If undefined is returned it means the check was not successful.
     *
     * @param {string} whenMessage
     * @param {Object} [options={}]
     * @param {boolean} [options.crashOnFail=false]
     * @param {boolean} [options.executeOnSuccess=true]
     * @returns {HTMLElement[]|undefined}
     */
    runOnce(whenMessage, { crashOnFail = false, executeOnSuccess = true } = {}) {
        const res = this.select();
        if (res?.length === this.options.count || crashOnFail) {
            // clean before doing anything else to avoid infinite loop due to side effects
            this.observer?.disconnect();
            clearTimeout(this.timer);
            for (const el of this.scrollListeners ?? []) {
                el.removeEventListener("scroll", this.onScroll);
            }
            this.done = true;
        }
        if (res?.length === this.options.count) {
            this.successMessage = `Found ${this.selectorMessage} (${whenMessage})`;
            if (executeOnSuccess) {
                this.executeAction(res[0]);
            }
            return res;
        } else {
            this.executeError = () => {
                let message = `Failed to find ${this.selectorMessage} (${whenMessage}).`;
                message = res
                    ? `${message} Found ${res.length} instead.`
                    : `${message} Parent not found.`;
                if (this.parentContains) {
                    if (this.parentContains.successMessage) {
                        log(true, this.parentContains.successMessage);
                    } else {
                        this.parentContains.executeError();
                    }
                }
                log(false, message);
                this.def?.reject(new Error(message));
                for (const childContains of this.childrenContains || []) {
                    if (childContains.successMessage) {
                        log(true, childContains.successMessage);
                    } else {
                        childContains.executeError();
                    }
                }
            };
            if (crashOnFail) {
                this.executeError();
            }
        }
    }

    /**
     * Executes the action(s) given to this constructor on the found element,
     * prints the success messages, and resolves the main deferred.

     * @param {HTMLElement} el
     */
    executeAction(el) {
        let message = this.successMessage;
        if (this.options.click) {
            message = `${message} and clicked it`;
            webClick(el, undefined, {
                mouseEventInit: this.options.click,
                skipDisabledCheck: true,
                skipVisibilityCheck: true,
            });
        }
        if (this.options.dragenterFiles) {
            message = `${message} and dragentered ${this.options.dragenterFiles.length} file(s)`;
            const ev = new Event("dragenter", { bubbles: true });
            Object.defineProperty(ev, "dataTransfer", {
                value: createFakeDataTransfer(this.options.dragenterFiles),
            });
            el.dispatchEvent(ev);
        }
        if (this.options.dragoverFiles) {
            message = `${message} and dragovered ${this.options.dragoverFiles.length} file(s)`;
            const ev = new Event("dragover", { bubbles: true });
            Object.defineProperty(ev, "dataTransfer", {
                value: createFakeDataTransfer(this.options.dragoverFiles),
            });
            el.dispatchEvent(ev);
        }
        if (this.options.dropFiles) {
            message = `${message} and dropped ${this.options.dropFiles.length} file(s)`;
            const ev = new Event("drop", { bubbles: true });
            Object.defineProperty(ev, "dataTransfer", {
                value: createFakeDataTransfer(this.options.dropFiles),
            });
            el.dispatchEvent(ev);
        }
        if (this.options.inputFiles) {
            message = `${message} and inputted ${this.options.inputFiles.length} file(s)`;
            // could not use _createFakeDataTransfer as el.files assignation will only
            // work with a real FileList object.
            const dataTransfer = new window.DataTransfer();
            for (const file of this.options.inputFiles) {
                dataTransfer.items.add(file);
            }
            el.files = dataTransfer.files;
            /**
             * Changing files programatically is not supposed to trigger the event but
             * it does in Chrome versions before 73 (which is on runbot), so in that
             * case there is no need to make a manual dispatch, because it would lead to
             * the files being added twice.
             */
            const versionRaw = navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);
            const chromeVersion = versionRaw ? parseInt(versionRaw[2], 10) : false;
            if (!chromeVersion || chromeVersion >= 73) {
                el.dispatchEvent(new Event("change"));
            }
        }
        if (this.options.insertText !== undefined) {
            message = `${message} and inserted text "${this.options.insertText.content}" (replace: ${this.options.insertText.replace})`;
            el.focus();
            if (this.options.insertText.replace) {
                el.value = "";
                el.dispatchEvent(new window.KeyboardEvent("keydown", { key: "Backspace" }));
                el.dispatchEvent(new window.KeyboardEvent("keyup", { key: "Backspace" }));
                el.dispatchEvent(new window.InputEvent("input"));
            }
            for (const char of this.options.insertText.content) {
                el.value += char;
                el.dispatchEvent(new window.KeyboardEvent("keydown", { key: char }));
                el.dispatchEvent(new window.KeyboardEvent("keyup", { key: char }));
                el.dispatchEvent(new window.InputEvent("input"));
            }
            el.dispatchEvent(new window.InputEvent("change"));
        }
        if (this.options.pasteFiles) {
            message = `${message} and pasted ${this.options.pasteFiles.length} file(s)`;
            const ev = new Event("paste", { bubbles: true });
            Object.defineProperty(ev, "clipboardData", {
                value: createFakeDataTransfer(this.options.pasteFiles),
            });
            el.dispatchEvent(ev);
        }
        if (this.options.setFocus) {
            message = `${message} and focused it`;
            el.focus();
        }
        if (this.options.setScroll !== undefined) {
            message = `${message} and set scroll to "${this.options.setScroll}"`;
            el.scrollTop =
                this.options.setScroll === "bottom" ? el.scrollHeight : this.options.setScroll;
        }
        if (this.options.triggerEvents) {
            message = `${message} and triggered "${this.options.triggerEvents.join(", ")}" events`;
            webTriggerEvents(el, null, this.options.triggerEvents, {
                skipVisibilityCheck: true,
            });
        }
        if (this.parentContains) {
            log(true, this.parentContains.successMessage);
        }
        log(true, message);
        for (const childContains of this.childrenContains) {
            log(true, childContains.successMessage);
        }
        this.def?.resolve();
    }

    /**
     * Returns the found element(s) according to this constructor setup.
     * If undefined is returned it means the parent cannot be found
     *
     * @returns {HTMLElement[]|undefined}
     */
    select() {
        const target = this.selectParent();
        if (!target) {
            return;
        }
        const baseRes = [...target.querySelectorAll(this.selector)]
            .map((el) => (this.options.shadowRoot ? el.shadowRoot : el))
            .filter((el) => el);
        /** @type {Contains[]} */
        this.childrenContains = [];
        const res = baseRes.filter((el, currentIndex) => {
            let condition =
                (this.options.textContent === undefined ||
                    el.textContent.trim() === this.options.textContent) &&
                (this.options.value === undefined || el.value === this.options.value) &&
                (this.options.scroll === undefined ||
                    (this.options.scroll === "bottom"
                        ? Math.abs(el.scrollHeight - el.clientHeight - el.scrollTop) <= 1
                        : Math.abs(el.scrollTop - this.options.scroll) <= 1));
            if (condition && this.options.text !== undefined) {
                if (
                    el.textContent.trim() !== this.options.text &&
                    [...el.querySelectorAll("*")].every(
                        (el) => el.textContent.trim() !== this.options.text
                    )
                ) {
                    condition = false;
                }
            }
            if (condition && this.options.contains) {
                for (const param of this.options.contains) {
                    const childContains = new Contains(param[0], { ...param[1], target: el });
                    if (
                        !childContains.runOnce(`as child of el ${currentIndex + 1})`, {
                            executeOnSuccess: false,
                        })
                    ) {
                        condition = false;
                    }
                    this.childrenContains.push(childContains);
                }
            }
            if (condition && this.options.visible !== undefined) {
                if (isVisible(el) !== this.options.visible) {
                    condition = false;
                }
            }
            if (condition && this.options.after) {
                const afterContains = new Contains(this.options.after[0], {
                    ...this.options.after[1],
                    target,
                });
                const afterEl = afterContains.runOnce(`as "after"`, {
                    executeOnSuccess: false,
                })?.[0];
                if (
                    !afterEl ||
                    !(el.compareDocumentPosition(afterEl) & Node.DOCUMENT_POSITION_PRECEDING)
                ) {
                    condition = false;
                }
                this.childrenContains.push(afterContains);
            }
            if (condition && this.options.before) {
                const beforeContains = new Contains(this.options.before[0], {
                    ...this.options.before[1],
                    target,
                });
                const beforeEl = beforeContains.runOnce(`as "before"`, {
                    executeOnSuccess: false,
                })?.[0];
                if (
                    !beforeEl ||
                    !(el.compareDocumentPosition(beforeEl) & Node.DOCUMENT_POSITION_FOLLOWING)
                ) {
                    condition = false;
                }
                this.childrenContains.push(beforeContains);
            }
            return condition;
        });
        if (
            this.options.scroll !== undefined &&
            this.scrollListeners &&
            baseRes.length === this.options.count &&
            res.length !== this.options.count
        ) {
            for (const el of baseRes) {
                if (!this.scrollListeners.has(el)) {
                    this.scrollListeners.add(el);
                    el.addEventListener("scroll", this.onScroll);
                }
            }
        }
        return res;
    }

    /**
     * Returns the found element that should act as the target (parent) for the
     * main selector.
     * If undefined is returned it means the parent cannot be found.
     *
     * @returns {HTMLElement|undefined}
     */
    selectParent() {
        if (this.options.parent) {
            this.parentContains = new Contains(this.options.parent[0], {
                ...this.options.parent[1],
                target: this.options.target,
            });
            return this.parentContains.runOnce(`as parent`, { executeOnSuccess: false })?.[0];
        }
        return this.options.target;
    }
}

/**
 * Waits until `count` elements matching the given `selector` are present in
 * `options.target`.
 *
 * @param {string} selector
 * @param {ContainsOptions} [options]
 * @returns {Promise}
 */
__exports.contains = contains; async function contains(selector, options) {
    await new Contains(selector, options).run();
}

const stepState = {
    expectedSteps: null,
    deferred: null,
    timeout: null,
    currentSteps: [],

    clear() {
        clearTimeout(this.timeout);
        this.timeout = null;
        this.deferred = null;
        this.currentSteps = [];
        this.expectedSteps = null;
    },

    check({ crashOnFail = false } = {}) {
        const success =
            this.expectedSteps.length === this.currentSteps.length &&
            this.expectedSteps.every((s, i) => s === this.currentSteps[i]);
        if (!success && !crashOnFail) {
            return;
        }
        QUnit.config.current.assert.verifySteps(this.expectedSteps);
        if (success) {
            this.deferred.resolve();
        } else {
            this.deferred.reject(new Error("Steps do not match."));
        }
        this.clear();
    },
};

if (window.QUnit) {
    QUnit.testStart(() =>
        registerCleanup(() => {
            if (stepState.expectedSteps) {
                stepState.check({ crashOnFail: true });
            } else {
                stepState.clear();
            }
        })
    );
}

/**
 * Indicate the completion of a test step. This step must then be verified by
 * calling `assertSteps`.
 *
 * @param {string} step
 */
__exports.step = step; function step(step) {
    stepState.currentSteps.push(step);
    QUnit.config.current.assert.step(step);
    if (stepState.expectedSteps) {
        stepState.check();
    }
}

/**
 * Wait for the given steps to be executed or for the timeout to be reached.
 *
 * @param {string[]} steps
 */
__exports.assertSteps = assertSteps; function assertSteps(steps) {
    if (stepState.expectedSteps) {
        stepState.check({ crashOnFail: true });
    }
    stepState.expectedSteps = steps;
    stepState.deferred = makeDeferred();
    stepState.timeout = setTimeout(() => stepState.check({ crashOnFail: true }), 2000);
    stepState.check();
    return stepState.deferred;
}

return __exports;
});

odoo.define(`@web/../tests/utils`, ['@web/../tests/legacy/utils'], function (require) {
                        return require('@web/../tests/legacy/utils');
                        });
;

/**********************************************************
*  Filepath: /web/static/tests/tours/user_switch_tour.js  *
*  Lines: 156                                             *
**********************************************************/
odoo.define('@web/../tests/tours/user_switch_tour', ['@web/core/registry'], function (require) {
'use strict';
let __exports = {};
const { registry } = require("@web/core/registry");

function logout() {
    return [
        {
            content: "check we're logged in",
            trigger: ".o_user_menu .dropdown-toggle",
            run: "click",
        },
        {
            content: "click the Log out button",
            trigger: ".dropdown-item[data-menu=logout]",
            run: "click",
        },
    ];
}

registry.category("web_tour.tours").add("test_user_switch", {
    url: "/odoo",
    steps: () => [
        ...logout(),
        {
            content: "check if the login input is empty",
            trigger: "input#login:empty",
        },
        {
            content: "check if the password input is empty",
            trigger: "input#password:empty",
        },
        {
            content: "Should contains the user switch button",
            trigger: ".oe_login_form .o_user_switch_btn",
            run: "click",
        },
        {
            content: "Click on Marc Demo on the quick login page",
            trigger:
                ".o_user_switch:not(:has(.list-group-item:nth-child(2))) .list-group-item:contains('Marc Demo')",
            run: "click",
        },
        {
            content: "Check user choice button to back on the quick login page",
            trigger: ".oe_login_form .o_user_switch_btn",
            run: "click",
        },
        {
            content: "Display the login form",
            trigger: ".o_user_switch .fa-user-circle-o",
            run: "click",
        },
        {
            content: "fill the login",
            trigger: "input#login",
            run: "edit admin",
        },
        {
            content: "fill the password",
            trigger: "input#password",
            run: "edit admin",
        },
        {
            content: "click on login button",
            trigger: 'button:contains("Log in")',
            run: "click",
        },
        ...logout(),
        {
            content: "Check if there is Mitchell Admin in user list selection",
            trigger: ".o_user_switch .list-group-item:nth-child(1):contains('Mitchell Admin')",
        },
        {
            content: "Check if there is Marc Demo in user list selection",
            trigger: ".o_user_switch .list-group-item:nth-child(2):contains('Marc Demo')",
        },
        {
            content: "Choice demo",
            trigger: ".o_user_switch .list-group-item:contains('Marc Demo')",
            run: "click",
        },
        {
            content: "check the login for demo",
            trigger: "input#login:value('demo')",
        },
        {
            content: "fill the password",
            trigger: "input#password",
            run: "edit demo",
        },
        {
            content: "Check back button to back on the quick login page",
            trigger: ".oe_login_form .o_user_switch_btn",
            run: "click",
        },
        {
            content: "Check have 2 users",
            trigger: ".o_user_switch .list-group-item:nth-child(2)",
        },
        {
            content: "Click on Mitchell Admin",
            trigger: ".o_user_switch .list-group-item:nth-child(1):contains('Mitchell Admin')",
            run: "click",
        },
        {
            content: "check the login for admin",
            trigger: "input#login:value('admin')",
        },
        {
            content: "fill the password",
            trigger: "input#password",
            run: "edit admin",
        },
        {
            content: "Check back button to back on the quick login page",
            trigger: ".oe_login_form .o_user_switch_btn",
            run: "click",
        },
        {
            content: "Display the login form",
            trigger: ".o_user_switch .fa-user-circle-o",
            run: "click",
        },
        {
            content: "the login form is display",
            trigger: "form.oe_login_form:not(.d-none)",
        },
        {
            content: "check if the login input is empty",
            trigger: "input#login:empty",
        },
        {
            content: "check if the password input is empty",
            trigger: "input#password:empty",
        },
        {
            content: "Back to user switch",
            trigger: ".oe_login_form .o_user_switch_btn",
            run: "click",
        },
        {
            content: "Remove the admin user from page",
            trigger: ".o_user_switch .d-flex:first-child .fa-times",
            run: "click",
        },
        {
            content: "only one user is left on quick login",
            trigger:
                ".o_user_switch:not(:has(.list-group-item:nth-child(2))) .list-group-item:contains('Marc Demo')",
        },
    ],
});

return __exports;
});
;

/********************************************************************
*  Filepath: /mail/static/tests/tours/activity_date_format_tour.js  *
*  Lines: 49                                                        *
********************************************************************/
odoo.define('@mail/../tests/tours/activity_date_format_tour', ['@web/core/registry'], function (require) {
'use strict';
let __exports = {};
const { registry } = require("@web/core/registry");

registry.category("web_tour.tours").add("mail_activity_date_format", {
    steps: () => [
        {
            trigger: "button:contains('Activities')",
            run: "click",
        },
        {
            trigger: "input[id*='activity_type_id']",
            run: "click",
        },
        {
            trigger: ".dropdown-item:contains('To-Do')",
            run: "click",
        },
        {
            trigger: "div[name='summary'] input",
            run: "edit Go Party",
        },
        {
            trigger: "button:contains('Schedule')",
            run: "click",
        },
        {
            trigger: ".o-mail-Activity:contains('Go Party')",
            run: "click",
        },
        {
            trigger: ".o-mail-Activity-info i",
            run: "click",
        },
        // Format expected from the server for 9 AM at the first day of 2024 is date_format = "%d/%b/%y", time_format = "%I:%M:%S %p".
        {
            trigger:
                ".o-mail-Activity-details tr:contains('Created') td:contains('01/Jan/24 09:00:00 AM')",
        },
        {
            // Default due date is 5 days after creation date.
            trigger: ".o-mail-Activity-details tr:contains('Due on') td:contains('06/Jan/24')",
        },
    ],
});

return __exports;
});
;

/************************************************************************
*  Filepath: /mail/static/tests/tours/discuss_channel_as_guest_tour.js  *
*  Lines: 30                                                            *
************************************************************************/
odoo.define('@mail/../tests/tours/discuss_channel_as_guest_tour', ['@web/core/registry'], function (require) {
'use strict';
let __exports = {};
const { registry } = require("@web/core/registry");

registry.category("web_tour.tours").add("discuss_channel_as_guest_tour.js", {
    steps: () => [
        {
            content: "Channel secret token has been hidden on welcome page",
            trigger: ".o-mail-WelcomePage",
            run() {
                if (!window.location.pathname.startsWith("/discuss/channel")) {
                    console.error("Channel secret token is still present in URL.");
                }
            },
        },
        {
            content: "Click join",
            trigger: "button[title='Join Channel']",
            run: "click",
        },
        {
            content: "Check that we are on channel page",
            trigger: ".o-mail-Thread",
        },
    ],
});

return __exports;
});
;

/***************************************************************************
*  Filepath: /mail/static/tests/tours/discuss_channel_call_public_tour.js  *
*  Lines: 36                                                               *
***************************************************************************/
odoo.define('@mail/../tests/tours/discuss_channel_call_public_tour', ['@web/core/registry'], function (require) {
'use strict';
let __exports = {};
const { registry } = require("@web/core/registry");

registry.category("web_tour.tours").add("discuss_channel_call_public_tour.js", {
    steps: () => [
        {
            content: "The call does not start on the welcome page",
            trigger: ".o-mail-WelcomePage",
            async run() {
                await new Promise((r) => setTimeout(r, 250));
                const rtcService = odoo.__WOWL_DEBUG__.root.env.services["discuss.rtc"];
                if (rtcService?.selfSession || rtcService?.state.hasPendingRequest) {
                    console.error("The call should not have started.");
                }
            },
        },
        {
            content: "Click join",
            trigger: "button[title='Join Channel']",
            run: "click",
        },
        {
            content: "Check that the call has started",
            trigger: ".o-discuss-Call",
        },
        {
            content: "Check that current user is in call ('disconnect' button visible)",
            trigger: "button[title='Disconnect']",
        },
    ],
});

return __exports;
});
;

/**********************************************************************
*  Filepath: /mail/static/tests/tours/discuss_channel_public_tour.js  *
*  Lines: 214                                                         *
**********************************************************************/
odoo.define('@mail/../tests/tours/discuss_channel_public_tour', ['@web/core/registry', '@web/../tests/utils'], function (require) {
'use strict';
let __exports = {};
const { registry } = require("@web/core/registry");
const { click, contains, inputFiles } = require("@web/../tests/utils");

registry.category("web_tour.tours").add("discuss_channel_public_tour.js", {
    steps: () => [
        {
            trigger: ".o-mail-Discuss",
        },
        {
            content: "Check that we are on channel page",
            trigger: ".o-mail-Thread",
            run() {
                if (!window.location.pathname.startsWith("/discuss/channel")) {
                    console.error("Channel secret token is still present in URL.");
                }
                const errors = odoo.loader.findErrors();
                if (Object.keys(errors).length) {
                    console.error("Couldn't load all JS modules.", errors);
                }
                document.body.classList.add("o_discuss_channel_public_modules_loaded");
                if (
                    document.title !== document.querySelector(".o-mail-Discuss-threadName")?.value
                ) {
                    console.error("Tab title should match conversation name.");
                }
            },
        },
        {
            content: "Wait for all modules loaded check in previous step",
            trigger: ".o_discuss_channel_public_modules_loaded",
        },
        {
            content: "Write something in composer",
            trigger: ".o-mail-Composer-input",
            run: "edit cheese",
        },
        {
            content: "Add a text file in composer",
            trigger: ".o-mail-Composer button[aria-label='Attach files']",
            async run() {
                const text = new File(["hello, world"], "text.txt", { type: "text/plain" });
                await inputFiles(".o-mail-Composer-coreMain .o_input_file", [text]);
            },
        },
        {
            trigger: ".o-mail-AttachmentCard:not(.o-isUploading)", // waiting the attachment to be uploaded
        },
        {
            content: "Check the text attachment is listed",
            trigger: '.o-mail-AttachmentCard[title="text.txt"]',
        },
        {
            content: "Add an image file in composer",
            trigger: ".o-mail-Composer button[aria-label='Attach files']",
            async run() {
                await inputFiles(".o-mail-Composer-coreMain .o_input_file", [
                    new File(
                        [
                            await (
                                await fetch(
                                    "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQIW2P4v5ThPwAG7wKklwQ/bwAAAABJRU5ErkJggg=="
                                )
                            ).blob(),
                        ],
                        "image.png",
                        { type: "image/png" }
                    ),
                ]);
            },
        },
        {
            trigger: ".o-mail-AttachmentImage:not(.o-isUploading)",
        },
        {
            content: "Check the image attachment is listed",
            trigger: '.o-mail-AttachmentImage[title="image.png"]',
            async run() {
                const store = odoo.__WOWL_DEBUG__.root.env.services["mail.store"];
                if (store.self.type === "guest") {
                    const src = this.anchor.querySelector("img").src;
                    const token = store.Attachment.get(
                        (src.match("/web/image/([0-9]+)") || []).at(-1)
                    )?.access_token;
                    if (!(token && src.includes(`access_token=${token}`))) {
                        throw new Error("Access token of the attachment isn't correct.");
                    }
                }
            },
        },
        {
            content: "Send message",
            trigger: ".o-mail-Composer-send:enabled",
            run: "click",
        },
        {
            content: "Check message is shown",
            trigger: '.o-mail-Message-body:contains("cheese")',
        },
        {
            content: "Check message contains the attachment",
            trigger: '.o-mail-Message .o-mail-AttachmentCard:contains("text.txt")',
        },
        {
            trigger: ".o-mail-Message-textContent:contains(cheese)",
            run: "hover && click .o-mail-Message [title='Add a Reaction']",
        },
        {
            trigger: ".o-EmojiPicker .o-Emoji:contains('')",
            run: "click",
        },
        {
            content: "Reload page (fetch reactions)",
            trigger: ".o-mail-Message",
            run() {
                location.reload();
            },
        },
        {
            content: "Remove reaction",
            trigger: ".o-mail-MessageReaction:contains('')",
            run: "click",
        },
        {
            content: "Reload page (fetch reactions)",
            trigger: ".o-mail-Message",
            run() {
                location.reload();
            },
        },
        {
            trigger: ".o-mail-Message:not(:has(.o-mail-MessageReaction))",
        },
        {
            content: "Click on more menu",
            trigger: ".o-mail-Message-textContent:contains(cheese)",
            run: "hover && click .o-mail-Message [title='Expand']",
        },
        {
            content: "Click on edit",
            trigger: ".o-mail-Message-moreMenu [title='Edit'], .o-mail-Message [title='Edit']",
            run: "click",
        },
        {
            content: "Edit message",
            trigger: ".o-mail-Message .o-mail-Composer-input",
            run: "edit vegetables",
        },
        {
            content: "Add one more file in composer",
            trigger: ".o-mail-Message button[aria-label='Attach files']",
            async run() {
                const extratxt = new File(["hello 2"], "extra.txt", { type: "text/plain" });
                await inputFiles(".o-mail-Message .o_input_file", [extratxt]);
            },
        },
        {
            trigger: ".o-mail-Message .o-mail-Composer .o-mail-AttachmentCard:not(.o-isUploading)", // waiting the attachment to be uploaded
        },
        {
            content: "Check the earlier provided extra attachment is listed",
            trigger: '.o-mail-Message .o-mail-Composer .o-mail-AttachmentCard[title="extra.txt"]',
        },
        {
            content: "Save edited message",
            trigger: ".o-mail-Message a:contains(save)",
            run: "click",
        },
        {
            content: "Check message is edited",
            trigger: '.o-mail-Message-body:contains("vegetables")',
        },
        {
            content: "Check edited message contains the first attachment",
            trigger: '.o-mail-Message .o-mail-AttachmentCard:contains("text.txt")',
        },
        {
            content: "Check edited message contains the extra attachment",
            trigger: '.o-mail-Message .o-mail-AttachmentCard:contains("extra.txt")',
            async run() {
                await click(".o-mail-AttachmentCard-unlink", {
                    parent: [".o-mail-AttachmentCard", { text: "extra.txt" }],
                });
                await click(".btn", { text: "Ok", parent: [".modal", { text: "Confirmation" }] });
                await contains(".o-mail-AttachmentCard", { text: "extra.txt", count: 0 });
            },
        },
        {
            content: "Open search panel",
            trigger: "button[title='Search Messages']",
            run: "click",
        },
        {
            content: "Search for the attachment name",
            trigger: ".o_searchview_input",
            run: "edit text.txt",
        },
        {
            content: "Trigger the search",
            trigger: "button[aria-label='Search button']",
            run: "click",
        },
        {
            content: "Check that searched message contains the attachment",
            trigger:
                '.o-mail-SearchMessagesPanel .o-mail-Message .o-mail-AttachmentCard:contains("text.txt")',
        },
    ],
});

return __exports;
});
;

/*********************************************************************
*  Filepath: /mail/static/tests/tours/discuss_configuration_tour.js  *
*  Lines: 88                                                         *
*********************************************************************/
odoo.define('@mail/../tests/tours/discuss_configuration_tour', ['@web/core/registry', '@web_tour/tour_service/tour_utils'], function (require) {
'use strict';
let __exports = {};
const { registry } = require("@web/core/registry");
const { stepUtils } = require("@web_tour/tour_service/tour_utils");

registry.category("web_tour.tours").add("discuss_configuration_tour", {
    url: "/odoo",
    steps: () => [
        stepUtils.showAppsMenuItem(),
        {
            trigger: '.o_app[data-menu-xmlid="mail.menu_root_discuss"]',
            run: "click",
        },
        {
            trigger: ".o_main_navbar button:contains('Configuration')",
            run: "click",
        },
        {
            trigger: ".dropdown-menu a:contains('Notification')",
            run: "click",
        },
        {
            trigger: ".o-mail-DiscussNotificationSettings label:contains('Mute')",
            run: "click",
        },
        {
            trigger: "button:contains('All Messages')",
            run: "click",
        },
        {
            trigger: "button:contains('Mentions Only')",
            run: "click",
        },
        {
            trigger: "button:contains('Nothing')",
            run: "click",
        },
        {
            trigger: ".modal-header button[aria-label='Close']",
            run: "click",
        },
        {
            trigger: ".o_main_navbar button:contains('Configuration')",
            run: "click",
        },
        {
            trigger: ".dropdown-menu a:contains('Voice & Video')",
            run: "click",
        },
        {
            trigger: "select[name='inputDevice']",
        },
        {
            trigger: "button:contains('Voice Detection')",
            run: "click",
        },
        {
            trigger: "label:contains('Voice detection threshold')",
        },
        {
            trigger: "button:contains('Push to Talk')",
            run: "click",
        },
        {
            trigger: "label:contains('Push-to-talk key')",
        },
        {
            trigger: "label:contains('Delay after releasing push-to-talk')",
        },
        {
            trigger: "input[aria-label='Show video participants only']",
        },
        {
            trigger: "input[aria-label='Blur video background']",
            run: "click",
        },
        {
            trigger: "label:contains('Background blur intensity')",
        },
        {
            trigger: "label:contains('Edge blur intensity')",
        },
    ],
});

return __exports;
});
;

/******************************************************************************************
*  Filepath: /mail/static/tests/tours/discuss_go_back_to_thread_from_breadcrumbs_tour.js  *
*  Lines: 17                                                                              *
******************************************************************************************/
odoo.define('@mail/../tests/tours/discuss_go_back_to_thread_from_breadcrumbs_tour', ['@web/core/registry'], function (require) {
'use strict';
let __exports = {};
const { registry } = require("@web/core/registry");

registry.category("web_tour.tours").add("discuss_go_back_to_thread_from_breadcrumbs.js", {
    steps: () => [
        { trigger: ".o-mail-Discuss-threadName[title='Inbox']" },
        { trigger: ".o-mail-DiscussSidebar-item:contains(Starred)", run: "click" },
        { trigger: "button[title='View or join channels']", run: "click" },
        { trigger: ".breadcrumb-item:contains(Starred)", run: "click" },
        { trigger: ".o-mail-Discuss-threadName[title='Starred']" },
    ],
});

return __exports;
});
;

/******************************************************************************
*  Filepath: /mail/static/tests/tours/discuss_sidebar_in_public_page_tour.js  *
*  Lines: 46                                                                  *
******************************************************************************/
odoo.define('@mail/../tests/tours/discuss_sidebar_in_public_page_tour', ['@web/core/registry'], function (require) {
'use strict';
let __exports = {};
const { registry } = require("@web/core/registry");

registry.category("web_tour.tours").add("sidebar_in_public_page_tour", {
    steps: () => [
        {
            trigger: ".o-mail-Discuss-header [title='Channel 1']",
        },
        {
            trigger: ".o-mail-DiscussSidebarChannel:contains(Channel 1).o-active",
        },
        {
            trigger: ".o-mail-DiscussSidebarChannel:contains(Channel 2)",
            run: "click",
        },
        {
            trigger: ".o-mail-Discuss-header [title='Channel 2']",
        },
        {
            trigger: ".o-mail-DiscussSidebarChannel:contains(Channel 2).o-active",
            run() {
                history.back();
            },
        },
        {
            trigger: ".o-mail-Discuss-header [title='Channel 1']",
        },
        {
            trigger: ".o-mail-DiscussSidebarChannel:contains(Channel 1).o-active",
            run() {
                history.forward();
            },
        },
        {
            trigger: ".o-mail-Discuss-header [title='Channel 2']",
        },
        {
            trigger: ".o-mail-DiscussSidebarChannel:contains(Channel 2).o-active",
        },
    ],
});

return __exports;
});
;

/**************************************************************************
*  Filepath: /mail/static/tests/tours/discuss_sub_channel_search_tour.js  *
*  Lines: 142                                                             *
**************************************************************************/
odoo.define('@mail/../tests/tours/discuss_sub_channel_search_tour', ['@web/../tests/utils', '@web/core/registry'], function (require) {
'use strict';
let __exports = {};
const { contains, dragenterFiles, dropFiles, scroll } = require("@web/../tests/utils");
const { registry } = require("@web/core/registry");

registry.category("web_tour.tours").add("test_discuss_sub_channel_search", {
    steps: () => [
        {
            trigger: "button[title='Threads']",
            run: "click",
        },
        {
            trigger: ".o-mail-SubChannelList",
            async run() {
                // 30 newest sub channels are loaded initially.
                for (let i = 99; i > 69; i--) {
                    await contains(".o-mail-SubChannelList-thread", {
                        text: `Sub Channel ${i}`,
                    });
                    await contains(".o-mail-SubChannelList-thread", { count: 30 });
                }
            },
        },
        {
            trigger: ".o-mail-ActionPanel:has(.o-mail-SubChannelList) .o_searchview_input",
            run: "edit Sub Channel 10",
        },
        {
            trigger:
                ".o-mail-ActionPanel:has(.o-mail-SubChannelList) button[aria-label='Search button']",
            run: "click",
        },
        {
            trigger: ".o-mail-SubChannelList-thread:contains(Sub Channel 10)",
            async run() {
                await contains(".o-mail-SubChannelList-thread", { count: 1 });
            },
        },
        {
            trigger: ".o_searchview_input",
            run: "clear",
        },
        {
            trigger: ".o-mail-SubChannelList-thread:contains(Sub Channel 99)",
            async run() {
                await contains(".o-mail-SubChannelList-thread", { count: 31 });
                // Already fetched sub channels are shown in addition to the one
                // that was fetched during the search.
                for (let i = 99; i > 69; i--) {
                    await contains(".o-mail-SubChannelList-thread", {
                        text: `Sub Channel ${i}`,
                    });
                }
                await contains(".o-mail-SubChannelList-thread", { text: `Sub Channel 10` });
                // Ensure lazy loading is still working after a search.
                await scroll(".o-mail-ActionPanel:has(.o-mail-SubChannelList)", "bottom");
            },
        },
        {
            trigger: ".o-mail-SubChannelList-thread:contains(Sub Channel 40)",
            async run() {
                await contains(".o-mail-SubChannelList-thread", { count: 61 });
                for (let i = 99; i > 39; i--) {
                    await contains(".o-mail-SubChannelList-thread", {
                        text: `Sub Channel ${i}`,
                    });
                }
                await scroll(".o-mail-ActionPanel:has(.o-mail-SubChannelList)", "bottom");
            },
        },
        {
            trigger: ".o-mail-SubChannelList-thread:contains(Sub Channel 11)",
            async run() {
                await contains(".o-mail-SubChannelList-thread", { count: 90 });
                for (let i = 99; i > 9; i--) {
                    await contains(".o-mail-SubChannelList-thread", {
                        text: `Sub Channel ${i}`,
                    });
                }
                await scroll(".o-mail-ActionPanel:has(.o-mail-SubChannelList)", "bottom");
            },
        },
        {
            trigger: ".o-mail-SubChannelList-thread:contains(Sub Channel 0)",
            async run() {
                await contains(".o-mail-SubChannelList-thread", { count: 100 });
                for (let i = 99; i > 0; i--) {
                    await contains(".o-mail-SubChannelList-thread", {
                        text: `Sub Channel ${i}`,
                    });
                }
            },
        },
    ],
});

registry.category("web_tour.tours").add("create_thread_for_attachment_without_body", {
    steps: () => [
        {
            content: "Open general channel",
            trigger: '.o-mail-DiscussSidebarChannel-itemName:contains("general")',
            run: "click",
        },
        {
            content: "Drop a file",
            trigger: ".o-mail-Discuss-main",
            async run() {
                const files = [new File(["hi there"], "file2.txt", { type: "text/plain" })];
                await dragenterFiles(".o-mail-Discuss-main", files);
                await dropFiles(".o-Dropzone", files);
            },
        },
        {
            content: "Click on send button",
            trigger: ".o-mail-Composer-send",
            run: "click",
        },
        {
            content: "Hover on attachment",
            trigger: '.o-mail-Message .o-mail-AttachmentCard:contains("file2.txt")',
            run: "hover",
        },
        {
            content: "Click on expand button",
            trigger: '.o-mail-Message [title="Expand"]',
            run: "click",
        },
        {
            content: "Create a new thread",
            trigger: '.o-dropdown-item:contains("Create Thread")',
            run: "click",
        },
        {
            content: "Check a new thread is created",
            trigger: '.o-mail-Discuss:contains("New Thread")',
        },
    ],
});

return __exports;
});
;

/******************************************************************************
*  Filepath: /mail/static/tests/tours/mail_activity_schedule_from_chatter.js  *
*  Lines: 65                                                                  *
******************************************************************************/
odoo.define('@mail/../tests/tours/mail_activity_schedule_from_chatter', ['@web/core/registry'], function (require) {
'use strict';
let __exports = {};
const { registry } = require("@web/core/registry");

registry.category("web_tour.tours").add("mail_activity_schedule_from_chatter", {
    steps: () => [
        {
            trigger: "button:contains('Activities')",
            run: "click",
        },
        {
            trigger: "input[id*='activity_type_id']",
            run: "click",
        },
        {
            trigger: ".dropdown-item:contains('Call')",
            run: "click",
        },
        {
            trigger: "input[id*='activity_type_id']:value('Call')",
        },
        {
            trigger: "button:contains('Schedule')",
        },
        {
            trigger: "input[id*='activity_type_id']",
            run: "click",
        },
        {
            trigger: ".dropdown-item:contains('To-Do')",
            run: "click",
        },
        {
            trigger: "div[name='summary'] input",
            run: "edit Play Mario Party",
        },
        {
            trigger: "button:contains('Schedule')",
            run: "click",
        },
        {
            trigger: ".o-mail-Activity:contains('Play Mario Party')",
            run: "click",
        },
        {
            trigger: "button:contains('Activities')",
            run: "click",
        },
        {
            trigger: "div[name='summary'] input",
            run: "edit Play Mario Kart",
        },
        {
            trigger: "button:contains('Mark as Done')",
            run: "click",
        },
        {
            trigger: ".o-mail-Message:contains('Play Mario Kart')",
        },
    ],
});

return __exports;
});
;

/******************************************************************
*  Filepath: /mail/static/tests/tours/mail_composer_test_tour.js  *
*  Lines: 272                                                     *
******************************************************************/
odoo.define('@mail/../tests/tours/mail_composer_test_tour', ['@web/core/registry', '@web/../tests/utils'], function (require) {
'use strict';
let __exports = {};
const { registry } = require("@web/core/registry");
const { contains, dragenterFiles, dropFiles, inputFiles } = require("@web/../tests/utils");

/**
 * This tour depends on data created by python test in charge of launching it.
 * It is not intended to work when launched from interface. It is needed to test
 * an action (action manager) which is not possible to test with QUnit.
 * @see mail/tests/test_mail_composer.py
 */
registry.category("web_tour.tours").add("mail/static/tests/tours/mail_composer_test_tour.js", {
    steps: () => [
        {
            content: "Wait for the chatter to be fully loaded",
            trigger: ".o-mail-Chatter",
            async run() {
                await contains(".o-mail-Message", { count: 1 });
            },
        },
        {
            content: "Click on Send Message",
            trigger: "button:contains(Send message)",
            run: "click",
        },
        {
            content: "Write something in composer",
            trigger: ".o-mail-Composer-input",
            run: "edit blahblah @Not && click body",
        },
        {
            content: "Mention a partner",
            trigger: ".o-mail-Composer-suggestion:contains(Not A Demo User)",
            run: "click",
        },
        {
            content: "Add one file in composer",
            trigger: ".o-mail-Composer button[aria-label='Attach files']",
            async run() {
                const files = [new File(["hello, world"], "file1.txt", { type: "text/plain" })];
                await inputFiles(".o-mail-Composer-coreMain .o_input_file", files);
            },
        },
        {
            trigger: ".o-mail-AttachmentCard:not(.o-isUploading)", // waiting the attachment to be uploaded
        },
        {
            content: "Open full composer",
            trigger: "button[aria-label='Full composer']",
            run: "click",
        },
        {
            content: "Check composer keeps open after pushing Escape",
            trigger: ".o_mail_composer_form_view",
            run: "press Escape",
        },
        {
            content: "Check the earlier provided attachment is listed",
            trigger: ".o_field_mail_composer_attachment_list a:contains(file1.txt)",
        },
        {
            content: "Check subject is autofilled",
            trigger: '[name="subject"] input',
            run() {
                const subjectValue = document.querySelector('[name="subject"] input').value;
                if (subjectValue !== "Jane") {
                    console.error(
                        `Full composer should have "Jane" in subject input (actual: ${subjectValue})`
                    );
                }
            },
        },
        {
            content: "Check composer content is kept and contains the user's signature",
            trigger: '.o_field_html[name="body"]',
            run() {
                const bodyContent = document.querySelector(
                    '.o_field_html[name="body"]'
                ).textContent;
                if (!bodyContent.includes("blahblah @Not A Demo User")) {
                    console.error(
                        `Full composer should contain text from small composer ("blahblah @Not A Demo User") in body input (actual: ${bodyContent})`
                    );
                }
                const mentionLink = document.querySelector(
                    '.o_field_html[name="body"] a'
                ).textContent;
                if (!mentionLink.includes("@Not A Demo User")) {
                    console.error(
                        `Full composer should contain mention link from small composer ("@Not A Demo User") in body input)`
                    );
                }
                /** When opening the full composer for the first time, the system
                 * should add the user's signature to the end of the message so
                 * that the user can edit it. After adding the signature to
                 * the editor, the server shouldn't automatically add the
                 * signature to the message (see: Python tests). */
                if ((bodyContent.match(/--\nErnest/g) || []).length !== 1) {
                    console.error("Full composer should contain the user's signature once.");
                }
            },
        },
        {
            content: "Drop a file on the full composer",
            trigger: ".o_mail_composer_form_view",
            async run() {
                const files = [new File(["hi there"], "file2.txt", { type: "text/plain" })];
                await dragenterFiles(".o_mail_composer_form_view .o_form_renderer", files);
                await dropFiles(".o-Dropzone", files);
            }
        },
        {
            content: "Check the attachment is listed",
            trigger: ".o_field_mail_composer_attachment_list a:contains(file2.txt)",
        },
        {
            content: "Click on the mail template selector",
            trigger: ".mail-composer-template-dropdown-btn",
            run: "click",
        },
        {
            content: "Check a template is listed",
            trigger:
                '.mail-composer-template-dropdown.popover .o-dropdown-item:contains("Test template")',
        },
        {
            content: "Send message from full composer",
            trigger: ".o_mail_send",
            run: "click",
        },
        {
            content: "Check message is shown",
            trigger: '.o-mail-Message-body:contains("blahblah @Not A Demo User")',
            run: "click",
        },
        {
            content: "Click on envelope to see recipients of message",
            trigger:
                '.o-mail-Message:has(.o-mail-Message-body:contains("blahblah @Not A Demo User")) .o-mail-Message-notification',
            run: "click",
        },
        {
            content: "Check message has correct recipients",
            trigger: ".o-mail-MessageNotificationPopover:contains('Not A Demo User\nJane')",
        },
        {
            content: "Check message contains the first attachment",
            trigger: '.o-mail-Message .o-mail-AttachmentCard:contains("file1.txt")',
        },
        {
            content: "Check message contains the second attachment",
            trigger: '.o-mail-Message .o-mail-AttachmentCard:contains("file2.txt")',
        },
        // Test the full composer input text is kept on closing
        {
            content: "Click on Send Message",
            trigger: "button:contains(Send message)",
            run: "click",
        },
        {
            content: "Open full composer",
            trigger: "button[aria-label='Full composer']",
            run: "click",
        },
        {
            content: "Check that the composer contains the signature",
            trigger: '.o_field_html[name="body"]',
            run() {
                const bodyContent = document.querySelector(
                    '.o_field_html[name="body"]'
                ).textContent;
                /** When opening the full composer, the system should add the
                 * user's signature, as this is a new message and the signature
                 * has not yet been added to it. */
                if ((bodyContent.match(/--\nErnest/g) || []).length !== 1) {
                    console.log("Full composer should contain the user's signature once.");
                }
            }
        },
        {
            content: "Write something in full composer",
            trigger: ".note-editable",
            run: "editor keep the content",
        },
        {
            content: "Close full composer",
            trigger: ".btn-close",
            run: "click",
        },
        {
            content: "Click on Send Message",
            trigger: "button:contains(Send message)",
            run: "click",
        },
        {
            content: "Check full composer text is kept",
            trigger: ".o-mail-Composer-input",
            run() {
                if (this.anchor.value !== "keep the content") {
                    console.error(
                        "Composer in chatter should contain full composer text after discarding."
                    );
                }
            },
        },
        {
            content: "Open full composer",
            trigger: "button[aria-label='Full composer']",
            run: "click",
        },
        {
            content: "Check that the composer doesn't add the user's signature twice",
            trigger: ".note-editable",
            run() {
                const bodyContent = document.querySelector(
                    '.o_field_html[name="body"]'
                ).textContent;
                /** When re-opening the full composer, the system shouldn't re-add
                 * the user's signature to the message. As the user deleted the
                 * signature in the previous steps (see: `editor keep the content`),
                 * the editor shouldn't contain any signature. */
                if ((bodyContent.match(/--\nErnest/g) || []).length !== 0) {
                    console.error("The composer should not contain the user's signature.");
                }
            }
        },
        {
            content: "Close full composer",
            trigger: ".btn-close",
            run: "click",
        },
        {
            content: "Click on Send Message",
            trigger: "button:contains(Send message)",
            run: "click",
        },
        {
            content: "Send message from chatter",
            trigger: ".o-mail-Composer-send",
            run: "click"
        },
        {
            content: "Check message is shown",
            trigger: '.o-mail-Message-body:contains("keep the content")',
        },
        // Test that the server automatically adds the user's signature to the
        // email when the user didn't open the full composer.
        {
            content: "Click on Send Message",
            trigger: "button:contains(Send message)",
            run: "click",
        },
        {
            content: "Write a message",
            trigger: ".o-mail-Composer-input",
            run: "edit hello world",
        },
        {
            content: "Send message from chatter",
            trigger: ".o-mail-Composer-send",
            run: "click"
        },
        {
            content: "Check message is shown",
            trigger: '.o-mail-Message-body:contains("hello world")',
        },
    ],
});

return __exports;
});
;

/***********************************************************************
*  Filepath: /mail/static/tests/tours/mail_message_load_order_tour.js  *
*  Lines: 75                                                           *
***********************************************************************/
odoo.define('@mail/../tests/tours/mail_message_load_order_tour', ['@web/core/registry', '@web/../tests/utils'], function (require) {
'use strict';
let __exports = {};
const { registry } = require("@web/core/registry");
const { contains, scroll } = require("@web/../tests/utils");

registry.category("web_tour.tours").add("mail_message_load_order_tour", {
    steps: () => [
        {
            trigger: ".o-mail-DiscussSidebarChannel:contains(MyTestChannel)",
            run: "click",
        },
        {
            trigger: ".o-mail-Thread .o-mail-Message",
            async run() {
                await contains(".o-mail-Thread .o-mail-Message", { count: 30 });
                await contains(".o-mail-Thread", { scroll: "bottom" });
            },
        },
        {
            trigger: "*[title='Pinned Messages']",
            run: "click",
        },
        {
            content: "Click on invisible jump (should hover card to be visible)",
            trigger: ".o-mail-MessageCard-jump:not(:visible)",
            run: "click",
        },
        {
            // Messages depends on FETCH_LIMIT (currently set to 60) in
            // the thread service. Thus, at first load the message range
            // will be (31 - 60). This trigger ensures the next messages
            // are fetched after jumping to the message.
            trigger:
                ".o-mail-Thread .o-mail-Message:first .o-mail-Message-textContent:not(:contains(31))",
            async run() {
                await contains(".o-mail-Thread .o-mail-Message", { count: 31 });
                await contains(".o-mail-Thread", { scroll: 0 });
                // ensure 1 - 31 are loaded in order: 30 below and the
                // one we're loading messages around.
                const messages = Array.from(
                    document.querySelectorAll(".o-mail-Thread .o-mail-Message-content")
                ).map((el) => el.innerText);
                for (let i = 0; i < 31; i++) {
                    if (messages[i] !== (i + 1).toString()) {
                        throw new Error("Wrong message order after loading around");
                    }
                }
                await scroll(".o-mail-Thread", "bottom");
            },
        },
        {
            // After jumping to the pinned message, the message range
            // was (1 -31): 30 before (but none were found), 30 after
            // and the pinned message itself. This trigger ensures the
            // next messages are fetched after scrolling to the bottom.
            trigger: ".o-mail-Thread .o-mail-Message .o-mail-Message-textContent:contains(17)",
            async run() {
                await contains(".o-mail-Thread .o-mail-Message", { count: 60 });
                // ensure 1 - 60  are loaded in order.
                const messages = Array.from(
                    document.querySelectorAll(".o-mail-Thread .o-mail-Message-content")
                ).map((el) => el.innerText);
                for (let i = 0; i < 60; i++) {
                    if (messages[i] !== (i + 1).toString()) {
                        throw new Error("Wrong message order after loading after");
                    }
                }
            },
        },
    ],
});

return __exports;
});
;

/*********************************************************************************
*  Filepath: /mail/static/tests/tours/mail_template_dynamic_placeholder_tour.js  *
*  Lines: 176                                                                    *
*********************************************************************************/
odoo.define('@mail/../tests/tours/mail_template_dynamic_placeholder_tour', ['@web/core/registry', '@web_tour/tour_service/tour_utils', '@odoo/hoot-dom'], function (require) {
'use strict';
let __exports = {};
const { registry } = require("@web/core/registry");
const { stepUtils } = require("@web_tour/tour_service/tour_utils");
const { delay } = require("@odoo/hoot-dom");

registry.category("web_tour.tours").add("mail_template_dynamic_placeholder_tour", {
    url: "/odoo",
    steps: () => [
        stepUtils.showAppsMenuItem(),
        {
            content: 'Go into the Setting "app"',
            trigger: '.o_app[data-menu-xmlid="base.menu_administration"]',
            run: "click",
        },
        {
            content: "Open email templates",
            trigger: 'button[name="open_mail_templates"]',
            run: "click",
        },
        {
            content: "Create a new email template",
            trigger: "button.o_list_button_add",
            run: "click",
        },
        {
            content: 'Insert # inside "Subject" input',
            trigger: 'div[name="subject"] input[type="text"]',
            run: "edit(no_model_id #)",
        },
        {
            content: 'Select "Contact" model',
            trigger: 'div[name="model_id"] input[type="text"]',
            run: "edit Contact",
        },
        {
            content: "Wait for the autocomplete RPC",
            trigger: 'div[name="model_id"] .ui-autocomplete:contains("Contact")',
            run: async() => {
                await delay(300);
            }
        },
        {
            content: "Click on contact",
            trigger: 'div[name="model_id"] .ui-autocomplete',
            run: async function () {
                const contact = Array.from(
                    document.querySelectorAll(
                        'div[name="model_id"] .ui-autocomplete .dropdown-item'
                    )
                ).find((el) => el.textContent === "Contact");
                await contact.click();
            },
        },
        {
            content: "Wait for the drop down to disappear",
            trigger: 'div[name="model_id"] .o-autocomplete:not(:has(.ui-autocomplete))',
            run: async () => {
                // Ensure the system has registered a correct model value before
                // we try to open the DPH.
                // It seems that the autocomplete validation can be very slow.
                await new Promise((r) => setTimeout(r, 200));
            },
        },
        {
            content: 'Retry insert # inside "Subject" input',
            trigger: 'div[name="subject"] input[type="text"]',
            run: "edit (yes_model_id) && press #",
        },
        {
            content: "Check if the dynamic placeholder popover is opened",
            trigger: "div.o_model_field_selector_popover",
        },
        {
            content: "filter the dph result",
            trigger: "div.o_model_field_selector_popover_search input[type='text']",
            run: "edit name",
        },
        {
            content: "Click on the first entry of the dynamic placeholder",
            trigger: 'div.o_model_field_selector_popover button:contains("Company Name")',
            run: "click",
        },
        {
            content: "Enter a default value",
            trigger:
                'div.o_model_field_selector_popover .o_model_field_selector_default_value_input input[type="text"]',
            run: "edit defValue",
        },
        {
            content: "Click on the insert button",
            trigger: "div.o_model_field_selector_popover button:first-child",
            run: "click",
        },
        {
            content: "Wait for the popover to disappear",
            trigger: "body:not(:has(.o_model_field_selector_popover))",
            run: "click",
        },
        {
            content: "Check if subject value was correctly updated",
            trigger: 'div[name="subject"] input[type="text"]',
            run() {
                const subjectValue = this.anchor.value;
                const correctValue = "yes_model_id {{object.company_name|||defValue}}";
                if (subjectValue !== correctValue) {
                    console.error(
                        `Email template should have "${correctValue}" in subject input (actual: ${subjectValue})`
                    );
                }
            },
        },
        {
            content: "Insert text inside editable",
            trigger: ".note-editable.odoo-editor-editable",
            async run(actions) {
                await actions.editor(`/`);
                document.querySelector(".note-editable").dispatchEvent(
                    new InputEvent("input", {
                        inputType: "insertText",
                        data: "/",
                    })
                );
            },
        },
        {
            content: "Click on the the dynamic placeholder powerBox options",
            trigger: "div.o-we-powerbox .o-we-command:contains(Dynamic Placeholder)",
            run: "click",
        },
        {
            content: "Check if the dynamic placeholder popover is opened",
            trigger: "div.o_model_field_selector_popover",
            run: "click",
        },
        {
            content: "filter the dph result",
            trigger: "div.o_model_field_selector_popover_search input[type='text']",
            run: "edit name",
        },
        {
            content: "Click on the first entry of the dynamic placeholder",
            trigger: 'div.o_model_field_selector_popover button:contains("Company Name")',
            run: "click",
        },
        {
            content: "Enter a default value",
            trigger:
                'div.o_model_field_selector_popover .o_model_field_selector_default_value_input input[type="text"]',
            run: "edit defValue",
        },
        {
            content: "Click on the insert button",
            trigger: "div.o_model_field_selector_popover button:first-child",
            run: "click",
        },
        {
            content: "Ensure the editable contain the dynamic placeholder t tag",
            trigger: `.note-editable.odoo-editor-editable t[t-out="object.company_name"]:contains("defValue")`,
            run: "click",
        },
        {
            content: "Discard form changes",
            trigger: "button.o_form_button_cancel",
            run: "click",
        },
        {
            content: "Wait for the form view to disappear",
            trigger: "body:not(:has(.o_form_sheet))",
        },
    ],
});

return __exports;
});
;

/***********************************************************************
*  Filepath: /mail/static/tests/tours/user_modify_own_profile_tour.js  *
*  Lines: 51                                                           *
***********************************************************************/
odoo.define('@mail/../tests/tours/user_modify_own_profile_tour', ['@web/core/registry', '@web/../tests/utils'], function (require) {
'use strict';
let __exports = {};
const { registry } = require("@web/core/registry");
const { contains, insertText } = require("@web/../tests/utils");

/**
 * Verify that a user can modify their own profile information.
 */
registry.category("web_tour.tours").add("mail/static/tests/tours/user_modify_own_profile_tour.js", {
    steps: () => [
        {
            content: "Open user account menu",
            trigger: ".o_user_menu button",
            run: "click",
        },
        {
            content: "Open preferences / profile screen",
            trigger: "[data-menu=settings]",
            run: "click",
        },
        {
            content: "Update the email address",
            trigger: 'div[name="email"] input',
            async run() {
                await insertText("div[name='email'] input", "updatedemail@example.com", {
                    replace: true,
                });
                await contains(".o_form_dirty", { count: 1 });
            },
        },
        {
            trigger: "body.modal-open",
        },
        {
            content: "Save the form",
            trigger: 'button[name="preference_save"]',
            run: "click",
        },
        {
            content: "Wait until the modal is closed",
            trigger: "body:not(.modal-open)",
            async run() {
                await contains(".o_form_dirty", { count: 0 });
            },
        },
    ],
});

return __exports;
});
;

/***************************************************
*  Filepath: /portal/static/tests/tours/portal.js  *
*  Lines: 39                                       *
***************************************************/
odoo.define('@portal/../tests/tours/portal', ['@web/core/registry'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { registry } = require("@web/core/registry");

registry.category("web_tour.tours").add('portal_load_homepage', {
    url: '/my',
    steps: () => [
        {
            content: "Check portal is loaded",
            trigger: 'a[href*="/my/account"]:contains("Edit"):first',
            run: "click",
        },
        {
            content: "Load my account details",
            trigger: 'input[value="Joel Willis"]',
            run: "click",
        },
        {
            content: 'type a different phone number',
            trigger: 'input[name="phone"]',
            run: "edit +1 555 666 7788",
        },
        {
            content: "Submit the form",
            trigger: 'button[type=submit]',
            run: "click",
        },
        {
            content: "Check that we are back on the portal",
            trigger: 'a[href*="/my/account"]:contains("Edit"):first',
        }
    ]
});

return __exports;
});
;

/************************************************************
*  Filepath: /portal/static/tests/tours/skip_to_content.js  *
*  Lines: 27                                                *
************************************************************/
odoo.define('@portal/../tests/tours/skip_to_content', ['@web/core/registry'], function (require) {
'use strict';
let __exports = {};
const { registry } = require("@web/core/registry");

registry.category("web_tour.tours").add("skip_to_content", {
    url: "/",
    steps: () => [
        {
            content: "Make sure that Skip to Content button is on top of all the links present in header",
            trigger: "a:first-child[class~='o_skip_to_content']",
            run: "click"
        },
        {
            content: "Check if we have been redirected to #wrap",
            trigger: "body",
            run: () => {
                if (!window.location.href.endsWith("#wrap")) {
                    console.error("We should be on #wrap.");
                }
            }
        }
    ]
});

return __exports;
});
;

/*************************************************************
*  Filepath: /account/static/tests/tours/tax_group_tests.js  *
*  Lines: 134                                                *
*************************************************************/
odoo.define('@account/../tests/tours/tax_group_tests', ['@account/js/tours/account', '@web/core/registry', '@web_tour/tour_service/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module */

const { accountTourSteps } = require("@account/js/tours/account");
const { registry } = require("@web/core/registry");
const { stepUtils } = require("@web_tour/tour_service/tour_utils");

registry.category("web_tour.tours").add('account_tax_group', {
    url: "/odoo",
    steps: () => [
    ...accountTourSteps.goToAccountMenu("Go to Invoicing"),
    {
        content: "Go to Vendors",
        trigger: 'span:contains("Vendors")',
        run: "click",
    },
    {
        content: "Go to Bills",
        trigger: 'a:contains("Bills")',
        run: "click",
    },
    {
        trigger: ".o_breadcrumb .text-truncate:contains(Bills)",
    },
    {
        content: "Create new bill",
        trigger: '.o_control_panel_main_buttons .o_list_button_add',
        run: "click",
    },
    // Set a vendor
    {
        content: "Add vendor",
        trigger: 'div.o_field_widget.o_field_res_partner_many2one[name="partner_id"] div input',
        run: "edit Account Tax Group Partner",
    },
    {
        content: "Valid vendor",
        trigger: '.ui-menu-item a:contains("Account Tax Group Partner")',
        run: "click",
    },
    // Add First product
    {
        content: "Add items",
        trigger: 'div[name="invoice_line_ids"] .o_field_x2many_list_row_add a:contains("Add a line")',
        run: "click",
    },
    {
        content: "Select input",
        trigger: 'div[name="invoice_line_ids"] .o_selected_row .o_list_many2one[name="product_id"] input',
        run: "edit Account Tax Group Product",
    },
    {
        content: "Valid item",
        trigger: '.ui-menu-item-wrapper:contains("Account Tax Group Product")',
        run: "click",
    },
    // Save account.move
    ...stepUtils.saveForm(),
    // Edit tax group amount
    {
        content: "Edit tax group amount",
        trigger: '.o_tax_group_edit',
        run: "click",
    },
    {
        content: "Modify the input value",
        trigger: '.o_tax_group_edit_input input',
        run() {
            this.anchor.value = 200;
            this.anchor.select();
            this.anchor.blur();
        },
    },
    // Check new value for total (with modified tax_group_amount).
    {
        content: "Valid total amount",
        trigger: 'span[name="amount_total"]:contains("800")',
        run: "click",
    },
    // Modify the quantity of the object
    {
        content: "Select item quantity",
        trigger: 'div[name="invoice_line_ids"] tbody tr.o_data_row .o_list_number[name="quantity"]',
        run: "click",
    },
    {
        content: "Change item quantity",
        trigger: 'div[name="invoice_line_ids"] tbody tr.o_data_row .o_list_number[name="quantity"] input',
        run: "edit 2",
    },
    {
        content: "Valid the new value",
        trigger: 'div[name="invoice_line_ids"] tbody tr.o_data_row .o_list_number[name="quantity"] input',
        run: "press Enter",
    },
    // Check new tax group value
    {
        content: "Check new value of tax group",
        trigger: '.o_tax_group_amount_value:contains("120")',
        run: "click",
    },
    // Save form
    ...stepUtils.saveForm(),
    // Check new tax group value
    {
        content: "Check new value of tax group",
        trigger: '.o_tax_group_amount_value:contains("120")',
        run: "click",
    },
    {
        content: "Edit tax value",
        trigger: '.o_tax_group_edit_input input',
        run: "edit 2 && click body",
    },
    {
        content: "Check new value of total",
        trigger: '.oe_subtotal_footer_separator:contains("1,202")',
        run: "click",
    },
    {
        content: "Discard changes",
        trigger: '.o_form_button_cancel',
        run: "click",
    },
    {
        content: "Check tax value is reset",
        trigger: '.o_tax_group_amount_value:contains("120")',
    },
]});

return __exports;
});
;

/*************************************************************************
*  Filepath: /account/static/tests/tours/tour_tests_shared_js_python.js  *
*  Lines: 24                                                             *
*************************************************************************/
odoo.define('@account/../tests/tours/tour_tests_shared_js_python', ['@web/core/registry'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module */

const { registry } = require("@web/core/registry");

registry.category("web_tour.tours").add('tests_shared_js_python', {
    url: "/account/init_tests_shared_js_python",
    steps: () => [
    {
        content: "Click",
        trigger: 'button',
        run: "click",
    },
    {
        content: "Wait",
        trigger: 'button.text-success',
        timeout: 3000,
    },
]});

return __exports;
});
;

/****************************************************************************
*  Filepath: /sale/static/tests/tours/mail_attachment_removal_test_tour.js  *
*  Lines: 38                                                                *
****************************************************************************/
odoo.define('@sale/../tests/tours/mail_attachment_removal_test_tour', ['@web/core/registry'], function (require) {
'use strict';
let __exports = {};
const { registry } = require("@web/core/registry");

registry.category("web_tour.tours").add("mail_attachment_removal_tour", {
    steps: () => [

    {
        content: "click on send by email",
        trigger: ".o_statusbar_buttons > button[name='action_quotation_send']",
        run: "click"
    },
    {
        content: "save a new layout",
        trigger: ".o_technical_modal button[name='document_layout_save']",
        run: "click"
    },
    {
        content: "delete attachment",
        trigger: ".o_field_widget[name='attachment_ids'] li > button .fa-times",
        run: "click"
    },
    {
        content: "send the email",
        trigger: ".o_mail_send",
        run: "click"
    },
    {
        content: "confirm quotation",
        trigger: "button[name='action_confirm']",
        run: "click"
    }
]
})

return __exports;
});
;

/***********************************************************************
*  Filepath: /sale/static/tests/tours/product_attribute_value_tour.js  *
*  Lines: 62                                                           *
***********************************************************************/
odoo.define('@sale/../tests/tours/product_attribute_value_tour', ['@web/core/registry', '@web_tour/tour_service/tour_utils'], function (require) {
'use strict';
let __exports = {};
const { registry } = require("@web/core/registry");
const { stepUtils } = require("@web_tour/tour_service/tour_utils");

const openProductAttribute = (product_attribute) => [
    ...stepUtils.goToAppSteps("sale.sale_menu_root", "Go to the Sales App"),
    {
        content: 'Open configuration menu',
        trigger: '.o-dropdown[data-menu-xmlid="sale.menu_sale_config"]',
        run: "click",
    },
    {
        content: 'Navigate to product attribute list view',
        trigger: '.o-dropdown-item[data-menu-xmlid="sale.menu_product_attribute_action"]',
        run: "click",
    },
    {
        content: `Navigate to ${product_attribute}`,
        trigger: `.o_data_cell[data-tooltip=${product_attribute}]`,
        run: "click",
    },
];
const deletePAV = (product_attribute_value, message) => [
    {
        content: 'Click delete button',
        trigger: `.o_data_cell[data-tooltip=${product_attribute_value}] ~ .o_list_record_remove`,
        run: "click",
    },
    {
        content: 'Check correct message in modal',
        trigger: message || '.modal-title:contains("Bye-bye, record!")',
        run: "click",
    },
    {
        content: 'Close modal',
        trigger: '.btn-close',
        run: "click",
    }
]

// This tour relies on data created on the Python test.
registry.category("web_tour.tours").add('delete_product_attribute_value_tour', {
    url: '/odoo',
    steps: () => [
        ...openProductAttribute("PA"),
        // Test error message on a used attribute value
        ...deletePAV("pa_value_1", ".text-prewrap:contains('pa_value_1')"),
        // Test deletability of a used attribute value on archived product
        ...deletePAV("pa_value_2"),
        // Test deletability of a removed attribute value on product
        ...deletePAV("pa_value_3"),
        {
            content: 'Check test finished',
            trigger: 'a:contains("Attributes")',
        }
    ]
});

return __exports;
});
;

/*******************************************************
*  Filepath: /sale/static/tests/tours/sale_catalog.js  *
*  Lines: 78                                           *
*******************************************************/
odoo.define('@sale/../tests/tours/sale_catalog', ['@web/core/registry'], function (require) {
'use strict';
let __exports = {};
const { registry } = require("@web/core/registry");

registry.category("web_tour.tours").add('sale_catalog', {
    steps: () => [
        {
            content: "Create a new SO",
            trigger: '.o_list_button_add',
            run: 'click',
        },
        {
            content: "Select the customer field",
            trigger: ".o_field_res_partner_many2one input.o_input",
            run: 'click',
        },
        {
            content: "Wait for the field to be active",
            trigger: ".o_field_res_partner_many2one input[aria-expanded=true]",
        },
        {
            content: "Select a customer from the dropdown",
            trigger: ".o_field_res_partner_many2one .dropdown-item:not([id$='_loading']):first",
            run: 'click',
        },
        {
            content: "Open product catalog",
            trigger: 'button[name="action_add_from_catalog"]',
            run: 'click',
        },
        {
            content: "Type 'Restricted' into the search bar",
            trigger: 'input.o_searchview_input',
            run: "edit Restricted",
        },
        {
            content: "Search for the product",
            trigger: 'input.o_searchview_input',
            run: "press Enter",
        },
        {
            content: "Wait for catalog rendering",
            trigger: '.o_kanban_record:contains("Restricted Product")',
        },
        {
            content: "Wait for filtering",
            trigger: '.o_kanban_renderer:not(:has(.o_kanban_record:contains("AAA Product")))',
        },
        {
            content: "Add the product to the SO",
            trigger: '.o_kanban_record:contains("Restricted Product") .fa-shopping-cart',
            run: 'click',
        },
        {
            content: "Wait for product to be added",
            trigger: '.o_kanban_record:contains("Restricted Product"):not(:has(.fa-shopping-cart))',
        },
        {
            content: "Input a custom quantity",
            trigger: '.o_kanban_record:contains("Restricted Product") .o_input',
            run: "edit 6",
        },
        {
            content: "Increase the quantity",
            trigger: '.o_kanban_record:contains("Restricted Product") .fa-plus',
            run: 'click',
        },
        {
            content: "Close the catalog",
            trigger: '.o-kanban-button-back',
            run: 'click',
        },
    ]
});

return __exports;
});
;

/******************************************************************
*  Filepath: /sale/static/tests/tours/sale_combo_configurator.js  *
*  Lines: 113                                                     *
******************************************************************/
odoo.define('@sale/../tests/tours/sale_combo_configurator', ['@web/core/registry', '@web_tour/tour_service/tour_utils', '@sale/js/tours/combo_configurator_tour_utils', '@sale/js/tours/product_configurator_tour_utils', '@sale/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
const { registry } = require('@web/core/registry');
const { stepUtils } = require('@web_tour/tour_service/tour_utils');
const comboConfiguratorTourUtils = require('@sale/js/tours/combo_configurator_tour_utils')[Symbol.for("default")];
const productConfiguratorTourUtils = require('@sale/js/tours/product_configurator_tour_utils')[Symbol.for("default")];
const tourUtils = require('@sale/js/tours/tour_utils')[Symbol.for("default")];

registry
    .category('web_tour.tours')
    .add('sale_combo_configurator', {
        url: '/odoo',
        steps: () => [
            ...stepUtils.goToAppSteps('sale.sale_menu_root', "Open the sales app"),
            ...tourUtils.createNewSalesOrder(),
            ...tourUtils.selectCustomer("Test Partner"),
            ...tourUtils.addProduct("Combo product"),
            // Assert that the combo configurator has the correct data.
            comboConfiguratorTourUtils.assertComboCount(2),
            comboConfiguratorTourUtils.assertComboItemCount("Combo A", 2),
            comboConfiguratorTourUtils.assertComboItemCount("Combo B", 2),
            // Assert that price changes when the quantity is updated.
            comboConfiguratorTourUtils.assertQuantity(1),
            comboConfiguratorTourUtils.assertPrice('25.00'),
            comboConfiguratorTourUtils.increaseQuantity(),
            comboConfiguratorTourUtils.assertQuantity(2),
            comboConfiguratorTourUtils.assertPrice('50.00'),
            comboConfiguratorTourUtils.decreaseQuantity(),
            comboConfiguratorTourUtils.assertQuantity(1),
            comboConfiguratorTourUtils.assertPrice('25.00'),
            comboConfiguratorTourUtils.setQuantity(3),
            comboConfiguratorTourUtils.assertQuantity(3),
            comboConfiguratorTourUtils.assertPrice('75.00'),
            // Assert that the combo configurator can only be saved after selecting an item for each
            // combo.
            comboConfiguratorTourUtils.assertConfirmButtonDisabled(),
            comboConfiguratorTourUtils.selectComboItem("Product A2"),
            comboConfiguratorTourUtils.selectComboItem("Product B2"),
            comboConfiguratorTourUtils.assertConfirmButtonEnabled(),
            // Assert that the product configurator is opened when a product with configurable
            // `no_variant` PTALs is selected.
            comboConfiguratorTourUtils.selectComboItem("Product A1"),
            productConfiguratorTourUtils.selectAttribute("Product A1", "No variant attribute", "A"),
            ...productConfiguratorTourUtils.saveConfigurator(),
            // Assert that the extra price of a combo item is applied correctly.
            comboConfiguratorTourUtils.assertPrice('90.00'),
            // Assert that the extra price of a `no_variant` PTAV is applied correctly.
            comboConfiguratorTourUtils.selectComboItem("Product A1"),
            ...productConfiguratorTourUtils.selectAndSetCustomAttribute(
                "Product A1", "No variant attribute", "B", "Some custom value"
            ),
            ...productConfiguratorTourUtils.saveConfigurator(),
            comboConfiguratorTourUtils.assertPrice('93.00'),
            // Assert that the order's content is correct.
            ...comboConfiguratorTourUtils.saveConfigurator(),
            tourUtils.checkSOLDescriptionContains("Combo product x 3"),
            tourUtils.checkSOLDescriptionContains(
                "Product A1", "No variant attribute: B: Some custom value"
            ),
            tourUtils.checkSOLDescriptionContains("Product B2"),
            {
                content: "Verify the combo item quantities",
                trigger: 'td[name="product_uom_qty"]:contains(3.00)',
            },
            {
                content: "Verify the first combo item's unit price",
                trigger: 'td[name="price_unit"]:contains(18.50)',
            },
            {
                content: "Verify the second combo item's unit price",
                trigger: 'td[name="price_unit"]:contains(12.50)',
            },
            {
                content: "Verify the order's total price",
                trigger: 'div.oe_subtotal_footer:contains(93.00)',
            },
            // Assert that the combo configurator is opened with the previous selection when the
            // combo is edited.
            tourUtils.editLineMatching("Combo product x 3"),
            tourUtils.editConfiguration(),
            comboConfiguratorTourUtils.setQuantity(2),
            comboConfiguratorTourUtils.assertComboItemSelected("Product A1"),
            comboConfiguratorTourUtils.assertComboItemSelected("Product B2"),
            comboConfiguratorTourUtils.selectComboItem("Product A2"),
            // Assert that the order's content has been updated.
            ...comboConfiguratorTourUtils.saveConfigurator(),
            tourUtils.checkSOLDescriptionContains("Combo product x 2"),
            tourUtils.checkSOLDescriptionContains("Product A2"),
            tourUtils.checkSOLDescriptionContains("Product B2"),
            {
                content: "Verify the combo item quantities",
                trigger: 'td[name="product_uom_qty"]:contains(2.00)',
            },
            {
                content: "Verify the first combo item's unit price",
                trigger: 'td[name="price_unit"]:contains(12.50)',
            },
            {
                content: "Verify the second combo item's unit price",
                trigger: 'td[name="price_unit"]:contains(12.50)',
            },
            {
                content: "Verify the order's total price",
                trigger: 'div.oe_subtotal_footer:contains(50.00)',
            },
            // Don't end the tour with a form in edition mode.
            ...stepUtils.saveForm(),
        ],
    });

return __exports;
});
;

/****************************************************************************************************
*  Filepath: /sale/static/tests/tours/sale_combo_configurator_preconfigure_unconfigurable_ptals.js  *
*  Lines: 43                                                                                        *
****************************************************************************************************/
odoo.define('@sale/../tests/tours/sale_combo_configurator_preconfigure_unconfigurable_ptals', ['@web/core/registry', '@web_tour/tour_service/tour_utils', '@sale/js/tours/combo_configurator_tour_utils', '@sale/js/tours/product_configurator_tour_utils', '@sale/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
const { registry } = require('@web/core/registry');
const { stepUtils } = require('@web_tour/tour_service/tour_utils');
const comboConfiguratorTourUtils = require('@sale/js/tours/combo_configurator_tour_utils')[Symbol.for("default")];
const productConfiguratorTourUtils = require('@sale/js/tours/product_configurator_tour_utils')[Symbol.for("default")];
const tourUtils = require('@sale/js/tours/tour_utils')[Symbol.for("default")];

registry
    .category('web_tour.tours')
    .add('sale_combo_configurator_preconfigure_unconfigurable_ptals', {
        url: '/odoo',
        steps: () => [
            ...stepUtils.goToAppSteps('sale.sale_menu_root', "Open the sales app"),
            ...tourUtils.createNewSalesOrder(),
            ...tourUtils.selectCustomer("Test Partner"),
            ...tourUtils.addProduct("Combo product"),
            {
                content: "Verify that unconfigurable ptals are preconfigured",
                trigger: `${comboConfiguratorTourUtils.comboItemSelector("Test product")}:contains("Attribute A: A")`,
            },
            {
                content: "Verify that configurable ptals aren't preconfigured",
                trigger: `${comboConfiguratorTourUtils.comboItemSelector("Test product")}:not(:contains("Attribute B: B"))`,
            },
            comboConfiguratorTourUtils.selectComboItem("Test product"),
            productConfiguratorTourUtils.selectAttribute(
                "Test product", "Attribute B", "B", 'multi'
            ),
            ...productConfiguratorTourUtils.saveConfigurator(),
            {
                content: "Verify that configurable ptals are now configured",
                trigger: `${comboConfiguratorTourUtils.comboItemSelector("Test product")}:contains("Attribute B: B")`,
            },
            ...comboConfiguratorTourUtils.saveConfigurator(),
            // Don't end the tour with a form in edition mode.
            ...stepUtils.saveForm(),
        ],
    });

return __exports;
});
;

/********************************************************************************************************
*  Filepath: /sale/static/tests/tours/sale_combo_configurator_preselect_single_unconfigurable_items.js  *
*  Lines: 42                                                                                            *
********************************************************************************************************/
odoo.define('@sale/../tests/tours/sale_combo_configurator_preselect_single_unconfigurable_items', ['@web/core/registry', '@web_tour/tour_service/tour_utils', '@sale/js/tours/combo_configurator_tour_utils', '@sale/js/tours/product_configurator_tour_utils', '@sale/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
const { registry } = require('@web/core/registry');
const { stepUtils } = require('@web_tour/tour_service/tour_utils');
const comboConfiguratorTourUtils = require('@sale/js/tours/combo_configurator_tour_utils')[Symbol.for("default")];
const productConfiguratorTourUtils = require('@sale/js/tours/product_configurator_tour_utils')[Symbol.for("default")];
const tourUtils = require('@sale/js/tours/tour_utils')[Symbol.for("default")];

registry
    .category('web_tour.tours')
    .add('sale_combo_configurator_preselect_single_unconfigurable_items', {
        url: '/odoo',
        steps: () => [
            ...stepUtils.goToAppSteps('sale.sale_menu_root', "Open the sales app"),
            ...tourUtils.createNewSalesOrder(),
            ...tourUtils.selectCustomer("Test Partner"),
            ...tourUtils.addProduct("Combo product"),
            // Assert that only single unconfigurable items are preselected.
            comboConfiguratorTourUtils.assertSelectedComboItemCount(2),
            comboConfiguratorTourUtils.assertComboItemSelected("Product A"),
            comboConfiguratorTourUtils.assertComboItemSelected("Product C"),
            comboConfiguratorTourUtils.assertConfirmButtonDisabled(),
            // Configure the remaining combos.
            comboConfiguratorTourUtils.selectComboItem("Product B"),
            productConfiguratorTourUtils.selectAttribute("Product B", "Attribute B", "B", 'multi'),
            ...productConfiguratorTourUtils.saveConfigurator(),
            comboConfiguratorTourUtils.selectComboItem("Product D"),
            productConfiguratorTourUtils.setCustomAttribute(
                "Product D", "Attribute D", "Test D"
            ),
            ...productConfiguratorTourUtils.saveConfigurator(),
            comboConfiguratorTourUtils.selectComboItem("Product E1"),
            comboConfiguratorTourUtils.assertConfirmButtonEnabled(),
            ...comboConfiguratorTourUtils.saveConfigurator(),
            // Don't end the tour with a form in edition mode.
            ...stepUtils.saveForm(),
        ],
    });

return __exports;
});
;

/*********************************************************
*  Filepath: /sale/static/tests/tours/sale_signature.js  *
*  Lines: 82                                             *
*********************************************************/
odoo.define('@sale/../tests/tours/sale_signature', ['@web/core/registry', '@web/core/utils/urls'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { registry } = require("@web/core/registry");
const { redirect } = require("@web/core/utils/urls");

// This tour relies on data created on the Python test.
registry.category("web_tour.tours").add('sale_signature', {
    url: '/my/quotes',
    steps: () => [
    {
        content: "open the test SO",
        trigger: 'a:contains(/^test SO$/)',
        run: "click",
    },
    {
        content: "click sign",
        trigger: 'a:contains("Sign")',
        run: "click",
    },
    {
        content: "check submit is enabled",
        trigger: '.o_portal_sign_submit:enabled',
    },
    {
        trigger: ".modal .o_web_sign_name_and_signature input:value(Joel Willis)"
    },
    {
        content: "click select style",
        trigger: '.modal .o_web_sign_auto_select_style button',
        run: "click",
    },
    {
        content: "click style 4",
        trigger: ".o-dropdown-item:eq(3)",
        run: "click",
    },
    {
        content: "click submit",
        trigger: '.modal .o_portal_sign_submit:enabled',
        run: "click",
    },
    {
        content: "check it's confirmed",
        trigger: '#quote_content:contains("Thank You")',
        run: "click",
    }, {
        trigger: '#quote_content',
        run: function () {
            redirect("/odoo");
        },  // Avoid race condition at the end of the tour by returning to the home page.
    },
    {
        trigger: 'nav',
    }
]});

registry.category("web_tour.tours").add("sale_signature_without_name", {
    steps: () => [
        {
            content: "Sign & Pay",
            trigger:
                ".o_portal_sale_sidebar .btn-primary, :iframe .o_portal_sale_sidebar .btn-primary",
            run: "click",
        },
        {
            content: "click submit",
            trigger: ".o_portal_sign_submit:enabled, :iframe .o_portal_sign_submit:enabled",
            run: "click",
        },
        {
            content: "check error because no name",
            trigger:
                '.o_portal_sign_error_msg:contains("Signature is missing."), :iframe .o_portal_sign_error_msg:contains("Signature is missing.")',
        },
    ],
});

return __exports;
});
;

/*************************************************************************
*  Filepath: /sale/static/src/js/tours/combo_configurator_tour_utils.js  *
*  Lines: 190                                                            *
*************************************************************************/
odoo.define('@sale/js/tours/combo_configurator_tour_utils', ['@odoo/hoot-dom'], function (require) {
'use strict';
let __exports = {};
const { queryAll, queryValue, waitUntil } = require('@odoo/hoot-dom');

function comboSelector(comboName) {
    return `
        .sale-combo-configurator-dialog
        [name="sale_combo_configurator_title"]:contains("${comboName}")
    `;
}

function comboItemSelector(comboItemName, extraClasses=[]) {
    const extraClassesSelector = extraClasses.map(extraClass => `.${extraClass}`).join('');
    return `
        .sale-combo-configurator-dialog
        .combo-item-grid
        .product-card${extraClassesSelector}:has(.card-title:contains("${comboItemName}"))
    `;
}

function assertComboCount(count) {
    return {
        content: `Assert that there are ${count} combos`,
        trigger: '.sale-combo-configurator-dialog',
        run: () => queryAll(
            '.sale-combo-configurator-dialog [name="sale_combo_configurator_title"]'
        ).length === count,
    };
}

function assertComboItemCount(comboName, count) {
    return {
        content: `Assert that there are ${count} combo items in combo ${comboName}`,
        trigger: comboSelector(comboName),
        run: () => queryAll(
            `${comboSelector(comboName)} + .combo-item-grid .product-card`
        ).length === count,
    };
}

function assertSelectedComboItemCount(count) {
    return {
        content: `Assert that there are ${count} selected combo items`,
        trigger: '.sale-combo-configurator-dialog',
        run: () => queryAll(
            `.sale-combo-configurator-dialog .combo-item-grid .product-card.selected`
        ).length === count,
    };
}

function selectComboItem(comboItemName) {
    return {
        content: `Select combo item ${comboItemName}`,
        trigger: comboItemSelector(comboItemName),
        run: 'click',
    };
}

function assertComboItemSelected(comboItemName) {
    return {
        content: `Assert that combo item ${comboItemName} is selected`,
        trigger: comboItemSelector(comboItemName, ['selected']),
    };
}

function increaseQuantity() {
    return {
        content: "Increase the combo quantity",
        trigger: '.sale-combo-configurator-dialog button[name="sale_quantity_button_plus"]',
        run: 'click',
    };
}

function decreaseQuantity() {
    return {
        content: "Decrease the combo quantity",
        trigger: '.sale-combo-configurator-dialog button[name="sale_quantity_button_minus"]',
        run: 'click',
    };
}

function setQuantity(quantity) {
    return {
        content: `Set the combo quantity to ${quantity}`,
        trigger: '.sale-combo-configurator-dialog input[name="sale_quantity"]',
        run: `edit ${quantity} && click .modal-body`,
    };
}

function assertQuantity(quantity) {
    const quantitySelector = '.sale-combo-configurator-dialog input[name="sale_quantity"]';
    return {
        content: `Assert that the combo quantity is ${quantity}`,
        trigger: quantitySelector,
        run: async () =>
            await waitUntil(() => queryValue(quantitySelector) === quantity, { timeout: 1000 }),
    };
}

function assertPrice(price) {
    return {
        content: `Assert that the price is ${price}`,
        trigger: `
            .sale-combo-configurator-dialog
            [name="sale_combo_configurator_total"]:contains("${price}")
        `,
    };
}

function assertPriceInfo(priceInfo) {
    return {
        content: `Assert that the price info is ${priceInfo}`,
        trigger: `.sale-combo-configurator-dialog footer.modal-footer:contains("${priceInfo}")`,
    };
}

function assertFooterButtonsDisabled() {
    return {
        content: "Assert that the footer buttons are disabled",
        trigger: '.sale-combo-configurator-dialog footer.modal-footer button:disabled',
    };
}

function assertFooterButtonsEnabled() {
    return {
        content: "Assert that the footer buttons are enabled",
        trigger: '.sale-combo-configurator-dialog footer.modal-footer button:enabled',
    };
}

function assertConfirmButtonDisabled() {
    return {
        content: "Assert that the confirm button is disabled",
        trigger: `
            .sale-combo-configurator-dialog
            button[name="sale_combo_configurator_confirm_button"]:disabled
        `,
    };
}

function assertConfirmButtonEnabled() {
    return {
        content: "Assert that the confirm button is enabled",
        trigger: `
            .sale-combo-configurator-dialog
            button[name="sale_combo_configurator_confirm_button"]:enabled
        `,
    };
}

function saveConfigurator() {
    return [
        {
            content: "Confirm the combo configurator",
            trigger: `
                .sale-combo-configurator-dialog
                button[name="sale_combo_configurator_confirm_button"]
            `,
            run: 'click',
        }, {
            content: "Wait until the modal is closed",
            trigger: 'body:not(:has(.sale-combo-configurator-dialog))',
        },
    ];
}

__exports[Symbol.for("default")] = {
    comboSelector,
    comboItemSelector,
    assertComboCount,
    assertComboItemCount,
    assertSelectedComboItemCount,
    selectComboItem,
    assertComboItemSelected,
    increaseQuantity,
    decreaseQuantity,
    setQuantity,
    assertQuantity,
    assertPrice,
    assertPriceInfo,
    assertFooterButtonsDisabled,
    assertFooterButtonsEnabled,
    assertConfirmButtonDisabled,
    assertConfirmButtonEnabled,
    saveConfigurator,
};

return __exports;
});
;

/***************************************************************************
*  Filepath: /sale/static/src/js/tours/product_configurator_tour_utils.js  *
*  Lines: 244                                                              *
***************************************************************************/
odoo.define('@sale/js/tours/product_configurator_tour_utils', ['@odoo/hoot-dom'], function (require) {
'use strict';
let __exports = {};
const { queryAttribute, queryValue, waitUntil } = require('@odoo/hoot-dom');

function productSelector(productName) {
    return `
        table.o_sale_product_configurator_table
        tr:has(td>div[name="o_sale_product_configurator_name"]
        span:contains("${productName}"))
    `;
}

function optionalProductSelector(productName) {
    return `
        table.o_sale_product_configurator_table_optional
        tr:has(td>div[name="o_sale_product_configurator_name"]
        span:contains("${productName}"))
    `;
}

function optionalProductImageSrc(productName) {
    return queryAttribute(
        `${optionalProductSelector(productName)} td.o_sale_product_configurator_img>img`, 'src'
    );
}

function addOptionalProduct(productName) {
    return {
        content: `Add ${productName}`,
        trigger: `
            ${optionalProductSelector(productName)}
            td.o_sale_product_configurator_price
            button:contains("Add")
        `,
        run: 'click',
    };
}

function removeOptionalProduct(productName) {
    return {
        content: `Remove ${productName}`,
        trigger: `
            ${productSelector(productName)}
            td.o_sale_product_configurator_qty
            a:contains("Remove")
        `,
        run: 'click',
    };
}

function increaseProductQuantity(productName) {
    return {
        content: `Increase the quantity of ${productName}`,
        trigger: `
            ${productSelector(productName)}
            td.o_sale_product_configurator_qty
            button:has(i.fa-plus)
        `,
        run: 'click',
    };
}

function setProductQuantity(productName, quantity) {
    return {
        content: `Set the quantity of ${productName} to ${quantity}`,
        trigger: `
            ${productSelector(productName)}
            td.o_sale_product_configurator_qty
            input[name="sale_quantity"]
        `,
        run: `edit ${quantity} && click .modal-body`,
    };
}

function assertProductQuantity(productName, quantity) {
    const quantitySelector = `
        ${productSelector(productName)}
        td.o_sale_product_configurator_qty
        input[name="sale_quantity"]
    `;
    return {
        content: `Assert that the quantity of ${productName} is ${quantity}`,
        trigger: quantitySelector,
        run: async () =>
            await waitUntil(() => queryValue(quantitySelector) === quantity, { timeout: 1000 }),
    };
}

function selectAttribute(productName, attributeName, attributeValue, attributeType='radio') {
    const ptalSelector = `
        ${productSelector(productName)}
        td>div[name="ptal"]:has(label:contains("${attributeName}"))
    `;
    const content = `Select ${attributeValue} for ${productName} ${attributeName}`;
    switch (attributeType) {
        case 'color':
            return {
                content: content,
                trigger: `${ptalSelector} label[title="${attributeValue}"]`,
                run: 'click',
            };
        case 'multi':
        case 'pills':
        case 'radio':
            return {
                content: content,
                trigger: `${ptalSelector} span:contains("${attributeValue}")`,
                run: 'click',
            };
        case 'select':
            return {
                content: content,
                trigger: `${ptalSelector} select`,
                run: `selectByLabel ${attributeValue}`,
            };
        default:
            console.error("Unsupported attribute type");
    }
}

function setCustomAttribute(productName, attributeName, customValue) {
    return {
        content: `Set ${customValue} as a custom attribute for ${productName} ${attributeName}`,
        trigger: `
            ${productSelector(productName)}
            td>div[name="ptal"]:has(label:contains("${attributeName}"))
            input[type="text"]
        `,
        run: `edit ${customValue} && click .modal-body`,
    };
}

function selectAndSetCustomAttribute(
    productName, attributeName, attributeValue, customValue, attributeType='radio'
) {
    return [
        selectAttribute(productName, attributeName, attributeValue, attributeType),
        setCustomAttribute(productName, attributeName, customValue),
    ];
}

function assertPriceTotal(total) {
    return {
        content: `Assert that the total is ${total}`,
        trigger:
            `table.o_sale_product_configurator_table tr>td[colspan="4"] span:contains("${total}")`,
    };
}

function assertProductPrice(productName, price) {
    return {
        content: `Assert that ${productName} costs ${price}`,
        trigger: `
            ${productSelector(productName)}
            td.o_sale_product_configurator_price
            span:contains("${price}")
        `,
    };
}

function assertOptionalProductPrice(productName, price) {
    return {
        content: `Assert that ${productName} costs ${price}`,
        trigger: `
            ${optionalProductSelector(productName)}
            td.o_sale_product_configurator_qty
            span:contains("${price}")
        `,
    };
}

function assertProductPriceInfo(productName, priceInfo) {
    return {
        content: `Assert that the price info of ${productName} is ${priceInfo}`,
        trigger: `
            ${productSelector(productName)}
            td.o_sale_product_configurator_price
            div:contains("${priceInfo}")
        `,
    };
}

function assertOptionalProductPriceInfo(productName, priceInfo) {
    return {
        content: `Assert that the price info of ${productName} is ${priceInfo}`,
        trigger: `
            ${optionalProductSelector(productName)}
            td.o_sale_product_configurator_qty
            div:contains("${priceInfo}")
        `,
    };
}

function assertProductNameContains(productName) {
    return {
        content: `Assert that the product name contains ${productName}`,
        trigger: productSelector(productName),
    };
}

function assertFooterButtonsDisabled() {
    return {
        content: "Assert that the footer buttons are disabled",
        trigger: '.o_sale_product_configurator_dialog footer.modal-footer button:disabled',
    };
}

function saveConfigurator() {
    return [
        {
            trigger: '.o_sale_product_configurator_dialog button:contains(Confirm)',
            run: 'click',
        }, {
            content: "Wait until the modal is closed",
            trigger: 'body:not(:has(.o_sale_product_configurator_dialog))',
        }
    ];
}

__exports[Symbol.for("default")] = {
    productSelector,
    optionalProductSelector,
    optionalProductImageSrc,
    addOptionalProduct,
    removeOptionalProduct,
    increaseProductQuantity,
    setProductQuantity,
    assertProductQuantity,
    selectAttribute,
    setCustomAttribute,
    selectAndSetCustomAttribute,
    assertPriceTotal,
    assertProductPrice,
    assertOptionalProductPrice,
    assertProductPriceInfo,
    assertOptionalProductPriceInfo,
    assertProductNameContains,
    assertFooterButtonsDisabled,
    saveConfigurator,
};

return __exports;
});
;

/******************************************************
*  Filepath: /sale/static/src/js/tours/tour_utils.js  *
*  Lines: 106                                         *
******************************************************/
odoo.define('@sale/js/tours/tour_utils', [], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

function createNewSalesOrder() {
    return [
        {
            trigger: '.o_sale_order',
        }, {
            content: "Create new order",
            trigger: '.o_list_button_add',
            run: 'click',
        },
    ]
}

function selectCustomer(customerName) {
    return [
        {
            content: `Select customer ${customerName}`,
            trigger: '.o_field_widget[name=partner_id] input',
            run: `edit ${customerName}`,
        },
        {
            trigger: `ul.ui-autocomplete > li > a:contains("${customerName}")`,
            run: 'click',
        },
    ];
}

function addProduct(productName, rowNumber=1) {
    return [
        {
            content: `Add product ${productName}`,
            trigger: 'a:contains("Add a product")',
            run: 'click',
        },
        {
            content: 'wait for new row to be created',
            trigger: `.o_data_row:nth-child(${rowNumber})`,
        },
        {
            trigger: 'div[name="product_template_id"] input',  // TODO VFE o_selected_row
            run: `edit ${productName}`,
        },
        {
            trigger: `ul.ui-autocomplete a:contains("${productName}")`,
            run: 'click',
        },
    ];
}

function clickSomewhereElse() {
    return [
        // TODO find a way for onchange to finish first ?
        {
            content: 'click somewhere else to exit cell focus',
            trigger: 'a[name=order_lines]',  // click on notebook tab to stop the sol edit mode.
            run: 'click',
        },
        {
            content: 'check that the soline is not focused anymore',
            trigger: 'table.o_section_and_note_list_view:not(:has(.o_selected_row))',
        }
    ]
}

function checkSOLDescriptionContains(productName, text) {
    // currently must be called after exiting the edit mode on the SOL
    // TODO in the future: handle edit mode and look directly into the textarea value
    if (!text) {
        return {
            trigger: `span:contains("${productName}")`,
        }
    }
    return {
        trigger: `span:contains("${productName}") ~ textarea`,
    }
}

function editLineMatching(productName, text) {
    let base_step = checkSOLDescriptionContains(productName, text);
    base_step['run'] = 'click';
    return base_step;
}

function editConfiguration() {
    return {
        trigger: '[name=product_template_id] button.fa-pencil',
        run: 'click',
    }
}

__exports[Symbol.for("default")] = {
    createNewSalesOrder,
    selectCustomer,
    addProduct,
    checkSOLDescriptionContains,
    editLineMatching,
    editConfiguration,
    clickSomewhereElse,
};

return __exports;
});
;

/************************************************************
*  Filepath: /calendar/static/tests/tours/calendar_tour.js  *
*  Lines: 161                                               *
************************************************************/
odoo.define('@calendar/../tests/tours/calendar_tour', ['@odoo/hoot-dom', '@web/core/registry', '@web_tour/tour_service/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { waitFor } = require("@odoo/hoot-dom");
const { registry } = require("@web/core/registry");
const { stepUtils } = require("@web_tour/tour_service/tour_utils");

const todayDate = function () {
    const now = new Date();
    const year = now.getFullYear();
    const month = String(now.getMonth() + 1).padStart(2, "0");
    const day = String(now.getDate()).padStart(2, "0");

    return `${month}/${day}/${year} 10:00:00`;
};

registry.category("web_tour.tours").add("calendar_appointments_hour_tour", {
    url: "/odoo",
    steps: () => [
        stepUtils.showAppsMenuItem(),
        {
            trigger: '.o_app[data-menu-xmlid="calendar.mail_menu_calendar"]',
            content: "Open Calendar",
            run: "click",
        },
        {
            trigger: ".o-calendar-button-new",
            content: "Create a new event",
            run: "click",
        },
        {
            trigger: "#name_0",
            content: "Give a name to the new event",
            run: "edit TEST EVENT",
        },
        {
            trigger: "#start_0",
            content: "Give a date to the new event",
            run: `edit ${todayDate()}`,
        },
        {
            trigger: "#duration_0",
            content: "Give a duration to the new event",
            run: "edit 02:00",
        },
        {
            trigger: ".fa-cloud-upload",
            content: "Save the new event",
            run: "click",
        },
        {
            trigger: ".o_back_button",
            content: "Go back to Calendar view",
            run: "click",
        },
        {
            trigger: ".scale_button_selection",
            content: "Click to change calendar view",
            run: "click",
        },
        {
            trigger: '.dropdown-item:contains("Month")',
            content: "Change the calendar view to Month",
            run: "click",
        },
        {
            trigger: ".fc-col-header-cell.fc-day.fc-day-mon",
            content: "Check the day is properly displayed",
            run: "click",
        },
        {
            trigger: '.fc-time:contains("10:00")',
            content: "Check the time is properly displayed",
            run: "click",
        },
        {
            trigger: '.o_event_title:contains("TEST EVENT")',
            content: "Check the event title",
        },
    ],
});

const clickOnTheEvent = {
    content: "Click on the event (focus + waiting)",
    trigger: 'a .fc-event-main:contains("Test Event")',
    async run(actions) {
        await actions.click();
        await new Promise((r) => setTimeout(r, 1000));
        const custom = document.querySelector(".o_cw_custom_highlight");
        if (custom) {
            custom.click();
            await waitFor(".o_cw_popover", { timeout: 8000 });
        }
    },
};

registry.category("web_tour.tours").add("test_calendar_delete_tour", {
    steps: () => [
        {
            content: "Select filter (everybody)",
            trigger: 'div[data-value="all"] input',
            run: "click",
        },
        clickOnTheEvent,
        {
            content: "Delete the event",
            trigger: ".o_cw_popover_delete",
            run: "click",
        },
        {
            content: "Validate the deletion",
            trigger: 'button:contains("Delete")',
            run: "click",
        },
    ],
});

registry.category("web_tour.tours").add("test_calendar_decline_tour", {
    steps: () => [
        clickOnTheEvent,
        {
            content: "Delete the event",
            trigger: ".o_cw_popover_delete",
            run: "click",
        },
        {
            content: "Wait declined status",
            trigger: ".o_attendee_status_declined",
        },
    ],
});

registry.category("web_tour.tours").add("test_calendar_decline_with_everybody_filter_tour", {
    steps: () => [
        {
            content: "Select filter (everybody)",
            trigger: 'div[data-value="all"] input',
            run: "click",
        },
        clickOnTheEvent,
        {
            content: "Delete the event",
            trigger: ".o_cw_popover_delete",
            run: "click",
        },
        {
            content: "Select filter (everybody)",
            trigger: 'div[data-value="all"] input',
            run: "click",
        },
        {
            content: "Wait declined status",
            trigger: ".o_attendee_status_declined",
        },
    ],
});

return __exports;
});
;

/**********************************************************************
*  Filepath: /contacts/static/tests/tours/debug_menu_set_defaults.js  *
*  Lines: 82                                                          *
**********************************************************************/
odoo.define('@contacts/../tests/tours/debug_menu_set_defaults', ['@web/core/registry', '@web_tour/tour_service/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

    const { registry } = require("@web/core/registry");
    const { stepUtils } = require("@web_tour/tour_service/tour_utils");

    registry.category("web_tour.tours").add('debug_menu_set_defaults', {
        url: '/odoo?debug=1',
        steps: () => [
            ...stepUtils.goToAppSteps('contacts.menu_contacts', "Open the contacts menu"),
            {
                content: "Create a new contact",
                trigger: '.o-kanban-button-new',
                run: "click",
            },
            {
                content: "Check that Company is checked by default, and not Individual",
                trigger: '.o_field_widget[name="company_type"] input[data-value="company"]:checked',
            },
            {
                content: "Select the individual radio button",
                trigger: '.o_field_widget[name="company_type"] input[data-value="person"]',
                run: "click",
            },
            {
                content: "Open the debug menu",
                trigger: '.o_debug_manager button',
                run: "click",
            },
            {
                content: "Click the Set Defaults menu",
                trigger: '.dropdown-item:contains(Set Default Values)',
                run: "click",
            },
            {
                content: "Choose Company Type = Individual",
                trigger: '#formview_default_fields',
                run: function () {
                    const element_field = document.querySelector('select#formview_default_fields');
                    element_field.value = 'company_type';
                    element_field.dispatchEvent(new Event("change"));
                },
            },
            {
                content: "Check that there are conditions",
                trigger: '#formview_default_conditions',
                run: "click",
            },
            {
                content: "Save the new default",
                trigger: 'footer button:contains(Save default)',
                run: "click",
            },
            {
                content: "Discard the contact creation",
                trigger: 'button.o_form_button_cancel',
                run: "click",
            },
            {
                trigger: '.o_action_manager > .o_kanban_view .o-kanban-button-new',
                run: "click",
            },
            {
                content: "Check that Individual is checked instead of Company",
                trigger: '.o_field_widget[name="company_type"] input[data-value="person"]:checked',
            },
            {
                content: "Discard the contact creation",
                trigger: 'button.o_form_button_cancel',
                run: "click",
            },
            {
                content: "Wait for discard",
                trigger: '.o_control_panel .o-kanban-button-new',
            },
        ]
    });

return __exports;
});
;

/**************************************************************
*  Filepath: /crm/static/tests/tours/create_crm_team_tour.js  *
*  Lines: 46                                                  *
**************************************************************/
odoo.define('@crm/../tests/tours/create_crm_team_tour', ['@web/core/registry', '@web_tour/tour_service/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module */

const { registry } = require("@web/core/registry");
const { stepUtils } = require("@web_tour/tour_service/tour_utils");

registry.category("web_tour.tours").add('create_crm_team_tour', {
    url: "/odoo",
    steps: () => [
    ...stepUtils.goToAppSteps('crm.crm_menu_root'),
{
    trigger: 'button[data-menu-xmlid="crm.crm_menu_config"]',
    run: "click",
}, {
    trigger: 'a[data-menu-xmlid="crm.crm_team_config"]',
    run: "click",
}, {
    trigger: 'button.o_list_button_add',
    run: "click",
}, {
    trigger: 'input[id="name_0"]',
    run: "edit My CRM Team",
}, {
    trigger: 'button.o-kanban-button-new',
    run: "click",
}, {
    trigger: 'div.modal-dialog tr:contains("Test Salesman") input.form-check-input',
    run: 'click',
}, {
    trigger: 'div.modal-dialog tr:contains("Test Sales Manager") input.form-check-input',
    run: 'click',
}, {
    trigger: 'div.modal-dialog tr:contains("Test Sales Manager") input.form-check-input:checked',
}, {
    trigger: '.o_list_selection_box:contains(2)',
}, {
    trigger: 'button.o_select_button',
    run: "click",
},
    ...stepUtils.saveForm()
]});

return __exports;
});
;

/*************************************************************************
*  Filepath: /crm/static/tests/tours/crm_email_and_phone_propagation.js  *
*  Lines: 33                                                             *
*************************************************************************/
odoo.define('@crm/../tests/tours/crm_email_and_phone_propagation', ['@web/core/registry', '@web_tour/tour_service/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

    const { registry } = require("@web/core/registry");
    const { stepUtils } = require("@web_tour/tour_service/tour_utils");

    registry.category("web_tour.tours").add('crm_email_and_phone_propagation_edit_save', {
        url: '/odoo',
        steps: () => [
        stepUtils.showAppsMenuItem(),
        {
            trigger: '.o_app[data-menu-xmlid="crm.crm_menu_root"]',
            content: 'open crm app',
            run: "click",
        }, {
            trigger: '.o_kanban_record:contains(Test Lead Propagation)',
            content: 'Open the first lead',
            run: 'click',
        },
        {
            trigger: ".o_form_editable .o_field_widget[name=email_from] input",
        },
        {
            trigger: ".o_form_button_save:not(:visible)",
            content: 'Save the lead',
            run: 'click',
        },
    ]});

return __exports;
});
;

/***********************************************************
*  Filepath: /crm/static/tests/tours/crm_forecast_tour.js  *
*  Lines: 93                                               *
***********************************************************/
odoo.define('@crm/../tests/tours/crm_forecast_tour', ['@odoo/hoot-dom', '@web/core/registry', '@web_tour/tour_service/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module */
const { queryAll } = require("@odoo/hoot-dom");
const { registry } = require("@web/core/registry");
const { stepUtils } = require("@web_tour/tour_service/tour_utils");
const today = luxon.DateTime.now();

registry.category("web_tour.tours").add('crm_forecast', {
    url: "/odoo",
    steps: () => [
    stepUtils.showAppsMenuItem(),
    {
        trigger: ".o_app[data-menu-xmlid='crm.crm_menu_root']",
        content: "open crm app",
        run: "click",
    }, {
        trigger: '.dropdown-toggle[data-menu-xmlid="crm.crm_menu_report"]',
        content: 'Open Reporting menu',
        run: 'click',
    }, {
        trigger: '.dropdown-item[data-menu-xmlid="crm.crm_menu_forecast"]',
        content: 'Open Forecast menu',
        run: 'click',
    }, {
        trigger: '.o_column_quick_create:contains(Add next month)',
        content: 'Wait page loading',
    }, {
        trigger: ".o-kanban-button-new",
        content: "click create",
        run: 'click',
    }, {
        trigger: ".o_field_widget[name=name] input",
        content: "complete name",
        run: "edit Test Opportunity 1",
    }, {
        trigger: ".o_field_widget[name=expected_revenue] input",
        content: "complete expected revenue",
        run: "edit 999999",
    }, {
        trigger: "button.o_kanban_edit",
        content: "edit lead",
        run: "click",
    }, {
        trigger: "div[name=date_deadline] input",
        content: "complete expected closing",
        run: `edit ${today.toFormat("MM/dd/yyyy")}`,
    }, {
        trigger: "div[name=date_deadline] input",
        content: "click to make the datepicker disappear",
        run: "click"
    }, {
        trigger: '.o_back_button',
        content: 'navigate back to the kanban view',
        tooltipPosition: "bottom",
        run: "click"
    }, {
        trigger: ".o_kanban_record:contains('Test Opportunity 1')",
        content: "move to the next month",
        async run(helpers) {
            const undefined_groups = queryAll('.o_column_title:contains("None")').length;
            await helpers.drag_and_drop(`.o_opportunity_kanban .o_kanban_group:eq(${1 + undefined_groups})`);
        },
    }, {
        trigger: ".o_kanban_record:contains('Test Opportunity 1')",
        content: "edit lead",
        run: "click"
    }, {
        trigger: ".o_field_widget[name=date_deadline] input",
        content: "complete expected closing",
        run: `edit ${today.plus({ months: 5 }).startOf("month").minus({ days: 1 }).toFormat("MM/dd/yyyy")} && press Escape`,
    }, {
        trigger: ".o_field_widget[name=probability] input",
        content: "max out probability",
        run: "edit 100",
    }, {
        trigger: '.o_back_button',
        content: 'navigate back to the kanban view',
        tooltipPosition: "bottom",
        run: "click"
    }, {
        trigger: '.o_kanban_add_column',
        content: "add next month",
        run: "click"
    }, {
        trigger: ".o_kanban_record:contains('Test Opportunity 1'):contains('Won')",
        content: "assert that the opportunity has the Won banner",
    }
]});

return __exports;
});
;

/********************************************************
*  Filepath: /crm/static/tests/tours/crm_rainbowman.js  *
*  Lines: 127                                           *
********************************************************/
odoo.define('@crm/../tests/tours/crm_rainbowman', ['@web/core/registry', '@web_tour/tour_service/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { registry } = require("@web/core/registry");
const { stepUtils } = require("@web_tour/tour_service/tour_utils");

registry.category("web_tour.tours").add("crm_rainbowman", {
    url: "/odoo",
    steps: () => [
        stepUtils.showAppsMenuItem(),
        {
            trigger: ".o_app[data-menu-xmlid='crm.crm_menu_root']",
            content: "open crm app",
            run: "click",
        },
        {
            trigger: ".o-kanban-button-new",
            content: "click create",
            run: "click",
        },
        {
            trigger: ".o_field_widget[name=name] input",
            content: "complete name",
            run: "edit Test Lead 1",
        },
        {
            trigger: ".o_field_widget[name=expected_revenue] input",
            content: "complete expected revenue",
            run: "edit 999999997",
        },
        {
            trigger: "button.o_kanban_add",
            content: "create lead",
            run: "click",
        },
        {
            trigger: ".o_kanban_record:contains('Test Lead 1')",
            content: "move to won stage",
            run: "drag_and_drop (.o_opportunity_kanban .o_kanban_group:has(.o_column_title:contains('Won')))",
        },
        {
            trigger: ".o_reward_rainbow",
        },
        {
            // This step and the following simulates the fact that after drag and drop,
            // from the previous steps, a click event is triggered on the window element,
            // which closes the currently shown .o_kanban_quick_create.
            trigger: ".o_kanban_renderer",
            run: "click",
        },
        {
            trigger: ".o_kanban_renderer:not(:has(.o_kanban_quick_create))",
        },
        {
            trigger: ".o-kanban-button-new",
            content: "create second lead",
            run: "click",
        },
        {
            trigger: ".o_field_widget[name=name] input",
            content: "complete name",
            run: "edit Test Lead 2",
        },
        {
            trigger: ".o_field_widget[name=expected_revenue] input",
            content: "complete expected revenue",
            run: "edit 999999998",
        },
        {
            trigger: "button.o_kanban_add",
            content: "create lead",
            run: "click",
        },
        {
            trigger: ".o_kanban_record:contains('Test Lead 2')",
        },
        {
            // move first test back to new stage to be able to test rainbowman a second time
            trigger: ".o_kanban_record:contains('Test Lead 1')",
            content: "move back to new stage",
            run: "drag_and_drop .o_opportunity_kanban .o_kanban_group:eq(0) ",
        },
        {
            trigger: ".o_kanban_record:contains('Test Lead 2')",
            content: "click on second lead",
            run: "click",
        },
        {
            trigger: ".o_statusbar_status button[data-value='4']",
            content: "move lead to won stage",
            run: "click",
        },
        {
            content: "wait for save completion",
            trigger: ".o_form_readonly, .o_form_saved",
        },
        {
            trigger: ".o_reward_rainbow",
        },
        {
            trigger: ".o_statusbar_status button[data-value='1']",
            content: "move lead to previous stage & rainbowman appears",
            run: "click",
        },
        {
            trigger: "button[name=action_set_won_rainbowman]",
            content: "click button mark won",
            run: "click",
        },
        {
            content: "wait for save completion",
            trigger: ".o_form_readonly, .o_form_saved",
        },
        {
            trigger: ".o_reward_rainbow",
        },
        {
            trigger: ".o_menu_brand",
            content: "last rainbowman appears",
        },
    ],
});

return __exports;
});
;

/******************************************************************************
*  Filepath: /website/static/tests/tour_utils/focus_blur_snippets_options.js  *
*  Lines: 24                                                                  *
******************************************************************************/
odoo.define('@website/../tests/tour_utils/focus_blur_snippets_options', [], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

odoo.loader.bus.addEventListener("module-started", (e) => {
    if (e.detail.moduleName === "@web_editor/js/editor/snippets.options") {
        const options = e.detail.module[Symbol.for("default")];
        const FocusBlur = options.Class.extend({
            onFocus() {
                window.focusBlurSnippetsResult.push(`focus ${this.focusBlurName}`);
            },
            onBlur() {
                window.focusBlurSnippetsResult.push(`blur ${this.focusBlurName}`);
            },
        });
        options.registry.FocusBlurParent = FocusBlur.extend({focusBlurName: 'parent'});
        options.registry.FocusBlurChild1 = FocusBlur.extend({focusBlurName: 'child1'});
        options.registry.FocusBlurChild2 = FocusBlur.extend({focusBlurName: 'child2'});
    }
});

return __exports;
});
;

/***********************************************************************
*  Filepath: /website/static/tests/tour_utils/website_preview_test.js  *
*  Lines: 23                                                           *
***********************************************************************/
odoo.define('@website/../tests/tour_utils/website_preview_test', ['@web/core/utils/patch'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module */

const { patch } = require("@web/core/utils/patch");

// It's an optionnal import, to patch only when the WebsitePreview is loaded.
const WebsitePreviewLoader = odoo.loader.modules.get("@website/client_actions/website_preview/website_preview");

if (WebsitePreviewLoader) {
    patch(WebsitePreviewLoader.WebsitePreview.prototype, {
        /**
         * @override
         */
        get testMode() {
            return true;
        }
    });
}

return __exports;
});
;

/******************************************************************************
*  Filepath: /website/static/tests/tour_utils/widget_lifecycle_dep_widget.js  *
*  Lines: 50                                                                  *
******************************************************************************/
odoo.define('@website/../tests/tour_utils/widget_lifecycle_dep_widget', ['@web/core/browser/browser'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/
const { browser } = require("@web/core/browser/browser");
const localStorage = browser.localStorage;

odoo.loader.bus.addEventListener("module-started", (e) => {
    if (e.detail.moduleName !== "@web/legacy/js/public/public_widget") {
        return;
    }

    const publicWidget = e.detail.module[Symbol.for("default")];

    const localStorageKey = 'widgetAndWysiwygLifecycle';
    if (!localStorage.getItem(localStorageKey)) {
        localStorage.setItem(localStorageKey, '[]');
    }

    function addLifecycleStep(step) {
        const oldValue = localStorage.getItem(localStorageKey);
        const newValue = JSON.stringify(JSON.parse(oldValue).concat(step));
        localStorage.setItem(localStorageKey, newValue);
    }

    publicWidget.registry.CountdownPatch = publicWidget.Widget.extend({
        selector: ".s_countdown",
        disabledInEditableMode: false,

        /**
         * @override
         */
        async start() {
            addLifecycleStep('widgetStart');
            await this._super(...arguments);
            this.el.classList.add("public_widget_started");
        },
        /**
         * @override
         */
        destroy() {
            this.el.classList.remove("public_widget_started");
            addLifecycleStep('widgetStop');
            this._super(...arguments);
        },
    });
});

return __exports;
});
;

/**********************************************************************
*  Filepath: /website/static/tests/tours/carousel_content_removal.js  *
*  Lines: 118                                                         *
**********************************************************************/
odoo.define('@website/../tests/tours/carousel_content_removal', ['@odoo/hoot-dom', '@website/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module */

const { delay } = require("@odoo/hoot-dom");
const {
    insertSnippet,
    clickOnSnippet,
    changeOption,
    clickOnSave,
    registerWebsitePreviewTour,
    goBackToBlocks,
} = require("@website/js/tours/tour_utils");

const carouselInnerSelector = ":iframe .carousel-inner";

registerWebsitePreviewTour("carousel_content_removal", {
    url: '/',
    edition: true,
}, () => [
    ...insertSnippet({
        id: 's_carousel',
        name: 'Carousel',
        groupName: "Intro",
}), {
    trigger: ":iframe .carousel .carousel-item.active .carousel-content",
    content: "Select the active carousel item.",
    run: "click",
}, {
    trigger: ":iframe .oe_overlay.oe_active .oe_snippet_remove",
    content: "Remove the active carousel item.",
    run: "click",
}, {
    trigger: ":iframe .carousel .carousel-item.active .container:not(:has(*)):not(:visible)",
    content: "Check for a carousel slide with an empty container tag",
},
    goBackToBlocks(),
    ...insertSnippet({
        id: "s_quotes_carousel",
        name: "Blockquote",
        groupName: "People",
}), {
    trigger: ":iframe .s_quotes_carousel_wrapper .carousel-item.active .s_blockquote",
    content: "Select the blockquote.",
    run: "click",
}, {
    trigger: ":iframe .oe_overlay.oe_active .oe_snippet_remove",
    content: "Remove the blockquote from the carousel item.",
    run: "click",
}, {
    trigger: ":iframe .s_quotes_carousel_wrapper .carousel-item.active:not(:has(.s_blockquote))",
    content: "Check that the blockquote has been removed and the carousel item is empty.",
}]);

const checkSlides = (number, position) => {
    const nSlide = (n) => `div.carousel-item:eq(${n})`;
    const hasNSlide = (n) => `:has(${nSlide(n - 1)}):not(:has(${nSlide(n)}))`;
    const activeSlide = (p) => `${nSlide(p - 1)}:is(.active)`;
    return {
        content: `Check if there are ${number} slides and if the ${position} is active`,
        trigger: `${carouselInnerSelector}${hasNSlide(number)} ${activeSlide(position)}`,
        async run() {
            // When continue the tour directly, slide menu can disappears or
            // action can not be done.
            await delay(500);
        },
    };
};

registerWebsitePreviewTour(
    "snippet_carousel",
    {
        url: "/",
        edition: true,
    },
    () => [
        ...insertSnippet({ id: "s_carousel", name: "Carousel", groupName: "Intro" }),
        ...clickOnSnippet(".carousel .carousel-item.active"),
        // Slide to the right.
        changeOption("CarouselItem", 'we-button[data-switch-to-slide="right"]'),
        checkSlides(3, 2),
        // Add a slide (with the "CarouselItem" option).
        changeOption("CarouselItem", "we-button[data-add-slide-item]"),
        checkSlides(4, 3),
        // Remove a slide.
        changeOption("CarouselItem", "we-button[data-remove-slide]"),
        checkSlides(3, 2),
        {
            trigger: ":iframe .carousel .carousel-control-prev",
            content: "Slide the carousel to the left with the arrows.",
            run: "click",
        },
        checkSlides(3, 1),
        // Add a slide (with the "Carousel" option).
        changeOption("Carousel", "we-button[data-add-slide]"),
        checkSlides(4, 2),
        {
            content: "Check if the slide indicator was correctly updated",
            trigger: "we-customizeblock-options span:contains(' (2/4)')",
        },
        // Check if we can still remove a slide.
        changeOption("CarouselItem", "we-button[data-remove-slide]"),
        checkSlides(3, 1),
        // Slide to the left.
        changeOption("CarouselItem", 'we-button[data-switch-to-slide="left"]'),
        checkSlides(3, 3),
        // Reorder the slides and make it the second one.
        changeOption("GalleryElement", 'we-button[data-position="prev"]'),
        checkSlides(3, 2),
        ...clickOnSave(),
        // Check that saving always sets the first slide as active.
        checkSlides(3, 1),
    ]
);

return __exports;
});
;

/***************************************************************************
*  Filepath: /website/static/tests/tours/client_action_iframe_fallback.js  *
*  Lines: 27                                                               *
***************************************************************************/
odoo.define('@website/../tests/tours/client_action_iframe_fallback', ['@website/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module */

const { registerWebsitePreviewTour } = require('@website/js/tours/tour_utils');

registerWebsitePreviewTour('client_action_iframe_fallback', {
    url: '/',
},
() => [
    {
        content: "Ensure we are on the expected page",
        trigger: ':iframe html[data-view-xmlid="website.homepage"]',
    }, {
        content: "Ensure the iframe fallback is not loaded in test mode",
        trigger: 'body',
        run() {
            if (document.querySelector('iframe[src="/website/iframefallback"]')) {
                throw new Error("The iframe fallback shouldn't be inside the DOM.");
            }
        },
    },
]);

return __exports;
});
;

/********************************************************************
*  Filepath: /website/static/tests/tours/client_action_redirect.js  *
*  Lines: 89                                                        *
********************************************************************/
odoo.define('@website/../tests/tours/client_action_redirect', ['@odoo/hoot-dom', '@web/core/registry'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module */

const { delay } = require("@odoo/hoot-dom");
const { registry } = require("@web/core/registry");

const testUrl = '/test_client_action_redirect';

const goToFrontendSteps = [{
    content: "Go to the frontend",
    trigger: 'body',
    async run() {
        await delay(2000);
        window.location.assign(testUrl);
    }
}, {
    content: "Check we are in the frontend",
    trigger: 'body:not(:has(.o_website_preview)) #test_contact_FE',
}];
const goToBackendSteps = [{
    content: "Go to the backend",
    trigger: 'body',
    async run() {
        await delay(2000);
        window.location.assign(`/@${testUrl}`);
    }
}, {
    content: "Check we are in the backend",
    trigger: ".o_website_preview[data-view-xmlid='website.test_client_action_redirect'] :iframe",
}];
const checkEditorSteps = [{
    content: "Check that the editor is loaded",
    trigger: ':iframe body.editor_enable',
    timeout: 30000,
}, {
    content: "exit edit mode",
    trigger: "button[data-action=save]:enabled:contains(save)",
    run: "click",
    timeout: 30000,
}, {
    content: "wait for editor to close",
    trigger: ':iframe body:not(.editor_enable)',
}];

registry.category("web_tour.tours").add('client_action_redirect', {
    url: testUrl,
    steps: () => [
    // Case 1: From frontend, click on `enable_editor=1` link without `/@/` in it
    ...goToFrontendSteps,
    {
        content: "Click on the link to frontend",
        trigger: '#test_contact_FE',
        run: "click",
    },
    ...checkEditorSteps,

    // Case 2: From frontend, click on `enable_editor=1` link with `/@/` in it
    ...goToFrontendSteps,
    {
        content: "Click on the link to backend",
        trigger: '#test_contact_BE',
        run: "click",
    },
    ...checkEditorSteps,

    // Case 3: From backend, click on `enable_editor=1` link without `/@/` in it
    // TODO: This will be fixed in another fix related to the listening of the
    //       URL changes from the client action.
    // ...goToBackendSteps,
    // {
    //     content: "Click on the link to frontend (2)",
    //     trigger: ':iframe #test_contact_FR',
    // },
    // ...checkEditorSteps,

    // Case 4: From backend, click on `enable_editor=1` link with `/@/` in it
    ...goToBackendSteps,
    {
        content: "Click on the link to backend (2)",
        trigger: ':iframe #test_contact_BE',
        run: "click",
    },
    ...checkEditorSteps,
]});

return __exports;
});
;

/*********************************************************
*  Filepath: /website/static/tests/tours/colorpicker.js  *
*  Lines: 83                                             *
*********************************************************/
odoo.define('@website/../tests/tours/colorpicker', ['@website/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
const {
    insertSnippet,
    clickOnSave,
    clickOnEditAndWaitEditMode,
    registerWebsitePreviewTour,
} = require('@website/js/tours/tour_utils');

function selectColorpickerSwitchPanel(type) {
    return [
        {
            content: "Select text snippet",
            trigger: ":iframe #wrap .s_text_block",
            run: "click"
        },
        {
            content: "Click on background-color option",
            trigger: ".o_we_so_color_palette[data-css-property='background-color']",
            run: "click"
        },
        {
            content: "Select type of colorpicker in switch panel",
            trigger: `.o_we_colorpicker_switch_pane_btn[data-target="${type}"]`,
            run: "click"
        },
    ]
}

function checkBackgroundColorWithRGBA(red, green, blue) {
    return [
        {
            content: "Check if the RGBA color matches the selected color",
            trigger: ".o_rgba_div",
            run: function () {
                const rgbaEl = this.anchor;
                const red_color = rgbaEl.querySelector(".o_red_input").value;
                const green_color = rgbaEl.querySelector(".o_green_input").value;
                const blue_color = rgbaEl.querySelector(".o_blue_input").value;
                if (red_color != red || green_color != green || blue_color != blue) {
                    console.error("There may be a problem with the RGBA colorpicker");
                }
            }
        },
    ]
}

registerWebsitePreviewTour("website_background_colorpicker", {
    edition: true,
    url: "/",
}, () => [
    ...insertSnippet({
        id: "s_text_block",
        name: "Text",
        groupName: "Text",
    }),
    ...selectColorpickerSwitchPanel("gradients"),
    {
        content: "Select first gradient element",
        trigger: ".o_colorpicker_section .o_we_color_btn[data-color='linear-gradient(135deg, rgb(255, 204, 51) 0%, rgb(226, 51, 255) 100%)']",
        run: "click"
    },
    ...clickOnSave(),
    ...clickOnEditAndWaitEditMode(),
    ...selectColorpickerSwitchPanel("gradients"),
    ...checkBackgroundColorWithRGBA("255", "204", "51"),
    ...clickOnSave(),
    ...clickOnEditAndWaitEditMode(),
    ...selectColorpickerSwitchPanel("custom-colors"),
    {
        content: "Select first custom color element",
        trigger: ".o_colorpicker_section .o_we_color_btn[style='background-color:#65435C;']",
        run: "click"
    },
    ...clickOnSave(),
    ...clickOnEditAndWaitEditMode(),
    ...selectColorpickerSwitchPanel("custom-colors"),
    ...checkBackgroundColorWithRGBA("101", "67", "92"),
]);

return __exports;
});
;

/********************************************************************
*  Filepath: /website/static/tests/tours/conditional_visibility.js  *
*  Lines: 272                                                       *
********************************************************************/
odoo.define('@website/../tests/tours/conditional_visibility', ['@website/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module */

const {
    changeOption,
    clickOnEditAndWaitEditMode,
    clickOnSave,
    clickOnSnippet,
    insertSnippet,
    goBackToBlocks,
    registerWebsitePreviewTour,
} = require('@website/js/tours/tour_utils');

const snippets = [
    {
        id: 's_text_image',
        name: 'Text - Image',
        groupName: "Content",
    },
    {
        id: "s_banner",
        name: "Banner",
        groupName: "Intro",
    },
    {
        id: "s_popup",
        name: "Popup",
        groupName: "Content",
    },
];
function checkEyeIcon(snippetName, visible) {
    const eyeIcon = visible ? "fa-eye" : "fa-eye-slash";
    const openOrClose = visible ? "open" : "close";
    const endExplanation = `should be ${openOrClose} in the "Invisible Elements" panel`;
    const invisibleElPanel = "o_we_invisible_el_panel";
    return {
            content: `The eye icon of ${snippetName} ${endExplanation}`,
            trigger:
            `.${invisibleElPanel} .o_we_invisible_entry:contains("${snippetName}") i.${eyeIcon}`,
        };
}
function checkEyesIconAfterSave(footerIsHidden = true) {
    const eyeIconChecks = [
        checkEyeIcon("Header", false),
        checkEyeIcon("Text - Image", true),
        checkEyeIcon("Popup", false),
        checkEyeIcon("Banner", true),
    ];
    if (footerIsHidden) {
        eyeIconChecks.push(checkEyeIcon("Footer", false));
    }
    return eyeIconChecks;
}
registerWebsitePreviewTour('conditional_visibility_1', {
    edition: true,
    url: '/',
}, () => [
...insertSnippet(snippets[0]),
...clickOnSnippet(snippets[0]),
changeOption('ConditionalVisibility', 'we-toggler'),
{
    content: 'click on conditional visibility',
    trigger: '[data-name="visibility_conditional"]',
    run: 'click',
},
{
    content: 'click on utm medium toggler',
    trigger: '[data-save-attribute="visibilityValueUtmMedium"] we-toggler',
    run: 'click',
},
{
    trigger: '[data-save-attribute="visibilityValueUtmMedium"] we-selection-items .o_we_m2o_search input',
    content: 'Search for Email',
    run: "edit Email",
},
{
    trigger: '[data-save-attribute="visibilityValueUtmMedium"] we-selection-items [data-add-record="Email"]',
    content: 'click on Email',
    run: 'click',
},
...clickOnSave(),
{
    trigger: ".o_website_preview:only-child",
},
{
    content: 'Check if the rule was applied',
    trigger: ':iframe #wrap:not(:visible)',
    run: function (actions) {
        const style = window.getComputedStyle(this.anchor.getElementsByClassName('s_text_image')[0]);
        if (style.display !== 'none') {
            console.error('error This item should be invisible and only visible if utm_medium === email');
        }
    },
},
...clickOnEditAndWaitEditMode(),
{
    content: 'Check if the element is visible as it should always be visible in edit view',
    trigger: ':iframe #wrap .s_text_image',
    run: function (actions) {
        const style = window.getComputedStyle((this.anchor));
        if (style.display === 'none') {
            console.error('error This item should now be visible because utm_medium === email');
        }
    },
},
]);

registerWebsitePreviewTour("conditional_visibility_3", {
    edition: true,
    url: "/",
},
() => [
checkEyeIcon("Text - Image", true),
// Drag a "Banner" snippet on the website.
...insertSnippet(snippets[1]),
// Click on the "Banner" snippet.
...clickOnSnippet(snippets[1]),
changeOption("ConditionalVisibility", "we-toggler"),
changeOption("ConditionalVisibility", '[data-name="visibility_conditional"]'),
checkEyeIcon("Banner", true),
goBackToBlocks(),
// Drag a "Popup" snippet on the website.
...insertSnippet(snippets[2]),
{
    content: "Toggle the visibility of the popup",
    trigger: ".o_we_invisible_el_panel .o_we_invisible_entry:contains('Popup')",
    run: "click",
},
checkEyeIcon("Popup", false),
{
    content: "Click on footer",
    trigger: ":iframe #wrapwrap footer",
    run: "click",
},
changeOption("HideFooter", "we-checkbox"),
checkEyeIcon("Footer", false),
{
    content: "Click on Header",
    trigger: ":iframe #wrapwrap header",
    run: "click",
},
changeOption("TopMenuVisibility", "we-toggler"),
changeOption("TopMenuVisibility", '[data-visibility="hidden"]'),
checkEyeIcon("Header", false),
{
    content: "Toggle the visibility of the Banner snippet",
    trigger: ".o_we_invisible_el_panel .o_we_invisible_entry:contains('Banner')",
    run: "click",
},
checkEyeIcon("Banner", false),
...clickOnSave(),
...clickOnEditAndWaitEditMode(),
...checkEyesIconAfterSave(),
]);

registerWebsitePreviewTour("conditional_visibility_4", {
    edition: true,
    url: "/",
},
() => [
// Click on the "Text-Image" snippet.
...clickOnSnippet(snippets[0]),
{
    content: "Click on the 'move down' option",
    trigger: ":iframe we-button.o_we_user_value_widget.fa-angle-down",
    run: "click",
},
...checkEyesIconAfterSave(),
{
    content: "Check the order on the 'Invisible Elements' panel",
    trigger: ".o_we_invisible_el_panel div:nth-child(3):contains('Banner')",
},
{
    content: "Toggle the visibility of the Footer",
    trigger: ".o_we_invisible_el_panel .o_we_invisible_entry:contains('Footer')",
    run: "click",
},
{
    content: "Check that the footer is visible",
    trigger: ":iframe #wrapwrap footer",
},
// Click on the "Banner" snippet.
...clickOnSnippet(snippets[1]),
{
    content: "Drag the 'Banner' snippet to the end of the page",
    trigger: ":iframe .o_overlay_move_options .o_move_handle",
    run: "drag_and_drop :iframe #wrapwrap footer",
},
...checkEyesIconAfterSave(false),
{
    content: "Check the order on the 'Invisible Elements' panel",
    trigger: ".o_we_invisible_el_panel div:nth-child(3):contains('Text - Image')",
},
]);

registerWebsitePreviewTour("conditional_visibility_5", {
    edition: true,
    url: "/",
}, () => [
    {
        content: "Toggle the visibility of the Footer",
        trigger: ".o_we_invisible_el_panel .o_we_invisible_entry:contains('Footer')",
        run: "click",
    },
    {
        content: "Check that the footer is visible",
        trigger: ":iframe #wrapwrap footer",
    },
    ...insertSnippet(snippets[0]),
    {
        content: "Click on the image of the dragged snippet",
        trigger: ":iframe .s_text_image img",
        run: "click",
    },
    changeOption("DeviceVisibility", 'we-button[data-toggle-device-visibility="no_desktop"]'),
    {
        content: "Check that the Column has been added in the 'Invisible Elements' panel",
        trigger: ".o_we_invisible_el_panel .o_we_invisible_entry:contains('Column')",
    },
    {
        content: "Click on the 'Text - Image' snippet",
        trigger: ":iframe .s_text_image",
        run: "click",
    },
    changeOption("ConditionalVisibility", 'we-button[data-toggle-device-visibility="no_desktop"]'),
    {
        content: "Check that the 'Text - Image' is the parent of 'Column' in the 'Invisible Elements' panel",
        trigger: ".o_we_invisible_el_panel .o_we_invisible_root_parent.o_we_invisible_entry:contains('Text - Image') + ul .o_we_invisible_entry.o_we_sublevel_1:contains('Column')",
    },
    {
        content: "Click on the 'Text - Image' entry on the 'Invisible Elements' panel",
        trigger: ".o_we_invisible_el_panel .o_we_invisible_root_parent.o_we_invisible_entry:contains('Text - Image')",
        run: "click",
    },
    {
        content: "Check that the snippet is visible on the website",
        trigger: ":iframe .s_text_image.o_snippet_desktop_invisible.o_snippet_override_invisible",
    },
    changeOption("ConditionalVisibility", 'we-button[data-toggle-device-visibility="no_mobile"]'),
    {
        content: "Check that the 'Text - Image' has been removed from the 'Invisible Elements' panel",
        trigger: ".o_we_invisible_el_panel:not(.o_we_invisible_entry:contains('Text - Image'))",
    },
    {
        content: "Click on the 'Column' entry on the 'Invisible Elements' panel",
        trigger: ".o_we_invisible_el_panel .o_we_invisible_entry:contains('Column')",
        run: "click",
    },
    {
        content: "Check that the column is visible on the website",
        trigger: ":iframe .s_text_image .row > .o_snippet_desktop_invisible.o_snippet_override_invisible",
    },
    changeOption("DeviceVisibility", 'we-button[data-toggle-device-visibility="no_mobile"]'),
    {
        content: "Check that the column has been removed from the 'Invisible Elements' panel",
        trigger: "#oe_snippets:not(:has(.o_we_invisible_entry:contains('Column')))",
    },
    {
        content: "Activate mobile preview",
        trigger: ".o_we_website_top_actions button[data-action='mobile']",
        run: "click",
    },
    {
        content: "Check that the 'Text - Image' is the parent of 'Column' in the 'Invisible Elements' panel",
        trigger: ".o_we_invisible_el_panel .o_we_invisible_root_parent.o_we_invisible_entry:contains('Text - Image') + ul .o_we_invisible_entry.o_we_sublevel_1:contains('Column')",
    },
]);

return __exports;
});
;

/*****************************************************************************
*  Filepath: /website/static/tests/tours/conditional_visibility_frontend.js  *
*  Lines: 25                                                                 *
*****************************************************************************/
odoo.define('@website/../tests/tours/conditional_visibility_frontend', ['@web/core/registry'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { registry } = require("@web/core/registry");

registry.category("web_tour.tours").add('conditional_visibility_2', {
    url: '/?utm_medium=Email',
    steps: () => [{
    content: 'The content previously hidden should now be visible',
    trigger: 'body #wrap',
    run: function (actions) {
        const style = window.getComputedStyle(
            this.anchor.getElementsByClassName("s_text_image")[0]
        );
        if (style.display === 'none') {
            console.error('error This item should now be visible because utm_medium === email');
        }
    },
},
]});

return __exports;
});
;

/**********************************************************************
*  Filepath: /website/static/tests/tours/configurator_translation.js  *
*  Lines: 102                                                         *
**********************************************************************/
odoo.define('@website/../tests/tours/configurator_translation', ['@web/core/l10n/localization', '@web/core/l10n/translation', '@web/core/registry', '@website/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module */

const { localization } = require("@web/core/l10n/localization");
const { translatedTerms } = require("@web/core/l10n/translation");
const { registry } = require("@web/core/registry");
const { clickOnEditAndWaitEditMode } = require("@website/js/tours/tour_utils");

registry.category("web_tour.tours").add('configurator_translation', {
    url: '/website/configurator',
    steps: () => [
    // Configurator first screen
    {
        content: "click next",
        trigger: 'button.o_configurator_show',
        run: "click",
    },
    // Make sure "Back" works
    {
        content: "use browser's Back",
        trigger: 'a.o_change_website_type',
        run() {
            window.history.back();
        },
    }, {
        content: "return to description screen",
        trigger: 'button.o_configurator_show',
        run: "click",
    },
    // Description screen
    {
        content: "select a website type",
        trigger: 'a.o_change_website_type',
        run: "click",
    }, {
        content: "insert a website industry",
        trigger: '.o_configurator_industry input',
        run: "edit ab",
    }, {
        content: "select a website industry from the autocomplete",
        trigger: '.o_configurator_industry_wrapper ul li a:contains("in fr")',
        run: "click",
    }, {
        content: "select an objective",
        trigger: '.o_configurator_purpose_dd a',
        run: "click",
    }, {
        content: "choose from the objective list",
        trigger: 'a.o_change_website_purpose',
        run: "click",
    },
    // Palette screen
    {
        content: "chose a palette card",
        trigger: '.palette_card',
        run: "click",
    },
    // Features screen
    {
        content: "select confidentialit",
        trigger: '.card:contains(Parseltongue_privacy)',
        run: "click",
    }, {
        content: "Click on build my website",
        trigger: 'button.btn-primary',
        run: "click",
    }, {
        content: "Loader should be shown",
        trigger: '.o_website_loader_container',
    }, {
        content: "Wait until the configurator is finished",
        trigger: ".o_website_preview[data-view-xmlid='website.homepage']",
        timeout: 30000,
    }, {
        content: "Check if the current interface language is active and monkey patch terms",
        trigger: "body",
        run() {
            if (localization.code !== "pa_GB") {
                throw new Error("The user language is not the correct one");
            } else {
                translatedTerms["Save"] = "Save_Parseltongue";
            }
        }
    },
    ...clickOnEditAndWaitEditMode(),
    {
        // Check the content of the save button to make sure the website is in
        // Parseltongue. (The editor should be in the website's default language,
        // which should be parseltongue in this test.)
        content: "exit edit mode",
        trigger: '.o_we_website_top_actions button.btn-primary:contains("Save_Parseltongue")',
        run: "click",
    }, {
         content: "wait for editor to be closed",
         trigger: ':iframe body:not(.editor_enable)',
    }
]});

return __exports;
});
;

/******************************************************************
*  Filepath: /website/static/tests/tours/custom_popup_snippet.js  *
*  Lines: 46                                                      *
******************************************************************/
odoo.define('@website/../tests/tours/custom_popup_snippet', ['@website/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module */

const {
    clickOnSnippet,
    insertSnippet,
    registerWebsitePreviewTour,
} = require("@website/js/tours/tour_utils");

const snippets = [
    { id: "s_popup", name: "Popup", groupName: "Content" },
    { id: "s_banner", name: "Banner", groupName: "Into" },
    { id: "s_popup", name: "Custom Popup", groupName: "Custom" },
];

registerWebsitePreviewTour(
    "custom_popup_snippet",
    {
        url: "/",
        edition: true,
    },
    () => [
        ...insertSnippet(snippets[0]),
        ...clickOnSnippet(snippets[1]),
        {
            content: "save this snippet to save later",
            trigger: ".o_we_user_value_widget.fa-save",
            run: "click",
        },
        {
            content: "confirm and reload custom snippet",
            trigger: ".modal-footer > .btn.btn-primary",
            run: "click",
        },
        ...insertSnippet(snippets[2]),
        {
            content: "check whether new custom popup is visible or not.",
            trigger: ":iframe section[data-snippet='s_banner']",
        },
    ]
);

return __exports;
});
;

/*******************************************************************************
*  Filepath: /website/static/tests/tours/default_shape_gets_palette_colors.js  *
*  Lines: 41                                                                   *
*******************************************************************************/
odoo.define('@website/../tests/tours/default_shape_gets_palette_colors', ['@odoo/hoot-dom', '@website/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { queryFirst } = require("@odoo/hoot-dom");
const {
    changeOption,
    clickOnSnippet,
    insertSnippet,
    registerWebsitePreviewTour,
} = require("@website/js/tours/tour_utils");

registerWebsitePreviewTour("default_shape_gets_palette_colors", {
    url: '/',
    edition: true,
}, () => [
    ...insertSnippet({
        id: 's_text_image',
        name: 'Text - Image',
        groupName: "Content",
    }),
    ...clickOnSnippet({
        id: 's_text_image',
        name: 'Text - Image',
    }),
    changeOption('ColoredLevelBackground', 'Shape'),
    {
        content: "Check that shape does not have a background-image in its inline style",
        trigger: ':iframe #wrap .s_text_image .o_we_shape',
        run() {
            const shape = queryFirst(":iframe :not(.o_ignore_in_tour) #wrap .s_text_image .o_we_shape");
            if (shape.style.backgroundImage) {
                throw new Error("The default shape has a background-image in its inline style (should rely on the class)");
            }
        },
    },
]);

return __exports;
});
;

/***************************************************************************
*  Filepath: /website/static/tests/tours/drag_and_drop_on_non_editable.js  *
*  Lines: 42                                                               *
***************************************************************************/
odoo.define('@website/../tests/tours/drag_and_drop_on_non_editable', ['@website/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { insertSnippet, goBackToBlocks, registerWebsitePreviewTour } = require('@website/js/tours/tour_utils');

registerWebsitePreviewTour("test_drag_and_drop_on_non_editable", {
    url: "/",
    edition: true,
}, () => [
    ...insertSnippet({
        id: "s_company_team",
        name: "Team",
        groupName: "People",
    }),
    {
        content: "Click on an editable media in non editable env.",
        trigger: ":iframe .s_company_team .o_not_editable > .o_editable_media",
        run: "click",
    },
    {
        content: "Verify that the Replace options is in the editor.",
        trigger: "we-button[data-replace-media]",
    },
    goBackToBlocks(),
    {
        trigger: ".o_website_preview.editor_enable.editor_has_snippets",
    },
    {
        content: "Drag and drop the Text Highlight building block next to the Team block media.",
        trigger: `#oe_snippets .oe_snippet[name="Text Highlight"].o_we_draggable .oe_snippet_thumbnail:not(.o_we_ongoing_insertion)`,
        run: "drag_and_drop :iframe .s_company_team .o_not_editable > .o_editable_media",
    },
    {
        content: "Verify that the Text Highlight building block isn't in a non editable element.",
        trigger: ":iframe .s_company_team :not(.o_not_editable) > .s_text_highlight",
    },
]);

return __exports;
});
;

/************************************************************************
*  Filepath: /website/static/tests/tours/drop_404_ir_attachment_url.js  *
*  Lines: 58                                                            *
************************************************************************/
odoo.define('@website/../tests/tours/drop_404_ir_attachment_url', ['@website/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const {
    changeOption,
    insertSnippet,
    registerWebsitePreviewTour,
} = require('@website/js/tours/tour_utils');

registerWebsitePreviewTour('drop_404_ir_attachment_url', {
    url: '/',
    edition: true,
}, () => [
    ...insertSnippet({
        id: 's_404_snippet',
        name: '404 Snippet',
        groupName: "Images",
    }),
    {
        content: 'Click on the snippet image',
        trigger: ':iframe .s_404_snippet img',
        run: "click",
    },
    {
        trigger: ".snippet-option-ReplaceMedia",
    },
    {
        content: 'Once the image UI appears, check the image has no size (404)',
        trigger: ':iframe .s_404_snippet img',
        run() {
            const imgEl = this.anchor;
            if (!imgEl.complete
                || imgEl.naturalWidth !== 0
                || imgEl.naturalHeight !== 0) {
                throw new Error('This is supposed to be a 404 image');
            }
        },
    },
    changeOption('ImageTools', 'we-select[data-name="shape_img_opt"] we-toggler'),
    changeOption('ImageTools', 'we-button[data-set-img-shape]'),
    {
        content: 'Once the shape is applied, check the image has now a size (placeholder image)',
        trigger: ':iframe .s_404_snippet img[src^="data:"]',
        run() {
            const imgEl = this.anchor;
            if (!imgEl.complete
                || imgEl.naturalWidth === 0
                || imgEl.naturalHeight === 0) {
                throw new Error('Even though the original image was a 404, the option should have been applied on the placeholder image');
            }
        },
    },
]);

return __exports;
});
;

/*********************************************************************************
*  Filepath: /website/static/tests/tours/dropdowns_and_header_hide_on_scroll.js  *
*  Lines: 85                                                                     *
*********************************************************************************/
odoo.define('@website/../tests/tours/dropdowns_and_header_hide_on_scroll', ['@website/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module */

const {
    clickOnSave,
    changeOption,
    checkIfVisibleOnScreen,
    insertSnippet,
    registerWebsitePreviewTour,
    selectHeader,
} = require("@website/js/tours/tour_utils");

const checkIfUserMenuNotMasked = function () {
    return [
        {
            content: "Click on the user dropdown",
            trigger: ":iframe #wrapwrap header li.dropdown > a:contains(mitchell admin)",
            run: "click",
        },
        checkIfVisibleOnScreen(
            ":iframe #wrapwrap header li.dropdown .dropdown-menu.show a[href='/my/home']"
        ),
    ];
};

const scrollDownToMediaList = function () {
    return {
        content: "Scroll down the page a little to leave the dropdown partially visible",
        trigger: ":iframe #wrapwrap .s_media_list",
        run() {
            // Scroll down to the media list snippet.
            this.anchor.scrollIntoView({ behavior: "instant" });
        },
    };
};

registerWebsitePreviewTour("dropdowns_and_header_hide_on_scroll", {
    url: "/",
    edition: true,
}, () => [
    ...insertSnippet({id: "s_media_list", name: "Media List", groupName: "Content"}),
    selectHeader(),
    changeOption("undefined", 'we-select[data-variable="header-scroll-effect"]'),
    changeOption("undefined", 'we-button[data-name="header_effect_fixed_opt"]'),
    {
        content: "Wait for the modification has been applied",
        trigger: ".o_we_customize_panel:contains(Select a block on your page to style it.)",
        timeout: 30000,
    },
    {
        trigger: ":iframe #wrapwrap header.o_header_fixed",
    },
    selectHeader(),
    changeOption("WebsiteLevelColor", 'we-select[data-variable="header-template"] we-toggler'),
    changeOption("WebsiteLevelColor", 'we-button[data-name="header_sales_two_opt"]'),
    {
        trigger: ":iframe .o_header_sales_two_top",
        timeout: 30000,
    },
    {
        content: "check that header_sales_two_opt is well selected",
        trigger: ":iframe #wrapwrap header.o_header_fixed div[aria-label=Middle] div[role=search]",
    },
    ...clickOnSave(undefined, 30000),
    ...checkIfUserMenuNotMasked(),
    // We scroll the page a little because when clicking on the dropdown, the
    // page needs to scroll to the top first and then open the dropdown menu.
    scrollDownToMediaList(),
    ...checkIfUserMenuNotMasked(),
    // We scroll the page again because when typing in the searchbar input, the
    // page needs also to scroll to the top first and then open the dropdown
    // with the search results.
    scrollDownToMediaList(),
    {
        content: "Type a search query into the searchbar input",
        trigger: ":iframe #wrapwrap header .s_searchbar_input input.search-query",
        run: "edit a",
    },
    checkIfVisibleOnScreen(":iframe #wrapwrap header .s_searchbar_input.show .o_dropdown_menu.show"),
]);

return __exports;
});
;

/***************************************************************
*  Filepath: /website/static/tests/tours/edit_link_popover.js  *
*  Lines: 233                                                  *
***************************************************************/
odoo.define('@website/../tests/tours/edit_link_popover', ['@website/js/tours/tour_utils', '@web/core/browser/browser', '@web/core/utils/patch'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const {
    insertSnippet,
    registerWebsitePreviewTour,
} = require("@website/js/tours/tour_utils");
const { browser } = require("@web/core/browser/browser");
const { patch } = require("@web/core/utils/patch");

const FIRST_PARAGRAPH = ':iframe #wrap .s_text_image p:nth-child(2)';

const clickFooter = [{
    content: "Save the link by clicking outside the URL input (not on a link element)",
    trigger: ':iframe footer h5:first',
    run: "click",
}, {
    content: "Wait delayed click on footer",
    trigger: '.o_we_customize_panel we-title:contains("Footer")',
}];

const clickEditLink = [{
    content: "Click on Edit Link in Popover",
    trigger: ':iframe .o_edit_menu_popover .o_we_edit_link',
    run: "click",
}, {
    content: "Ensure popover is closed",
    trigger: ':iframe html:not(:has(.o_edit_menu_popover))', // popover should be closed
}];

registerWebsitePreviewTour('edit_link_popover', {
    url: '/',
    edition: true,
}, () => [
    // 1. Test links in page content (web_editor)
    ...insertSnippet({
        id: 's_text_image',
        name: 'Text - Image',
        groupName: "Content",
    }),
    {
        content: "Click on a paragraph",
        trigger: FIRST_PARAGRAPH,
        run: "editor Paragraph", // Make sure the selection is set in the paragraph
    },
    {
        content: "Click on 'Link' to open Link Dialog",
        trigger: "#toolbar:not(.oe-floating) #create-link",
        run: "click",
    },
    {
        content: "Type the link URL /contactus",
        trigger: '#o_link_dialog_url_input',
        run: "edit /contactus",
    },
    ...clickFooter,
    {
        content: "Click on newly created link",
        trigger: `${FIRST_PARAGRAPH} a`,
        run: "click",
    },
    {
        content: "Popover should be shown",
        trigger: ':iframe .o_edit_menu_popover .o_we_url_link:contains("Contact Us")', // At this point preview is loaded
    },
    ...clickEditLink,
    {
        content: "Type the link URL /",
        trigger: '#o_link_dialog_url_input',
        run: `edit /`,
    },
    ...clickFooter,
    {
        content: "Click on link",
        trigger: `${FIRST_PARAGRAPH} a`,
        run: "click",
    },
    {
        content: "Popover should be shown with updated preview data",
        trigger: ':iframe .o_edit_menu_popover .o_we_url_link:contains("Home")',
    },
    {
        content: "Click on Remove Link in Popover",
        trigger: ':iframe .o_edit_menu_popover .o_we_remove_link',
        run: "click",
    },
    {
        content: "Link should be removed",
        trigger: `${FIRST_PARAGRAPH}:not(:has(a))`,
    },
    {
        content: "Ensure popover is closed",
        trigger: ':iframe html:not(:has(.o_edit_menu_popover))', // popover should be closed
    },
    // 2. Test links in navbar (website)
    {
        content: "Click navbar menu Home",
        trigger: ':iframe .top_menu a:contains("Home")',
        run: "click",
    },
    {
        content: "Popover should be shown (2)",
        trigger: ':iframe .o_edit_menu_popover .o_we_url_link:contains("Home")',
    },
    ...clickEditLink,
    {
        content: "Change the URL",
        trigger: '#url_input',
        run: "edit /contactus",
    },
    {
        content: "Save the Edit Menu modal",
        trigger: '.modal-footer .btn-primary',
        run: "click",
    },
    {
        trigger: "div:not(.o_loading_dummy) > #oe_snippets",
    },
    {
        content: "Click on the Home menu again",
        trigger: ':iframe .top_menu a:contains("Home")[href="/contactus"]',
        run: "click",
    },
    {
        content: "Popover should be shown with updated preview data (2)",
        trigger: ':iframe .o_edit_menu_popover .o_we_url_link:contains("Contact Us")',
    },
    {
        content: "Click on Edit Menu in Popover",
        trigger: ':iframe .o_edit_menu_popover .js_edit_menu',
        run: "click",
    },
    {
        content: "Edit Menu (tree) should open",
        trigger: '.o_website_dialog .oe_menu_editor',
    },
    {
        content: "Close modal",
        trigger: '.modal-footer .btn-secondary',
        run: "click",
    },
    {
        content: "Check that the modal is closed",
        trigger: ":iframe html:not(.modal-body)",
    },
    // 3. Test other links (CTA in navbar & links in footer)
    {
        content: "Click CTA in navbar",
        trigger: ':iframe .o_main_nav a.btn-primary[href="/contactus"]',
        run: "click",
    },
    {
        content: "Popover should be shown (3)",
        trigger: ':iframe .o_edit_menu_popover .o_we_url_link:contains("Contact Us")',
    },
    {
        content: "Toolbar should be shown (3)",
        trigger: `.oe-toolbar:not(.oe-floating):has(#o_link_dialog_url_input:value('/contactus'))`,
    },
    {
        content: "Click 'Home' link in footer",
        trigger: ':iframe footer a[href="/"]',
        async run(helpers) {
            await helpers.click();
            const el = this.anchor;
            const sel = el.ownerDocument.getSelection();
            sel.collapse(el.childNodes[1], 1);
            el.focus();
        }
    },
    {
        content: "Popover should be shown (4)",
        trigger: ':iframe .o_edit_menu_popover .o_we_url_link:contains("Home")',
    },
    {
        content: "Toolbar should be shown (4)",
        trigger: `.oe-toolbar:not(.oe-floating):has(#o_link_dialog_url_input:value('/'))`,
    },
    // 4. Popover should close when clicking non-link element
    ...clickFooter,
    // 5. Double click should not open popover but should open toolbar link
    {
        trigger: ":iframe html:not(:has(.o_edit_menu_popover))", // popover should be closed
    },
    {
        content: "Double click on link",
        trigger: ':iframe footer a[href="/"]',
        async run(actions) {
            // Create range to simulate real double click, see pull request
            const range = document.createRange();
            range.selectNodeContents(this.anchor);
            const sel = window.getSelection();
            sel.removeAllRanges();
            sel.addRange(range);
            await actions.click();
            await actions.dblclick();
        },
    },
    {
        trigger: ":iframe html:has(.o_edit_menu_popover)",
    },
    {
        content: "Ensure popover is opened on double click, and so is right panel edit link",
        trigger: 'html:has(#o_link_dialog_url_input)',
    },
    {
        trigger: ':iframe .o_edit_menu_popover a.o_we_full_url[target="_blank"]',
    },
    {
        content: "Ensure that a click on the link popover link opens a new window in edit mode",
        trigger: ':iframe .o_edit_menu_popover a.o_we_url_link[target="_blank"]',
        run(actions) {
            // We do not want to open a link in a tour
            patch(browser, {
                open(url) {
                    if (window.location.hostname === url.hostname && url.pathname.startsWith('/@/')) {
                        document.querySelector('body').classList.add('new_backend_window_opened');
                    }
                }
            }, {pure: true});
            actions.click();
        },
    },
    {
        content: "Ensure that link is opened correctly in edit mode",
        trigger: '.new_backend_window_opened',
    },
]);

return __exports;
});
;

/***********************************************************
*  Filepath: /website/static/tests/tours/edit_megamenu.js  *
*  Lines: 314                                              *
***********************************************************/
odoo.define('@website/../tests/tours/edit_megamenu', ['@website/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const {
    changeOption,
    clickOnExtraMenuItem,
    clickOnSave,
    registerWebsitePreviewTour,
} = require("@website/js/tours/tour_utils");

const toggleMegaMenu = (stepOptions) => Object.assign({}, {
    content: "Toggles the mega menu.",
    trigger: ":iframe .top_menu .nav-item a.o_mega_menu_toggle",
    run(helpers) {
        // If the mega menu is displayed inside the extra menu items, it should
        // already be displayed.
        if (!this.anchor.closest(".o_extra_menu_items")) {
            helpers.click();
        }
    },
}, stepOptions);

registerWebsitePreviewTour('edit_megamenu', {
    url: '/',
    edition: true,
}, () => [
    // Add a megamenu item to the top menu.
    {
        content: "Click on a menu item",
        trigger: ":iframe .top_menu .nav-item a",
        run: "click",
    },
    {
        content: "Click on 'Link' to open Link Dialog",
        trigger: ':iframe .o_edit_menu_popover a.js_edit_menu',
        run: "click",
    },
    {
        trigger: ".o_website_dialog:visible",
    },
    {
        content: "Trigger the link dialog (click 'Add Mega Menu Item')",
        trigger: '.modal-body a:eq(1)',
        run: "click",
    },
    {
        content: "Write a label for the new menu item",
        trigger: '.modal-dialog .o_website_dialog input',
        run: "edit Megaaaaa!",
    },
    {
        content: "Confirm the mega menu label",
        trigger: ".modal .modal-footer button:contains(ok)",
        run: "click",
    },
    {
        trigger: '.oe_menu_editor [data-is-mega-menu="true"] .js_menu_label:contains("Megaaaaa!")',
    },
    {
        content: "Save the website menu with a new mega menu",
        trigger: ".modal .modal-footer button:contains(save)",
        run: "click",
    },
    {
        trigger: "body:not(:has(.modal))",
    },
    {
        trigger: '#oe_snippets.o_loaded',
    },
    {
        trigger: ".o_website_preview.editor_enable.editor_has_snippets:not(.o_is_blocked)"
    },
    // Edit a menu item
    clickOnExtraMenuItem({}, true),
    toggleMegaMenu({}),
    {
        content: "Select the last menu link of the first column",
        trigger: ':iframe .s_mega_menu_odoo_menu .row > div:first-child .nav > :nth-child(6)', // 6th is the last one
        run: "click",
    },
    {
        content: "Hit the delete button to remove the menu link",
        trigger: ':iframe .oe_overlay .oe_snippet_remove',
        run: "click",
    },
    {
        content: "Check that the last menu link was deleted",
        trigger: ':iframe .s_mega_menu_odoo_menu .row > div:first-child .nav:not(:has(:nth-child(6)))',
    },
    {
        content: "Click on the first title item.",
        trigger: ':iframe .o_mega_menu h4',
        run: "click",
    },
    {
        content: "Press enter.",
        trigger: ':iframe .o_mega_menu h4',
        run() {
            this.anchor.dispatchEvent(
                new window.InputEvent("input", {bubbles: true, inputType: "insertParagraph"})
            );
        },
    },
    {
        content: "The menu should still be visible. Edit a menu item.",
        trigger: ':iframe .o_mega_menu h4',
        // The content is removed in the previous step so it's now invisible.
        run: "editor New Menu Item",
    },
    {
        // If this step fails, it means that a patch inside bootstrap was lost.
        content: "Press the 'down arrow' key.",
        trigger: ':iframe .o_mega_menu h4',
        run: "press ArrowDown",
    },
    ...clickOnSave(),
    clickOnExtraMenuItem({}, true),
    toggleMegaMenu(),
    {
        content: "The menu item should have been renamed.",
        trigger: ':iframe .o_mega_menu h4:contains("New Menu Item")',
    },
]);
registerWebsitePreviewTour("megamenu_active_nav_link", {
    url: "/",
    edition: true,
}, () => [
       // Add a megamenu item to the top menu.
    {
        content: "Click on a menu item",
        trigger: ":iframe .top_menu .nav-item a",
        run: "click",
    },
    {
        content: "Click on 'Link' to open Link Dialog",
        trigger: ":iframe .o_edit_menu_popover a.js_edit_menu",
        run: "click",
    },
    {
        trigger: ".o_website_dialog",
    },
    {
        content: "Trigger the link dialog (click 'Add Mega Menu Item')",
        trigger: ".modal-body a:eq(1)",
        run: "click",
    },
    {
        content: "Write a label for the new menu item",
        trigger: ".modal-dialog .o_website_dialog input",
        run: "edit MegaTron",
    },
    {
        content: "Confirm the mega menu label",
        trigger: ".modal .modal-footer .btn-primary:contains(ok)",
        run: "click",
    },
    {
        trigger: `.oe_menu_editor [data-is-mega-menu="true"] .js_menu_label:contains("MegaTron")`,
    },
    {
        content: "Save the website menu with a new mega menu",
        trigger: ".modal-footer .btn-primary",
        run: "click",
    },
    {
        trigger: "#oe_snippets.o_loaded",
    },
    {
        content: "Check for the new mega menu",
        trigger: `:iframe .top_menu:has(.nav-item a.o_mega_menu_toggle:contains("Megatron"))`,
    },
    {
        trigger: ".o_website_preview.editor_enable.editor_has_snippets:not(.o_is_blocked)"
    },
    clickOnExtraMenuItem({}, true),
    toggleMegaMenu({}),
    {
        content: "Select the last menu link of the first column",
        trigger: ":iframe .s_mega_menu_odoo_menu .row > div:first-child .nav > :nth-child(6)",
        run: "click",
    },
    {
        content: "Click 'edit link' button if URL input is now shown",
        trigger: "#create-link",
        async run(actions) {
            // Note: the 'create-link' button is always here, however the input 
            // for the URL might not be.
            // We have to consider both cases:
            // 1. Single-app website build: a few menu, so no extra menu added 
            //    and the URL input is shown
            // 2. Multi-app website build:  many menu, so extra menu added 
            //    and the URL input is not shown
            if (!document.querySelector("#o_link_dialog_url_input")) {
                await actions.click();
            }
        },
    },
    {
        content: "Change the link",
        trigger: "#o_link_dialog_url_input",
        run: "edit /new_page"
    },
    ...clickOnSave(),
    clickOnExtraMenuItem({}, true),
    toggleMegaMenu(),
    {
        content: "Click on the last menu link of the first column",
        trigger: ":iframe .s_mega_menu_odoo_menu .row > div:first-child .nav > :nth-child(6)",
        run: "click",
    },
    {
        content: "Check if the new mega menu is active",
        trigger: `:iframe .top_menu:has(.nav-item a.o_mega_menu_toggle.active:contains("MegaTron"))`,
    },
])
registerWebsitePreviewTour('edit_megamenu_big_icons_subtitles', {
    url: '/',
    edition: true,
}, () => [
    // Add a megamenu item to the top menu.
    {
        content: "Click on a menu item",
        trigger: ':iframe .top_menu .nav-item a',
        run: "click",
    },
    {
        content: "Click on 'Link' to open Link Dialog",
        trigger: ':iframe .o_edit_menu_popover a.js_edit_menu',
        run: "click",
    },
    {
        trigger: ".o_website_dialog",
    },
    {
        content: "Trigger the link dialog (click 'Add Mega Menu Item')",
        trigger: '.modal-body a:eq(1)',
        run: "click",
    },
    {
        content: "Write a label for the new menu item",
        trigger: '.modal-dialog .o_website_dialog input',
        run: "edit Megaaaaa2!",
    },
    {
        content: "Confirm the mega menu label",
        trigger: ".modal .modal-footer .btn-primary:contains(ok)",
        run: "click",
    },
    {
        trigger: '.oe_menu_editor [data-is-mega-menu="true"] .js_menu_label:contains("Megaaaaa2!")',
    },
    {
        content: "Save the website menu with a new mega menu",
        trigger: '.modal-footer .btn-primary',
        run: "click",
    },
    {
        trigger: '#oe_snippets.o_loaded',
    },
    {
        content: "Check for the new mega menu",
        trigger: ':iframe .top_menu:has(.nav-item a.o_mega_menu_toggle:contains("Megaaaaa2!"))',
    },
    {
        trigger: ".o_website_preview.editor_enable.editor_has_snippets:not(.o_is_blocked)"
    },
    // Edit a menu item
    clickOnExtraMenuItem({}, true),
    toggleMegaMenu({}),
    {
        content: "Select the first menu link of the first column",
        trigger: ':iframe .s_mega_menu_odoo_menu .row > div:first-child .nav > :first-child',
        run: "click",
    },
    changeOption("MegaMenuLayout", "we-toggler"),
    {
        content: "Select Big Icons Subtitles mega menu",
        trigger: '[data-select-label="Big Icons Subtitles"]',
        run: "click",
    },
    {
        content: "Select the h4 of first menu link of the first column",
        trigger: ':iframe .s_mega_menu_big_icons_subtitles .row > div:first-child .nav > :first-child h4',
        async run(actions) {
            // Clicking on the h4 element first time leads to the selection of
            // the entire a.nav-link, due to presence of `o_default_snippet_text` class
            // hence, specify the selection on the h4 element
            await actions.click();
            const iframeDocument = document.querySelector('.o_iframe').contentDocument;
            const range = iframeDocument.createRange();
            range.selectNodeContents(this.anchor);
            const sel = iframeDocument.getSelection();
            sel.removeAllRanges();
            sel.addRange(range);
        },
    },
    {
        content: "Convert it to Bold",
        trigger: '#oe_snippets #toolbar #bold',
        run: "click",
    },
    ...clickOnSave(),
    clickOnExtraMenuItem({}, true),
    toggleMegaMenu(),
    {
        content: "The menu item should only convert selected text to Bold.",
        trigger: ':iframe .s_mega_menu_big_icons_subtitles .row > div:first-child .nav > :first-child span:not(:has(strong))',
    },
]);

return __exports;
});
;

/********************************************************
*  Filepath: /website/static/tests/tours/edit_menus.js  *
*  Lines: 495                                           *
********************************************************/
odoo.define('@website/../tests/tours/edit_menus', ['@odoo/hoot-dom', '@website/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module */

const { delay } = require('@odoo/hoot-dom');
const {
    clickOnEditAndWaitEditMode,
    clickOnExtraMenuItem,
    clickOnSave,
    insertSnippet,
    registerWebsitePreviewTour,
} = require('@website/js/tours/tour_utils');

registerWebsitePreviewTour('edit_menus', {
    url: '/',
}, () => [
    // Add a megamenu item from the menu.
    {
        trigger: ":iframe #wrapwrap",
    },
    {
        content: "open site menu",
        trigger: 'button[data-menu-xmlid="website.menu_site"]',
        run: "click",
    },
    {
        content: "Click on Edit Menu",
        trigger: 'a[data-menu-xmlid="website.menu_edit_menu"]',
        run: "click",
    },
    {
        trigger: ".o_website_dialog:visible",
    },
    {
        content: "Trigger the link dialog (click 'Add Mega Menu Item')",
        trigger: '.modal:not(.o_inactive_modal) .modal-body a:eq(1)',
        run: "click",
    },
    {
        content: "Write a label for the new menu item",
        trigger: '.modal:not(.o_inactive_modal) .modal-dialog .o_website_dialog input',
        run: "edit Megaaaaa!",
    },
    {
        content: "Confirm the mega menu label",
        trigger: ".modal:not(.o_inactive_modal) .modal-footer .btn-primary:contains(ok)",
        run: "click",
    },
    {
        trigger: '.oe_menu_editor [data-is-mega-menu="true"] .js_menu_label:contains("Megaaaaa!")',
    },
    {
        content: "Save the new menu",
        trigger: '.modal-footer .btn-primary',
        run: "click",
    },
    {
        trigger: "body:not(:has(.oe_menu_editor))",
    },
    {
        trigger: ":iframe body:contains(welcome to your)",
    },
    clickOnExtraMenuItem({}, true),
    {
        content: "There should be a new megamenu item.",
        trigger: ':iframe .top_menu .nav-item a.o_mega_menu_toggle:contains("Megaaaaa!")',
    },
    // Add a menu item in edit mode.
    ...clickOnEditAndWaitEditMode(),
    {
        content: "Click on a menu item",
        trigger: ":iframe .top_menu .nav-item a",
        run: "click",
    },
    {
        content: "Click on Edit Menu",
        trigger: ':iframe .o_edit_menu_popover a.js_edit_menu',
        run: "click",
    },
    {
        trigger: ".o_website_dialog:visible",
    },
    {
        content: "Trigger the link dialog (click 'Add Menu Item')",
        trigger: '.modal-body a:eq(0)',
        run: "click",
    },
    {
        trigger: ".modal:not(.o_inactive_modal) .modal-dialog .o_website_dialog input:eq(0)",
    },
    {
        content: "Confirm the new menu entry without a label",
        trigger: ".modal:not(.o_inactive_modal) .modal-footer .btn-primary:contains(ok)",
        run: "click",
    },
    {
        content: "It didn't save without a label. Fill label input.",
            trigger: ".modal:not(.o_inactive_modal) .modal-dialog .o_website_dialog input:eq(0)",
        run: "edit Random!",
    },
    {
        content: "Confirm the new menu entry without a url",
        trigger: ".modal:not(.o_inactive_modal) .modal-footer .btn-primary:contains(ok)",
        run: "click",
    },
    {
        trigger: ".modal:not(.o_inactive_modal) .modal-dialog .o_website_dialog input.is-invalid",
    },
    {
        content: "It didn't save without a url. Fill url input.",
        trigger: '.modal:not(.o_inactive_modal) .modal-dialog .o_website_dialog input:eq(1)',
        run: "edit #",
    },
    {
        content: "Confirm the new menu entry",
        trigger: ".modal:not(.o_inactive_modal) .modal-footer .btn-primary:contains(ok)",
        run: "click",
    },
    {
        trigger: '.oe_menu_editor .js_menu_label:contains("Random!")',
    },
    {
        content: "Save the website menu with the new entry",
        trigger: '.modal:not(.o_inactive_modal) .modal-footer .btn-primary',
        run: "click",
    },
    {
        trigger: "body:not(:has(.modal))",
    },
    {
        trigger: "#oe_snippets.o_loaded",
    },
    // Edit the new menu item from the "edit link" popover button
    clickOnExtraMenuItem({}, true),
    {
        trigger: ".o_website_preview.editor_enable.editor_has_snippets:not(.o_is_blocked)",
    },
    {
        content: "Menu should have a new link item",
        trigger: ':iframe .top_menu .nav-item a:contains("Random!")',
        // Don't click the new menu when the editor is still blocked.
        run: "click",
    },
    {
        content: "navbar shouldn't have any zwnbsp and no o_link_in_selection class",
        trigger: ':iframe nav.navbar:not(:has(.o_link_in_selection)):not(:contains("\ufeff"))',
    },
    {
        content: "Click on Edit Link",
        trigger: ':iframe .o_edit_menu_popover a.o_we_edit_link',
        run: "click",
    },
    {
        content: "Change the label",
        trigger: '.modal-dialog .o_website_dialog input:eq(0)',
        run: "edit Modnar",
    },
    {
        content: "Confirm the new label",
        trigger: '.modal-footer .btn-primary',
        run: "click",
    },
    ...clickOnSave(),
    clickOnExtraMenuItem({}, true),
    {
        content: "Label should have changed",
        trigger: ':iframe .top_menu .nav-item a:contains("Modnar")',
    },
    // Edit the menu item from the "edit menu" popover button
    ...clickOnEditAndWaitEditMode(),
    clickOnExtraMenuItem({}, true),
    {
        content: "Click on the 'Modnar' link",
        trigger: ':iframe .top_menu .nav-item a:contains("Modnar")',
        run: "click",
    },
    {
        content: "Click on the popover Edit Menu button",
        trigger: ':iframe .o_edit_menu_popover a.js_edit_menu',
        run: "click",
    },
    {
        content: "Click on the dialog Edit Menu button",
        trigger: '.oe_menu_editor .js_menu_label:contains("Modnar")',
        run() {
            const liEl = this.anchor.closest('[data-menu-id]');
            liEl.querySelector('button.js_edit_menu').click();
        },
    },
    {
        content: "Change the label",
        trigger: ".modal:not(.o_inactive_modal) .modal-dialog .o_website_dialog input:eq(0)",
        run: "edit Modnar !!",
    },
    {
        content: "Confirm the new menu label",
        trigger: ".modal:not(.o_inactive_modal) .modal-footer button:contains(ok)",
        run: "click",
    },
    {
        trigger: '.oe_menu_editor .js_menu_label:contains("Modnar !!")',
    },
    {
        content: "Save the website menu with the new menu label",
        trigger: ".modal:not(.o_inactive_modal) .modal-footer button:contains(save)",
        run: "click",
    },
    // Drag a block to be able to scroll later.
    ...insertSnippet({id: "s_media_list", name: "Media List", groupName: "Content"}),
    ...clickOnSave(),
    clickOnExtraMenuItem({}, true),
    {
        content: "Label should have changed",
        trigger: ':iframe .top_menu .nav-item a:contains("Modnar !!")',
    },
    // Nest menu item from the menu.
    {
        content: "open site menu",
        trigger: 'button[data-menu-xmlid="website.menu_site"]',
        run: "click",
    },
    {
        content: "Click on Edit Menu",
        trigger: 'a[data-menu-xmlid="website.menu_edit_menu"]',
        run: "click",
    },
    {
        content: `Drag "Contact Us" menu below "Home" menu`,
        trigger: '.oe_menu_editor li:contains("Contact us") .fa-bars',
        run(helpers) {
            return helpers.drag_and_drop('.oe_menu_editor li:contains("Home")', {
                position: {
                    top: 57,
                    left:5,
                },
                relative: true,
            });
        },
    },
    {
        content: "Drag 'Contact Us' item as a child of the 'Home' item",
        trigger: '.oe_menu_editor li:contains("Contact us") .fa-bars',
        run: 'drag_and_drop .oe_menu_editor li:contains("Contact us") .form-control',
    },
    {
        content: "Wait for drop",
        trigger: '.oe_menu_editor li:contains("Home") ul li:contains("Contact us")',
    },
    // Drag the Mega menu to the first position.
    {
        content: "Drag Mega at the top",
        trigger: '.oe_menu_editor li:contains("Megaaaaa!") .fa-bars',
        run(helpers) {
            return helpers.drag_and_drop(".oe_menu_editor li:contains('Home') .fa-bars", {
                position : {
                    top: 20,
                },
                relative: true,
            });
        },
    },
    {
        content: "Wait for drop",
        trigger: '.oe_menu_editor:first-child:contains("Megaaaaa!")',
    },
    {
        content: "Save the website menu with new nested menus",
        trigger: '.modal-footer .btn-primary',
        run: "click",
    },
    {
        content: "Menu item should have a child",
        trigger: ':iframe .top_menu .nav-item a.dropdown-toggle:contains("Home")',
        run: "click",
    },
    // Check that with the auto close of dropdown menus, the dropdowns remain
    // openable.
    {
        content: "When menu item is opened, child item must appear in the shown menu",
        trigger: ':iframe .top_menu .nav-item:contains("Home") ul.show li a.dropdown-item:contains("Contact us")[href="/contactus"]',
        run() {
            // Scroll down.
            this.anchor.closest("body").querySelector(".o_footer_copyright_name")
                .scrollIntoView(true);
        },
    },
    {
        content: "The Home menu should be closed",
        trigger: ':iframe .top_menu .nav-item:contains("Home"):has(ul:not(.show))',
    },
    {
        content: "Open the Home menu after scroll",
        trigger: ':iframe .top_menu .nav-item a.dropdown-toggle:contains("Home")',
        run: "click",
    },
    {
        content: "Check that the Home menu is opened",
        trigger: ':iframe .top_menu .nav-item:contains("Home") ul.show li' +
            ' a.dropdown-item:contains("Contact us")[href="/contactus"]',
    },
    {
        content: "Close the Home menu",
        trigger: ':iframe .top_menu .nav-item:has(a.dropdown-toggle:contains("Home"))',
        run: "click",
    },
    {
        content: "Check that the Home menu is closed",
        trigger: ':iframe .top_menu .nav-item:contains("Home"):has(ul:not(.show))',
    },
    {
        content: "Open the mega menu",
        trigger: ':iframe .top_menu .nav-item a.o_mega_menu_toggle:contains("Megaaaaa!")',
        run: "click",
    },
    {
        content: "When the mega menu is opened, scroll up",
        trigger: ":iframe .top_menu .o_mega_menu_toggle.show",
        run() {
            const marginTopOfMegaMenu = getComputedStyle(
                this.anchor.closest(".dropdown").querySelector(".o_mega_menu"))["margin-top"];
            if (marginTopOfMegaMenu !== '0px') {
                console.error('The margin-top of the mega menu should be 0px');
            }
            // Scroll up.
            this.anchor.closest("body").querySelector(".s_media_list_item:nth-child(2)")
                .scrollIntoView(true);
        }
    },
    {
        content: "Check that the mega menu is closed",
        trigger: ':iframe .top_menu .nav-item:contains("Megaaaaa!"):has(div[data-name="Mega Menu"]:not(.show))',
    },
    {
        content: "Open the mega menu after scroll",
        trigger: ':iframe .top_menu .nav-item a.o_mega_menu_toggle:contains("Megaaaaa!")',
        run: "click",
    },
    {
        content: "Check that the mega menu is opened",
        trigger: ':iframe .top_menu .nav-item:has(a.o_mega_menu_toggle:contains("Megaaaaa!")) ' +
                 '.s_mega_menu_odoo_menu',
    },
    ...clickOnEditAndWaitEditMode(),
    {
        trigger: ":iframe main section.s_media_list .s_media_list_item:eq(2) h3:contains(post)",
    },
    {
        content: "Open nested menu item",
        trigger: ':iframe .o_header_is_scrolled.o_top_fixed_element .nav-item:contains("Home"):nth-child(2) .dropdown-toggle',
        async run(actions) {
            // If you scroll after click on dropdown, nested menu disappears.
            await delay(500);
            // So wait that scroll is finished before click.
            await actions.click();
        },
    },
    {
        // If this step fails, it means that a patch inside bootstrap was lost.
        content: "Press the 'down arrow' key.",
        trigger: ':iframe .top_menu .nav-item:contains("Home") li:contains("Contact us")',
        run: "press ArrowDown",
    },
    ...clickOnSave(),
    // Nest and re-arrange menu items for a newly created menu
    {
        content: "Open site menu",
        trigger: 'button[data-menu-xmlid="website.menu_site"]',
        run: "click",
    },
    {
        content: "Click on Edit Menu",
        trigger: 'a[data-menu-xmlid="website.menu_edit_menu"]',
        run: "click",
    },
    {
        content: "Trigger link dialog (click 'Add Menu Item')",
        trigger: '.modal-body a:eq(0)',
        run: "click",
    },
    {
        content: "Write a label for the new menu item",
        trigger: '.modal-dialog .o_website_dialog input:eq(0)',
        run: "edit new_menu",
    },
    {
        content: "Write a url for the new menu item",
        trigger: '.modal-dialog .o_website_dialog input:eq(1)',
        run: "edit #",
    },
    {
        content: "Confirm the new menu entry",
        trigger: '.modal:not(.o_inactive_modal) .modal-footer .btn-primary:contains(ok)',
        run: "click",
    },
    {
        content: "Check if new menu(new_menu) is added",
        trigger: '.oe_menu_editor li:contains("new_menu")',
    },
    {
        content: "Trigger link dialog (click 'Add Menu Item')",
        trigger: '.modal-body a:eq(0)',
        run: "click",
    },
    {
        content: "Write a label for the new menu item",
        trigger: '.modal-dialog .o_website_dialog input:eq(0)',
        run: "edit new_nested_menu",
    },
    {
        content: "Write a url for the new menu item",
        trigger: '.modal-dialog .o_website_dialog input:eq(1)',
        run: "edit #",
    },
    {
        content: "Confirm the new menu entry",
        trigger: '.modal:not(.o_inactive_modal) .modal-footer .btn-primary:contains(ok)',
        run: "click",
    },
    {
        content: "Check if new menu(new_nested_menu) is added",
        trigger: '.oe_menu_editor li:contains("new_nested_menu")',
    },
    {
        content: "Nest 'new_nested_menu' under 'new_menu'",
        trigger: '.oe_menu_editor li:contains("new_nested_menu") .fa-bars',
        run: "drag_and_drop .oe_menu_editor li:contains('new_menu') .form-control",
    },
    {
        content: "Drag 'Modnar !!' below 'new_menu'",
        trigger: '.oe_menu_editor li:contains("Modnar !!") .fa-bars',
        async run(helpers) {
            await helpers.drag_and_drop('.oe_menu_editor li:contains("new_menu") .fa-bars', {
                position: "bottom",
            });
        },
    },
    {
        content: "Nest 'Modnar !!' under 'new_menu'",
        trigger: '.oe_menu_editor li:contains("Modnar !!") .fa-bars',
        run: "drag_and_drop .oe_menu_editor li:contains('new_menu') .form-control",
    },
    {
        content: "Check if 'nested_menu' and 'Modnar !!' is nested under 'new_menu'",
        trigger: '.oe_menu_editor li:contains("new_menu") > ul > li:contains("Modnar !!") + li:contains("nested_menu")',
    },
    {
        content: "Move 'Modnar !!' below 'new_nested_menu' inside the 'new_menu'",
        trigger: '.oe_menu_editor  li:contains("new_menu") > ul > li:contains("Modnar !!") .fa-bars',
        async run(helpers) {
            await helpers.drag_and_drop(".oe_menu_editor  li:contains('new_menu') > ul > li:contains('new_nested_menu') .fa-bars", {
                position: "bottom",
            });
        },
    },
    {
        content: "Check if 'Modnar !!' is now below 'new_nested_menu' in 'new_menu'",
        trigger: '.oe_menu_editor li:contains("new_menu") > ul > li:last-child:contains("Modnar !!")',
    },
]);

registerWebsitePreviewTour(
    "edit_menus_delete_parent",
    {
        url: "/",
    },
    () => [
        {
            trigger: ":iframe #wrapwrap",
        },
        {
            content: "Open site menu",
            trigger: 'button[data-menu-xmlid="website.menu_site"]',
            run: "click",
        },
        {
            content: "Click on Edit Menu",
            trigger: 'a[data-menu-xmlid="website.menu_edit_menu"]',
            run: "click",
        },
        {
            content: "Delete Home menu",
            trigger: ".modal-body ul li:nth-child(1) button.js_delete_menu",
            run: "click",
        },
        {
            content: "Save",
            trigger: ".modal-footer button:first-child",
            run: "click",
        },
    ]
);

return __exports;
});
;

/******************************************************************
*  Filepath: /website/static/tests/tours/edit_translated_page.js  *
*  Lines: 41                                                      *
******************************************************************/
odoo.define('@website/../tests/tours/edit_translated_page', ['@web/core/registry', '@website/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { registry } = require("@web/core/registry");
const { clickOnEditAndWaitEditModeInTranslatedPage } = require("@website/js/tours/tour_utils");

registry.category("web_tour.tours").add('edit_translated_page_redirect', {
    url: '/nl/contactus',
    steps: () => [
    {
        content: "Enter backend",
        trigger: 'a.o_frontend_to_backend_edit_btn',
        run: "click",
    },
    {
        content: "Check the data-for attribute",
        trigger: ':iframe main:has([data-for="contactus_form"])',
    },
    ...clickOnEditAndWaitEditModeInTranslatedPage(),
    {
        content: "Go to /nl",
        trigger: "body",
        run: () => {
            // After checking the presence of the editor dashboard, we visit a
            // translated version of the homepage. The homepage is a special
            // case (there is no trailing slash), so we test it separately.
            location.href = '/nl';
        },
    },
    {
        content: "Enter backend",
        trigger: 'a.o_frontend_to_backend_edit_btn',
        run: "click",
    },
    ...clickOnEditAndWaitEditModeInTranslatedPage(),
]});

return __exports;
});
;

/*****************************************************************************
*  Filepath: /website/static/tests/tours/editable_root_as_custom_snippet.js  *
*  Lines: 49                                                                 *
*****************************************************************************/
odoo.define('@website/../tests/tours/editable_root_as_custom_snippet', ['@website/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const {
    changeOption,
    clickOnEditAndWaitEditMode,
    clickOnSave,
    clickOnSnippet,
    insertSnippet,
    registerWebsitePreviewTour,
} = require('@website/js/tours/tour_utils');

registerWebsitePreviewTour("editable_root_as_custom_snippet", {
    edition: true,
    url: '/custom-page',
}, () => [
    ...clickOnSnippet('.s_title.custom[data-oe-model][data-oe-id][data-oe-field][data-oe-xpath]'),
    changeOption('SnippetSave', 'we-button'),
    {
        content: "Confirm modal",
        trigger: '.modal-footer .btn-primary',
        run: "click",
    },
    {
        content: "Wait for the custom category to appear in the panel",
        trigger: '.oe_snippet[name="Custom"]',
    },
    ...clickOnSave(),
    {
        content: "Go to homepage",
        trigger: ':iframe a[href="/"].nav-link',
        run: "click",
    },
    {
        content: "Wait to land on homepage",
        trigger: ':iframe a[href="/"].nav-link.active',
    },
    ...clickOnEditAndWaitEditMode(),
    ...insertSnippet({id: "s_title", name: "Custom Title", groupName: "Custom"}),
    {
        content: "Check that the custom snippet does not have branding",
        trigger: ':iframe #wrap .s_title.custom:not([data-oe-model]):not([data-oe-id]):not([data-oe-field]):not([data-oe-xpath])',
    },
]);

return __exports;
});
;

/*****************************************************************
*  Filepath: /website/static/tests/tours/focus_blur_snippets.js  *
*  Lines: 76                                                     *
*****************************************************************/
odoo.define('@website/../tests/tours/focus_blur_snippets', ['@website/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { insertSnippet, registerWebsitePreviewTour } = require('@website/js/tours/tour_utils');

const blockIDToData = {
    parent: {
        selector: ':iframe .s_focusblur',
        name: 'section',
        overlayIndex: 2,
    },
    child1: {
        selector: ':iframe .s_focusblur_child1',
        name: 'first child',
        overlayIndex: 0,
    },
    child2: {
        selector: ':iframe .s_focusblur_child2',
        name: 'second child',
        overlayIndex: 1,
    },
};

function clickAndCheck(blockID, expected) {
    const blockData = blockIDToData[blockID] || {};

    return [{
        content: blockID ? `Enable the ${blockData.name}` : 'Disable all blocks',
        trigger: blockData.selector || ':iframe #wrapwrap',
        run: "click",
    }, {
        content: 'Once the related overlays are enabled/disabled, check that the focus/blur calls have been correct.',
        trigger: blockID
            ? `:iframe .oe_overlay.o_draggable:eq(${blockData.overlayIndex}).oe_active`
            : `:iframe #oe_manipulators:not(:has(.oe_active)):not(:visible)`,
        run() {
            const result = window.focusBlurSnippetsResult;
            window.focusBlurSnippetsResult = [];

            if (expected.length !== result.length
                || !expected.every((item, i) => item === result[i])) {
                throw new Error(`
                    Expected: ${expected.toString()}
                    Result: ${result.toString()}
                `);
            }
        },
    }];
}

window.focusBlurSnippetsResult = [];

registerWebsitePreviewTour("focus_blur_snippets", {
    url: "/",
    edition: true,
}, () => [
    ...insertSnippet({
        id: "s_focusblur",
        name: "s_focusblur",
        groupName: "Content",
    }),
    ...clickAndCheck('parent', ['focus parent']),
    ...clickAndCheck(null, ['blur parent']),
    ...clickAndCheck('child1', ['focus parent', 'focus child1']),
    ...clickAndCheck('child1', []),
    ...clickAndCheck(null, ['blur parent', 'blur child1']),
    ...clickAndCheck('parent', ['focus parent']),
    ...clickAndCheck('child1', ['blur parent', 'focus parent', 'focus child1']),
    ...clickAndCheck('child2', ['blur parent', 'blur child1', 'focus parent', 'focus child2']),
    ...clickAndCheck('parent', ['blur parent', 'blur child2', 'focus parent']),
]);

return __exports;
});
;

/*********************************************************
*  Filepath: /website/static/tests/tours/font_family.js  *
*  Lines: 68                                             *
*********************************************************/
odoo.define('@website/../tests/tours/font_family', ['@website/js/tours/tour_utils', '@web/core/utils/patch'], function (require) {
'use strict';
let __exports = {};
const { registerWebsitePreviewTour, goToTheme } = require("@website/js/tours/tour_utils");
const { patch } = require("@web/core/utils/patch");

registerWebsitePreviewTour(
    "website_font_family",
    {
        url: "/",
        edition: true,
    },
    () => [
        ...goToTheme(),
        {
            content: "Click on the heading font family selector",
            trigger: "we-select[data-variable='headings-font']",
            run: "click",
        },
        {
            content: "Click on the 'Arvo' font we-button from the font selection list.",
            trigger: "we-selection-items we-button[data-font-family='Arvo']",
            run: "click",
        },
        {
            content: "Verify that the 'Arvo' font family is correctly applied to the heading.",
            trigger: "we-toggler[style*='font-family: Arvo;']",
        },
        {
            content: "Open the heading font family selector",
            trigger: "we-toggler[style*='font-family: Arvo;']",
            run: "click",
        },
        {
            trigger: "we-select[data-variable='headings-font']",
            // This is a workaround to prevent the _reloadBundles method from being called.
            // It addresses the issue where selecting a we-button with data-no-bundle-reload,
            // such as o_we_add_font_btn.
            run: function () {
                const options = odoo.loader.modules.get("@web_editor/js/editor/snippets.options")[
                    Symbol.for("default")
                ];
                patch(options.Class.prototype, {
                    async _refreshBundles() {
                        console.error("The font family selector value get reload to its default.");
                    },
                });
            },
        },
        {
            content: "Click on the 'Add a custom font' button",
            trigger: "we-select[data-variable='headings-font'] .o_we_add_font_btn",
            run: "click",
        },
        {
            content: "Wait for the modal to open and then refresh",
            trigger: "body .o_dialog button.btn-secondary",
            run: "click",
        },
        {
            content: "Check that 'Arvo' font family is still applied and not reverted",
            trigger: "we-toggler[style*='font-family: Arvo;']",
        },
    ]
);

return __exports;
});
;

/****************************************************************
*  Filepath: /website/static/tests/tours/gray_color_palette.js  *
*  Lines: 78                                                    *
****************************************************************/
odoo.define('@website/../tests/tours/gray_color_palette', ['@website/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/
const { goBackToBlocks, goToTheme, registerWebsitePreviewTour } = require('@website/js/tours/tour_utils');

function waitForCSSReload() {
    // TODO we should find a better way to wait for this in tests after CSS
    // reload, it is currently done multiple different ways depending on the
    // test.
    return [
        // This step is here because the option is applied but triggers a
        // reloading of the CC value, so if the second value is sent too soon,
        // it will be ignored. Clicking on the snippet tab and back will ensure
        // that the mutex is cleared, and therefore we can apply the saturation
        // step.
        goBackToBlocks(),
        ...goToTheme(),
        {
            content: "Wait for no loading",
            trigger: 'body:not(:has(.o_we_ui_loading)) :iframe body:not(:has(.o_we_ui_loading))',
        },
    ];
}

registerWebsitePreviewTour('website_gray_color_palette', {
    url: '/',
    edition: true,
}, () => [
    ...goToTheme(),
    {
        content: "Toggle gray color palette",
        trigger: '.o_we_gray_preview.o_we_collapse_toggler',
        run: "click",
    },
    {
        content: "Drag the hue slider",
        trigger: '.o_we_slider_tint[data-param="gray-hue"] input',
        run: "range 100",
    },
    {
        content: "Wait for loading",
        trigger: ":iframe body:has(.o_we_ui_loading)",
    },
    {
        content: "Check the preview of the gray 900 after hue change",
        trigger: '[variable="900"][style="background-color: rgb(36, 41, 33) !important;"]',
    },
    ...waitForCSSReload(),
    {
        content: "Drag the saturation slider",
        trigger: '.o_we_user_value_widget[data-param="gray-extra-saturation"] input',
        run: "range 15",
    },
    {
        content: "Wait for loading",
        trigger: ":iframe body:has(.o_we_ui_loading)",
    },
    {
        content: "Check the preview of the gray 900 after saturation change",
        trigger: '[variable="900"][style="background-color: rgb(34, 47, 27) !important;"]',
    },
    ...waitForCSSReload(),
    {
        content: "Wait for the iframe to be loaded",
        trigger: ':iframe body',
        run() {
            const iframeEl = document.querySelector('.o_website_preview .o_iframe');
            const styles = iframeEl.contentWindow.getComputedStyle(iframeEl.contentDocument.documentElement);
            if (styles.getPropertyValue('--900').toString().replace(/ /g, '') !== '#222F1B') {
                throw new Error('The value for the gray 900 is not right');
            }
        }
    },
]);

return __exports;
});
;

/*********************************************************
*  Filepath: /website/static/tests/tours/grid_layout.js  *
*  Lines: 101                                            *
*********************************************************/
odoo.define('@website/../tests/tours/grid_layout', ['@website/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const {
    changeOption,
    clickOnSave,
    clickOnSnippet,
    insertSnippet,
    registerWebsitePreviewTour,
} = require('@website/js/tours/tour_utils');

const snippet = {
    id: 's_text_image',
    name: 'Text - Image',
    groupName: "Content",
};

registerWebsitePreviewTour('website_replace_grid_image', {
    url: '/',
    edition: true,
}, () => [
    ...insertSnippet(snippet),
    ...clickOnSnippet(snippet),
    {
        content: "Toggle to grid mode",
        trigger: '.o_we_user_value_widget[data-name="grid_mode"]',
        run: "click",
    },
    {
        content: "Replace image",
        trigger: ':iframe .s_text_image img',
        run: 'dblclick',
    },
    {
        content: "Pick new image",
        trigger: '.o_select_media_dialog img[title="s_banner_default_image.jpg"]',
        run: "click",
    },
    {
        content: "Add new image column",
        trigger: '.o_we_user_value_widget[data-add-element="image"]',
        run: "click",
    },
    {
        content: "Pick new image",
        trigger: '.o_select_media_dialog img[title="s_banner_default_image2.jpg"]',
        run: "click",
    },
    {
        content: "Replace new image",
        trigger: ':iframe .s_text_image img[src*="s_banner_default_image2.jpg"]',
        run: 'dblclick',
    },
    {
        content: "Pick new image",
        trigger: '.o_select_media_dialog img[title="s_banner_default_image.jpg"]',
        run: "click",
    },
    ...clickOnSave()
]);

registerWebsitePreviewTour("scroll_to_new_grid_item", {
    url: "/",
    edition: true,
}, () => [
    // Drop enough snippets to scroll.
    ...insertSnippet({id: "s_text_image", name: "Text - Image", groupName: "Content"}),
    ...insertSnippet({id: "s_image_text", name: "Image - Text", groupName: "Content"}),
    ...insertSnippet({id: "s_image_text", name: "Image - Text", groupName: "Content"}),
    // Toggle the first snippet to grid mode.
    ...clickOnSnippet({id: "s_text_image", name: "Text - Image"}),
    changeOption("layout_column", 'we-button[data-name="grid_mode"]'),
    // Add a new grid item.
    changeOption("layout_column", 'we-button[data-add-element="image"]'),
    {
        content: "Select the new image in the media dialog",
        trigger: '.o_select_media_dialog img[title="s_banner_default_image.jpg"]',
        run: "click",
    }, {
        content: "Check that the page scrolled to the new grid item",
        trigger: ":iframe .s_text_image .o_grid_item:nth-child(3)",
        async run() {
            // Leave some time to the page to scroll.
            await new Promise((r) => setTimeout(r, 500));
            const newItemPosition = this.anchor.getBoundingClientRect();
            if (newItemPosition.top < 0) {
                throw new Error("The page did not scroll to the new grid item.");
            }
            document.body.classList.add("o_scrolled_to_grid_item");
        },
    }, {
        content: "Make sure the scroll check is done",
        trigger: ".o_scrolled_to_grid_item",
    },
    ...clickOnSave(),
]);

return __exports;
});
;

/*********************************************************
*  Filepath: /website/static/tests/tours/html_editor.js  *
*  Lines: 367                                            *
*********************************************************/
odoo.define('@website/../tests/tours/html_editor', ['@website/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module**/
/* global ace */

const {clickOnSave, registerWebsitePreviewTour } = require("@website/js/tours/tour_utils");

const adminCssModif = '#wrap {display: none;}';
const demoCssModif = '// demo_edition';

registerWebsitePreviewTour('html_editor_language', {
    url: '/test_page',
}, () => [
    {
        content: "Wait the content is loaded and html/css editor is in menu before clicking on open site menu",
        trigger: ":iframe main:contains(rommelpot)",
    },
    {
    content: "open site menu",
    trigger: 'button[data-menu-xmlid="website.menu_site"]',
    run: "click",
}, {
    content: "open html editor",
    trigger: 'a[data-menu-xmlid="website.menu_ace_editor"]',
    run: "click",
}, {
    content: "add something in the page's default language version",
    trigger: 'div.ace_line .ace_xml:contains("rommelpot")',
    run: () => {
        ace.edit(document.querySelector('#resource-editor div')).getSession().insert({
            row: 1,
            column: 1,
        }, '<div class="test_language"/>\n');
    },
}, {
    content: "save the html editor",
    trigger: 'body:has(div.ace_line .ace_xml:contains("test_language")) .o_resource_editor .btn-primary',
    run: "click",
}, {
    content: "check that the page has the modification",
    trigger: ':iframe #wrapwrap:has(.test_language)',
}, {
    content: "check that the page has not lost the original text",
    trigger: ':iframe #wrapwrap:contains("rommelpot")',
}]
);

registerWebsitePreviewTour('html_editor_multiple_templates', {
    url: '/generic',
    edition: true,
},
    () => [
        {
            content: "drop a snippet group",
            trigger: "#oe_snippets .oe_snippet[name=Intro].o_we_draggable .oe_snippet_thumbnail",
            // id starting by 'oe_structure..' will actually create an inherited view
            run: "drag_and_drop :iframe #oe_structure_test_ui",
        },
        {
            content: "Click on the s_cover snippet",
            trigger: ':iframe .o_snippet_preview_wrap[data-snippet-id="s_cover"]',
            run: "click",
        },
        ...clickOnSave(),
        // 2. Edit generic view
        {
            content: "open site menu",
            trigger: 'button[data-menu-xmlid="website.menu_site"]',
            run: "click",
        },
        {
            content: "open html editor",
            trigger: 'a[data-menu-xmlid="website.menu_ace_editor"]',
            run: "click",
        },
        {
            content: "add something in the generic view",
            trigger: 'div.ace_line .ace_xml:contains("Generic")',
            run() {
                ace.edit(document.querySelector('#resource-editor div')).getSession().insert({row: 3, column: 1}, '<p>somenewcontent</p>\n');
            },
        },
        // 3. Edit oe_structure specific view
        {
            content: "select oe_structure specific view",
            trigger: 'div.ace_line .ace_xml:contains("somenewcontent")',
        },
        {
            content: "open file selector menu",
            trigger: ".o_resource_editor .o_select_menu_toggler",
            run: "click",
        },
        {
            content: "open oe_structure_test_ui view",
            trigger: ".o-dropdown--menu .o-dropdown-item:contains(oe_structure_test_ui)",
            run: "click",
        },
        {
            trigger: '.o_resource_editor .o_select_menu_toggler:contains("oe_structure_test_ui")',
        },
        {
            content: "add something in the oe_structure specific view",
            trigger: 'div.ace_line .ace_xml:contains("s_cover")',
            run() {
                ace.edit(document.querySelector('#resource-editor div')).getSession().insert({row: 2, column: 1}, '<p>anothernewcontent</p>\n');
            },
        },
        {
            trigger: 'div.ace_line .ace_xml:contains("anothernewcontent")',
        },
        {
            content: "save the html editor",
            trigger: ".o_resource_editor button:contains(Save)",
            run: "click",
        },
        {
            trigger: ':iframe #wrapwrap:contains("anothernewcontent")',
        },
        {
           content: "check that the page has both modification",
           trigger: ':iframe #wrapwrap:contains("somenewcontent")',
       },
    ]
);

registerWebsitePreviewTour('test_html_editor_scss', {
    url: '/contactus',
},
    () => [
        // 1. Open Html Editor and select a scss file
        {
            trigger: ":iframe #wrap:visible", // ensure state for later
        },
        {
            trigger: ":iframe h1:contains(contact us)",
        },
        {
            trigger: ":iframe input[name=company]",
        },
        {
            content: "open site menu",
            trigger: 'nav button[data-menu-xmlid="website.menu_site"]:contains(site)',
            run: "click",
        },
        {
            content: "open html editor",
            trigger: '.o_popover a[data-menu-xmlid="website.menu_ace_editor"]:contains(/^HTML/)',
            run: "click",
        },
        {
            content: "open type switcher",
            trigger: '.o_resource_editor_type_switcher button',
            run: "click",
        },
        {
            content: "select scss files",
            trigger: '.o-dropdown--menu .dropdown-item:contains("SCSS")',
            run: "click",
        },
        {
            content: "select 'user_custom_rules'",
            trigger: '.o_resource_editor .o_select_menu_toggler:contains("user_custom_rules")',
        },
        // 2. Edit that file and ensure it was saved then reset it
        {
            content: "add some scss content in the file",
            trigger: 'div.ace_line .ace_comment:contains("footer {")',
            run() {
                ace.edit(document.querySelector('#resource-editor div')).getSession().insert({row: 2, column: 0}, `${adminCssModif}\n`);
            },
        },
        {
            trigger: `div.ace_line:contains("${adminCssModif}")`,
        },
        {
            content: "save the html editor",
            trigger: ".o_resource_editor_title button:contains(Save)",
            run: "click",
        },
        {
            content: "check that the scss modification got applied",
            trigger: ':iframe body:has(#wrap:hidden)',
            timeout: 30000, // SCSS compilation might take some time
        },
        {
            content: "reset view (after reload, html editor should have been reopened where it was)",
            trigger: '#resource-editor-id button:contains(Reset)',
            run: "click",
        },
        {
            content: "confirm reset warning",
            trigger: '.modal-footer .btn-primary',
            run: "click",
        },
        {
            content: "check that the scss file was reset correctly, wrap content should now be visible again",
            trigger: ':iframe #wrap:visible',
            timeout: 30000, // SCSS compilation might take some time
        },
        // 3. Customize again that file (will be used in second part of the test
        //    to ensure restricted user can still use the HTML Editor)
        {
            content: "add some scss content in the file",
            trigger: 'div.ace_line .ace_comment:contains("footer {")',
            run() {
                ace.edit(document.querySelector('#resource-editor div')).getSession().insert({row: 2, column: 0}, `${adminCssModif}\n`);
            },
        },
        {
            trigger: `div.ace_line:contains("${adminCssModif}")`,
        },
        {
            content: "save the html editor",
            trigger: ".o_resource_editor_title button:contains(Save)",
            run: "click",
        },
        {
            content: "check that the scss modification got applied",
            trigger: ':iframe body:has(#wrap:hidden)',
        },
    ]
);

registerWebsitePreviewTour('test_html_editor_scss_2', {
    url: '/',
},
    () => [
        // This part of the test ensures that a restricted user can still use
        // the HTML Editor if someone else made a customization previously.

        // 4. Open Html Editor and select a scss file
        {
            trigger: "[is-ready=true]:iframe #wrapwrap",
        },
        {
            content: "open site menu",
            trigger: 'button[data-menu-xmlid="website.menu_site"]',
            run: "click",
        },
        {
            content: "open html editor",
            trigger: '.o_popover a[data-menu-xmlid="website.menu_ace_editor"]:contains(/^HTML/)',
            run: "click",
        },
        {
            content: "open type switcher",
            trigger: '.o_resource_editor_type_switcher button',
            run: "click",
        },
        {
            content: "select scss files",
            trigger: '.o-dropdown--menu .dropdown-item:contains("SCSS")',
            run: "click",
        },
        {
            content: "select 'user_custom_rules'",
            trigger: '.o_resource_editor .o_select_menu_toggler:contains("user_custom_rules")',
        },
        // 5. Edit that file and ensure it was saved then reset it
        {
            content: "add some scss content in the file",
            trigger: `div.ace_line:contains("${adminCssModif}")`,
            // ensure the admin modification is here
            run() {
                ace.edit(document.querySelector('#resource-editor div')).getSession().insert({row: 2, column: 0}, `${demoCssModif}\n`);
            },
        },
        {
            trigger: `div.ace_line:contains("${demoCssModif}")`,
        },
        {
            content: "save the html editor",
            trigger: ".o_resource_editor button:contains(Save)",
            run: "click",
        },
        {
            content: "reset view (after reload, html editor should have been reopened where it was)",
            trigger: '#resource-editor-id button:contains(Reset)',
            timeout: 30000, // SCSS compilation might take some time
            run: "click",
        },
        {
            content: "confirm reset warning",
            trigger: ".modal:contains(careful) .modal-footer .btn-primary",
            run: "click",
        },
        {
            content: "Wait for the reload of the iframe",
            trigger: "[is-ready=false]:iframe #wrapwrap",
        },
        {
            trigger: "[is-ready=true]:iframe #wrapwrap",
        },
        {
            trigger: `body:not(:has(div.ace_line:contains("${adminCssModif}")))`,
        },
        {
            content: "check that the scss file was reset correctly",
            trigger: `body:not(:has(div.ace_line:contains("${demoCssModif}")))`,
            timeout: 30000, // SCSS compilation might take some time
        },
    ]
);

registerWebsitePreviewTour(
    "website_code_editor_usable",
    {
        // TODO: enable debug mode when failing tests have been fixed (props validation)
        url: "/",
    },
    () => [
        {
            trigger: ":iframe #wrapwrap",
        },
        {
            content: "Open Site menu",
            trigger: 'button[data-menu-xmlid="website.menu_site"]',
            run: "click",
        },
        {
            content: "Open HTML / CSS Editor",
            trigger: '.o_popover a[data-menu-xmlid="website.menu_ace_editor"]:contains(/^HTML/)',
            run: "click",
        },
        {
            content: "Bypass warning",
            trigger: ".o_resource_editor_wrapper div:nth-child(2) button:nth-child(3)",
            run: "click",
        },
        // Test all 3 file type options
        ...[{
            menuItemIndex: 1,
            editorMode: 'qweb',
        }, {
            menuItemIndex: 2,
            editorMode: 'scss',
        }, {
            menuItemIndex: 3,
            editorMode: 'javascript',
        }]
            .map(({ menuItemIndex, editorMode }) => [
                {
                    content: "Open file type dropdown",
                    trigger: ".o_resource_editor_type_switcher .dropdown-toggle",
                    run: "click",
                },
                {
                    content: `Select type ${menuItemIndex}`,
                    trigger: `.o-overlay-container .o-dropdown--menu .dropdown-item:nth-child(${menuItemIndex})`,
                    run: "click",
                },
                {
                    content: "Wait for editor mode to change",
                    trigger: `.ace_editor[data-mode="${editorMode}"]`,
                },
                {
                    content: "Make sure text is being highlighted",
                    trigger: ".ace_content .ace_text-layer .ace_line:first-child span",
                },
            ])
            .flat(),
    ]
);

return __exports;
});
;

/**************************************************************
*  Filepath: /website/static/tests/tours/link_to_document.js  *
*  Lines: 77                                                  *
**************************************************************/
odoo.define('@website/../tests/tours/link_to_document', ['@website/js/tours/tour_utils', '@web/core/utils/patch'], function (require) {
'use strict';
let __exports = {};
const { insertSnippet, registerWebsitePreviewTour } = require("@website/js/tours/tour_utils");
const { patch } = require("@web/core/utils/patch");

// Opening the system's file selector is not possible programmatically, so we
// mock the upload service.
let unpatch;
const patchStep = {
    content: "Patch upload service",
    trigger: "body",
    run: () => {
        const uploadService = odoo.__WOWL_DEBUG__.root.env.services.uploadLocalFiles;
        unpatch = patch(uploadService, {
            async upload() {
                return [{ id: 1, name: "file.txt", public: true, checksum: "123" }];
            },
        });
    },
};
const unpatchStep = {
    content: "Unpatch upload service",
    trigger: "body",
    run: () => unpatch(),
};

/**
 * The purpose of this tour is to check the Linktools to create a link to an
 * uploaded document.
 */
registerWebsitePreviewTour(
    "test_link_to_document",
    {
        url: "/",
        edition: true,
    },
    () => [
        ...insertSnippet({
            name: "Banner",
            id: "s_banner",
            groupName: "Intro",
        }),
        {
            content: "Click on button Start Now",
            trigger: ":iframe #wrap .s_banner a:nth-child(1)",
            run: "click",
        },
        patchStep,
        {
            content: "Click on link to an uploaded document",
            trigger: ".o_url_input .o_we_user_value_widget.fa.fa-upload",
            run: "click",
        },
        {
            content: "Check if a document link is created",
            trigger: ":iframe #wrap .s_banner .oe_edited_link[href^='/web/content']",
        },
        unpatchStep,
        {
            content: "Check if by default the option auto-download is enabled",
            trigger: ":iframe #wrap .s_banner .oe_edited_link[href$='download=true']",
        },
        {
            content: "Deactivate direct download",
            trigger: ".o_switch > we-checkbox[name='direct_download']",
            run: "click",
        },
        {
            content: "Check if auto-download is disabled",
            trigger: ":iframe #wrap .s_banner .oe_edited_link:not([href$='download=true'])",
        },
    ]
);

return __exports;
});
;

/********************************************************
*  Filepath: /website/static/tests/tours/link_tools.js  *
*  Lines: 498                                           *
********************************************************/
odoo.define('@website/../tests/tours/link_tools', ['@website/js/tours/tour_utils', '@web_editor/js/editor/odoo-editor/src/utils/utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module */

const {
    changeOption,
    clickOnEditAndWaitEditMode,
    clickOnElement,
    clickOnSave,
    insertSnippet,
    registerWebsitePreviewTour,
} = require('@website/js/tours/tour_utils');
const { boundariesIn, setSelection, nodeSize } = require('@web_editor/js/editor/odoo-editor/src/utils/utils');

const clickOnImgStep = {
    content: "Click somewhere else to save.",
    trigger: ':iframe #wrap .s_text_image img',
    run: "click",
};

registerWebsitePreviewTour('link_tools', {
    url: '/',
    edition: true,
}, () => [
    // 1. Create a new link from scratch.
    ...insertSnippet({
        id: 's_text_image',
        name: 'Text - Image',
        groupName: "Content",
    }),
    {
        content: "Replace first paragraph, to insert a new link",
        trigger: ':iframe #wrap .s_text_image p',
        run: 'editor Go to odoo: ',
    },
    {
        content: "Open link tools",
        trigger: "#toolbar:not(.oe-floating) #create-link",
        run: "click",
    },
    {
        content: "Type the link URL odoo.com",
        trigger: '#toolbar:not(.oe-floating) #o_link_dialog_url_input',
        run: 'edit odoo.com',
    },
    clickOnImgStep,
    {
        content: "Select the newly created link",
        trigger: ':iframe #wrap .s_text_image a[href="http://odoo.com"]:contains("odoo.com")',
        run() {
            setSelection(this.anchor, 0, this.anchor, nodeSize(this.anchor));
        }
    },
    // Remove the link.
    {
        content: "Click on the newly created link",
        trigger: ':iframe #wrap .s_text_image a[href="http://odoo.com"]:contains("odoo.com")',
        run: 'click',
    },
    {
        content: "Remove the link.",
        trigger: ':iframe .popover:contains("http://odoo.com") a .fa-chain-broken',
        run: 'click',
    },
    {
        content: "Check that the link was removed",
        trigger: ':iframe #wrap .s_text_image p:contains("Go to odoo:"):not(:has(a))',
    },
    // Recreate the link.
    {
        content: "Select first paragraph, to insert a new link",
        trigger: ':iframe #wrap .s_text_image p',
        run: 'click',
    },
    {
        content: "Open link tools",
        trigger: "#toolbar #create-link",
        run: 'click',
    },
    {
        content: "Type the link URL odoo.com",
        trigger: '#o_link_dialog_url_input',
        run: 'edit odoo.com'
    },
    clickOnImgStep,
    // 2. Edit the link with the link tools.
    {
        content: "Click on the newly created link",
        trigger: ':iframe .s_text_image a[href="http://odoo.com"]:contains("odoo.com")',
        run: "click",
    },
    {
        content: "Change content (editing the label input) to odoo website_2",
        trigger: '#o_link_dialog_label_input:value(odoo.com)',
        run: 'edit odoo website_2',
    },
    {
        content: "Change content (editing the DOM) to odoo website",
        trigger: ':iframe .s_text_image a[href="http://odoo.com"]:contains("odoo website_2")',
        run: 'editor odoo website',
    },
    clickOnImgStep,
    {
        content: "Click again on the link",
        trigger: ':iframe .s_text_image a[href="http://odoo.com"]:contains("odoo website")',
        run: "click",
    },
    {
        content: "Check that the label input contains the new content",
        trigger: '#o_link_dialog_label_input:value(odoo website)',
    },
    {
        content: "Link tools, should be open, change the url",
        trigger: '#o_link_dialog_url_input',
        run: "edit odoo.be",
    },

    ...clickOnSave(),
    // 3. Edit a link after saving the page.
    ...clickOnEditAndWaitEditMode(),
    {
        content: "The new link content should be odoo website and url odoo.be",
        trigger: ':iframe .s_text_image a[href="http://odoo.be"]:contains("odoo website")',
        run: "click",
    },
    {
        content: "The new link content should be odoo website and url odoo.be",
        trigger: '#toolbar:not(.oe-floating) .dropdown:has([name="link_style_color"]) > button',
        run: "click",
    },
    {
        content: "Click on the secondary style button.",
        trigger: '#toolbar:not(.oe-floating) we-button[data-value="secondary"]',
        run: "click",
    },
    ...clickOnSave(),
    {
        content: "The link should have the secondary button style.",
        trigger: ':iframe .s_text_image a.btn.btn-secondary[href="http://odoo.be"]:contains("odoo website")',
    },
    // 4. Add link on image.
    ...clickOnEditAndWaitEditMode(),
    ...insertSnippet({
        id: 's_three_columns',
        name: 'Columns',
        groupName: "Columns",
    }),
    {
        content: "Click on the first image.",
        trigger: ':iframe .s_three_columns .row > :nth-child(1) img',
        run: "click",
    },
    {
        content: "Activate link.",
        trigger: '.o_we_customize_panel we-row:contains("Media") we-button.fa-link',
        run: "click",
    },
    {
        content: "Set URL.",
        trigger: '.o_we_customize_panel we-input:contains("Your URL") input',
        // TODO: remove && click
        run: "edit odoo.com && click(we-title:contains(Your URL))",
    },
    {
        content: "Deselect image.",
        trigger: ':iframe .s_three_columns .row > :nth-child(2) img',
        run: "click",
    },
    {
        content: "Re-select image.",
        trigger: ':iframe .s_three_columns .row > :nth-child(1) img',
        run: "click",
    },
    {
        content: "Check that the second image is not within a link.",
        trigger: ':iframe .s_three_columns .row > :nth-child(2) figure > img',
    },
    {
        content: "Check that link tools appear.",
        trigger: ':iframe .popover div a:contains("http://odoo.com")',
    },
    ...clickOnSave(),
    {
        content: "Check that the first image was saved.",
        trigger: ':iframe .s_three_columns .row > :nth-child(1) figure > a > img',
    },
    {
        content: "Check that the second image was saved.",
        trigger: ':iframe .s_three_columns .row > :nth-child(2) figure > img',
    },
    // 5. Remove link from image.
    ...clickOnEditAndWaitEditMode(),
    {
        content: "Reselect the first image.",
        trigger: ':iframe .s_three_columns .row > :nth-child(1) figure > a > img',
        run: 'click',
    },
    {
        content: "Check that link tools appear.",
        trigger: ':iframe .popover div a:contains("http://odoo.com")',
    },
    {
        content: "Remove link.",
        trigger: ':iframe .popover:contains("http://odoo.com") a .fa-chain-broken',
        run: "click",
    },
    {
        content: "Check that image is not within a link anymore.",
        trigger: ':iframe .s_three_columns .row > :nth-child(1) figure > img',
    },
    // 6. Add mega menu with Cards template and edit URL on text-selected card.
    clickOnElement("menu link", ":iframe header .nav-item a"),
    clickOnElement("'Edit menu' icon", ":iframe .o_edit_menu_popover .fa-sitemap"),
    {
        trigger: ".o_website_dialog:visible",
    },
    {
        content: "Click on 'Add Mega Menu Item' link",
        trigger: ".modal-body a:contains('Add Mega Menu Item')",
        run: "click",
    },
    {
        content: "Enter mega menu name",
        trigger: ".modal .modal-body input",
        run: "edit Mega",
    },
    {
        content: "Clicking on the OK button",
        trigger: ".modal button:contains(ok)",
        run: "click",
    },
    {
        content: "Drag Mega at the top",
        trigger: '.oe_menu_editor li:contains("Mega") .fa-bars',
        run(helpers) {
            return helpers.drag_and_drop(".oe_menu_editor li:contains('Home') .fa-bars", {
                position : {
                    top: 20,
                },
                relative: true,
            });
        },
    },
    {
        content: "Wait for drop",
        trigger: '.oe_menu_editor:first-child:contains("Mega")',
    },
    {
        content: "Clicking on the OK button",
        trigger: ".modal button:contains(Save)",
        run: "click",
    },
    clickOnElement("mega menu", ":iframe header .o_mega_menu_toggle"),
    changeOption("MegaMenuLayout", "we-toggler"),
    changeOption("MegaMenuLayout", '[data-select-label="Cards"]'),
    clickOnElement("card's text", ":iframe header .s_mega_menu_cards span"),
    {
        content: "Enter an URL",
        trigger: "#o_link_dialog_url_input",
        run: "edit https://www.odoo.com",
    },
    {
        content: "Check nothing is lost",
        trigger: ":iframe header .s_mega_menu_cards a[href='https://www.odoo.com']:has(img):has(h4):has(span)",
    },
    // 7. Create new a link from a URL-like text.
    // TODO: the two following steps should be removed.
    // Note that human couldn't replace text hidden by the mega menu.
    {
        content: "click on Mega menu item to hide Mega menu content",
        trigger: `:iframe a[role="menuitem"]:contains(Mega)`,
        run: "click",
    },
    {
        content: "Be sure that mega menu is hidden",
        trigger: `:iframe #wrapwrap:not(div[data-name="Mega Menu"])`,
    },
    {
        content: "Replace first paragraph, write a URL",
        trigger: ':iframe #wrap .s_text_image p',
        run: "editor odoo.com",
    },
    {
        content: "Select text",
        trigger: ':iframe #wrap .s_text_image p:contains(odoo.com)',
        run() {
            setSelection(...boundariesIn(this.anchor), false);
        }
    },
    {
        content: "Open link tools",
        trigger: "#toolbar #create-link",
        run: "click",
    },
    clickOnImgStep,
    {
        // URL transformation into link should persist, without the need for
        // input at input[name=url]
        content: "Check that link was created",
        trigger: ":iframe .s_text_image p a[href='http://odoo.com']:contains('odoo.com')",
    },
    {
        content: "Click on link to open the link tools",
        trigger: ":iframe .s_text_image p a[href='http://odoo.com']",
        run: "click",
    },
    // 8. Check that http links are not coerced to https and vice-versa.
    {
        content: "Change URL to https",
        trigger: "#o_link_dialog_url_input",
        run() {
            // TODO: update the tour to use helpers.edit("https://odoo.com")
            // To see what happens with edit, add `pause:true` to the previous step
            // and type yourself https://odoo.com in #o_link_dialog_url_input
            // The label will be ohttps://
            this.anchor.value = "https://odoo.com";
            this.anchor.dispatchEvent(new InputEvent("input", { bubbles: true }));
        }
    },
    {
        content: "Check that link was updated",
        trigger: ":iframe .s_text_image p a[href='https://odoo.com']:contains('odoo.com')",
    },
    {
        trigger: "div#oe_snippets:not(div.o_we_ui_loading)",
    },
    {
        content: "Change it back http",
        trigger: "#o_link_dialog_url_input",
        run() {
            // TODO: update the tour to use helpers.edit("http://odoo.com")
            this.anchor.value = "http://odoo.com";
            this.anchor.dispatchEvent(new InputEvent("input", { bubbles: true }));
        }
    },
    {
        content: "Check that link was updated",
        trigger: ":iframe .s_text_image p a[href='http://odoo.com']:contains('odoo.com')",
    },
    // 9. Test conversion between http and mailto links.
    {
        trigger: "div#oe_snippets:not(div.o_we_ui_loading)",
    },
    {
        content: "Change URL into an email address",
        trigger: "#o_link_dialog_url_input",
        run: "edit callme@maybe.com",
    },
    {
        content: "Check that link was updated and link content is synced with URL",
        trigger: ":iframe .s_text_image p a[href='mailto:callme@maybe.com']:contains('callme@maybe.com')",
    },
    {
        trigger: "div#oe_snippets:not(div.o_we_ui_loading)",
    },
    {
        content: "Change URL back into a http one",
        trigger: "#o_link_dialog_url_input",
        // TODO: remove && click
        run: "edit callmemaybe.com && click body",
    },
    {
        content: "Check that link was updated and link content is synced with URL",
        trigger: ":iframe .s_text_image p a[href='http://callmemaybe.com']:contains('callmemaybe.com')",
    },
    // 10. Test that UI stays up-to-date.
    // TODO this step which was added by https://github.com/odoo/odoo/commit/9fc283b514d420fdfd66123845d9ec3563572692
    // for no apparent reason (the X-original-commit of that one does not add
    // this step) is not required for the test to work (it passes more often
    // without this step than with it). It is a cause of race condition (last
    // check: 31 over 162 tries failed on this). It however makes sense: the
    // popover should indeed be shown and stay shown at this point. To be
    // reenabled once the related feature is robust.
    /*
    {
        content: "Popover should be shown",
        trigger: ":iframe .o_edit_menu_popover .o_we_url_link:contains('http://callmemaybe.com')",
    },
    */
    {
        content: "Edit link label",
        trigger: ":iframe .s_text_image p a",
        run: "click",
            // See SHOPS_STEP_DISABLED. TODO. These steps do not consistently
            // update the link for some reason... to investigate.
            /*
            // Simulating text input.
            const link = this.anchor;
            actions.text("callmemaybe.com/shops");
            // Trick the editor into keyboardType === 'PHYSICAL' and delete the
            // last character "s" and end with "callmemaybe.com/shop"
            link.dispatchEvent(new KeyboardEvent("keydown", { key: "Backspace", bubbles: true }));
            // Trigger editor's '_onInput' handler, which leads to a history step.
            link.dispatchEvent(new InputEvent('input', {inputType: 'insertText', bubbles: true}));
            */
    },
    // See SHOPS_STEP_DISABLED. TODO.
    /*
    {
        content: "Check that links's href was updated",
        trigger: ":iframe .s_text_image p a[href='http://callmemaybe.com/shop']:contains('callmemaybe.com/shop')",
    },
    */
    // TODO this step is disabled for now because it is a cause of race
    // condition (last check: 57 over 162 tries failed on this). The popover
    // seems to sometimes unexpectedly close. Probably why the "Popover should
    // be shown" step above had to be disabled as well.
    /*
    {
        content: "Check popover content is up-to-date",
        trigger: ":iframe .popover div a:contains('http://callmemaybe.com/shop')",
    },
    */
    // TODO this step is disabled for now because writing "/shop" in above steps
    // currently is not considered most of the time all of a sudden... to
    // investigate (it was not needed in 16.4). See SHOPS_STEP_DISABLED.
    /*
    {
        content: "Check Link tools URL input content is up-to-date",
        trigger: "#o_link_dialog_url_input",
        run() {
            // FIXME this was changed with 69a27360c98aee3d97eb42e9a27a751311791e15
            // to omit the http:// part... but this part is removed
            // inconsistently. Trying to fix the test actually made it so
            // http:// is still there at this point... make it consistent and
            // then remove http:// here again.
            if (this.anchor.value !== 'http://callmemaybe.com/shop') {
                throw new Error("Tour step failed");
            }
        }
    },
    */
    // 11. Pick a URL with auto-complete
    {
        trigger: `input#o_link_dialog_url_input`,
    },
    {
        content: "Wait the sidebar is openend",
        trigger: `we-title:contains(Inline text)`,
    },
    {
        trigger: 'body:not(:has(.o_we_ui_loading))',
    },
    {
        content: "Enter partial URL",
        trigger: "input#o_link_dialog_url_input",
        run: "edit /contact",
    },
    {
        content: "Pick '/contactus",
        trigger: "ul.ui-autocomplete li div:contains('/contactus (Contact Us)')",
        run: "click",
    },
    {
        content: "Check that links's href and label were updated",
        trigger: ":iframe .s_text_image p a[href='/contactus']:contains('/contactus')",
    },
    // 12. Add a link leading to a 404 page
    {
        content: "Enter a non-existent URL",
        trigger: "#o_link_dialog_url_input",
        run: "edit /this-address-does-not-exist",
    },
    {
        content: "Check that the link's href was updated and click on it",
        trigger: ":iframe .s_text_image p a[href='/this-address-does-not-exist']",
        run: "click",
    },
    // TODO this step is disabled for now because it is a cause of race
    // condition (last check: 3 times over 95). The popover seems to sometimes
    // unexpectedly close.
    /*
    {
        content: "Check popover content is up-to-date (2)",
        trigger: ":iframe .popover div a:contains('/this-address-does-not-exist')",
    },
    */
    // 13. Check that ZWS is not added in the link label input.
    clickOnImgStep,
    {
        content: "Click on contact us button",
        trigger: ":iframe a.btn[href='/contactus']",
        run: "click",
    },
    {
        trigger: "div#oe_snippets:not(div.o_we_ui_loading)",
    },
    {
        content: "Verify that the link label input does not contain ZWS",
        trigger: "#o_link_dialog_label_input:value('Contact Us')",
    },
    // TODO: understand why tour need big timeout to passed and remove it
    ...clickOnSave("bottom", 20000),
]);

return __exports;
});
;

/**********************************************************
*  Filepath: /website/static/tests/tours/media_dialog.js  *
*  Lines: 215                                             *
**********************************************************/
odoo.define('@website/../tests/tours/media_dialog', ['@website/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module */

const {
    changeOption,
    clickOnSave,
    insertSnippet,
    registerWebsitePreviewTour,
} = require('@website/js/tours/tour_utils');

registerWebsitePreviewTour("website_media_dialog_undraw", {
    url: '/',
    edition: true,
}, () => [
...insertSnippet({
    id: 's_text_image',
    name: 'Text - Image',
    groupName: "Content",
}),
{
    content: "Open the media dialog from the snippet",
    trigger: ":iframe .s_text_image img",
    run: "dblclick",
}, {
    content: "Search for 'banner' to call the media library", // Mocked call
    trigger: ".o_select_media_dialog .o_we_search",
    run: "edit banner",
}, {
    content: "Check that the media library is available",
    trigger: '.o_select_media_dialog:has(.o_we_search_select option[value="media-library"])',
},
{
    content: "Ensure all images are loaded to avoid CORS is misconfigured on the API server, image will be treated as non-dynamic.",
    trigger: ".modal .o_load_done_msg",
},
]);

registerWebsitePreviewTour("website_media_dialog_external_library", {
    url: "/",
    edition: true,
}, () => [
    ...insertSnippet({
        id: "s_text_image",
        name: "Text - Image",
        groupName: "Content",
    }),
    {
        content: "Open the media dialog from the snippet",
        trigger: ":iframe .s_text_image img",
        run: "dblclick",
    }, {
        content: "Dummy search to call the media library",
        trigger: ".o_select_media_dialog .o_we_search",
        run: "edit a",
    }, {
        content: "Choose the media library to only show its media",
        trigger: ".o_select_media_dialog .o_we_search_select",
        run: "select Illustrations",
    }, {
        content: "Double click on the first image",
        trigger: ".o_select_media_dialog img.o_we_attachment_highlight",
        run: "click",
    }, {
        content: "Reopen the media dialog",
        trigger: ":iframe .s_text_image img",
        run: "dblclick",
    }, {
        content: "Check that the image was created only once",
        trigger: ".o_select_media_dialog .o_we_existing_attachments .o_existing_attachment_cell img[src^='/html_editor/shape/illustration/']",
        run() {
            const listEl = this.anchor.closest(".o_select_media_dialog .o_we_existing_attachments");
            const selector = ".o_existing_attachment_cell img[src^='/html_editor/shape/illustration/']";
            const uploadedImgs = listEl.querySelectorAll(`${selector}[title='${this.anchor.title}']`);
            if (uploadedImgs.length !== 1) {
                throw new Error(`${uploadedImgs.length} attachment(s) were found. Exactly 1 should have been created.`);
            }
        },
    },
    {
        content: "Click on the first illustration image",
        trigger: ".o_select_media_dialog .o_we_attachment_highlight",
        run: "click",
    },
    {
        content: "Select the image",
        trigger: ":iframe .s_text_image img",
        run: "click",
    },
    {
        content: "Try to crop the image",
        trigger: "#oe_snippets .o_we_customize_panel .o_we_user_value_widget[data-crop='true']",
        run: "click",
    },
    {
        content: "Observe the crop is denied for illustration image",
        trigger: ".o_notification_manager .o_notification",
    },
    ...clickOnSave(),
]);

registerWebsitePreviewTour('website_media_dialog_icons', {
    url: '/',
    edition: true,
}, () => [
    ...insertSnippet({
        id: 's_social_media',
        name: 'Social Media',
    }),
    {
        content: "Open MediaDialog from a snippet icon",
        trigger: ':iframe .s_social_media .fa-instagram',
        run: "dblclick",
    },
    {
        content: "Pick the same icon",
        trigger: '.o_select_media_dialog .o_we_attachment_selected.fa-instagram',
        run: "click",
    },
    {
        content: "Check if the icon remains the same",
        trigger: ':iframe .s_social_media .fa-instagram',
    },
    {
        content: "Open MediaDialog again",
        trigger: ':iframe .s_social_media .fa-instagram',
        run: "dblclick",
    },
    {
        content: "Click on the ADD button",
        trigger: '.o_select_media_dialog .btn:contains(Add)',
        run: "click",
    },
    {
        content: "Check if the icon remains the same",
        trigger: ':iframe .s_social_media .fa-instagram',
    },
    ...clickOnSave()
]);

registerWebsitePreviewTour("website_media_dialog_image_shape", {
    url: "/",
    edition: true,
}, () => [
    ...insertSnippet({
        id: "s_text_image",
        name: "Text - Image",
        groupName: "Content",
    }),
    {
        content: "Click on the image",
        trigger: ":iframe .s_text_image img",
        run: "click",
    },
    changeOption("ImageTools", 'we-select[data-name="shape_img_opt"] we-toggler'),
    changeOption("ImageTools", "we-button[data-set-img-shape]"),
    {
        content: "Open MediaDialog from an image",
        trigger: "we-customizeblock-option:contains(media) we-button:contains(replace)",
        run: "click",
    },
    {
        content: "Click on the 'Icons' tab",
        trigger: '.o_select_media_dialog .o_notebook_headers .nav-item a:contains("Icons")',
        run: "click",
    },
    {
        content: "Select an icon",
        trigger: ".o_select_media_dialog:has(.nav-link.active:contains('Icons')) .tab-content span.fa-heart",
        run: "click",
    },
    {
        content: "Checks that the icon doesn't have a shape",
        trigger: ":iframe .s_text_image .fa-heart:not([data-shape])",
    },
]);

registerWebsitePreviewTour("website_media_dialog_insert_media", {
    url: "/",
    edition: true,
}, () => [
    ...insertSnippet({
        id: "s_text_block",
        name: "Text",
        groupName: "Text",
    }),
    {
        content: "Click on the first paragraph",
        trigger: ":iframe .s_text_block p",
        run: "click",
    },
    {
        content: "Click on the toolbar's 'insert media' button",
        trigger: ".oe-toolbar #media-insert",
        run: "click",
    },
    {
        content: "Click on the 'Icons' tab",
        trigger: ".o_select_media_dialog a.nav-link:contains('Icons')",
        run: "click",
    },
    {
        content: "Click on the first icon",
        trigger: ".o_select_media_dialog .font-icons-icon",
        run: "click",
    },
    {
        content: "Verify that the icon was inserted",
        trigger: ":iframe .s_text_block p > span.fa",
    },
]);

return __exports;
});
;

/****************************************************************
*  Filepath: /website/static/tests/tours/media_iframe_video.js  *
*  Lines: 67                                                    *
****************************************************************/
odoo.define('@website/../tests/tours/media_iframe_video', ['@website/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
const { insertSnippet, registerWebsitePreviewTour } = require("@website/js/tours/tour_utils");

registerWebsitePreviewTour("website_media_iframe_video", {
        url: "/",
        edition: true,
    }, () => [
        ...insertSnippet({
            id: "s_text_image",
            name: "Text - Image",
            groupName: "Content",
        }),
        {
            content: "Select the image",
            trigger: ":iframe #wrap .s_text_image img",
            run: "click",
        },
        {
            content: "Open image link options",
            trigger: "[data-name='media_link_opt']",
            run: "click",
        },
        {
            content: "Enter the url",
            trigger: "input[placeholder='www.example.com']",
            run: "edit odoo.com",
        },
        {
            content: "Click on replace media",
            trigger: "[data-replace-media='true']",
            run: "click",
        },
        {
            content: "Click on video button",
            trigger: "a:contains('Videos')",
            run: "click",
        },
        {
            content: "Enter video link",
            trigger: "#o_video_text",
            run: "edit https://youtu.be/nbso3NVz3p8",
        },
        {
            content: "Check video is preview",
            trigger: ".o_video_dialog_iframe",
        },
        {
            content: "Click on 'add' button",
            trigger: ".modal-footer button:contains('Add')",
            run: "click",
        },
        {
            content: "Ensure that the parent of media_iframe_video is not an 'a' tag.",
            trigger: ":iframe .media_iframe_video",
            run: function () {
                if (this.anchor.parentElement.tagName === "A") {
                    console.error("Iframe video has link!!!");
                }
            },
        },
    ]
);

return __exports;
});
;

/***********************************************************
*  Filepath: /website/static/tests/tours/multi_edition.js  *
*  Lines: 43                                               *
***********************************************************/
odoo.define('@website/../tests/tours/multi_edition', ['@website/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { clickOnSave, insertSnippet, registerWebsitePreviewTour } = require('@website/js/tours/tour_utils');

registerWebsitePreviewTour('website_multi_edition', {
    url: '/',
    edition: true,
}, () => [
    {
        content: 'Check the current page has not the elements that will be added',
        trigger: ':iframe body:not(:has(.s_text_image)):not(:has(.s_hr))',
    },
    // Edit the main element of the page
    ...insertSnippet({
        id: 's_text_image',
        name: 'Text - Image',
        groupName: "Content",
    }),
    // Edit another part in the page, like the footer
    {
        trigger: ".o_website_preview.editor_enable.editor_has_snippets",
    },
    {
        trigger: `#oe_snippets .oe_snippet[name="Separator"].o_we_draggable .oe_snippet_thumbnail:not(.o_we_ongoing_insertion)`,
        content: "Drag the Separator building block and drop it at the bottom of the page.",
        run: "drag_and_drop :iframe .oe_drop_zone:last",
    },
    ...clickOnSave(),
    {
        content: 'Check that the main element of the page was properly saved',
        trigger: ':iframe main .s_text_image',
    },
    {
        content: 'Check that the footer was properly saved',
        trigger: ':iframe footer .s_hr',
    },
]);

return __exports;
});
;

/**********************************************************
*  Filepath: /website/static/tests/tours/page_manager.js  *
*  Lines: 271                                             *
**********************************************************/
odoo.define('@website/../tests/tours/page_manager', ['@website/js/tours/tour_utils', '@web/core/registry'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { testSwitchWebsite, registerWebsitePreviewTour } = require('@website/js/tours/tour_utils');
const { registry } = require("@web/core/registry");

// TODO: This part should be moved in a QUnit test
const checkKanbanGroupBy = [
    {
        content: "Click on Kanban View",
        trigger: ".o_cp_switch_buttons .o_kanban",
        run: "click",
    },
    {
        trigger: ".o_kanban_renderer",
    },
    {
        content: "Open search panel menu",
        trigger: ".o_control_panel .o_searchview_dropdown_toggler",
        run: "click",
    },
    {
        content: "Select 'Active' in the select of Add Custom Group",
        trigger: "select.o_add_custom_group_menu",
        run: "select active",
    },
    {
        trigger: ".o_kanban_renderer .o_kanban_header",
    },
    {
        content: "Click on List View",
        trigger: ".o_cp_switch_buttons .o_list",
        run: "click",
    },
    {
        trigger: ".o_list_renderer",
    },
    {
        content: "Remove applied Group By",
        trigger: ".o_cp_searchview .o_facet_remove",
        run: "click",
    },
];

const checkWebsiteFilter = [{
	content: "Click on the search options",
	trigger: ".o_searchview_dropdown_toggler",
    run: "click",
}, {
	content: "Select Test Website",
	trigger: ".o_dropdown_container.o_website_menu > .dropdown-item:contains('Test Website')",
    run: "click",
}, {
	content: "Check that the homepage is now the one of Test Website",
	trigger: ".o_list_table .o_data_row .o_data_cell[name=name]:contains('Home') " +
			 "~ .o_data_cell[name=website_id]:contains('Test Website')",
}, {
	content: "Check that the search options are still open",
	trigger: ".o_search_bar_menu",
}, {
	content: "Go back to My Website",
	trigger: ".o_dropdown_container.o_website_menu > .dropdown-item:contains('My Website')",
    run: "click",
}, {
	content: "Check that the homepage is now the one of My Website",
	trigger: ".o_list_table .o_data_row .o_data_cell[name=name]:contains('Home') " +
			 "~ .o_data_cell[name=website_id]:contains('My Website'):not(:contains('2'))",
}];

const deleteSelectedPage = [
    {
        content: "Click on Action",
        trigger: '.o_cp_action_menus button',
        run: "click",
    },
    {
        content: "Click on Delete",
        trigger: '.o-dropdown--menu span:contains("Delete")',
        run: "click",
    },
    {
        content: "Click on I am sure about this",
        trigger: 'main.modal-body input[type="checkbox"]',
        // The loading of the dependencies can take a while and
        // sometimes reach the default 10s timeout
        timeout: 20000,
        run: "click",
    },
    {
        content: "Click on OK",
        trigger: '.modal-content footer button.btn-primary:not([disabled])',
        run: "click",
    }
];
const homePage = 'tr:contains("Home")';

const refreshPage = [
    {
        trigger: "body",
        run() {window.location.reload();},
    },
];
const duplicateSinglePage = [
    {
        content: "Click on checkbox",
        trigger:
            '.o_list_renderer tr:contains("/test-duplicate") td.o_list_record_selector input[type="checkbox"]',
        run: "click",
    },
    {
        content: "Click on Action button",
        trigger: ".o_cp_action_menus button",
        run: "click",
    },
    {
        content: "Click on Duplicate",
        trigger: '.o-dropdown--menu span:contains("Duplicate")',
        run: "click",
    },
    {
        content: "Put your website name as 'Test Duplicate' here",
        trigger: 'main.modal-body input[type="text"]',
        run: "edit Test Duplicate",
    },
    {
        content: "Click on OK",
        trigger: ".modal-footer button.btn-primary",
        run: "click",
    },
    ...refreshPage,
];

const duplicateMultiplePage = [
    {
        content: "Click on checkbox",
        trigger:
            '.o_list_renderer tr:contains("/test-duplicate") td.o_list_record_selector input[type="checkbox"]',
        run: "click",
    },
    {
        content: "Click on checkbox",
        trigger:
            '.o_list_renderer tr:contains("/test-duplicate-1") td.o_list_record_selector input[type="checkbox"]',
        run: "click",
    },
    {
        content: "Click on Action button",
        trigger: ".o_cp_action_menus button",
        run: "click",
    },
    {
        content: "Click on Duplicate",
        trigger: '.o-dropdown--menu span:contains("Duplicate")',
        run: "click",
    },
    {
        content: "Put your website name as 'Test Duplicate' here",
        trigger: 'main.modal-body input[type="text"]',
        run: "edit Test Duplicate",
    },
    {
        content: "Click on OK",
        trigger: ".modal-footer button.btn-primary",
        run: "click",
    },
    ...refreshPage,
];

registerWebsitePreviewTour('website_page_manager', {
    url: '/',
}, () => [
    {
        content: "Click on Site",
        trigger: 'button.dropdown-toggle[data-menu-xmlid="website.menu_site"]',
        run: "click",
    },
    {
        content: "Click on Pages",
        trigger: 'a.dropdown-item[data-menu-xmlid="website.menu_website_pages_list"]',
        run: "click",
    },
    ...checkKanbanGroupBy,
    ...checkWebsiteFilter,
    {
        content: "Click on Home Page",
        trigger: `.o_list_renderer ${homePage} td.o_list_record_selector input[type="checkbox"]`,
        run: "click",
    },
    ...deleteSelectedPage,
    {
        content: "Check that the page has been removed",
        trigger: `.o_list_renderer:not(:has(${homePage}))`,
    },
    {
        content: "Click on All Pages",
        trigger: '.o_list_renderer thead input[type="checkbox"]',
        run: "click",
    },
    ...deleteSelectedPage,
    {
        content: "Check that all pages have been removed",
        trigger: '.o_list_renderer tbody:not(:has([data-id]))',
    },
]);

registerWebsitePreviewTour('website_page_manager_session_forced', {
    url: '/',
}, () => [...testSwitchWebsite('Test Website'), {
    content: "Click on Site",
    trigger: 'button.dropdown-toggle[data-menu-xmlid="website.menu_site"]',
    run:" click",
}, {
    content: "Click on Pages",
    trigger: 'a.dropdown-item[data-menu-xmlid="website.menu_website_pages_list"]',
    run:" click",
}, {
    content: "Check that the homepage is the one of Test Website",
    trigger: ".o_list_table .o_data_row .o_data_cell[name=name]:contains('Home') " +
             "~ .o_data_cell[name=website_id]:contains('Test Website')",
}, {
	content: "Click on the search options",
	trigger: ".o_searchview_dropdown_toggler",
    run:" click",
}, {
	content: "Check that the selected website is Test Website",
	trigger: ".o_dropdown_container.o_website_menu > .dropdown-item:contains('Test Website')",
}]);

registry.category("web_tour.tours").add('website_page_manager_direct_access', {
    url: '/odoo/action-website.action_website_pages_list',
    steps: () => [{
    content: "Check that the homepage is the one of Test Website",
    trigger: ".o_list_table .o_data_row .o_data_cell[name=name]:contains('Home') " +
             "~ .o_data_cell[name=website_id]:contains('Test Website')",
}, {
	content: "Click on the search options",
	trigger: ".o_searchview_dropdown_toggler",
    run:" click",
}, {
	content: "Check that the selected website is Test Website",
	trigger: ".o_dropdown_container.o_website_menu > .dropdown-item:contains('Test Website')",
}]});

registerWebsitePreviewTour(
    "website_clone_pages",
    {
        url: "/",
    },
    () => [
        {
            content: "Click on Site",
            trigger: 'button.dropdown-toggle[data-menu-xmlid="website.menu_site"]',
            run: "click",
        },
        {
            content: "Click on Pages",
            trigger: 'a.dropdown-item[data-menu-xmlid="website.menu_website_pages_list"]',
            run: "click",
        },
        ...duplicateSinglePage,
        ...duplicateMultiplePage,
        {
            trigger: "td:contains('/test-duplicate-2-1')",
        },
    ]
);

return __exports;
});
;

/******************************************************
*  Filepath: /website/static/tests/tours/parallax.js  *
*  Lines: 68                                          *
******************************************************/
odoo.define('@website/../tests/tours/parallax', ['@website/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const {
    changeOption,
    clickOnEditAndWaitEditMode,
    clickOnSave,
    clickOnSnippet,
    insertSnippet,
    registerWebsitePreviewTour,
} = require("@website/js/tours/tour_utils");

const coverSnippet = {id: "s_cover", name: "Cover", groupName: "Intro"};

registerWebsitePreviewTour("test_parallax", {
    url: "/",
    edition: true,
}, () => [
    ...insertSnippet(coverSnippet),
    ...clickOnSnippet(coverSnippet),
    changeOption("BackgroundOptimize", "we-toggler"),
    changeOption("BackgroundOptimize", 'we-button[data-gl-filter="blur"]'),
{
    content: "Check that the Cover snippet has the Blur filter on its background image",
    trigger: ":iframe .s_cover span[data-gl-filter='blur']",
},
    changeOption("Parallax", "we-toggler"),
    changeOption("Parallax", 'we-button[data-select-data-attribute="0"]'),
{
    content: "Check that the data related to the filter have been transferred to the new target",
    trigger: ":iframe .s_cover[data-gl-filter='blur']",
},
{
    content: "Check that the 'o_modified_image_to_save' class has been transferred to the new target",
    trigger: ":iframe .s_cover.o_modified_image_to_save",
},
    changeOption("Parallax", "we-toggler"),
    changeOption("Parallax", 'we-button[data-select-data-attribute="1"]'),
{
    content: "Check that the 'o_modified_image_to_save' class has been deleted from the old target",
    trigger: ":iframe .s_cover:not(.o_modified_image_to_save)",
},
{
    content: "Check that the 'o_modified_image_to_save' class has been transferred to the new target",
    trigger: ":iframe span.s_parallax_bg.o_modified_image_to_save",
},
{
    content: "Check that the data related to the filter have been transferred to the new target",
    trigger: ":iframe span.s_parallax_bg[data-gl-filter='blur']",
},
    changeOption("Parallax", "we-toggler"),
    changeOption("Parallax", 'we-button[data-select-data-attribute="1.5"]'),
{
    content: "Check that the option was correctly applied",
    trigger: ':iframe span.s_parallax_bg[style*=top][style*=bottom][style*=transform]',
},
    ...clickOnSave(),
    ...clickOnEditAndWaitEditMode(),
{
    content: "The parallax should not add o_dirty when entering edit mode",
    trigger: ':iframe #wrap:not(.o_dirty)',
},
]);

return __exports;
});
;

/*********************************************************************
*  Filepath: /website/static/tests/tours/popup_visibility_option.js  *
*  Lines: 38                                                         *
*********************************************************************/
odoo.define('@website/../tests/tours/popup_visibility_option', ['@website/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
const { insertSnippet, registerWebsitePreviewTour } = require("@website/js/tours/tour_utils");

registerWebsitePreviewTour(
    "website_popup_visibility_option",
    {
        url: "/",
        edition: true,
    },
    () => [
        ...insertSnippet({
            id: "s_popup",
            name: "Popup",
            groupName: "Content",
        }),
        {
            content: "Click on the column within the popup snippet.",
            trigger: ":iframe #wrap .s_popup .o_cc1",
            run: "click",
        },
        {
            content: "Click the 'No Desktop' visibility option.",
            trigger:
                ".snippet-option-DeviceVisibility we-button[data-toggle-device-visibility='no_desktop']",
            run: "click",
        },
        {
            content: "Verify that the popup is visible and the column is invisible.",
            trigger:
                ".o_we_invisible_root_parent i.fa-eye, ul .o_we_invisible_entry i.fa-eye-slash",
        },
    ]
);

return __exports;
});
;

/**************************************************************
*  Filepath: /website/static/tests/tours/powerbox_snippet.js  *
*  Lines: 138                                                 *
**************************************************************/
odoo.define('@website/../tests/tours/powerbox_snippet', ['@website/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
const {clickOnSnippet, insertSnippet, registerWebsitePreviewTour } = require("@website/js/tours/tour_utils");

registerWebsitePreviewTour("website_powerbox_snippet",{
    edition: true,
},
() => [
...insertSnippet({
    id: "s_text_block",
    name: "Text",
    groupName: "Text",
}),
...clickOnSnippet({
    id: "s_text_block",
    name: "Text",
}),
{
    content: "Select the last paragraph",
    trigger: ":iframe .s_text_block p:last-child",
    run: "click",
},
{
    content: "Show the powerbox",
    trigger: ":iframe .s_text_block p:last-child",
    async run(actions) {
        await actions.editor(`/`);
        const wrapwrap = this.anchor.closest("#wrapwrap");
        wrapwrap.dispatchEvent(
            new InputEvent("input", {
                inputType: "insertText",
                data: "/",
            })
        );
    },
},
{
    content: "Click on the alert snippet",
    trigger: ".oe-powerbox-wrapper .oe-powerbox-commandWrapper:contains('Alert')",
    run: "click",
},
{
    content: "Check if s_alert snipept is inserted",
    trigger: ":iframe .s_alert",
}
]);

registerWebsitePreviewTour(
    "website_powerbox_keyword",
    {
        edition: true,
    },
    () => [
        ...insertSnippet({
            id: "s_text_block",
            name: "Text",
            groupName: "Text",
        }),
        ...clickOnSnippet({
            id: "s_text_block",
            name: "Text",
        }),
        {
            content: "Select the last paragraph",
            trigger: ":iframe .s_text_block p:last-child",
            run: "click",
        },
        {
            content: "Show the powerbox",
            trigger: ":iframe .s_text_block p:last-child",
            async run(actions) {
                await actions.editor(`/`);
                const wrapwrapEl = this.anchor.closest("#wrapwrap");
                wrapwrapEl.dispatchEvent(
                    new InputEvent("input", {
                        inputType: "insertText",
                        data: "/",
                    })
                );
            },
        },
        {
            content: "Initially alert snippet should be present in the powerbox",
            trigger: ".oe-powerbox-wrapper .oe-powerbox-commandName:contains('Alert')",
        },
        {
            content: "Change the content to '/table' so that alert snippet should not be present in the powerbox",
            trigger: ":iframe .s_text_block p:last-child",
            run() {
                const wrapwrapEl = this.anchor.closest("#wrapwrap");
                this.anchor.textContent = "/table";
                wrapwrapEl.ownerDocument.dispatchEvent(
                    new KeyboardEvent("keyup", {
                        key: "DummyKey",
                        code: "KeyDummy",
                        cancelable: true,
                    })
                );
            },
        },
        {
            content: "Alert snippet should not be present in the powerbox",
            trigger: ".oe-powerbox-wrapper .oe-powerbox-commandName:not(:contains('Alert'))",
        },
        {
            content: "Change the content to '/banner'",
            trigger: ":iframe .s_text_block p:last-child",
            run() {
                const wrapwrapEl = this.anchor.closest("#wrapwrap");
                this.anchor.textContent = "/banner";
                wrapwrapEl.ownerDocument.dispatchEvent(
                    new KeyboardEvent("keyup", {
                        key: "DummyKey",
                        code: "KeyDummy",
                        cancelable: true,
                    })
                );
            },
        },
        {
            content: "Alert snippet should be present in the powerbox",
            trigger: ".oe-powerbox-wrapper .oe-powerbox-commandName:contains('Alert')",
        },
        {
            content: "Click on the alert snippet",
            trigger: ".oe-powerbox-wrapper .oe-powerbox-commandName:contains('Alert')",
            run: "click",
        },
        {
            content: "Check if s_alert snippet is inserted",
            trigger: ":iframe .s_alert",
        },
    ]
);

return __exports;
});
;

/****************************************************************
*  Filepath: /website/static/tests/tours/public_user_editor.js  *
*  Lines: 14                                                    *
****************************************************************/
odoo.define('@website/../tests/tours/public_user_editor', ['@web/core/registry'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { registry } = require("@web/core/registry");

registry.category("web_tour.tours").add('public_user_editor', {
    steps: () => [{
    trigger: '.note-editable',
}]});

return __exports;
});
;

/***************************************************************************
*  Filepath: /website/static/tests/tours/public_user_editor_dep_widget.js  *
*  Lines: 20                                                               *
***************************************************************************/
// @odoo-module ignore

odoo.loader.bus.addEventListener("module-started", (e) => {
    if (e.detail.moduleName === "@web_editor/js/frontend/loadWysiwygFromTextarea") {
        const publicWidget = odoo.loader.modules.get("@web/legacy/js/public/public_widget")[Symbol.for('default')];
        const { loadWysiwygFromTextarea } = e.detail.module;

        publicWidget.registry['public_user_editor_test'] = publicWidget.Widget.extend({
            selector: 'textarea.o_public_user_editor_test_textarea',

            /**
             * @override
             */
            start: async function () {
                await this._super(...arguments);
                await loadWysiwygFromTextarea(this, this.el, {});
            },
        });
    }
})
;

/************************************************************
*  Filepath: /website/static/tests/tours/reset_password.js  *
*  Lines: 32                                                *
************************************************************/
odoo.define('@website/../tests/tours/reset_password', ['@web/core/registry'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { registry } = require("@web/core/registry");

registry.category("web_tour.tours").add('website_reset_password', {
    steps: () => [
    {
        content: "fill new password",
        trigger: '.oe_reset_password_form input[name="password"]',
        run: "edit adminadmin",
    },
    {
        content: "fill confirm password",
        trigger: '.oe_reset_password_form input[name="confirm_password"]',
        run: "edit adminadmin",
    },
    {
        content: "submit reset password form",
        trigger: '.oe_reset_password_form button[type="submit"]',
        run: "click",
    },
    {
        content: "check that we're logged in",
        trigger: '.o_user_menu .dropdown-toggle',
    },
]});

return __exports;
});
;

/***************************************************************
*  Filepath: /website/static/tests/tours/restricted_editor.js  *
*  Lines: 15                                                   *
***************************************************************/
odoo.define('@website/../tests/tours/restricted_editor', ['@website/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { clickOnEditAndWaitEditMode, registerWebsitePreviewTour } = require("@website/js/tours/tour_utils");

registerWebsitePreviewTour("restricted_editor", {
    url: "/",
}, () => [
    ...clickOnEditAndWaitEditMode(),
]);

return __exports;
});
;

/*************************************************
*  Filepath: /website/static/tests/tours/rte.js  *
*  Lines: 325                                    *
*************************************************/
odoo.define('@website/../tests/tours/rte', ['@website/js/tours/tour_utils', '@odoo/owl'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const {
    clickOnEditAndWaitEditMode,
    clickOnSave,
    insertSnippet,
    goToTheme,
    registerWebsitePreviewTour,
} = require("@website/js/tours/tour_utils");
const { whenReady } = require("@odoo/owl");

registerWebsitePreviewTour('rte_translator', {
    url: '/',
    edition: true,
    wait_for: whenReady(),
}, () => [
...goToTheme(),
{
    content: "click on Add a language",
    trigger: "we-button[data-add-language]",
    run: "click",
}, {
    content: "confirm leave editor",
    trigger: ".modal-dialog button.btn-primary",
    run: "click",
}, {
    content: "type Parseltongue",
    trigger: 'div[name="lang_ids"] .o_input_dropdown input',
    run: "edit Parseltongue",
}, {
    content: 'select Parseltongue',
    trigger: '.dropdown-item:contains(Parseltongue)',
    run: "click",
},
{
    trigger: '.modal-dialog div[name="lang_ids"] .rounded-pill .o_tag_badge_text:contains(Parseltongue)',
},
{
    content: "load Parseltongue",
    trigger: '.modal-footer .btn-primary',
    run: "click",
}, {
    content: "click language dropdown (2)",
    trigger: ':iframe .js_language_selector .dropdown-toggle',
    timeout: 60000,
    run: "click",
},
{
    trigger: ':iframe html[lang*="pa-GB"]',
},
{
    content: "go to english version",
    trigger: ':iframe .js_language_selector a[data-url_code="en"]',
    run: "click",
},
{
    trigger: ':iframe html[lang*="en-US"]',
},
{
    content: "Open new page menu",
    trigger: ".o_menu_systray .o_new_content_container > a",
    run: "click",
}, {
    content: "click on new page",
    trigger: '.o_new_content_element a',
    run: "click",
}, {
    content: "click on Use this template",
    trigger: ".o_page_template .o_button_area:not(:visible)",
    run: "click",
}, {
    content: "insert file name",
    trigger: ".modal:not(.o_inactive_modal):contains(new page) .modal-body input[type=text]",
    run: "edit rte_translator.xml && press Enter",
},
{
    trigger: '.modal:not(.o_inactive_modal):contains(new page) .modal-body input[type="text"]:value(rte_translator.xml)',
},
{
    content: "create file",
    trigger: ".modal:not(.o_inactive_modal):contains(new page) button.btn-primary:contains(create)",
    run: "click",
}, {
    content: "click on the 'page manager' button",
    trigger: 'button[name="website.action_website_pages_list"]',
    run: "click",
}, {
    content: "click on the record to display the xml file in the iframe",
    trigger: 'td:contains("rte_translator.xml")',
    run: "click",
}, {
    content: "Open new page menu",
    trigger: ".o_menu_systray .o_new_content_container > a",
    run: "click",
}, {
    content: "click on new page",
    trigger: '.o_new_content_element a',
    run: "click",
}, {
    content: "click on Use this template",
    trigger: ".o_page_template .o_button_area:not(:visible)",
    run: "click",
}, {
    content: "insert page name",
    trigger: '.modal .modal-dialog .modal-body input[type="text"]',
    run: "edit rte_translator",
},
{
    trigger: 'input[type="text"]:value(rte_translator)',
},
{
    content: "create page",
    trigger: ".modal button.btn-primary:contains(create)",
    run: "click",
},
{
    trigger: "body:not(:has(.modal))",
},
...insertSnippet({
    id: "s_cover",
    name: "Cover",
    groupName: "Intro",
}), {
    content: "change content",
    trigger: ':iframe #wrap',
    run() {
        $('iframe:not(.o_ignore_in_tour)').contents().find("#wrap p:first").replaceWith('<p>Write one or <font style="background-color: yellow;">two paragraphs <b>describing</b></font> your product or\
            <font style="color: rgb(255, 0, 0);">services</font>. To be successful your content needs to be\
            useful to your <a href="/999">readers</a>.</p> <input value="test translate default value" placeholder="test translate placeholder"/>\
            <p>&lt;b&gt;&lt;/b&gt; is an HTML&nbsp;tag &amp; is empty</p>');
        $('iframe:not(.o_ignore_in_tour)').contents().find("#wrap img").attr("title", "test translate image title");
    }
    }, {
    content: "ensure change was applied",
    trigger: ':iframe #wrap p:first b',
},
...clickOnSave(),
{
    content: "click language dropdown (3)",
    trigger: ':iframe .js_language_selector .dropdown-toggle',
    run: "click",
},
{
    trigger: ':iframe html[lang*="en"]',
},
{
    content: "click on Parseltongue version",
    trigger: ':iframe .js_language_selector a[data-url_code="pa_GB"]',
    run: "click",
}, {
    content: "edit",
    trigger: '.o_edit_website_container button',
    run: "click",
},
{
    trigger: ":iframe html:not(:has(#wrap p span))",
},
{
    content: "translate",
    trigger: '.o_translate_website_dropdown_item',
    run: "click",
}, {
    content: "close modal",
    trigger: '.modal-footer .btn-secondary',
    run: "click",
}, {
    content: "check if translation is activate",
    trigger: ':iframe [data-oe-translation-source-sha]',
    run: "click",
},
{
    trigger: "#oe_snippets.o_loaded",
},
{
    content: "translate text",
    trigger: ':iframe #wrap p font:first',
    async run(actionHelper) {
        await actionHelper.editor('translated Parseltongue text');
        const {Wysiwyg} = odoo.loader.modules.get('@web_editor/js/wysiwyg/wysiwyg');
        Wysiwyg.setRange(this.anchor.childNodes[0], 22);
        this.anchor.dispatchEvent(new KeyboardEvent("keyup", {bubbles: true, key: "_"}));
        this.anchor.dispatchEvent(new InputEvent("input", {bubbles: true}));
    },
}, {
    content: "translate text with special char",
    trigger: ':iframe #wrap input + p span:first',
    async run(actionHelper) {
        await actionHelper.click();
        this.anchor.textContent = '<{translated}>' + this.anchor.textContent;
        const {Wysiwyg} = odoo.loader.modules.get('@web_editor/js/wysiwyg/wysiwyg');
        Wysiwyg.setRange(this.anchor.childNodes[0], 0);
        this.anchor.dispatchEvent(new KeyboardEvent("keyup", {bubbles: true, key: "_"}));
        this.anchor.dispatchEvent(new InputEvent("input", {bubbles: true}));
    },
},
{
    trigger: ':iframe #wrap .o_dirty font:first:contains(translated Parseltongue text)',
},
{
    content: "click on input",
    trigger: ':iframe #wrap input:first',
    run: 'click',
}, {
    content: "translate placeholder",
    trigger: '.modal-dialog input:first',
    run: "edit test Parseltongue placeholder",
}, {
    content: "translate default value",
    trigger: '.modal-dialog input:last',
    run: "edit test Parseltongue default value",
},
{
    trigger: '.modal input:value("test Parseltongue placeholder")',
},
{
    content: "close modal",
    trigger: '.modal-footer .btn-primary',
    run: "click",
}, {
    content: "check: input marked as translated",
    trigger: ':iframe input[placeholder="test Parseltongue placeholder"].oe_translated',
},
...clickOnSave(),
{
    content: "check: content is translated",
    trigger: ':iframe #wrap p font:first:contains(translated Parseltongue text)',
}, {
    content: "check: content with special char is translated",
    trigger: ":iframe #wrap input + p:contains(<{translated}><b></b> is an HTML tag & )",
}, {
    content: "check: placeholder translation",
    trigger: ':iframe input[placeholder="test Parseltongue placeholder"]',
}, {
    content: "check: default value translation",
    trigger: ':iframe input[value="test Parseltongue default value"]',
},
{
    trigger: ':iframe html[lang*="pa-GB"]:not(:has(#wrap p span))',
},
{
    content: "open language selector",
    trigger: ':iframe .js_language_selector button:first',
    run: "click",
}, {
    content: "return to english version",
    trigger: ':iframe .js_language_selector a[data-url_code="en"]',
    run: "click",
}, {
    content: "Check body",
    trigger: ":iframe body:not(:has(#wrap p font:first:contains(/^paragraphs <b>describing</b>$/)))",
},
...clickOnEditAndWaitEditMode(),
{
    content: "select text",
    trigger: ':iframe #wrap p',
    async run(actionHelper) {
        await actionHelper.click();
        var el = this.anchor;
        var mousedown = document.createEvent('MouseEvents');
        mousedown.initMouseEvent('mousedown', true, true, window, 0, 0, 0, 0, 0, false, false, false, false, 0, el);
        el.dispatchEvent(mousedown);
        var mouseup = document.createEvent('MouseEvents');
        const { Wysiwyg } = odoo.loader.modules.get('@web_editor/js/wysiwyg/wysiwyg');
        Wysiwyg.setRange(el.childNodes[2], 6, el.childNodes[2], 13);
        mouseup.initMouseEvent('mouseup', true, true, window, 0, 0, 0, 0, 0, false, false, false, false, 0, el);
        el.dispatchEvent(mouseup);
    },
// This is disabled for now because it reveals a bug that is fixed in saas-15.1
// and considered a tradeoff in 15.0. The bug concerns the invalidation of
// translations when inserting tags with more than one character. Whereas <u>
// didn't trigger an invalidation, <span style="text-decoration-line: underline;">
// does.
// }, {
//     content: "underline",
//     trigger: '.oe-toolbar #underline',
},
...clickOnSave(),
{
    content: "click language dropdown (4)",
    trigger: ':iframe .js_language_selector .dropdown-toggle',
    run: "click",
}, {
    content: "return in Parseltongue",
    trigger: ':iframe html[lang="en-US"] .js_language_selector .js_change_lang[data-url_code="pa_GB"]',
    run: "click",
},
{
    trigger: ':iframe html[lang*="pa-GB"]',
},
{
    content: "check bis: content is translated",
    trigger: ':iframe #wrap p font:first:contains(translated Parseltongue text)',
    run: "click",
}, {
    content: "check bis: placeholder translation",
    trigger: ':iframe input[placeholder="test Parseltongue placeholder"]',
    run: "edit Test",
}, {
    content: "open site menu",
    trigger: 'button[data-menu-xmlid="website.menu_site"]',
    run: "click",
}, {
    content: "Open HTML editor",
    trigger: 'a[data-menu-xmlid="website.menu_ace_editor"]',
    run: "click",
}, {
    content: "Check that the editor is not showing translated content (1)",
    trigger: '.ace_text-layer .ace_line:contains("an HTML")',
    run() {
        const lineEscapedText = $(this.anchor.textContent).last().text();
        if (lineEscapedText !== "&lt;b&gt;&lt;/b&gt; is an HTML&nbsp;tag &amp; is empty") {
            console.error('The HTML editor should display the correct untranslated content');
            $('iframe:not(.o_ignore_in_tour)').contents().find('body').addClass('rte_translator_error');
        }
    },
}, {
    content: "Check that the editor is not showing translated content (2)",
    trigger: ':iframe body:not(.rte_translator_error)',
}]);

return __exports;
});
;

/***********************************************************************
*  Filepath: /website/static/tests/tours/skip_website_configurator.js  *
*  Lines: 53                                                           *
***********************************************************************/
odoo.define('@website/../tests/tours/skip_website_configurator', ['@web/core/registry'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { registry } = require("@web/core/registry");

registry.category("web_tour.tours").add('skip_website_configurator', {
    url: '/odoo/action-website.action_website_configuration',
    steps: () => [
    {
        content: "create a new website",
        trigger: 'button[name="action_website_create_new"]',
        run: "click",
    },
    {
        content: "insert website name",
        trigger: 'div[name="name"] input',
        run: "edit Website EN",
    },
    {
        content: "validate the website creation modal",
        trigger: '.modal button.btn-primary',
        run: "click",
    },
    {
        content: "skip configurator",
        // This trigger targets the skip button, it doesn't have a more
        // explicit class or ID.
        trigger: '.o_configurator_container .container-fluid .btn.btn-link',
        run: "click",
    },
    {
        content: "Install a theme",
        trigger: ".o_theme_preview_top",
        run: "hover && click button[name=button_choose_theme]",
    },
    {
        trigger: ".o_menu_systray .o_user_menu",
    },
    {
        content: "Check that the homepage is loaded",
        trigger: ".o_website_preview[data-view-xmlid='website.homepage']",
        timeout: 30000,
    },
    {
        content: "Wait title is present before close tour",
        trigger: ":iframe h2:contains(welcome to your)",
    }
]});

return __exports;
});
;

/************************************************************************
*  Filepath: /website/static/tests/tours/snippet_background_edition.js  *
*  Lines: 416                                                           *
************************************************************************/
odoo.define('@website/../tests/tours/snippet_background_edition', ['@web_editor/js/common/utils', '@website/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module */

const weUtils = require('@web_editor/js/common/utils')[Symbol.for("default")];
const {
    changeBackgroundColor,
    changeOption,
    clickOnEditAndWaitEditMode,
    clickOnSave,
    clickOnSnippet,
    insertSnippet,
    registerWebsitePreviewTour,
} = require('@website/js/tours/tour_utils');

const snippets = [
    {
        id: 's_text_image',
        name: 'Text - Image',
        groupName: "Content",
    },
];
const gradients = [
    'linear-gradient(135deg, rgb(203, 94, 238) 0%, rgb(75, 225, 236) 100%)',
    'linear-gradient(135deg, rgb(255, 222, 202) 0%, rgb(202, 115, 69) 100%)',
];

function typeToName(xType) {
    return xType === 'cc' ? 'color combinations' : xType === 'bg' ? 'background colors' : 'gradients';
}

function switchTo(type, _name) {
    const target = type === 'cc' ? 'color-combinations' : type === 'bg' ? 'custom-colors' : 'gradients';
    const name = _name || typeToName(type);
    return {
        trigger: `.o_we_colorpicker_switch_pane_btn[data-target="${target}"]`,
        content: `Switch to ${name}`,
        run: "click",
    };
}

function addCheck(steps, checkX, checkNoX, xType, noSwitch = false) {
    if (!checkX && !checkNoX) {
        return;
    }

    const name = typeToName(xType);
    const selectorCheckX = checkX && `.o_we_color_btn[data-color="${checkX}"].selected`;
    const selectorCheckNoX = checkNoX && `.o_we_color_btn[data-color="${checkNoX}"]:not(.selected)`;
    const step = {
        trigger: selectorCheckX || selectorCheckNoX,
        content: `The correct ${name} is marked as selected`,
        tooltipPosition: "bottom",
    };
    if (!noSwitch) {
        steps.push(switchTo(xType, name));
    }
    if (!selectorCheckX && selectorCheckNoX) {
        steps.push({
            trigger: selectorCheckNoX,
        });
    }
    steps.push(step);
}

function checkAndUpdateBackgroundColor({
    checkCC, checkNoCC,
    checkBg, checkNoBg,
    checkGradient, checkNoGradient,
    changeType, change,
    finalSelector, finalRun
}) {
    const steps = [
        changeBackgroundColor(),
    ];

    addCheck(steps, checkCC, checkNoCC, 'cc', true);
    addCheck(steps, checkBg, checkNoBg, 'bg');
    addCheck(steps, checkGradient, checkNoGradient, 'gradient');

    if (changeType) {
        steps.push(switchTo(changeType));
        steps.push(changeOption('ColoredLevelBackground', `.o_we_color_btn[data-color="${change}"]`, 'background color', 'top', true));
        steps.push({
            trigger: finalSelector,
            content: "The selected colors have been applied (CC AND (BG or GRADIENT))",
            tooltipPosition: 'bottom',
            run: finalRun,
        });
    }

    return steps;
}

function updateAndCheckCustomGradient({updateStep, checkGradient}) {
    const steps = [updateStep, {
        trigger: `:iframe #wrapwrap section.${snippets[0].id}.o_cc1`,
        content: 'Color combination 1 still selected',
    }];
    addCheck(steps, checkGradient, checkGradient !== gradients[0] && gradients[0], 'gradient', true);
    return steps;
}

registerWebsitePreviewTour('snippet_background_edition', {
    url: '/',
    edition: true,
},
() => [
...insertSnippet(snippets[0]),
...clickOnSnippet(snippets[0]),

// Set background image and save.
{
    content: "Click on camera icon",
    trigger: ".snippet-option-ColoredLevelBackground we-button.fa-camera",
    run: "click",
},
{
    content: "Click on image",
    trigger: ".o_select_media_dialog img[title='test.png']",
    run: "click",
},
...clickOnSave(),
{
    content: "Check that the image is set",
    trigger: `:iframe section.${snippets[0].id} img[data-original-id]`,
},
...clickOnEditAndWaitEditMode(),
...clickOnSnippet(snippets[0]),
// Remove background image.
{
    content: "Click on camera icon",
    trigger: ".snippet-option-ColoredLevelBackground we-button.fa-camera",
    run: "click",
},

// Add a color combination
...checkAndUpdateBackgroundColor({
    changeType: 'cc',
    change: 3,
    finalSelector: `:iframe .${snippets[0].id}.o_cc.o_cc3:not([class*=bg-]):not([style*="background"])`,
}),

// Change the color combination + Check the previous one was marked as selected
...checkAndUpdateBackgroundColor({
    checkCC: 3,
    changeType: 'cc',
    change: 2,
    finalSelector: `:iframe .${snippets[0].id}.o_cc.o_cc2:not(.o_cc3):not([class*=bg-])`,
}),

// Check the color combination was marked as selected + Edit the bg color
...checkAndUpdateBackgroundColor({
    checkCC: 2,
    checkNoCC: 3,
    changeType: 'bg',
    change: 'black-50',
    finalSelector: `:iframe .${snippets[0].id}.o_cc.o_cc2.bg-black-50`,
}),

// Check the current color palette selection + Change the bg color
...checkAndUpdateBackgroundColor({
    checkCC: 2,
    checkBg: 'black-50',
    changeType: 'bg',
    change: '800',
    finalSelector: `:iframe .${snippets[0].id}.o_cc.o_cc2.bg-800:not(.bg-black-50)`,
}),

// Check the current color palette selection + Change the color combination
// again. It should keep the bg color class.
...checkAndUpdateBackgroundColor({
    checkCC: 2,
    checkBg: '800',
    checkNoBg: 'black-50',
    changeType: 'cc',
    change: 4,
    finalSelector: `:iframe .${snippets[0].id}.o_cc.o_cc4:not(.o_cc2).bg-800`,
}),

// Check the current color palette status + Replace the bg color by a gradient
...checkAndUpdateBackgroundColor({
    checkCC: 4,
    checkNoCC: 2,
    checkBg: '800',
    changeType: 'gradient',
    change: gradients[0],
    finalSelector: `:iframe .${snippets[0].id}.o_cc.o_cc4:not(.bg-800)[style*="background-image: ${gradients[0]}"]`,
}),

// Check the current color palette status + Replace the gradient
...checkAndUpdateBackgroundColor({
    checkCC: 4,
    checkNoBg: '800',
    checkGradient: gradients[0],
    changeType: 'gradient',
    change: gradients[1],
    finalSelector: `:iframe .${snippets[0].id}.o_cc.o_cc4[style*="background-image: ${gradients[1]}"]:not([style*="background-image: ${gradients[0]}"])`,
}),

// Check the current color palette selection + Change the color combination
// again. It should keep the gradient.
...checkAndUpdateBackgroundColor({
    checkCC: 4,
    checkGradient: gradients[1],
    checkNoGradient: gradients[0],
    changeType: 'cc',
    change: 1,
    finalSelector: `:iframe .${snippets[0].id}.o_cc.o_cc1:not(.o_cc4)[style*="background-image: ${gradients[1]}"]`,
}),

// Final check of the color status in the color palette
...checkAndUpdateBackgroundColor({
    checkCC: 1,
    checkNoCC: 4,
    checkGradient: gradients[1],
}),

// Now, add an image on top of that color combination + gradient
{
    // Close the palette before selecting a media.
    trigger: '.snippet-option-ColoredLevelBackground we-title',
    content: 'Close palette',
    run: "click",
},
changeOption('ColoredLevelBackground', '[data-name="bg_image_toggle_opt"]'),
{
    trigger: '.o_existing_attachment_cell img',
    content: "Select an image in the media dialog",
    run: "click",
},
{
    trigger: `:iframe .${snippets[0].id}.o_cc.o_cc1`,
    run: function () {
        const parts = weUtils.backgroundImageCssToParts(
            getComputedStyle(this.anchor)["background-image"]
        );
        if (!parts.url || !parts.url.startsWith('url(')) {
            throw new Error('An image should have been added as background.');
        }
        if (parts.gradient !== gradients[1]) {
            throw new Error('The gradient should have been kept when adding the background image');
        }
    },
},

// Replace the gradient while there is a background-image
...checkAndUpdateBackgroundColor({
    checkCC: 1,
    checkGradient: gradients[1],
    changeType: 'gradient',
    change: gradients[0],
    finalSelector: `:iframe .${snippets[0].id}.o_cc.o_cc1:not([style*="${gradients[1]}"])`,
    finalRun: function () {
        const parts = weUtils.backgroundImageCssToParts(
            getComputedStyle(this.anchor)["background-image"]
        );
        if (!parts.url || !parts.url.startsWith('url(')) {
            throw new Error('The image should have been kept when changing the gradient');
        }
        if (parts.gradient !== gradients[0]) {
            throw new Error('The gradient should have been changed');
        }
    },
}),

// Customize gradient
changeBackgroundColor(),
switchTo('gradient'),
// Avoid navigating across tabs to maintain current editor state
// Step colors
...updateAndCheckCustomGradient({
    updateStep: {
        trigger: '.colorpicker .o_custom_gradient_scale',
        content: 'Add step',
        run() {
            // TODO: use run: "click", instead
            this.anchor.click();
        }
    },
    checkGradient: 'linear-gradient(135deg, rgb(203, 94, 238) 0%, rgb(203, 94, 238) 0%, rgb(75, 225, 236) 100%)',
}),
...updateAndCheckCustomGradient({
    updateStep: {
        trigger: '.colorpicker .o_slider_multi input.active',
        content: 'Move step',
        run(helpers) {
            this.anchor.value = 45;
            helpers.click();
        },
    },
    checkGradient: 'linear-gradient(135deg, rgb(203, 94, 238) 0%, rgb(203, 94, 238) 45%, rgb(75, 225, 236) 100%)',
}),
...updateAndCheckCustomGradient({
    updateStep: {
        trigger: '.colorpicker .o_color_picker_inputs .o_hex_div input',
        content: 'Pick step color',
        // TODO: remove && click
        run: "edit #FF0000 && click .o_color_picker_inputs",
    },
    checkGradient: 'linear-gradient(135deg, rgb(203, 94, 238) 0%, rgb(255, 0, 0) 45%, rgb(75, 225, 236) 100%)',
}),
...updateAndCheckCustomGradient({
    updateStep: {
        trigger: '.colorpicker .o_remove_color',
        content: 'Delete step',
        run: 'click',
    },
    checkGradient: 'linear-gradient(135deg, rgb(203, 94, 238) 0%, rgb(75, 225, 236) 100%)',
}),
// Linear
...updateAndCheckCustomGradient({
    updateStep: {
        trigger: '.colorpicker input[data-name="angle"]',
        content: 'Change angle',
        run: "edit 50 && click .o_color_picker_inputs",
    },
    checkGradient: 'linear-gradient(50deg, rgb(203, 94, 238) 0%, rgb(75, 225, 236) 100%)',
}),
// Radial
...updateAndCheckCustomGradient({
    updateStep: {
        trigger: '.colorpicker we-button[data-gradient-type="radial-gradient"]',
        content: 'Switch to Radial',
        run: 'click',
    },
    checkGradient: 'radial-gradient(circle farthest-side at 25% 25%, rgb(203, 94, 238) 0%, rgb(75, 225, 236) 100%)',
}),
...updateAndCheckCustomGradient({
    updateStep: {
        trigger: '.colorpicker input[data-name="positionX"]',
        content: 'Change X position',
        run: "edit 33 && click .o_color_picker_inputs",
    },
    checkGradient: 'radial-gradient(circle farthest-side at 33% 25%, rgb(203, 94, 238) 0%, rgb(75, 225, 236) 100%)',
}),
...updateAndCheckCustomGradient({
    updateStep: {
        trigger: '.colorpicker input[data-name="positionY"]',
        content: 'Change Y position',
        run: "edit 75 && click .o_color_picker_inputs",
    },
    checkGradient: 'radial-gradient(circle farthest-side at 33% 75%, rgb(203, 94, 238) 0%, rgb(75, 225, 236) 100%)',
}),
...updateAndCheckCustomGradient({
    updateStep: {
        trigger: '.colorpicker we-button[data-gradient-size="closest-side"]',
        content: 'Change color spread size',
        run: 'click',
    },
    checkGradient: 'radial-gradient(circle closest-side at 33% 75%, rgb(203, 94, 238) 0%, rgb(75, 225, 236) 100%)',
}),
// Revert to predefined gradient
{
    trigger: `.o_we_color_btn[data-color="${gradients[0]}"]`,
    content: `Revert to predefiend gradient ${gradients[0]}`,
    run: 'click',
},

// Replace the gradient by a bg color
...checkAndUpdateBackgroundColor({
    checkCC: 1,
    checkGradient: gradients[0],
    checkNoGradient: gradients[1],
    changeType: 'bg',
    change: 'black-75',
    finalSelector: `:iframe .${snippets[0].id}.o_cc.o_cc1.bg-black-75[style^="background-image: url("]:not([style*="${gradients[0]}"])`
}),

// Re-add a gradient
...checkAndUpdateBackgroundColor({
    checkCC: 1,
    checkBg: 'black-75',
    checkNoGradient: gradients[0],
    changeType: 'gradient',
    change: gradients[1],
    finalSelector: `:iframe .${snippets[0].id}.o_cc.o_cc1:not(.bg-black-75)`,
    finalRun() {
        const parts = weUtils.backgroundImageCssToParts(
            getComputedStyle(this.anchor)["background-image"]
        );
        if (!parts.url || !parts.url.startsWith('url(')) {
            throw new Error('The image should have been kept when re-adding the gradient');
        }
        if (parts.gradient !== gradients[1]) {
            throw new Error('The gradient should have been re-added');
        }
    },
}),

// Final check of color selection and removing the image
...checkAndUpdateBackgroundColor({
    checkCC: 1,
    checkNoBg: 'black-75',
    checkGradient: gradients[1],
}),
changeOption('ColoredLevelBackground', '[data-name="bg_image_toggle_opt"]', 'image toggle', 'top', true),
{
    trigger: `:iframe .${snippets[0].id}.o_cc.o_cc1[style*="background-image: ${gradients[1]}"]`,
},

// Now removing all colors via the 'None' button (note: colorpicker still opened)
{
    trigger: '.o_colorpicker_reset',
    content: "Click on the None button of the color palette",
    run: "click",
},
{
    trigger: `:iframe .${snippets[0].id}:not(.o_cc):not(.o_cc1):not([style*="background-image"])`,
    content: "All color classes and properties should have been removed",
}
]);

return __exports;
});
;

/***************************************************************************
*  Filepath: /website/static/tests/tours/snippet_cache_across_websites.js  *
*  Lines: 42                                                               *
***************************************************************************/
odoo.define('@website/../tests/tours/snippet_cache_across_websites', ['@website/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const {
    clickOnEditAndWaitEditMode,
    clickOnSave,
    registerWebsitePreviewTour,
    testSwitchWebsite,
} = require('@website/js/tours/tour_utils');

registerWebsitePreviewTour('snippet_cache_across_websites', {
    edition: true,
    url: '/@/'
}, () => [
    {
        content: "Click on the Custom category block",
        trigger: "#oe_snippets .oe_snippet[name='Custom'].o_we_draggable .oe_snippet_thumbnail",
        run: "click",
    },
    {
        content: "Ensure custom snippet preview appeared in the dialog",
        trigger: ":iframe .o_snippet_preview_wrap[data-snippet-id='s_text_block'] section[data-name='custom_snippet_test']",
    },
    {
        content: "Close the 'add snippet' dialog",
        trigger: ".o_add_snippet_dialog .modal-header .btn-close",
        run: "click",
    },
    // There's no need to save, but canceling might or might not show a popup...
    ...clickOnSave(),
    ...testSwitchWebsite('Test Website'),
    ...clickOnEditAndWaitEditMode(),
    {
        content: "Check that the custom snippet category is not here",
        trigger: "#oe_snippets:not(:has(.oe_snippet[name='Custom']))",
    },
]);

return __exports;
});
;

/***************************************************************
*  Filepath: /website/static/tests/tours/snippet_countdown.js  *
*  Lines: 61                                                   *
***************************************************************/
odoo.define('@website/../tests/tours/snippet_countdown', ['@website/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module */

const {
    changeOption,
    clickOnSnippet,
    insertSnippet,
    registerWebsitePreviewTour,
} = require('@website/js/tours/tour_utils');

registerWebsitePreviewTour('snippet_countdown', {
    url: '/',
    edition: true,
}, () => [
    ...insertSnippet({id: "s_countdown", name: "Countdown", groupName: "Content"}),
    ...clickOnSnippet({id: 's_countdown', name: 'Countdown'}),
    changeOption('countdown', 'we-select:has([data-end-action]) we-toggler', 'end action'),
    changeOption('countdown', 'we-button[data-end-action="message"]', 'end action'),
    changeOption('countdown', 'we-button.toggle-edit-message', 'message preview'),
    // The next two steps check that the end message does not disappear when a
    // widgets_start_request is triggered.
    {
        content: "Hover an option which has a preview",
        trigger: '[data-select-class="o_half_screen_height"]',
        run: "hover",
    },
    {
        content: "Check that the countdown message is still displayed",
        trigger: ':iframe .s_countdown .s_picture',
        run() {
            // Just a visibility check

            // Also make sure the mouseout and mouseleave are triggered so that
            // next steps make sense.
            // TODO the next steps are not actually testing anything without
            // it and the mouseout and mouseleave make sense but really it
            // should not be *necessary* to simulate those for the editor flow
            // to make some sense.
            const previousAnchor = document.querySelector('[data-select-class="o_half_screen_height"]');
            previousAnchor.dispatchEvent(new Event("mouseout"));
            previousAnchor.dispatchEvent(new Event("mouseleave"));
        },
    },
    // Next, we change the end action to message and no countdown while the edit
    // message toggle is still activated. It should hide the countdown
    changeOption('countdown', 'we-select:has([data-end-action]) we-toggler', 'end action'),
    changeOption('countdown', 'we-button[data-end-action="message_no_countdown"]', 'end action'),
    {
        content: "Check that the countdown is not displayed",
        trigger: ':iframe .s_countdown:has(.s_countdown_canvas_wrapper:not(:visible))',
    },
    {
        content: "Check that the message is still displayed",
        trigger: ':iframe .s_countdown .s_picture',
    },
]);

return __exports;
});
;

/**************************************************************************
*  Filepath: /website/static/tests/tours/snippet_editor_panel_options.js  *
*  Lines: 219                                                             *
**************************************************************************/
odoo.define('@website/../tests/tours/snippet_editor_panel_options', ['@website/js/tours/tour_utils', '@web/core/browser/browser'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module */

const {
    changeOption,
    clickOnSave,
    insertSnippet,
    goBackToBlocks,
    registerWebsitePreviewTour,
} = require('@website/js/tours/tour_utils');
const { browser } = require('@web/core/browser/browser');

registerWebsitePreviewTour('snippet_editor_panel_options', {
    url: '/',
    edition: true,
}, () => [
...insertSnippet({
    id: 's_text_image',
    name: 'Text - Image',
    groupName: "Content",
}),
// Test keeping the text selection when using the width option.
{
    content: "Click on the first paragraph.",
    trigger: ':iframe .s_text_image p',
    run: "click",
}, {
    content: "The text toolbar should be visible. The paragraph should be selected.",
    trigger: '#oe_snippets .o_we_customize_panel > #o_we_editor_toolbar_container',
    run() {
        const iframeDocument = document.querySelector('.o_iframe').contentDocument;
        const pText = iframeDocument.querySelector('.s_text_image p').textContent;
        const selection = iframeDocument.getSelection().toString();
        if (pText !== selection) {
            console.error("The paragraph was not correctly selected.");
        }
    },
}, {
    content: "Click on the width option.",
    trigger: '[data-select-class="o_container_small"]',
    run: "click",
}, {
    content: "The snippet should have the correct class.",
    trigger: ':iframe .s_text_image > .o_container_small',
}, {
    content: "The text toolbar should still be visible, and the text still selected.",
    trigger: '#oe_snippets .o_we_customize_panel > #o_we_editor_toolbar_container',
    run() {
        const iframeDocument = document.querySelector('.o_iframe').contentDocument;
        const pText = iframeDocument.querySelector('.s_text_image p').textContent;
        const selection = iframeDocument.getSelection().toString();
        if (pText !== selection) {
            console.error("The paragraph text selection was lost.");
        }
    },
},
// Test the anchor option.
{
    content: "Click on the anchor option",
    trigger: '#oe_snippets .snippet-option-anchor we-button',
    async run(helpers) {
        // Patch and ignore write on clipboard in tour as we don't have permissions
        const oldWriteText = browser.navigator.clipboard.writeText;
        browser.navigator.clipboard.writeText = () => { console.info('Copy in clipboard ignored!') };
        await helpers.click();
        browser.navigator.clipboard.writeText = oldWriteText;
    }
}, {
    content: "Check the copied url from the notification toast",
    trigger: '.o_notification_manager .o_notification_content',
    run() {
        const { textContent } = this.anchor;
        const url = textContent.substring(textContent.indexOf('/'));

        // The url should not target the client action
        if (url.startsWith('/@')) {
            console.error('The anchor option should target the frontend');
        }

        const iframeDocument = document.querySelector('.o_iframe').contentDocument;
        const snippetId = iframeDocument.querySelector('.s_text_image').id;
        if (!url || url.indexOf(snippetId) < 0) {
            console.error('The anchor option does not target the correct snippet.');
        }
    },
},
// Test keeping the text selection when adding columns to a snippet with none.
goBackToBlocks(),
...insertSnippet({
    id: 's_text_block',
    name: 'Text',
    groupName: "Text",
}),
{
    content: "Click on the first paragraph.",
    trigger: ':iframe .s_text_block p',
    run: "click",
}, {
    content: "The text toolbar should be visible. The paragraph should be selected.",
    trigger: '#oe_snippets .o_we_customize_panel > #o_we_editor_toolbar_container',
    run() {
        const iframeDocument = document.querySelector('.o_iframe').contentDocument;
        const pText = iframeDocument.querySelector('.s_text_block p').textContent;
        const selection = iframeDocument.getSelection().toString();
        if (pText !== selection) {
            console.error("The paragraph was not correctly selected.");
        }
    },
}, {
    content: "Click on the columns option.",
    trigger: '.snippet-option-layout_column we-select',
    run: "click",
},
{
    content: "Change the number of columns.",
    trigger: '.snippet-option-layout_column [data-select-count="3"]',
    run: "click",
}, {
    content: "The snippet should have the correct number of columns.",
    trigger: ':iframe .s_text_block .container > .row .col-lg-4:eq(3)',
    run() {
        if (this.anchor.childElementCount !== 3) {
            console.error("The snippet does not have the correct number of columns");
        }
    },
}, {
    content: "The text toolbar should still be visible, and the text still selected.",
    trigger: '#oe_snippets .o_we_customize_panel > #o_we_editor_toolbar_container',
    run() {
        const iframeDocument = document.querySelector('.o_iframe').contentDocument;
        const pText = iframeDocument.querySelector('.s_text_block p').textContent;
        const selection = iframeDocument.getSelection().toString();
        if (pText !== selection) {
            console.error("The paragraph text selection was lost.");
        }
    },
},
// Test keeping the text selection when removing all columns of a snippet.
{
    content: "Click on the columns option.",
    trigger: '.snippet-option-layout_column we-select',
    run: "click",
},
{
    content: "Change the number of columns.",
    trigger: '.snippet-option-layout_column [data-select-count="0"]',
    run: "click",
}, {
    content: "The snippet should have the correct number of columns.",
    trigger: ':iframe .s_text_block .container:not(:has(.row))',
}, {
    content: "The text toolbar should still be visible, and the text still selected.",
    trigger: '#oe_snippets .o_we_customize_panel > #o_we_editor_toolbar_container',
    run() {
        const iframeDocument = document.querySelector('.o_iframe').contentDocument;
        const pText = iframeDocument.querySelector('.s_text_block p').textContent;
        const selection = iframeDocument.getSelection().toString();
        if (pText !== selection) {
            console.error("The paragraph text selection was lost.");
        }
    },
},
// Test keeping the text selection when toggling the grid mode.
changeOption("layout_column", 'we-button[data-name="grid_mode"]'),
{
    content: "The snippet row should have the grid mode class.",
    trigger: ":iframe .s_text_block .row.o_grid_mode",
}, {
    content: "The text toolbar should still be visible, and the text still selected.",
    trigger: "#oe_snippets .o_we_customize_panel > #o_we_editor_toolbar_container",
    run() {
        const iframeDocument = document.querySelector(".o_iframe").contentDocument;
        const pText = iframeDocument.querySelector(".s_text_block p").textContent;
        const selection = iframeDocument.getSelection().toString();
        if (pText !== selection) {
            console.error("The paragraph text selection was lost.");
        }
    },
},
// Test keeping the text selection when toggling back the normal mode.
changeOption("layout_column", 'we-button[data-name="normal_mode"]'),
{
    content: "The snippet row should not have the grid mode class anymore.",
    trigger: ":iframe .s_text_block .row:not(.o_grid_mode)",
}, {
    content: "The text toolbar should still be visible, and the text still selected.",
    trigger: "#oe_snippets .o_we_customize_panel > #o_we_editor_toolbar_container",
    run() {
        const iframeDocument = document.querySelector(".o_iframe").contentDocument;
        const pText = iframeDocument.querySelector(".s_text_block p").textContent;
        const selection = iframeDocument.getSelection().toString();
        if (pText !== selection) {
            console.error("The paragraph text selection was lost.");
        }
    },
},
// Test close dropdowns if click anywhere outside the dropdown
{
    content: "Open text style dropdown.",
    trigger: "#style button.dropdown-toggle",
    run: "click",
}, {
    content: "Check if dropdown opened correctly.",
    trigger: "#style button[data-bs-toggle=dropdown][aria-expanded=true]",
}, {
    content: "Click on the first paragraph again.",
    trigger: ":iframe .s_text_block p",
    run: "click",
}, {
    content: "Check if dropdown closed correctly.",
    trigger: "#style button[data-bs-toggle=dropdown][aria-expanded=false]",
},
...clickOnSave(),
]);

return __exports;
});
;

/*****************************************************************************
*  Filepath: /website/static/tests/tours/snippet_empty_parent_autoremove.js  *
*  Lines: 88                                                                 *
*****************************************************************************/
odoo.define('@website/../tests/tours/snippet_empty_parent_autoremove', ['@website/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const {
    changeOption,
    clickOnSnippet,
    insertSnippet,
    registerWebsitePreviewTour,
} = require("@website/js/tours/tour_utils");

function removeSelectedBlock() {
    return {
        content: "Remove selected block",
        trigger: '#oe_snippets we-customizeblock-options:nth-last-child(3) .oe_snippet_remove',
        run: "click",
    };
}

registerWebsitePreviewTour('snippet_empty_parent_autoremove', {
    url: '/',
    edition: true,
}, () => [
    // Base case: remove both columns from text - image
    ...insertSnippet({
        id: 's_text_image',
        name: 'Text - Image',
        groupName: "Content",
    }),
    {
        content: "Click on second column",
        trigger: ':iframe #wrap .s_text_image .row > :nth-child(2)',
        run: "click",
    },
    removeSelectedBlock(),
    {
        content: "Click on first column",
        trigger: ':iframe #wrap .s_text_image .row > :first-child',
        run: "click",
    },
    removeSelectedBlock(),
    {
        content: "Check that #wrap is empty",
        trigger: ':iframe #wrap:empty',
    },

    // Cover: test that parallax, bg-filter and shape are not treated as content
    ...insertSnippet({
        id: 's_cover',
        name: 'Cover',
        groupName: "Intro",
    }),
    ...clickOnSnippet({
        id: 's_cover',
        name: 'Cover',
    }),
    // Add a shape
    changeOption('ColoredLevelBackground', 'Shape'),
    {
        content: "Check that the parallax element is present",
        trigger: ':iframe #wrap .s_cover .s_parallax_bg',
    },
    {
        content: "Check that the filter element is present",
        trigger: ':iframe #wrap .s_cover .o_we_bg_filter',
    },
    {
        content: "Check that the shape element is present",
        trigger: ':iframe #wrap .s_cover .o_we_shape',
    },
    // Add a column
    changeOption('layout_column', 'we-toggler'),
    changeOption('layout_column', '[data-select-count="1"]'),
    {
        content: "Click on the created column",
        trigger: ':iframe #wrap .s_cover .row > :first-child',
        run: "click",
    },
    removeSelectedBlock(),
    {
        content: "Check that #wrap is empty",
        trigger: ':iframe #wrap:empty',
    },
]);

return __exports;
});
;

/***********************************************************
*  Filepath: /website/static/tests/tours/snippet_image.js  *
*  Lines: 52                                               *
***********************************************************/
odoo.define('@website/../tests/tours/snippet_image', ['@website/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const {insertSnippet, registerWebsitePreviewTour } = require("@website/js/tours/tour_utils");

registerWebsitePreviewTour("snippet_image", {
    url: "/",
    edition: true,
}, () => [
    ...insertSnippet({id: "s_image", name: "Image"}),
{
    content: "Verify if the media dialog opens",
    trigger: ".o_select_media_dialog",
},
{
    content: "Close the media dialog",
    trigger: ".o_select_media_dialog .btn-close",
    run: "click",
},
{
    content: "Verify if the image placeholder has been removed",
    trigger: ":iframe footer:not(:has(.s_image > svg))",
},
    ...insertSnippet({id: "s_image", name: "Image"}),
{
    content: "Verify that the image placeholder is within the page",
    trigger: ":iframe footer .s_image > svg",
},
{
    content: "Click on the image",
    trigger: ".o_select_media_dialog .o_we_media_dialog_img_wrapper img",
    run: "click",
},
{
    content: "Verify if the image has been added in the footer and if the image placeholder has been removed",
    trigger: ":iframe footer:not(:has(.s_image > svg)) img.o_we_custom_image",
},
{
    content: "Click on the 'undo' button",
    trigger: '#oe_snippets button.fa-undo',
    run: "click",
},
{
    content: "Check that the image and the image placeholder have been removed",
    trigger: ":iframe footer:not(:has(.s_image > svg)):not(:has(img.o_we_custom_image))",
},
]);

return __exports;
});
;

/*******************************************************************
*  Filepath: /website/static/tests/tours/snippet_image_gallery.js  *
*  Lines: 163                                                      *
*******************************************************************/
odoo.define('@website/../tests/tours/snippet_image_gallery', ['@website/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module */

const {
    addMedia,
    changeOption,
    clickOnSave,
    clickOnSnippet,
    insertSnippet,
    registerWebsitePreviewTour,
} = require('@website/js/tours/tour_utils');

registerWebsitePreviewTour('snippet_image_gallery', {
    url: '/',
    edition: true,
}, () => [
    ...insertSnippet({id: 's_images_wall', name: 'Images Wall', groupName: "Images"}),
    ...clickOnSave(),
    {
        content: 'Click on an image of the Image Wall',
        trigger: ':iframe .s_image_gallery img',
        run: 'click',
    },
    {
        content: 'Check that the modal has opened properly',
        trigger: ':iframe .s_gallery_lightbox img',
    },
]);

registerWebsitePreviewTour("snippet_image_gallery_remove", {
    url: "/",
    edition: true,
}, () => [
    ...insertSnippet({
        id: "s_image_gallery",
        name: "Image Gallery",
        groupName: "Images",
}),
...clickOnSnippet({
    id: 's_image_gallery',
    name: 'Image Gallery',
}), {
    content: "Click on Remove all",
    trigger: "we-button:has(div:contains('Remove all'))",
    run: "click",
}, {
    content: "Click on Add Images",
    trigger: ":iframe span:contains('Add Images')",
    run: "click",
}, {
    content: "Click on the first new image",
    trigger: ".o_select_media_dialog img[title='s_default_image.jpg']",
    run: "click",
}, {
    content: "Click on the second new image",
    trigger: ".o_select_media_dialog img[title='s_default_image2.jpg']",
    run: "click",
},
    addMedia(),
   {
    content: "Click on the image of the Image Gallery snippet",
    trigger: ":iframe .s_image_gallery .carousel-item.active  img",
    run: "click",
}, {
    content: "Check that the Snippet Editor of the clicked image has been loaded",
    trigger: "we-customizeblock-options span:contains('Image'):not(:contains('Image Gallery'))",
}, {
    content: "Click on Remove Block",
    trigger: ".o_we_customize_panel we-title:has(span:contains('Image Gallery')) we-button[title='Remove Block']",
    run: "click",
}, {
    content: "Check that the Image Gallery snippet has been removed",
    trigger: ":iframe #wrap:not(:has(.s_image_gallery))",
}]);

registerWebsitePreviewTour("snippet_image_gallery_reorder", {
    url: "/",
    edition: true,
}, () => [
    ...insertSnippet({
        id: "s_image_gallery",
        name: "Image Gallery",
        groupName: "Images",
    }),
{
    content: "Click on the first image of the snippet",
    trigger: ":iframe .s_image_gallery .carousel-item.active img",
    run: "click",
},
    changeOption('ImageTools', 'we-select:contains("Filter") we-toggler'),
    changeOption('ImageTools', '[data-gl-filter="blur"]'),
{
    content: "Check that the image has the correct filter",
    trigger: ".snippet-option-ImageTools we-select:contains('Filter') we-toggler:contains('Blur')",
}, {
    content: "Click on move to next",
    trigger: ".snippet-option-GalleryElement we-button[data-position='next']",
    run: "click",
}, {
    content: "Check that the image has been moved",
    trigger: ":iframe .s_image_gallery .carousel-item.active img[data-index='1']",
}, {
    content: "Click on the footer to reload the editor panel",
    trigger: ":iframe #footer",
    run: "click",
}, {
    content: "Check that the footer options have been loaded",
    trigger: ".snippet-option-HideFooter we-button:contains('Page Visibility')",
}, {
    content: "Click on the moved image",
    trigger: ":iframe .s_image_gallery .carousel-item.active img[data-index='1'][data-gl-filter='blur']",
    run: "click",
}, {
    content: "Check that the image still has the correct filter",
    trigger: ".snippet-option-ImageTools we-select:contains('Filter') we-toggler:contains('Blur')",
}, {
    content: "Click to access next image",
    trigger: ":iframe .s_image_gallery .carousel-control-next",
    run: "click",
}, {
    content: "Check that the option has changed",
    trigger: ".snippet-option-ImageTools we-select:contains('Filter') we-toggler:not(:contains('Blur'))",
}, {
    content: "Click to access previous image",
    trigger: ":iframe .s_image_gallery .carousel-control-prev",
    run: "click",
}, {
    content: "Check that the option is restored",
    trigger: ".snippet-option-ImageTools we-select:contains('Filter') we-toggler:contains('Blur')",
}]);

registerWebsitePreviewTour("snippet_image_gallery_thumbnail_update", {
    url: "/",
    edition: true,
}, () => [
    ...insertSnippet({
        id: "s_image_gallery",
        name: "Image Gallery",
        groupName: "Images",
    }),
    ...clickOnSnippet({
        id: "s_image_gallery",
        name: "Image Gallery",
    }),
    changeOption("GalleryImageList", "we-button[data-add-images]"),
{
    content: "Click on the default image",
    trigger: ".o_select_media_dialog img[title='s_default_image.jpg']",
    run: "click",
},
    addMedia(),
{
    content: "Check that the new image has been added",
    trigger: ":iframe .s_image_gallery:has(img[data-index='3'])",
}, {
    content: "Check that the thumbnail of the first image has not been changed",
    trigger: ":iframe .s_image_gallery div.carousel-indicators button:first-child[style='background-image: url(/web/image/website.library_image_08)']",
}]);

return __exports;
});
;

/*******************************************************************
*  Filepath: /website/static/tests/tours/snippet_image_quality.js  *
*  Lines: 59                                                       *
*******************************************************************/
odoo.define('@website/../tests/tours/snippet_image_quality', ['@website/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module */

const { insertSnippet, registerWebsitePreviewTour } = require("@website/js/tours/tour_utils");

registerWebsitePreviewTour('website_image_quality', {
    url: '/',
    edition: true,
}, () => [
    ...insertSnippet({
        id: 's_text_image',
        name: 'Text - Image',
        groupName: "Content",
    }),
    {
        content: "Select image",
        trigger: ':iframe .s_text_image img',
        run: "click",
    },
    {
        content: "Set low quality",
        trigger: 'we-customizeblock-options:has(we-title:contains("Image")) we-range[data-set-quality] input',
        run: 'range 5',
    },
    {
        content: "Wait for image update: NOT original image",
        trigger: ':iframe .s_text_image img:not([src$="s_text_image_default_image"])',
    },
    {
        content: "Check image size",
        // Reached size cannot be hardcoded because it changes with
        // different versions of Chrome.
        trigger: 'we-customizeblock-options:has(we-title:contains("Image")) .o_we_image_weight:contains(" kb"):not(:contains("42.9 kb"))',
        run() {
            // Make sure the reached size is smaller than the original one.
            if (parseFloat(this.anchor.innerText) >= 42.9) {
                throw new Error("Image size should be smaller than original");
            }
        },
    },
    {
        content: "Set high quality",
        trigger: 'we-customizeblock-options:has(we-title:contains("Image")) we-range[data-set-quality] input',
        run: 'range 99',
    },
    {
        content: "Wait for image update: back to original image",
        trigger: ':iframe .s_text_image img[src$="LRQeyj8rLxXuVHZYnLENbMShuqm5A0slYRpf/AP/Z"]',
    },
    {
        content: "Check image size",
        trigger: 'we-customizeblock-options:has(we-title:contains("Image")) .o_we_image_weight:contains("42.9")',
    },
]);

return __exports;
});
;

/*****************************************************************
*  Filepath: /website/static/tests/tours/snippet_images_wall.js  *
*  Lines: 128                                                    *
*****************************************************************/
odoo.define('@website/../tests/tours/snippet_images_wall', ['@website/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const {clickOnSnippet, insertSnippet, registerWebsitePreviewTour } = require("@website/js/tours/tour_utils");

const wallRaceConditionClass = "image_wall_race_condition";
const preventRaceConditionSteps = [{
    content: "Wait a few ms to avoid race condition",
    // Ensure the class is remove from previous call of those steps
    trigger: `body:not(.${wallRaceConditionClass})`,
    run() {
        setTimeout(() => {
            document.body.classList.add(wallRaceConditionClass);
        }, 500);
    }
}, {
    content: "Check the race condition class is added after a few ms",
    trigger: `body.${wallRaceConditionClass}`,
    run() {
        document.body.classList.remove(wallRaceConditionClass);
    }
}];

const selectSignImageStep = [
    {
        trigger: ".o_we_customize_panel:not(:has(.snippet-option-GalleryElement))",
    },
    {
        content: "Click on image 14",
        trigger: ":iframe .s_image_gallery img[data-original-src*='library_image_14']",
        run: "click",
    },
];
// Without reselecting the image, the tour manages to click on the
// move button before the active image is updated.

// We need to wait a few ms before clicking on the footer because after
// clicking on reposition option, there may be a delay during the click on
// another block would be ignored.
const reselectSignImageSteps = [
    ...preventRaceConditionSteps,
    {
        trigger: ":iframe .s_image_gallery .o_masonry_col:nth-child(2):has(img[data-index='1'])",
    },
    {
        content: "Select footer",
        trigger: ":iframe footer",
        run: "click",
    },
    ...selectSignImageStep,
];

registerWebsitePreviewTour("snippet_images_wall", {
    url: "/",
    edition: true,
}, () => [
    ...insertSnippet({
        id: "s_images_wall",
        name: "Images Wall",
        groupName: "Images",
}),
...clickOnSnippet({
    id: "s_image_gallery",
    name: "Images Wall",
}),
        ...selectSignImageStep,
{
    content: "Click on add a link",
    trigger: ".snippet-option-ReplaceMedia we-button[data-set-link]",
    run: "click",
}, {
    content: "Change the link of the image",
    trigger: ".snippet-option-ReplaceMedia [data-set-url] input",
    // TODO: This should not be needed, but there seems to be an odd behavior
    // with the input not properly blurring when clicking on the reorder
    // buttons. However this is also the case in older versions. It
    // only crashes here because there is also a change in the tour framework
    // now using hoot.
    run: "edit /contactus && click body",
}, {
    content: "Click on move to previous",
    trigger: ".snippet-option-GalleryElement we-button[data-position='prev']",
    run: "click",
}, {
    content: "Check if sign is in second column",
    trigger: ":iframe .s_image_gallery .o_masonry_col:nth-child(2):has(a[href='/contactus'] img[data-index='1'][data-original-src*='library_image_14'])",
},
...reselectSignImageSteps,
{
    content: "Click on move to first",
    trigger: ".snippet-option-GalleryElement we-button[data-position='first']",
    run: "click",
}, {
    content: "Check if sign is in first column",
    trigger: ":iframe .s_image_gallery .o_masonry_col:nth-child(1):has(img[data-index='0'][data-original-src*='library_image_14'])",
},
...reselectSignImageSteps,
{
    content: "Click on move to previous",
    trigger: ".snippet-option-GalleryElement we-button[data-position='prev']",
    run: "click",
}, {
    content: "Check if sign is in third column",
    trigger: ":iframe .s_image_gallery .o_masonry_col:nth-child(3):has(img[data-index='5'][data-original-src*='library_image_14'])",
},
...reselectSignImageSteps,
{
    content: "Click on move to next",
    trigger: ".snippet-option-GalleryElement we-button[data-position='next']",
    run: "click",
}, {
    content: "Check if sign is in first column",
    trigger: ":iframe .s_image_gallery .o_masonry_col:nth-child(1):has(img[data-index='0'][data-original-src*='library_image_14'])",
},
...reselectSignImageSteps,
{
    content: "Click on move to last",
    trigger: ".snippet-option-GalleryElement we-button[data-position='last']",
    run: "click",
}, {
    content: "Check layout",
    trigger: ":iframe .s_image_gallery .o_masonry_col:nth-child(3):has(img[data-index='5'][data-original-src*='library_image_14'])",
}]);

return __exports;
});
;

/**********************************************************************
*  Filepath: /website/static/tests/tours/snippet_popup_add_remove.js  *
*  Lines: 78                                                          *
**********************************************************************/
odoo.define('@website/../tests/tours/snippet_popup_add_remove', ['@website/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module */

const {
    clickOnEditAndWaitEditMode,
    clickOnSave,
    insertSnippet,
    registerWebsitePreviewTour,
} = require('@website/js/tours/tour_utils');

registerWebsitePreviewTour('snippet_popup_add_remove', {
    url: '/',
    edition: true,
}, () => [
    ...insertSnippet({
        name: "Popup",
        id: "s_popup",
        groupName: "Content",
}), {
    content: 'Edit s_popup snippet',
    trigger: ':iframe #wrap.o_editable [data-snippet="s_popup"] .row > div', // Click deep in the snippet structure
    run: "click",
}, {
    content: 'Check s_popup setting are loaded, wait panel is visible',
    trigger: '.o_we_customize_panel',
},
...clickOnSave(),
...clickOnEditAndWaitEditMode(),
{
    content: 'Toggle the visibility of the Popup',
    trigger: '.o_we_invisible_el_panel .o_we_invisible_entry:contains("Popup")',
    run: "click",
}, {
    content: 'Edit s_popup snippet(2)',
    trigger: ':iframe #wrap.o_editable [data-snippet="s_popup"] h2',
    run: function() {
        // Simulating pressing enter.
        const anchor = this.anchor;
        // Trick the editor into keyboardType === 'PHYSICAL' and press enter
        anchor.dispatchEvent(new KeyboardEvent("keydown", { key: "Enter", bubbles: true }));
        // Trigger editor's '_onInput' handler, which leads to historyRollback.
        anchor.dispatchEvent(new InputEvent('input', { inputType: 'insertLineBreak', bubbles: true }));
    }
}, {
    content: 'Check the s_popup was visible',
    trigger: ':iframe #wrapwrap:has([data-snippet="s_popup"]:not(.d-none))',
}, {
    content: `Remove the s_popup snippet`,
    trigger: '.o_we_customize_panel we-customizeblock-options:contains("Popup") we-button.oe_snippet_remove:first',
    run: "click",
}, {
    content: 'Check the s_popup was removed',
    trigger: ':iframe #wrap.o_editable:not(:has([data-snippet="s_popup"]))',
},
// Test that undoing dropping the snippet removes the invisible elements panel.
...insertSnippet({
    name: "Popup",
    id: "s_popup",
    groupName: "Content",
}), {
    content: "The popup should be in the invisible elements panel.",
    trigger: '.o_we_invisible_el_panel .o_we_invisible_entry',
}, {
    content: "Click on the 'undo' button.",
    trigger: '#oe_snippets button.fa-undo',
    run: "click",
}, {
    content: "Check that the s_popup was removed.",
    trigger: ':iframe #wrap.o_editable:not(:has([data-snippet="s_popup"]))',
}, {
    content: "The invisible elements panel should also be removed.",
    trigger: '#oe_snippets:not(:has(.o_we_invisible_el_panel)',
}]);

return __exports;
});
;

/**************************************************************************
*  Filepath: /website/static/tests/tours/snippet_popup_and_animations.js  *
*  Lines: 222                                                             *
**************************************************************************/
odoo.define('@website/../tests/tours/snippet_popup_and_animations', ['@website/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module */

const {
    changeOption,
    clickOnEditAndWaitEditMode,
    clickOnElement,
    clickOnSave,
    insertSnippet,
    registerWebsitePreviewTour,
} = require("@website/js/tours/tour_utils");

const snippets = [
    {
        id: "s_popup",
        name: "Popup",
        groupName: "Content",
    },
    {
        id: "s_media_list",
        name: "Media List",
        groupName: "Content",
    },
    {
        id: "s_three_columns",
        name: "Columns",
        groupName: "Columns",
    },
];

const setOnScrollAnim = function () {
    return [
        changeOption("WebsiteAnimate", 'we-select[data-is-animation-type-selection="true"] we-toggler'),
        changeOption("WebsiteAnimate", 'we-button[data-animation-mode="onScroll"]'),
        changeOption("WebsiteAnimate", 'we-select[data-name="animation_effect_opt"] we-toggler'),
        changeOption("WebsiteAnimate", 'we-button[data-name="o_anim_slide_in_opt"]'),
    ];
};

registerWebsitePreviewTour("snippet_popup_and_animations", {
    url: "/",
    edition: true,
}, () => [
    ...insertSnippet(snippets[1]), // Media List
    ...insertSnippet(snippets[1]), // Media List
    ...insertSnippet(snippets[2]), // Columns
    clickOnElement("3rd columns", ":iframe .s_three_columns .row > :last-child"),
    ...setOnScrollAnim(),
    {
        content: "Open the Cookies Bar.",
        trigger: ".o_we_invisible_el_panel .o_we_invisible_entry",
        run: "click",
    },
    {
        trigger: ":iframe #website_cookies_bar:not(.d-none):not(:visible)",
    },
    {
        content: "Scroll to top",
        trigger: ":iframe html",
        run() {
            const animatedColumnEl = this.anchor.querySelector(".s_three_columns .row > :last-child");
            // When the animated element is fully visible, its animation delay
            // should be rounded to -1 in the following condition.
            if (Math.round(parseFloat(animatedColumnEl.style.animationDelay)) !== -1) {
                throw new Error("The scroll animation in the page did not start properly with the cookies bar open.");
            }
            this.anchor.scrollTo({
                top: 0,
                left: 0,
                behavior: 'smooth'
            });
        },
    },
    {
        trigger: ":iframe header#top:not(.o_header_affixed)",
    },
    {
        content: "Wait for the page to be scrolled to the top.",
        trigger: ":iframe .s_three_columns .row > :last-child:not(.o_animating)",
        run() {
            // If the column has been animated successfully, the animation delay
            // should be set to approximately zero when it is not visible.
            // The main goal of the following condition is to verify if the
            // animation delay is being updated as expected.
            if (Math.round(parseFloat(this.anchor.style.animationDelay)) !== 0) {
                throw new Error("The scroll animation in the page did not end properly with the cookies bar open.");
            }
        },
    },
    {
        content: "Close the Cookies Bar.",
        trigger: ".o_we_invisible_el_panel .o_we_invisible_entry",
        run: "click",
    },
    ...insertSnippet(snippets[0]), // Popup
    ...insertSnippet(snippets[1]), // Media List
    {
        trigger: ".o_website_preview.editor_enable.editor_has_snippets",
    },
    {
        content: "Drag the Columns snippet group and drop it at the bottom of the popup.",
        trigger: '#oe_snippets .oe_snippet[name="Columns"] .oe_snippet_thumbnail:not(.o_we_ongoing_insertion)',
        run: "drag_and_drop :iframe #wrap .s_popup .modal-content.oe_structure .oe_drop_zone:last",
    },
    {
        content: "Click on the s_three_columns snippet.",
        trigger: ':iframe .o_snippet_preview_wrap[data-snippet-id="s_three_columns"]',
        run: "click",
    },
    clickOnElement("3rd columns", ":iframe .s_popup .s_three_columns .row > :last-child"),
    ...setOnScrollAnim(),
    {
        content: "Verify the animation delay of the animated element in the popup at the beginning",
        trigger: ":iframe .s_popup .modal",
        run() {
            const animatedColumnEl = this.anchor.querySelector(".s_three_columns .row > :last-child");
            // When the animated element is fully visible, its animation delay
            // should be rounded to -1 in the following condition.
            if (Math.round(parseFloat(animatedColumnEl.style.animationDelay)) !== -1) {
                throw new Error("The scroll animation in the modal did not start properly.");
            }
            this.anchor.closest(".modal").scrollTo({
                top: 0,
                left: 0,
                behavior: 'smooth'
            });
        },
    },
    {
        content: "Wait until the column is no longer animated/visible.",
        trigger: ":iframe .s_popup .s_three_columns .row > :last-child:not(:has(.o_animating))",
        async run() {
            //TODO: understand why we now wait 500ms before check the condition
            await new Promise((r) => setTimeout(r, 500));
            // If the column has been animated successfully, the animation delay
            // should be set to approximately zero when it is not visible.
            if (Math.round(parseFloat(this.anchor.style.animationDelay)) !== 0) {
                throw new Error("The scroll animation in the modal did not end properly.");
            }
        },
    },
    {
        content: "Close the Popup",
        trigger: ".o_we_invisible_el_panel .o_we_invisible_entry:contains('Popup') i.fa-eye",
        run: "click",
    },
    {
        content: "Check that the popup has been closed",
        trigger: ".o_we_invisible_el_panel .o_we_invisible_entry:contains('Popup') i.fa-eye-slash",
    },
    clickOnElement("Last image of the 'Columns' snippet", ":iframe .s_three_columns .o_animate_on_scroll img"),
    changeOption("WebsiteAnimate", 'we-toggler:contains("None")'),
    changeOption("WebsiteAnimate", 'we-button[data-animation-mode="onHover"]'),
    {
        trigger: ".snippet-option-WebsiteAnimate we-row:contains('Animation') we-select[data-is-animation-type-selection] we-toggler:contains('On Hover')",
    },
    {
        content: "Check that the hover effect animation has been applied on the image",
        trigger: ":iframe .s_three_columns .o_animate_on_scroll img[data-hover-effect='overlay']",
    },
    ...clickOnSave(),
    ...clickOnEditAndWaitEditMode(),
    clickOnElement("Image of the 'Columns' snippet with the overlay effect", ":iframe .s_three_columns .o_animate_on_scroll img[data-hover-effect='overlay']"),
    changeOption("WebsiteAnimate", 'we-toggler:contains("Overlay")'),
    changeOption("WebsiteAnimate", 'we-button[data-select-data-attribute="outline"]'),
    {
        trigger: ".snippet-option-WebsiteAnimate we-select[data-attribute-name='hoverEffect'] we-toggler:contains('Outline')",
    },
    {
        content: "Check that the outline effect has been applied on the image",
        trigger: ":iframe .s_three_columns .o_animate_on_scroll img[data-hover-effect='outline']",
    },
    ...clickOnSave(),
    {
        content: "Check that the image src is not the raw data",
        trigger: ":iframe .s_three_columns .o_animate_on_scroll img[data-hover-effect='outline']",
        run() {
            const imgEl = document.querySelector("iframe").contentDocument.querySelector(".s_three_columns .o_animate_on_scroll img[data-hover-effect='outline']");
            const src = imgEl.getAttribute("src");
            if (src.startsWith("data:image")) {
                throw new Error("The image source should not be raw data after the editor save");
            }
        },
    },
    ...clickOnEditAndWaitEditMode(),
    clickOnElement("Image of the 'Columns' snippet with the outline effect", ":iframe .s_three_columns .o_animate_on_scroll img[data-hover-effect='outline']"),
    changeOption("ImageTools", 'we-select:contains("Filter") we-toggler:contains("None")'),
    changeOption("ImageTools", 'we-button:contains("Blur")'),
    {
        trigger: ".snippet-option-ImageTools we-select:contains('Filter') we-toggler:contains('Blur')",
    },
    {
        content: "Check that the Blur filter has been applied on the image",
        trigger: ":iframe .s_three_columns .o_animate_on_scroll img[data-gl-filter='blur']",
    },
    {
        content: "Click on the 'undo' button",
        trigger: ".o_we_external_history_buttons button.fa-undo",
        run: "click",
    },
    {
        content: "Check that the Blur filter has been removed from the image",
        trigger: ":iframe .s_three_columns .o_animate_on_scroll img:not([data-gl-filter='blur'])",
    },
    ...clickOnSave(),
    {
        content: "Check that the image src is not the raw data",
        trigger: ":iframe .s_three_columns .o_animate_on_scroll img[data-hover-effect='outline']",
        run() {
            const imgEl = document.querySelector("iframe").contentDocument.querySelector(".s_three_columns .o_animate_on_scroll img[data-hover-effect='outline']");
            const src = imgEl.getAttribute("src");
            if (src.startsWith("data:image")) {
                throw new Error("The image source should not be raw data after the editor save");
            }
        },
    },
]);

return __exports;
});
;

/*************************************************************************
*  Filepath: /website/static/tests/tours/snippet_popup_and_scrollbar.js  *
*  Lines: 176                                                            *
*************************************************************************/
odoo.define('@website/../tests/tours/snippet_popup_and_scrollbar', ['@website/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module */

const {
    changeOption,
    insertSnippet,
    goBackToBlocks,
    registerWebsitePreviewTour,
} = require("@website/js/tours/tour_utils");

const snippets = [
    {
        id: "s_popup",
        name: "Popup",
        groupName: "Content",
    },
    {
        id: "s_media_list",
        name: "Media List",
        groupName: "Content",
    },
];

const checkScrollbar = function (hasScrollbar) {
    return {
        content: `Check that the page ${hasScrollbar ? "has" : "does not have"} a vertical scrollbar.`,
        trigger: `:iframe ${hasScrollbar ? "body:not(.modal-open)" : "body.modal-open"}`,
        run: function () {
            const style = window.getComputedStyle(this.anchor);
            if (!hasScrollbar && (style.overflow !== "hidden" || parseFloat(style.paddingRight) < 1)) {
                console.error("error The vertical scrollbar should be hidden");
            } else if (hasScrollbar && (style.overflow === "hidden" || parseFloat(style.paddingRight) > 0)) {
                console.error("error The vertical scrollbar should be displayed");
            }
        },
    };
};

const toggleBackdrop = function () {
    return changeOption('SnippetPopup', 'we-button[data-name="popup_backdrop_opt"] we-checkbox', 'backdrop');
};

registerWebsitePreviewTour("snippet_popup_and_scrollbar", {
    url: "/",
    edition: true,
}, () => [
    ...insertSnippet(snippets[1]), // Media List
    ...insertSnippet(snippets[0]), // Popup
    checkScrollbar(false),
    {
        content: 'Click on the s_popup snippet',
        trigger: ':iframe .s_popup .modal',
        run: "click",
    },
    toggleBackdrop(), // hide Popup backdrop
    checkScrollbar(true),
    goBackToBlocks(),
    {
        content: "Drag the Content snippet group and drop it at the bottom of the popup.",
        trigger: '#oe_snippets .oe_snippet[name="Content"] .oe_snippet_thumbnail:not(.o_we_ongoing_insertion)',
        run: "drag_and_drop :iframe #wrap .s_popup .oe_drop_zone:last",
    },
    {
        content: "Click on the s_media_list snippet.",
        trigger: ':iframe .o_snippet_preview_wrap[data-snippet-id="s_media_list"]',
        run: "click",
    },
    checkScrollbar(false),
    {
        content: "Select the Media List snippet in the Popup.",
        trigger: ":iframe #wrap .s_popup .modal-content .s_media_list",
        run: "click",
    },
    {
        content: "Remove the Media List snippet in the Popup.",
        trigger: ":iframe .oe_overlay.oe_active .oe_snippet_remove",
        run: "click",
    },
    checkScrollbar(true),
    toggleBackdrop(), // show Popup backdrop
    checkScrollbar(false),
    {
        content: "Close the Popup that has now backdrop.",
        trigger: ".o_we_invisible_el_panel .o_we_invisible_entry:first",
        run: "click",
    },
    checkScrollbar(true),
    {
        content: "Open the Cookies Bar.",
        trigger: ".o_we_invisible_el_panel .o_we_invisible_entry:last",
        run: "click",
    },
    checkScrollbar(true),
    toggleBackdrop(), // show Cookies Bar backdrop
    checkScrollbar(false),
    toggleBackdrop(), // hide Cookies Bar backdrop
    checkScrollbar(true),
    {
        content: "Open the Popup that has backdrop.",
        trigger: ".o_we_invisible_el_panel .o_we_invisible_entry:first",
        run: "click",
    },
    /* task-4185877
    checkScrollbar(false),
    */
    goBackToBlocks(),
    {
        content: "Drag the Content snippet group and drop it at the bottom of the popup.",
        trigger: '#oe_snippets .oe_snippet[name="Content"] .oe_snippet_thumbnail:not(.o_we_ongoing_insertion)',
        run: "drag_and_drop :iframe #wrap .s_popup .oe_drop_zone:last",
    },
    {
        content: "Click on the s_media_list snippet.",
        trigger: ':iframe .o_snippet_preview_wrap[data-snippet-id="s_media_list"]',
        run: "click",
    },
    /* task-4185877
    checkScrollbar(true), // The popup backdrop is activated so there should be a scrollbar
    */
    {
        content: 'Click on the s_popup snippet',
        trigger: ':iframe .s_popup .modal',
        run: "click",
    },
    {
        content: "Remove the s_popup snippet",
        trigger: ".o_we_customize_panel we-customizeblock-options:contains('Popup') we-button.oe_snippet_remove:first",
        async run(helpers) {
            await helpers.click();
            // TODO: remove the below setTimeout. Without it, goBackToBlocks() not works.
            await new Promise((r) => setTimeout(r, 1000));
        }
    },
    checkScrollbar(true),
    goBackToBlocks(),
    {
        content: "Drag the Content snippet group and drop it in the Cookies Bar.",
        trigger: '#oe_snippets .oe_snippet[name="Content"] .oe_snippet_thumbnail:not(.o_we_ongoing_insertion)',
        run: "drag_and_drop :iframe #website_cookies_bar .modal-content.oe_structure",
    },
    {
        content: "Click on the s_media_list snippet.",
        trigger: ':iframe .o_snippet_preview_wrap[data-snippet-id="s_media_list"]',
        run: "click",
    },
    {
        content: "Select the Media List snippet in the Cookies Bar.",
        trigger: ":iframe #website_cookies_bar .modal-content .s_media_list",
        run: "click",
    },
    {
        content: "Duplicate the Media List snippet",
        trigger: ".o_we_customize_panel we-customizeblock-options:contains('Media List') we-button.oe_snippet_clone:first",
        run() {
            // TODO: use run: "click", instead
            this.anchor.click();
        }
    },
    checkScrollbar(false),
    {
        content: "Remove the first Media List snippet in the Cookies Bar.",
        trigger: ":iframe .oe_overlay.oe_active .oe_snippet_remove",
        run: "click",
    },
    {
        content: "Remove the second Media List snippet in the Cookies Bar.",
        trigger: ":iframe .oe_overlay.oe_active .oe_snippet_remove",
        run: "click",
    },
    checkScrollbar(true),
]);

return __exports;
});
;

/****************************************************************************
*  Filepath: /website/static/tests/tours/snippet_popup_display_on_click.js  *
*  Lines: 123                                                               *
****************************************************************************/
odoo.define('@website/../tests/tours/snippet_popup_display_on_click', ['@website/js/tours/tour_utils', '@web/core/browser/browser'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module */

const {
    clickOnEditAndWaitEditMode,
    clickOnElement,
    clickOnSave,
    changeOption,
    insertSnippet,
    registerWebsitePreviewTour,
} = require('@website/js/tours/tour_utils');
const { browser } = require("@web/core/browser/browser");

registerWebsitePreviewTour("snippet_popup_display_on_click", {
    url: "/",
    edition: true,
}, () => [
    ...insertSnippet({id: "s_text_image", name: "Image - Text", groupName: "Content"}),
    ...insertSnippet({id: "s_popup", name: "Popup", groupName: "Content"}),
    {
        content: "Click inside the popup to access its options menu.",
        trigger: ":iframe .s_popup .s_banner",
        run: "click",
    },
    changeOption("SnippetPopup", 'we-select[data-attribute-name="display"] we-toggler'),
    {
        content: "Click on the display 'On Click' option",
        trigger: "#oe_snippets we-button[data-name='onclick_opt']",
        async run(helpers) {
            // Patch and ignore write on clipboard in tour as we don't have permissions
            const oldWriteText = browser.navigator.clipboard.writeText;
            browser.navigator.clipboard.writeText = () => { console.info('Copy in clipboard ignored!') };
            await helpers.click();
            browser.navigator.clipboard.writeText = oldWriteText;
        }
    },
    {
        content: "Check the copied anchor from the notification toast",
        trigger: ".o_notification_manager .o_notification_content",
        run() {
            const notificationContent = this.anchor.innerText;
            const anchor = notificationContent.substring(notificationContent.indexOf("#"));

            if (anchor !== "#Win-%2420") {
                console.error("The popup anchor is not '#Win-%2420' as expected.");
            }
        },
    },
    clickOnElement("button to close the popup", ":iframe .s_popup_close"),
    clickOnElement("text image snippet button", ":iframe .s_text_image .btn-secondary"),
    {
        content: "Paste the popup anchor in the URL input",
        trigger: "#o_link_dialog_url_input",
        run: "edit #Win-%2420",
    },
    ...clickOnSave(),
    {
        trigger: "body .o_notification_manager:not(.o_upload_progress_toast):empty:hidden",
    },
    {
        content: "Wait content of iframe is loaded",
        trigger: ":iframe main:contains(enhance your)",
    },
    clickOnElement("text image snippet button", ":iframe .s_text_image .btn-secondary"),
    {
        content: "Verify that the popup opens after clicked the button.",
        trigger: ":iframe .s_popup .modal[id='Win-%2420'].show",
        run: "click",
    },
    clickOnElement("button to close the popup", ":iframe .s_popup_close"),
    {
        content: "Go to the 'contactus' page.",
        trigger: ":iframe a[href='/contactus']",
        run: "click",
    },
    {
        content: "wait for the page to be loaded",
        trigger: ".o_website_preview[data-view-xmlid='website.contactus']",
    },
    ...clickOnEditAndWaitEditMode(),
    ...insertSnippet({id: "s_text_image", name: "Image - Text", groupName: "Content"}),
    clickOnElement("text image snippet button", ":iframe .s_text_image .btn-secondary"),
    {
        content: "Add a link to the homepage in the URL input",
        trigger: "#o_link_dialog_url_input",
        run: "edit /",
    },
    {
        content: "Open the page anchor selector",
        trigger: ".o_link_dialog_page_anchor .dropdown-toggle",
        run: "click",
    },
    {
        content: "Click on the popup anchor to add it after the homepage link in the URL input",
        trigger: ".o_link_dialog_page_anchor we-button:contains('#Win-%2420')",
        run: "click",
    },
    ...clickOnSave(),
    {
        trigger: "body .o_notification_manager:not(.o_upload_progress_toast):empty:hidden",
    },
    {
        content: "Wait content of iframe is loaded",
        trigger: ":iframe main:contains(enhance your)",
    },
    {
        content: "Wait form is patched",
        trigger: ":iframe form#contactus_form input[name=company]:value(yourcompany)",
    },
    clickOnElement("text image snippet button", ":iframe .s_text_image .btn-secondary"),
    {
        trigger: ".o_website_preview[data-view-xmlid='website.homepage']",
    },
    {
        content: "Verify that the popup opens when the homepage page loads.",
        trigger: ":iframe .s_popup .modal[id='Win-%2420'].show",
    },
]);

return __exports;
});
;

/************************************************************
*  Filepath: /website/static/tests/tours/snippet_rating.js  *
*  Lines: 39                                                *
************************************************************/
odoo.define('@website/../tests/tours/snippet_rating', ['@website/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/
const {
    changeOption,
    clickOnSnippet,
    insertSnippet,
    registerWebsitePreviewTour,
} = require('@website/js/tours/tour_utils');

registerWebsitePreviewTour("snippet_rating", {
    url: "/",
    edition: true,
}, () => [
    ...insertSnippet({ id: "s_rating", name: "Rating" }),
    ...clickOnSnippet({ id: "s_rating", name: "Rating" }),
    changeOption("Rating", "we-select:has([data-select-class]) we-toggler"),
    changeOption("Rating", 'we-button[data-select-class="s_rating_inline"]'),
    {
        content: "Check whether s_rating_inline class applied or not",
        trigger: ":iframe .s_rating_inline",
    },
    changeOption("Rating", "we-select:has([data-select-class]) we-toggler"),
    changeOption("Rating", 'we-button[data-select-class="s_rating_no_title"]'),
    {
        content: "Check whether s_rating_no_title class applied or not",
        trigger: ":iframe .s_rating_no_title",
    },
    changeOption("Rating", "we-select:has([data-select-class]) we-toggler"),
    changeOption("Rating", 'we-button[data-select-class=""] div:contains("Top")'),
    {
        content: "Check whether s_rating_no_title class removed or not",
        trigger: ":iframe .s_rating:not(.s_rating_no_title)",
    },
]);

return __exports;
});
;

/******************************************************************
*  Filepath: /website/static/tests/tours/snippet_social_media.js  *
*  Lines: 225                                                     *
******************************************************************/
odoo.define('@website/../tests/tours/snippet_social_media', ['@website/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module */

const {
    clickOnEditAndWaitEditMode,
    clickOnSave,
    clickOnSnippet,
    insertSnippet,
    registerWebsitePreviewTour,
} = require('@website/js/tours/tour_utils');

// TODO: Remove following steps once fix of task-3212519 is done.
// Those steps are preventing a race condition to happen in the meantime: when
// the tour was clicking on the toggle to hide facebook in the next step, it
// would actually "ignore" the result of the click on the toggle and would just
// consider the action of focusing out the input.
const socialRaceConditionClass = 'social_media_race_condition';
const preventRaceConditionStep = [
    {
        trigger: `body:not(.${socialRaceConditionClass})`,
    },
    {
    content: "Wait a few ms to avoid race condition",
    // Ensure the class is remove from previous call of those steps
    trigger: ':iframe .s_social_media',
    run() {
        setTimeout(() => {
            document.body.classList.add(socialRaceConditionClass);
        }, 500);
    }
}, {
    content: "Check the race condition class is added after a few ms",
    trigger: `body.${socialRaceConditionClass}`,
    run() {
        document.body.classList.remove(socialRaceConditionClass);
    }
}];

const replaceIconByImage = function (url) {
    return [{
        content: "Replace the icon by an image",
        trigger: `:iframe .s_social_media a[href='${url}'] i.fa`,
        run: "dblclick",
    },
    {
        content: "Go to the Images tab in the media dialog",
        trigger: ".o_select_media_dialog .o_notebook_headers .nav-item a:contains('Images')",
        run: "click",
    },
    {
        content: "Select the image",
        trigger: ".o_select_media_dialog img[title='s_banner_default_image.jpg']",
        run: "click",
    },
    ...preventRaceConditionStep,
    ];
};

const addNewSocialNetwork = function (optionIndex, linkIndex, url, replaceIcon = false) {
    const replaceIconByImageSteps = replaceIcon ? replaceIconByImage("https://www.example.com") : [];
    return [{
        content: "Click on Add New Social Network",
        trigger: 'we-list we-button.o_we_list_add_optional',
        run: "click",
    },
    {
        content: "Ensure new option is found",
        trigger: `we-list table input:eq(${optionIndex})[data-list-position="${optionIndex}"][data-dom-position="${linkIndex}"][data-undeletable=false]`,
    },
    {
        content: "Ensure new link is found",
        trigger: `:iframe .s_social_media:has(a:eq(${linkIndex})[href='https://www.example.com'])`,
    },
    ...replaceIconByImageSteps,
    {
        content: "Change added Option label",
        trigger: `we-list table input:eq(${optionIndex})`,
        run: `edit ${url} && click body`,
    },
    {
        content: "Ensure new link is changed",
        trigger: `:iframe .s_social_media:has(a:eq(${linkIndex})[href='${url}'])`,
    },
    ...preventRaceConditionStep,
    ];
};

registerWebsitePreviewTour('snippet_social_media', {
    url: '/',
    edition: true,
}, () => [
    ...insertSnippet({id: 's_social_media', name: 'Social Media'}),
    ...clickOnSnippet({id: 's_social_media', name: 'Social Media'}),
    ...addNewSocialNetwork(7, 7, 'https://www.youtu.be/y7TlnAv6cto'),
    {
        content: 'Click on the toggle to hide Facebook',
        trigger: 'we-list table we-button.o_we_user_value_widget',
        run: 'click',
    },
    {
        content: "Ensure twitter became first",
        trigger: ':iframe .s_social_media:has(a:eq(0)[href="/website/social/twitter"])',
    },
    {
        content: 'Drag the facebook link at the end of the list',
        trigger: 'we-list table we-button.o_we_drag_handle',
        tooltipPosition: 'bottom',
        run: "drag_and_drop we-list table tr:last-child",
    },
    {
        content: 'Check drop completed',
        trigger: 'we-list table input:eq(7)[data-media="facebook"]',
    },
    ...preventRaceConditionStep,
    // Create a Link for which we don't have an icon to propose.
    ...addNewSocialNetwork(8, 7, 'https://whatever.it/1EdSw9X'),
    // Create a custom instagram link.
    ...addNewSocialNetwork(9, 8, 'https://instagr.am/odoo.official/'),
    {
        content: "Check if the result is correct before removing",
        trigger: ":iframe .s_social_media" +
                 ":has(a:eq(0)[href='/website/social/twitter'])" +
                 ":has(a:eq(1)[href='/website/social/linkedin'])" +
                 ":has(a:eq(2)[href='/website/social/youtube'])" +
                 ":has(a:eq(3)[href='/website/social/instagram'])" +
                 ":has(a:eq(4)[href='/website/social/github'])" +
                 ":has(a:eq(5)[href='/website/social/tiktok'])" +
                 ":has(a:eq(6)[href='https://www.youtu.be/y7TlnAv6cto']:has(i.fa-youtube))" +
                 ":has(a:eq(7)[href='https://whatever.it/1EdSw9X']:has(i.fa-pencil))" +
                 ":has(a:eq(8)[href='https://instagr.am/odoo.official/']:has(i.fa-instagram))",
    },
    // Create a custom link, not officially supported, ensure icon is found.
    {
        content: 'Change custom social to unsupported link',
        trigger: 'we-list table input:eq(6)',
        run: "edit https://www.paypal.com/abc && click body",
    },
    {
        content: "Ensure paypal icon is found",
        trigger: ":iframe .s_social_media" +
                 ":has(a:eq(6)[href='https://www.paypal.com/abc']:has(i.fa-paypal))",
    },
    ...preventRaceConditionStep,
    {
        content: 'Delete the custom link',
        trigger: 'we-list we-button.o_we_select_remove_option',
        run: 'click',
    },
    {
        content: "Ensure custom link was removed",
        trigger: ':iframe .s_social_media:has(a:eq(6)[href="https://whatever.it/1EdSw9X"]:has(i.fa-pencil))',
    },
    {
        content: 'Click on the toggle to show Facebook',
        trigger: 'we-list table we-button.o_we_user_value_widget:not(.active)',
        run: 'click',
    },
    {
        content: "Check if the result is correct after removing",
        trigger: ":iframe .s_social_media" +
                 ":has(a:eq(0)[href='/website/social/twitter'])" +
                 ":has(a:eq(1)[href='/website/social/linkedin'])" +
                 ":has(a:eq(2)[href='/website/social/youtube'])" +
                 ":has(a:eq(3)[href='/website/social/instagram'])" +
                 ":has(a:eq(4)[href='/website/social/github'])" +
                 ":has(a:eq(5)[href='/website/social/tiktok'])" +
                 ":has(a:eq(6)[href='/website/social/facebook'])" +
                 ":has(a:eq(7)[href='https://whatever.it/1EdSw9X']:has(i.fa-pencil))" +
                 ":has(a:eq(8)[href='https://instagr.am/odoo.official/']:has(i.fa-instagram))",
    },
    {
        content: 'Change url of the DB instagram link',
        trigger: 'we-list table input:eq(3)',
        run: "edit https://instagram.com/odoo.official/ && click body",
    },
    ...preventRaceConditionStep,
    ...clickOnSave(),
    ...clickOnEditAndWaitEditMode(),
    ...clickOnSnippet({
        id: 's_social_media',
        name: 'Social Media',
    }),
    {
        content: "Check if we can still change custom icons",
        trigger: ':iframe .s_social_media a[href="https://whatever.it/1EdSw9X"] i.fa-pencil',
        run: 'dblclick',
    },
    {
        content: "Select a new icon",
        trigger: '.o_select_media_dialog .fa-heart',
        run: "click",
    },
    {
        content: "Check if the result is correct after setting the icon",
        trigger: ":iframe .s_social_media" +
                 ":has(a:eq(0)[href='/website/social/twitter'])" +
                 ":has(a:eq(1)[href='/website/social/linkedin'])" +
                 ":has(a:eq(2)[href='/website/social/youtube'])" +
                 ":has(a:eq(3)[href='/website/social/instagram'])" +
                 ":has(a:eq(4)[href='/website/social/github'])" +
                 ":has(a:eq(5)[href='/website/social/tiktok'])" +
                 ":has(a:eq(6)[href='/website/social/facebook'])" +
                 ":has(a:eq(7)[href='https://whatever.it/1EdSw9X']:has(i.fa-heart))" +
                 ":has(a:eq(8)[href='https://instagr.am/odoo.official/']:has(i.fa-instagram))",
    },
    // Create a social network but replace its icon by an image before setting
    // the link (`replaceIcon` parameter set to `true`).
    ...addNewSocialNetwork(9, 9, "https://google.com", true),
    // Create a social network after replacing the first icon by an image.
    ...replaceIconByImage("/website/social/twitter"),
    ...addNewSocialNetwork(10, 10, "https://facebook.com"),
    {
        content: "Check if the result is correct after adding images",
        trigger: ":iframe .s_social_media" +
                 ":has(a:eq(0)[href='/website/social/twitter']:has(img))" +
                 ":has(a:eq(9)[href='https://google.com']:has(img))" +
                 ":has(a:eq(10)[href='https://facebook.com']:has(img))",
    },
    ...clickOnSave(),
]);

return __exports;
});
;

/**********************************************************************
*  Filepath: /website/static/tests/tours/snippet_table_of_content.js  *
*  Lines: 118                                                         *
**********************************************************************/
odoo.define('@website/../tests/tours/snippet_table_of_content', ['@odoo/hoot-dom', '@website/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module */

const { isVisible } = require('@odoo/hoot-dom');
const {
    clickOnEditAndWaitEditMode,
    clickOnSave,
    insertSnippet,
    goBackToBlocks,
    registerWebsitePreviewTour,
} = require('@website/js/tours/tour_utils');

const scrollToHeading = function (position) {
    return {
        content: `Scroll to h2 number ${position}`,
        trigger: `:iframe h2:eq(${position})`,
        run: function () {
            this.anchor.scrollIntoView(true);
        },
    };
};
const checkTOCNavBar = function (tocPosition, activeHeaderPosition) {
    return {
        content: `Check that the header ${activeHeaderPosition} is active for TOC ${tocPosition}`,
        trigger: `:iframe .s_table_of_content:eq(${tocPosition}) .table_of_content_link:eq(${activeHeaderPosition}).active `,
    };
};

registerWebsitePreviewTour('snippet_table_of_content', {
    url: '/',
    edition: true,
}, () => [
    ...insertSnippet({id: "s_table_of_content", name: "Table of Content", groupName: "Text"}),
    {
        content: "Drag the Text snippet group and drop it.",
        trigger: '#oe_snippets .oe_snippet[name="Text"] .oe_snippet_thumbnail:not(.o_we_ongoing_insertion)',
        run: "drag_and_drop :iframe #wrap",
    },
    {
        content: "Click on the s_table_of_content snippet.",
        trigger: ':iframe .o_snippet_preview_wrap[data-snippet-id="s_table_of_content"]',
        run: "click",
    },
    // To make sure that the public widgets of the two previous ones started.
    ...insertSnippet({id: "s_banner", name: "Banner", groupName: "Intro"}),
    {
        content: "Drag the Intro snippet group and drop it.",
        trigger: '#oe_snippets .oe_snippet[name="Intro"] .oe_snippet_thumbnail:not(.o_we_ongoing_insertion)',
        run: "drag_and_drop :iframe #wrap",
    },
    {
        content: "Click on the s_banner snippet.",
        trigger: ':iframe .o_snippet_preview_wrap[data-snippet-id="s_banner"]',
        run: "click",
    },
    ...clickOnSave(),
    checkTOCNavBar(0, 0),
    checkTOCNavBar(1, 0),
    scrollToHeading(1),
    checkTOCNavBar(0, 1),
    checkTOCNavBar(1, 0),
    scrollToHeading(2),
    checkTOCNavBar(1, 0),
    scrollToHeading(3),
    checkTOCNavBar(1, 1),
    ...clickOnEditAndWaitEditMode(),
    {
        content: "Click on the first TOC's title",
        trigger: ':iframe .s_table_of_content:eq(0) h2',
        run: "click",
    },
    {
        content: "Hide the first TOC on mobile",
        trigger: '[data-toggle-device-visibility="no_mobile"]',
        run: "click",
    },
    // Go back to blocks tabs to avoid changing the first ToC options
    goBackToBlocks(),
    {
        content: "Click on the second TOC's title",
        trigger: ':iframe .s_table_of_content:eq(1) h2',
        run: "click",
    },
    {
        content: "Hide the second TOC on desktop",
        trigger: '[data-toggle-device-visibility="no_desktop"]',
        run: "click",
    },
    ...clickOnSave(),
    {
        content: "Check that we have the good TOC on desktop",
        trigger: ':iframe .s_table_of_content.o_snippet_mobile_invisible',
        run: () => {
            if (isVisible(':iframe .s_table_of_content.o_snippet_desktop_invisible')) {
                console.error('The mobile TOC should not be visible on desktop');
            }
        },
    },
    {
        content: "Toggle the mobile view",
        trigger: '.o_mobile_preview > a',
        run: "click",
    },
    {
        content: "Check that we have the good TOC on mobile",
        trigger: ':iframe .s_table_of_content.o_snippet_desktop_invisible',
        run: () => {
            if (isVisible(':iframe .s_table_of_content.o_snippet_mobile_invisible')) {
                console.error('The desktop TOC should not be visible on mobile');
            }
        },
    },
]);

return __exports;
});
;

/*****************************************************************
*  Filepath: /website/static/tests/tours/snippet_translation.js  *
*  Lines: 97                                                     *
*****************************************************************/
odoo.define('@website/../tests/tours/snippet_translation', ['@web/core/l10n/localization', '@web/core/l10n/translation', '@website/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { localization } = require('@web/core/l10n/localization');
const { translatedTerms } = require('@web/core/l10n/translation');
const {
    clickOnEditAndWaitEditMode,
    clickOnEditAndWaitEditModeInTranslatedPage,
    clickOnSave,
    insertSnippet,
    registerWebsitePreviewTour,
} = require('@website/js/tours/tour_utils');

registerWebsitePreviewTour('snippet_translation', {
    url: '/',
}, () => [
    {
        content: "Wait for website preview and check language",
        trigger: ":iframe html:has(body:contains(welcome to your)):has(.o_top_fixed_element)",
        run: () => {
            if (localization.code !== "fu_GB") {
                console.error("the user language is not properly set");
            } else {
                translatedTerms["Save"] = "Save in fu_GB";
            }
        }
    },
    ...clickOnEditAndWaitEditMode(),
    ...insertSnippet({id: "s_cover", name: "Cover", groupName: "Intro"}),
    {
        content: "Check that contact us contain Parseltongue",
        trigger: ':iframe .s_cover .btn-outline-secondary:contains("Contact us in Parseltongue")',
    },
    {
        content: "Check that the save button contains 'in fu_GB'",
        trigger: '.btn[data-action="save"]:contains("Save in fu_GB")',
    },
]);
registerWebsitePreviewTour('snippet_translation_changing_lang', {
    url: '/',
}, () => [
    {
        content: "Open dropdown language selector",
        trigger: ':iframe .js_language_selector button',
        run: "click",
    },
    {
        content: "Select the language to Parseltongue",
        trigger: ":iframe .js_language_selector .js_change_lang[data-url_code=pa_GB]",
        run: "click",
    },
    {
        content: "Wait the language has changed.",
        trigger: ":iframe header.o_top_fixed_element nav li:contains(parseltongue)",
    },
    {
        content: "Open dropdown language selector",
        trigger: ':iframe .js_language_selector button',
        run: "click",
    },
    {
        content: "Select the language to English",
        trigger: ":iframe .js_language_selector .js_change_lang[data-url_code=en]",
        run: "click",
    },
    {
        content: "Wait the language has changed.",
        trigger: ":iframe nav li:contains(english)",
    },
    {
        content: "Open Edit dropdown",
        trigger: '.o_edit_website_container button',
        run: "click",
    },
    {
        content: "Enable translation",
        trigger: '.o_translate_website_dropdown_item',
        run: "click",
    },
    {
        content: "Close the dialog",
        trigger: '.modal-footer .btn-primary',
        run: "click",
    },
    ...clickOnSave(),
    ...clickOnEditAndWaitEditModeInTranslatedPage(),
    ...insertSnippet({name: "Cover", id: "s_cover", groupName: "Intro"}),
    {
        content: "Check that contact us contain Parseltongue",
        trigger: ':iframe .s_cover .btn-outline-secondary:contains("Contact us in Parseltongue")',
    },
]);

return __exports;
});
;

/*************************************************************
*  Filepath: /website/static/tests/tours/snippet_version.js  *
*  Lines: 79                                                 *
*************************************************************/
odoo.define('@website/../tests/tours/snippet_version', ['@website/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const {
    clickOnSave,
    insertSnippet,
    registerWebsitePreviewTour
} = require('@website/js/tours/tour_utils');

registerWebsitePreviewTour("snippet_version_1", {
    edition: true,
    url: "/",
}, () => [
    ...insertSnippet({
        id: 's_test_snip',
        name: 'Test snip',
        groupName: "Content",
    }),
    ...insertSnippet({
        id: 's_text_image',
        name: 'Text - Image',
        groupName: "Content",
    }),
    {
    content: "Test t-snippet and t-snippet-call: snippets have data-snippet set",
    trigger: '#oe_snippets .o_panel_body > .oe_snippet',
    run: function () {
        // Tests done here as all these are not visible on the page
        const draggableSnippets = [...document.querySelectorAll('#oe_snippets .o_panel_body > .oe_snippet:not([data-module-id]) > :nth-child(2)')];
        if (draggableSnippets.length && !draggableSnippets.every(el => el.dataset.snippet)) {
            console.error("error Some t-snippet are missing their template name or there are no snippets to drop");
        }
        if (!document.querySelector('iframe:not(.o_ignore_in_tour)').contentDocument.querySelector('#wrap [data-snippet="s_test_snip"] [data-snippet="s_share"]')) {
            console.error("error Dropped a s_test_snip snippet but missing s_share template name in it");
        }
    },
},
    ...clickOnSave(),
]);
registerWebsitePreviewTour("snippet_version_2", {
    edition: true,
    url: "/",
}, () => [
{
    content: "Edit s_test_snip",
    trigger: ':iframe #wrap.o_editable .s_test_snip',
    run: "click",
},
{
    trigger:
        "we-customizeblock-options:contains(Test snip) .snippet-option-VersionControl > we-alert",
},
{
    content: "Edit text_image",
    trigger: ':iframe #wrap.o_editable .s_text_image',
    run: "click",
},
{
    trigger:
        "we-customizeblock-options:contains(Text - Image) .snippet-option-VersionControl  > we-alert",
},
{
    content: "Edit s_share",
    trigger: ':iframe #wrap.o_editable .s_share',
    run: "click",
},
{
    trigger:
        "we-customizeblock-options:contains(Share) .snippet-option-VersionControl > we-alert",
},
{
    content: "s_share is outdated",
    trigger: ':iframe body',
}]);

return __exports;
});
;

/***********************************************************************
*  Filepath: /website/static/tests/tours/snippet_visibility_option.js  *
*  Lines: 124                                                          *
***********************************************************************/
odoo.define('@website/../tests/tours/snippet_visibility_option', ['@website/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
const {
    insertSnippet,
    clickOnSave,
    clickOnEditAndWaitEditMode,
    registerWebsitePreviewTour,
} = require('@website/js/tours/tour_utils');

registerWebsitePreviewTour("snippet_visibility_option", {
    url: "/",
    edition: true,
}, () => [
    ...insertSnippet({
        id: "s_popup",
        name: "Popup",
        groupName: "Content",
    }),
    {
        content: "Click on the column within the popup snippet.",
        trigger: ":iframe #wrap .s_popup .o_cc1",
        run: "click"
    },
    {
        content: "Click the 'No Desktop' visibility option.",
        trigger: ".snippet-option-DeviceVisibility we-button[data-toggle-device-visibility='no_desktop']",
        run: "click"
    },
    {
        content: "Click on the banner within the popup snippet.",
        trigger: ":iframe #wrap .s_popup .s_banner",
        run: "click"
    },
    {
        content: "Click the 'No Desktop' visibility option.",
        trigger: "we-button[data-toggle-device-visibility='no_desktop']",
        run: "click"
    },
    {
        content: "Click on the popup snippet to hide",
        trigger: ".o_we_invisible_root_parent",
        run: "click"
    },
    {
        content: "Click on the popup snippet in the list of invisible elements.",
        trigger: ".o_we_invisible_root_parent",
        run: "click"
    },
    {
        content: "Verify that both the banner and column are marked as invisible.",
        trigger: ".o_we_invisible_root_parent",
        run: () => {
            const isBlockInvisible = document.querySelector("li .o_we_invisible_entry i").classList.contains("fa-eye-slash");
            const isColumnInvisible = document.querySelector("li li .o_we_invisible_entry i").classList.contains("fa-eye-slash");
            if (!isBlockInvisible || !isColumnInvisible) {
                console.error("Visibility issue detected with the elements.");
            }
        }
    },
    ...clickOnSave(),
    ...clickOnEditAndWaitEditMode(),
    {
        content: "Click on the banner snippet in the list of invisible elements.",
        trigger: "li > .o_we_invisible_entry",
        run: "click"
    },
    {
        content: "Verify that the popup is visible and the column is still invisible.",
        trigger: "li > .o_we_invisible_entry",
        run: () => {
            const isPopupVisible = document.querySelector(".o_we_invisible_root_parent i").classList.contains("fa-eye");
            const isColumnInvisible = document.querySelector("li li .o_we_invisible_entry i").classList.contains("fa-eye-slash");
            if (!isPopupVisible || !isColumnInvisible) {
                console.error("Visibility issue detected with the elements.");
            }
        }
    },
    ...clickOnSave(),
    ...clickOnEditAndWaitEditMode(),
    {
        content: "Click on the column snippet in the list of invisible elements.",
        trigger: "li li .o_we_invisible_entry",
        run: "click"
    },
    {
        content: "Verify that both the popup and the banner are now visible.",
        trigger: ".o_we_invisible_root_parent",
        run: () => {
            const isPopupVisible = document.querySelector(".o_we_invisible_root_parent i").classList.contains("fa-eye");
            const isBlockVisible = document.querySelector("li .o_we_invisible_entry i").classList.contains("fa-eye");
            if (!isPopupVisible || !isBlockVisible) {
                console.error("Visibility issue detected with the elements.");
            }
        }
    },
    {
        content: "Click on the popup snippet to hide its descendant elements.",
        trigger: ".o_we_invisible_root_parent",
        run: () => {
            setTimeout(() => {
                document.querySelector(".o_we_invisible_root_parent").click();
            }, 1000);
        }
    },
    {
        content: "Make sure the parent snippet is invisible.",
        trigger: ".o_we_invisible_root_parent i.fa-eye-slash",
    },
    {
        content: "Verify that both the banner and column snippets are marked as invisible.",
        trigger: ".o_we_invisible_root_parent",
        run: () => {
            const isBlockInvisible = document.querySelector("li .o_we_invisible_entry i").classList.contains("fa-eye-slash");
            const isColumnInvisible = document.querySelector("li li .o_we_invisible_entry i").classList.contains("fa-eye-slash");
            if (!isColumnInvisible || !isBlockInvisible) {
                console.error("Visibility issue detected with the elements.");
            }
        }
    },
]);

return __exports;
});
;

/************************************************************************
*  Filepath: /website/static/tests/tours/snippets_all_drag_and_drop.js  *
*  Lines: 184                                                           *
************************************************************************/
odoo.define('@website/../tests/tours/snippets_all_drag_and_drop', ['@website/js/tours/tour_utils', '@web/core/utils/patch', '@web/core/registry'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const {
    clickOnEditAndWaitEditMode,
    insertSnippet,
    goBackToBlocks,
    clickOnSnippet,
    changeOption,
} = require("@website/js/tours/tour_utils");
const { patch } = require("@web/core/utils/patch");

const patchWysiwygAdapter = () => {
    const { WysiwygAdapterComponent } = odoo.loader.modules.get("@website/components/wysiwyg_adapter/wysiwyg_adapter");
    return patch(WysiwygAdapterComponent.prototype, {
        _trigger_up(ev) {
            super._trigger_up(...arguments);
            if (ev.name === 'snippet_removed') {
                document.body.setAttribute("test-dd-snippet-removed", true);
            }
        }
    });
};

let unpatchWysiwygAdapter = null;

const { registry } = require("@web/core/registry");

let snippetsNames = (new URL(document.location.href)).searchParams.get('snippets_names') || '';
// When this test is loaded in the backend, the search params aren't as easy to
// read as before. Little trickery to make this test run.
const searchParams = new URLSearchParams(window.location.search).get('path');
if (searchParams) {
    snippetsNames = new URLSearchParams(searchParams.split('/')[1]).get('snippets_names') || '';
    snippetsNames = snippetsNames.split(',');
}
const dropInOnlySnippets = {
    's_button': '.btn',
    's_video': '.media_iframe_video',
};
let steps = [];
let n = 0;
for (let snippet of snippetsNames) {
    n++;
    snippet = {
        name: snippet.split(':')[0],
        group: snippet.split(':')[1],
    };
    const isModal = ['s_popup', 's_newsletter_subscribe_popup'].includes(snippet.name);
    const isDropInOnlySnippet = Object.keys(dropInOnlySnippets).includes(snippet.name);

    let draggableElSelector = "";
    if (snippet.group) {
        draggableElSelector = `#oe_snippets .oe_snippet[data-snippet-group="${snippet.group}"] .oe_snippet_thumbnail`;
    } else {
        draggableElSelector = `#oe_snippets .oe_snippet:has( > [data-snippet="${snippet.name}"]) .oe_snippet_thumbnail`;
    }

    const snippetSteps = [{
        content: `Drop ${snippet.group || snippet.name} ${snippet.group ? "group" : "snippet"} [${n}/${snippetsNames.length}]`,
        trigger: draggableElSelector,
        run: "drag_and_drop :iframe #wrap .oe_drop_zone",
    }, {
        content: `Edit ${snippet.name} snippet`,
        trigger: `:iframe #wrap.o_editable [data-snippet='${snippet.name}']${isModal ? ' .modal.show' : ''}`,
        run: "click",
    }, {
        content: `check ${snippet.name} setting are loaded, wait panel is visible`,
        trigger: ".o_we_customize_panel",
    }, {
        content: `Remove the ${snippet.name} snippet`, // Avoid bad perf if many snippets
        trigger: "we-button.oe_snippet_remove:last",
        run: "click",
    },
    {
        trigger: "body[test-dd-snippet-removed]",
    },
    {
        content: `click on 'BLOCKS' tab (${snippet.name})`,
        trigger: ".o_we_add_snippet_btn",
        async run (actions) {
            document.body.removeAttribute("test-dd-snippet-removed");
            await actions.click();
        },
    }];

    if (snippet.group) {
        snippetSteps.splice(1, 0, {
            content: "Click on the snippet preview in the dialog",
            trigger: `:iframe .o_snippet_preview_wrap[data-snippet-id="${snippet.name}"]`,
            run: "click",
        });
    }

    if (snippet === 's_google_map') {
        snippetSteps.splice(2, 4, {
            content: 'Close API Key popup',
            trigger: ":iframe .modal-footer .btn-secondary",
            run: "click",
        });
    } else if (isModal) {
        snippetSteps.splice(
            4,
            3,
            {
                content: `Make sure ${snippet.name} is shown`,
                trigger: ":iframe body.modal-open",
            },
            {
                content: `Hide the ${snippet.name} popup`,
                trigger: `:iframe [data-snippet='${snippet.name}'] .s_popup_close`,
                run: "click",
            }
        );
    } else if (isDropInOnlySnippet) {
        // The 'drop in only' snippets have their 'data-snippet' attribute
        // removed once they are dropped, so we need to use a different selector.
        snippetSteps[1].trigger = `:iframe #wrap.o_editable ${dropInOnlySnippets[snippet.name]}`;
    }
    steps = steps.concat(snippetSteps);
}

registry.category("web_tour.tours").add("snippets_all_drag_and_drop", {
    // To run the tour locally, you need to insert the URL sent by the python
    // tour here. There is currently an issue with tours which don't have an URL
    // url: '/?enable_editor=1&snippets_names=s_process_steps:columns,s_website_form:,s_...',
    steps: () => [
    ...clickOnEditAndWaitEditMode(),
    {
        content: "Ensure snippets are actually passed at the test.",
        trigger: "body",
        run: function () {
            // safety check, otherwise the test might "break" one day and
            // receive no steps. The test would then not test anything anymore
            // without us noticing it.
            if (steps.length < 500) {
                console.error(`This test is not behaving as it should, got only ${steps.length} steps.`);
            }
            unpatchWysiwygAdapter = patchWysiwygAdapter();
        },
    },
    // This first step is needed as it will be used later for inner snippets
    // Without this, it will dropped inside the footer and will need an extra
    // selector.
    ...insertSnippet({
        id: "s_text_image",
        name: "Text - Image",
        groupName: "Content"
    }),
    {
        content: "Edit s_text_image snippet",
        trigger: ":iframe #wrap.o_editable [data-snippet='s_text_image']",
        run: "click",
    },
    {
        content: "check setting are loaded, wait panel is visible",
        trigger: ".o_we_customize_panel",
        run: "click",
    },
    // We hide the header before starting to drop snippets. This prevents
    // situations where the header's drop zones overlap with those of the #wrap,
    // ensuring that a snippet is dropped in the #wrap as expected instead of
    // the header.
    ...clickOnSnippet({id: "o_header_standard", name: "Header"}),
    changeOption("TopMenuVisibility", "we-select:has([data-visibility]) we-toggler"),
    changeOption("TopMenuVisibility", 'we-button[data-visibility="hidden"]'),
    goBackToBlocks(),
].concat(steps).concat([
    {
        content: "Remove wysiwyg patch",
        trigger: "body",
        run: () => unpatchWysiwygAdapter(),
    }
            ])
            .map((step) => {
                delete step.noPrepend;
                return step;
            }),
});

return __exports;
});
;

/*********************************************************************
*  Filepath: /website/static/tests/tours/specific_website_editor.js  *
*  Lines: 32                                                         *
*********************************************************************/
odoo.define('@website/../tests/tours/specific_website_editor', ['@web/core/registry', '@website/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { registry } = require("@web/core/registry");
const {
    clickOnEditAndWaitEditMode,
    registerWebsitePreviewTour
} = require('@website/js/tours/tour_utils');

registerWebsitePreviewTour("generic_website_editor", {
    edition: true,
}, () => [{
    trigger: ':iframe body:not([data-hello="world"])',
    content: 'Check that the editor DOM matches its website-generic features',
}]);

// Good practice would have been to use `registerWebsitePreviewTour`
// for this tour with `edition: true` and remove the first step to enter edit
// mode. Unfortunately this breaks the page and therefore the test fails for
// unknown reason.
registry.category("web_tour.tours").add('specific_website_editor', {
    steps: () => [
    ...clickOnEditAndWaitEditMode(),
{
    trigger: ':iframe body[data-hello="world"]',
    content: 'Check that the editor DOM matches its website-specific features',
}]});

return __exports;
});
;

/******************************************************************
*  Filepath: /website/static/tests/tours/start_cloned_snippet.js  *
*  Lines: 48                                                      *
******************************************************************/
odoo.define('@website/../tests/tours/start_cloned_snippet', ['@website/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const {
    clickOnSnippet,
    registerWebsitePreviewTour,
} = require('@website/js/tours/tour_utils');

registerWebsitePreviewTour('website_start_cloned_snippet', {
    edition: true,
    url: '/',
}, () => {
    const countdownSnippet = {
        name: 'Countdown',
        id: 's_countdown',
    };
    return [
        {
            trigger: ".o_website_preview.editor_enable.editor_has_snippets",
        },
        {
            trigger: `#oe_snippets .oe_snippet[name="${countdownSnippet.name}"].o_we_draggable .oe_snippet_thumbnail:not(.o_we_ongoing_insertion)`,
            run: "drag_and_drop :iframe #wrapwrap #wrap",
        },
        ...clickOnSnippet(countdownSnippet),
        {
            content: 'Click on clone snippet',
            trigger: '.oe_snippet_clone',
            run: "click",
        },
        {
            content: 'Check that the cloned snippet has a canvas and that something has been drawn inside of it',
            trigger: ':iframe .s_countdown:eq(1) canvas',
            run: function () {
                // Check that at least one bit has been drawn in the canvas
                if (!this.anchor.getContext("2d").getImageData(0, 0, 1000, 1000).data.includes(1)) {
                    console.error('The cloned snippet should have been started');
                }
            },
        },

    ]
});

return __exports;
});
;

/*************************************************************
*  Filepath: /website/static/tests/tours/text_animations.js  *
*  Lines: 55                                                 *
*************************************************************/
odoo.define('@website/../tests/tours/text_animations', ['@website/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module */

const {
    insertSnippet,
    registerWebsitePreviewTour,
} = require('@website/js/tours/tour_utils');

registerWebsitePreviewTour("text_animations", {
    url: "/",
    edition: true,
}, () => [
    ...insertSnippet({
        id: "s_cover",
        name: "Cover",
        groupName: "Intro",
    }),
    {
        content: "Click on the snippet title",
        trigger: ":iframe .s_cover h1",
        run: "dblclick", // Make sure the title is selected.
    },
    {
        content: "Click on the 'Animate Text' button to activate the option",
        trigger: "div.o_we_animate_text",
        run: "click",
    },
    {
        content: "Check that the animation was applied",
        trigger: ":iframe .s_cover h1 span.o_animated_text",
    },
    {
        content: "Click on the 'Animate Text' button",
        trigger: "div.o_we_animate_text",
        run: "click",
    },
    {
        content: "Check that the animation was disabled for the title",
        trigger: ":iframe .s_cover:not(:has(.o_animated_text))",
    },
    {
        content: "Try to apply the text animation again",
        trigger: "div.o_we_animate_text",
        run: "click",
    },
    {
        content: "Check that the animation was applied",
        trigger: ":iframe .s_cover:has(span.o_animated_text)",
    },
]);

return __exports;
});
;

/*************************************************************
*  Filepath: /website/static/tests/tours/text_highlights.js  *
*  Lines: 97                                                 *
*************************************************************/
odoo.define('@website/../tests/tours/text_highlights', ['@website/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module */

const {
    insertSnippet,
    registerWebsitePreviewTour,
    selectElementInWeSelectWidget,
} = require('@website/js/tours/tour_utils');

registerWebsitePreviewTour("text_highlights", {
    url: "/",
    edition: true,
}, () => [
    ...insertSnippet({
        id: "s_cover",
        name: "Cover",
        groupName: "Intro",
    }),
    {
        content: "Select the snippet title",
        trigger: ":iframe .s_cover h1",
        run: "dblclick",
    },
    {
        content: "Click on the 'Highlight Effects' button to activate the option",
        trigger: "div.o_we_text_highlight",
        run: "click",
    },
    {
        content: "Check that the highlight was applied",
        trigger: ":iframe .s_cover h1 span.o_text_highlight > .o_text_highlight_item > svg:has(.o_text_highlight_path_underline)",
    },
    {
        content: "Check that the highlights grid was displayed",
        trigger: "we-select[data-name=text_highlight_opt] we-toggler.active",
    },
    {
        content: "Disable the highlight effect",
        trigger: "div.o_we_text_highlight",
        run: "click",
    },
    {
        content: "Check that the highlight was disabled for the title",
        trigger: ":iframe .s_cover:not(:has(.o_text_highlight))",
    },
    {
        // On muti-line text, the highlight effect is added on every detected
        // line (using the `.o_text_highlight_item` span).
        content: "Update and select the snippet paragraph content",
        trigger: ":iframe .s_cover p",
        run() {
            const iframeDOC = document.querySelector(".o_iframe").contentDocument;
            const firstLine = document.createElement("strong");
            firstLine.textContent = "Text content line A";
            const secondLine = document.createElement("i");
            secondLine.textContent = "Text content line B";
            this.anchor.replaceChildren(firstLine, document.createElement("br"), secondLine);
            // Select the whole content.
            const range = iframeDOC.createRange();
            const selection = iframeDOC.getSelection();
            range.selectNodeContents(this.anchor);
            selection.removeAllRanges();
            selection.addRange(range);
        },
    },
    {
        content: "Add the highlight effect on the muti-line text",
        trigger: "div.o_we_text_highlight",
        run: "click",
    },
    {
        content: "Check if the text was correctly updated",
        trigger: ":iframe .o_text_highlight_underline:has(span:contains(Text content line A) + br + span:contains(Text content line B))",
    },
    ...selectElementInWeSelectWidget("text_highlight_opt", "Jagged").slice(1), // The select is already opened
    {
        trigger: ":iframe .o_text_highlight_item:has(.o_text_highlight_path_jagged):nth-child(3)",
    },
    {
        content: "When changing the text highlight, we only replace the highlight SVG with a new drawn one",
        trigger: ":iframe .o_text_highlight_item:has(.o_text_highlight_path_jagged):nth-child(1)",
    },
    {
        content: "Disable the highlight effect",
        trigger: "div.o_we_text_highlight",
        run: "click",
    },
    {
        content: "Check if the original DOM structure was restored",
        trigger: ":iframe .s_cover p:has(strong:contains(Text content line A) + br + i:contains(Text content line B))",
    },
]);

return __exports;
});
;

/*****************************************************************
*  Filepath: /website/static/tests/tours/translate_menu_name.js  *
*  Lines: 41                                                     *
*****************************************************************/
odoo.define('@website/../tests/tours/translate_menu_name', ['@website/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const {
    clickOnExtraMenuItem,
    clickOnSave,
    registerWebsitePreviewTour,
} = require('@website/js/tours/tour_utils');

registerWebsitePreviewTour('translate_menu_name', {
    url: '/pa_GB',
    edition: false,
}, () => [
    {
        content: "Open Edit dropdown",
        trigger: '.o_edit_website_container button',
        run: "click",
    },
    {
        content: "activate translate mode",
        trigger: '.o_translate_website_dropdown_item',
        run: "click",
    },
    {
        content: "Close the dialog",
        trigger: '.modal-footer .btn-primary',
        run: "click",
    },
    clickOnExtraMenuItem({}, true),
    {
        content: "translate the menu entry",
        trigger: ':iframe a[href="/englishURL"] span',
        run: "editor value pa-GB",
    },
    ...clickOnSave(),
]);

return __exports;
});
;

/********************************************************************
*  Filepath: /website/static/tests/tours/translate_text_options.js  *
*  Lines: 121                                                       *
********************************************************************/
odoo.define('@website/../tests/tours/translate_text_options', ['@website/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const {
    clickOnSave,
    insertSnippet,
    registerWebsitePreviewTour,
    selectElementInWeSelectWidget,
} = require("@website/js/tours/tour_utils");

const selectText = (selector) => {
    return {
        content: "Select some text content",
        trigger: `:iframe ${selector}`,
        run() {
            const iframeDOC = document.querySelector(".o_iframe").contentDocument;
            const range = iframeDOC.createRange();
            const selection = iframeDOC.getSelection();
            range.selectNodeContents(this.anchor);
            selection.removeAllRanges();
            selection.addRange(range);
            this.anchor.click();
        },
    };
};

registerWebsitePreviewTour(
    "translate_text_options",
    {
        url: "/",
        edition: true,
    },
    () => [
        ...insertSnippet({
            id: "s_text_block",
            name: "Text",
            groupName: "Text",
        }),
        {
            content: "Select the first text block in the snippet",
            trigger: ":iframe #wrap .s_text_block p:first",
            run: "dblclick",
        },
        {
            content: "Click on the 'Animate Text' button to activate the option",
            trigger: "div.o_we_animate_text",
            run: "click",
        },
        {
            content: "Select the second text block in the snippet",
            trigger: ":iframe #wrap .s_text_block p:last",
            run: "dblclick",
        },
        {
            content: "Click on the 'Highlight Effects' button to activate the option",
            trigger: "div.o_we_text_highlight",
            run: "click",
        },
        ...clickOnSave(),
        {
            content: "Change the language to French",
            trigger: ':iframe .js_language_selector .js_change_lang[data-url_code="fr"]',
            run: "click",
        },
        {
            content: "Click edit button",
            trigger: ".o_menu_systray .o_edit_website_container button",
            run: "click",
        },
        {
            content: "Enable translation",
            trigger: ".o_popover .o_translate_website_dropdown_item",
            run: "click",
        },
        {
            content: "Close the dialog",
            trigger: ".modal-footer .btn-secondary",
            run: "click",
        },
        // Select the highlighted text content.
        selectText("#wrap .s_text_block p:last .o_text_highlight"),
        {
            content: "Check that the highlight options were displayed",
            trigger: "#toolbar we-select[data-name=text_highlight_opt]",
        },
        ...selectElementInWeSelectWidget("text_highlight_opt", "Jagged"),
        // Select the animated text content.
        selectText("#wrap .s_text_block p:first .o_animated_text"),
        {
            content:
                "Check that the animation options are displayed and highlight options are no longer visible",
            trigger:
                "#toolbar:not(:has(.snippet-option-TextHighlight)) .snippet-option-WebsiteAnimate",
        },
        // Select a text content without any option.
        selectText("footer .s_text_block p:first span"),
        {
            content: "Check that all text options are removed",
            trigger:
                "#toolbar:not(:has(.snippet-option-TextHighlight, .snippet-option-WebsiteAnimate))",
        },
        // Select the highlighted text content again.
        selectText("#wrap .s_text_block p:last .o_text_highlight"),
        {
            content: "Check that only the highlight options are displayed",
            trigger:
                "#toolbar:not(:has(.snippet-option-WebsiteAnimate)) .snippet-option-TextHighlight",
        },
        ...clickOnSave(),
        {
            content: "Check that the highlight effect was correctly translated",
            trigger:
                ":iframe .s_text_block .o_text_highlight:has(.o_text_highlight_item:has(.o_text_highlight_path_jagged))",
        },
    ]
);

return __exports;
});
;

/*************************************************************
*  Filepath: /website/static/tests/tours/unsplash_beacon.js  *
*  Lines: 17                                                 *
*************************************************************/
odoo.define('@website/../tests/tours/unsplash_beacon', ['@web/core/registry'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { registry } = require("@web/core/registry");

registry.category("web_tour.tours").add("test_unsplash_beacon", {
    url: "/",
    steps: () => [{
        content: "Verify whether beacon was sent.",
        trigger: 'img[data-beacon="sent"]',
    }],
});

return __exports;
});
;

/****************************************************************************
*  Filepath: /website/static/tests/tours/website_backend_menus_redirect.js  *
*  Lines: 39                                                                *
****************************************************************************/
odoo.define('@website/../tests/tours/website_backend_menus_redirect', ['@web/core/registry'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { registry } = require("@web/core/registry");

registry.category("web_tour.tours").add('website_backend_menus_redirect', {
    url: '/',
    steps: () => [
{
    isActive: ["enterprise"],
    content: 'Need at least a step so the tour is not failing in enterprise',
    trigger: 'body',
}, {
    isActive: ["community"],
    content: 'Make frontend to backend menus appears',
    trigger: 'body:has(#wrap)',
    run: function () {
        // The dropdown is hidden behind an SVG on hover animation.
        this.anchor.querySelector(".o_frontend_to_backend_apps_menu").classList.add("show");
    },
}, {
    isActive: ["community"],
    content: 'Click on Test Root backend menu',
    trigger: '.o_frontend_to_backend_apps_menu a:contains("Test Root")',
    run: "click",
}, {
    isActive: ["community"],
    content: 'Check that we landed on the apps page (Apps), and not the Home Action page (Settings)',
    // It cannot be the name of the menu here, as that would still be displayed
    // even when the default home action would be loaded. So instead, use a
    // class used by the Apps Kanban.
    trigger: '.oe_module_flag:not(:visible)',
}
]});

return __exports;
});
;

/*****************************************************************
*  Filepath: /website/static/tests/tours/website_click_tests.js  *
*  Lines: 48                                                     *
*****************************************************************/
odoo.define('@website/../tests/tours/website_click_tests', ['@website/js/tours/tour_utils', '@web_tour/tour_service/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const {
    clickOnEditAndWaitEditMode,
    clickOnSave,
    clickOnSnippet,
    insertSnippet,
    goBackToBlocks,
    registerWebsitePreviewTour,
} = require('@website/js/tours/tour_utils');
const { stepUtils } = require("@web_tour/tour_service/tour_utils");

const cover = {
    id: 's_cover',
    name: 'Cover',
    groupName: "Intro",
};

registerWebsitePreviewTour('website_click_tour', {
    url: '/',
}, () => [
    stepUtils.waitIframeIsReady(),
    {
        content: "trigger a page navigation",
        trigger: ':iframe a[href="/contactus"]',
        run: "click",
    },
    {
        content: "wait for the page to be loaded",
        trigger: '.o_website_preview[data-view-xmlid="website.contactus"]',
    },
    ...clickOnEditAndWaitEditMode(),
    {
        content: "click on a link that would trigger navigation",
        trigger: ':iframe a[href="/"]',
        run: "click",
    },
    goBackToBlocks(),
    ...insertSnippet(cover),
    ...clickOnSnippet(cover),
    ...clickOnSave(),
]);

return __exports;
});
;

/*****************************************************************
*  Filepath: /website/static/tests/tours/website_form_editor.js  *
*  Lines: 1115                                                   *
*****************************************************************/
odoo.define('@website/../tests/tours/website_form_editor', ['@website/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const {
    changeOption,
    clickOnEditAndWaitEditMode,
    clickOnSave,
    insertSnippet,
    goBackToBlocks,
    registerWebsitePreviewTour,
} = require('@website/js/tours/tour_utils');

// Visibility possible values:
const VISIBLE = 'Always Visible';
const HIDDEN = 'Hidden';
const CONDITIONALVISIBILITY = 'Visible only if';

const NB_NON_ESSENTIAL_REQUIRED_FIELDS_IN_DEFAULT_FORM = 2;
const ESSENTIAL_FIELDS_VALID_DATA_FOR_DEFAULT_FORM = [
    {
        name: 'email_from',
        value: 'admin@odoo.com',
    },
    {
        name: 'subject',
        value: 'Hello, world!',
    }
];
const essentialFieldsForDefaultFormFillInSteps = [];
for (const data of ESSENTIAL_FIELDS_VALID_DATA_FOR_DEFAULT_FORM) {
    essentialFieldsForDefaultFormFillInSteps.push({
        content: "Enter data in model-required field",
        trigger: `:iframe .s_website_form_model_required .s_website_form_input[name="${data.name}"]`,
        run: `edit ${data.value} && press Tab`,
    });
    essentialFieldsForDefaultFormFillInSteps.push({
        trigger: `:iframe .s_website_form_model_required .s_website_form_input[name="${data.name}"]:value(${data.value})`,
    });
}

// Replace all `"` character by `&quot;`.
const getQuotesEncodedName = function (name) {
        return name.replaceAll(/"/g, character => `&quot;`);
};

const triggerFieldByLabel = (label) => {
    return `.s_website_form_field.s_website_form_custom:has(label:contains("${label}"))`;
};
const selectFieldByLabel = (label) => {
    return [{
        content: `Select field "${label}"`,
        trigger: ":iframe " + triggerFieldByLabel(label),
        run: "click",
    }];
};
const selectButtonByText = function (text) {
    return [{
        content: "Open the select",
        trigger: `we-select:has(we-button:contains("${text}")) we-toggler`,
        run: "click",
    },
    {
        content: "Click on the option",
        trigger: `we-select we-button:contains("${text}")`,
        run: "click",
    }];
};
const selectButtonByData = function (data) {
    return [{
        content: "Open the select",
        trigger: `we-select:has(we-button[${data}]) we-toggler`,
        run: "click",
    }, {
        content: "Click on the option",
        trigger: `we-select we-button[${data}]`,
        run: "click",
    }];
};
const addField = function (name, type, label, required, isCustom,
                           display = {visibility: VISIBLE, condition: ""}) {
    const data = isCustom ? `data-custom-field="${name}"` : `data-existing-field="${name}"`;
    const ret = [
    {
        trigger: ":iframe .s_website_form_field",
    },
    {
        content: "Select form",
        trigger: ':iframe section.s_website_form',
        run: "click",
    }, {
        content: "Add field",
        trigger: 'we-button[data-add-field]',
        run: "click",
    },
    ...selectButtonByData(data),
    {
        content: "Wait for field to load",
        trigger: `:iframe .s_website_form_field[data-type="${name}"],:iframe .s_website_form_input[name="${name}"]`, //custom or existing field
    },
    ...selectButtonByText(display.visibility),
];
    let testText = ':iframe .s_website_form_field';
    if (display.condition) {
        ret.push({
            content: "Set the visibility condition",
            trigger: 'we-input[data-attribute-name="visibilityCondition"] input',
            run: `edit ${display.condition} && press Tab`,
        });
    }
    if (required) {
        testText += '.s_website_form_required';
        ret.push({
            content: "Mark the field as required",
            trigger: 'we-button[data-name="required_opt"] we-checkbox',
            run: "click",
        });
    }
    if (label) {
        testText += `:has(label:contains(${label}))`;
        ret.push({
            content: "Change the label text",
            trigger: 'we-input[data-set-label-text] input',
            run: `edit ${label} && press Tab`,
        });
    }
    if (type !== 'checkbox' && type !== 'radio' && type !== 'select') {
        let inputType = type === 'textarea' ? type : `input[type="${type}"]`;
        const nameAttribute = isCustom && label ? getQuotesEncodedName(label) : name;
        testText += `:has(${inputType}[name="${CSS.escape(nameAttribute)}"]${required ? "[required]" : ""})`;
    }
    ret.push({
        content: "Check the resulting field",
        trigger: testText,
    });
    return ret;
};
const addCustomField = function (name, type, label, required, display) {
    return addField(name, type, label, required, true, display);
};
const addExistingField = function (name, type, label, required, display) {
    return addField(name, type, label, required, false, display);
};

registerWebsitePreviewTour("website_form_editor_tour", {
    url: '/',
    edition: true,
}, () => [
    // Drop a form builder snippet and configure it
    {
        content: "Drop the form snippet",
        trigger: '#oe_snippets .oe_snippet .oe_snippet_thumbnail[data-snippet=s_website_form]',
        run: "drag_and_drop :iframe #wrap",
    },
    {
        trigger: ":iframe .s_website_form_field",
    },
    {
        content: "Select form by clicking on an input field",
        trigger: ':iframe section.s_website_form input',
        run: "click",
    }, {
        content: "Verify that the form editor appeared",
        trigger: '.o_we_customize_panel .snippet-option-WebsiteFormEditor',
    },
    goBackToBlocks(),
    {
        trigger: ":iframe .s_website_form_field",
    },
    {
        content: "Select form by clicking on a text area",
        trigger: ':iframe section.s_website_form textarea',
        run: "click",
    },
    {
        content: "Verify that the form editor appeared",
        trigger: '.o_we_customize_panel .snippet-option-WebsiteFormEditor',
    },
    {
        content: "Rename and leave the field label",
        trigger: 'we-input[data-set-label-text] input',
        run: "edit Renamed && click body",
    },
    goBackToBlocks(),
    {
        trigger: ":iframe .s_website_form_field",
    },
    {
        content: "Select form itself (not a specific field)",
        trigger: ':iframe section.s_website_form',
        run: "click",
    },
    ...selectButtonByText('Send an E-mail'),
    {
        content: "Form has a model name",
        trigger: ':iframe section.s_website_form form[data-model_name="mail.mail"]',
        run: "click",
    }, {
        content: 'Edit the Phone Number field',
        trigger: ':iframe input[name="phone"]',
        run: "click",
    }, {
        content: 'Change the label position of the phone field',
        trigger: 'we-button[data-select-label-position="right"]',
        run: "click",
    },
    ...addCustomField("char", "text", "Conditional Visibility Check 1", false),
    ...addCustomField("char", "text", "Conditional Visibility Check 2", false),
    ...selectButtonByData("data-set-visibility='conditional'"),
    ...selectButtonByData("data-set-visibility-dependency='Conditional Visibility Check 1'"),
    ...addCustomField("char", "text", "Conditional Visibility Check 2", false),
    ...selectFieldByLabel("Conditional Visibility Check 1"),
    ...selectButtonByData("data-set-visibility='conditional'"),
    {
        content: "Check that 'Conditional Visibility Check 2' is not in the list of the visibility selector of Conditional Visibility Check 1",
        trigger: "we-select[data-name='hidden_condition_opt']:not(:has(we-button[data-set-visibility-dependency='Conditional Visibility Check 2']))",
    },
    ...addCustomField("char", "text", "Conditional Visibility Check 3", false),
    ...addCustomField("char", "text", "Conditional Visibility Check 4", false),
    ...selectButtonByData("data-set-visibility='conditional'"),
    ...selectButtonByData("data-set-visibility-dependency='Conditional Visibility Check 3'"),
    {
        content: "Change the label of 'Conditional Visibility Check 4' and change it to 'Conditional Visibility Check 3'",
        trigger: 'we-input[data-set-label-text] input',
        // TODO: remove && click body
        run: "edit Conditional Visibility Check 3 && click body",
    },
    {
        content: "Check that the conditional visibility of the renamed field is removed",
        trigger: "we-customizeblock-option.snippet-option-WebsiteFieldEditor we-select:contains('Visibility'):has(we-toggler:contains('Always Visible'))",
    },
    ...addCustomField("char", "text", "Conditional Visibility Check 5", false),
    ...addCustomField("char", "text", "Conditional Visibility Check 6", false),
    ...selectButtonByData("data-set-visibility='conditional'"),
    {
        content: "Change the label of 'Conditional Visibility Check 6' and change it to 'Conditional Visibility Check 5'",
        trigger: 'we-input[data-set-label-text] input',
        // TODO: remove && click body
        run: "edit Conditional Visibility Check 5 && click body",
    },
    {
        content: "Check that 'Conditional Visibility Check 5' is not in the list of the renamed field",
        trigger: "we-customizeblock-option.snippet-option-WebsiteFieldEditor we-select[data-name='hidden_condition_opt']:not(:has(we-button:contains('Conditional Visibility Check 5')))",
    },
    ...addExistingField('email_cc', 'text', 'Test conditional visibility', false, {visibility: CONDITIONALVISIBILITY, condition: 'odoo'}),
    {
        content: "Ensure that the description has correctly been added on the field",
        trigger: ":iframe .s_website_form_field:contains('Test conditional visibility') .s_website_form_field_description",
    },
    // Check that visibility condition is deleted on dependency type change.
    ...addCustomField("char", "text", "dependent", false, {visibility: CONDITIONALVISIBILITY}),
    ...addCustomField("selection", "radio", "dependency", false),
    ...selectFieldByLabel("dependent"),
    ...selectButtonByData('data-set-visibility-dependency="dependency"'),
    ...selectFieldByLabel("dependency"),
    ...selectButtonByData('data-custom-field="char"'),
    ...selectFieldByLabel("dependent"),
    {
        content: "Open the select",
        trigger: 'we-select:has(we-button[data-set-visibility="visible"]) we-toggler',
        run: "click",
    },
    {
        content: "Check that the field no longer has conditional visibility",
        trigger: "we-select we-button[data-set-visibility='visible'].active",
    },

    ...addExistingField('date', 'text', 'Test Date', true),

    ...addExistingField('record_name', 'text', 'Awesome Label', false, {visibility: HIDDEN}),

    ...addExistingField('body_html', 'textarea', 'Your Message', true),

    ...addExistingField('recipient_ids', 'checkbox'),

    ...addCustomField('one2many', 'checkbox', 'Products', true),
    {
        content: "Change Option 1 label",
        trigger: 'we-list table input:eq(0)',
        run: "edit Iphone && press Tab",
    }, {
        content: "Change Option 2 label",
        trigger: 'we-list table input:eq(1)',
        run: "edit Galaxy S && press Tab",
    },{
        content: "Change first Option 3 label",
        trigger: 'we-list table input:eq(2)',
        run: "edit Xperia && press Tab",
    },
    {
        content: "Click on Add new Checkbox",
        trigger: 'we-list we-button.o_we_list_add_optional',
        run: "click",
    },
    {
        content: "Change added Option label",
        trigger: 'we-list table input:eq(3)',
        run: "edit Wiko Stairway && press Tab",
    }, {
        content: "Check the resulting field",
        trigger: ":iframe .s_website_form_field.s_website_form_custom.s_website_form_required" +
                    ":has(.s_website_form_multiple[data-display='horizontal'])" +
                    ":has(.checkbox:has(label:contains('Iphone')):has(input[type='checkbox'][required]))" +
                    ":has(.checkbox:has(label:contains('Galaxy S')):has(input[type='checkbox'][required]))" +
                    ":has(.checkbox:has(label:contains('Xperia')):has(input[type='checkbox'][required]))" +
                    ":has(.checkbox:has(label:contains('Wiko Stairway')):has(input[type='checkbox'][required]))",
    },
    ...selectButtonByData('data-multi-checkbox-display="vertical"'),
    {
        content: "Check the resulting field",
        trigger: ":iframe .s_website_form_field.s_website_form_custom.s_website_form_required" +
                    ":has(.s_website_form_multiple[data-display='vertical'])" +
                    ":has(.checkbox:has(label:contains('Iphone')):has(input[type='checkbox'][required]))" +
                    ":has(.checkbox:has(label:contains('Galaxy S')):has(input[type='checkbox'][required]))" +
                    ":has(.checkbox:has(label:contains('Xperia')):has(input[type='checkbox'][required]))" +
                    ":has(.checkbox:has(label:contains('Wiko Stairway')):has(input[type='checkbox'][required]))",
    },
    // Check conditional visibility for the relational fields
    ...selectButtonByData("data-set-visibility='conditional'"),
    ...selectButtonByData("data-set-visibility-dependency='recipient_ids'"),
    ...selectButtonByText("Is not equal to"),
    ...selectButtonByText("Mitchell Admin"),
    ...clickOnSave(),
    {
        content: "Check 'products' field is visible.",
        trigger: `:iframe .s_website_form:has(${triggerFieldByLabel("Products")}:visible)`,
    }, {
        content: "choose the option 'Mitchell Admin' of partner.",
        trigger: ":iframe .checkbox:has(label:contains('Mitchell Admin')) input[type='checkbox']",
        run: "click",
    }, {
        content: "Check 'products' field is not visible.",
        trigger: ":iframe .s_website_form" +`:has(${triggerFieldByLabel("Products")}:not(:visible))`,
    },
    ...clickOnEditAndWaitEditMode(),
    ...addCustomField('selection', 'radio', 'Service', true),
    {
        content: "Change Option 1 label",
        trigger: 'we-list table input:eq(0)',
        run: "edit After-sales Service",
    }, {
        content: "Change Option 2 label",
        trigger: 'we-list table input:eq(1)',
        run: "edit Invoicing Service",
    }, {
        content: "Change first Option 3 label",
        trigger: 'we-list table input:eq(2)',
        run: "edit Development Service",
    },
    {
        // TODO: Fix code to avoid this behavior
        content: "Click outside focused element before click on add new checkbox otherwise button does'nt work",
        trigger: "we-list we-title",
        run: "click",
    },
    {
        content: "Click on Add new Checkbox",
        trigger: 'we-list we-button.o_we_list_add_optional',
        run: "click",
    }, {
        content: "Change last Option label",
        trigger: 'we-list table input:eq(3)',
        run: "edit Management Service",
    }, {
        content: "Mark the field as not required",
        trigger: 'we-button[data-name="required_opt"] we-checkbox',
        run: function () {
            // We need this 'setTimeout' to ensure that the 'blur' event of
            // the input has enough time to be executed. Without it, the
            // click on the 'we-checkbox' takes priority, and the 'blur'
            // event is not executed (see the '_onListItemBlurInput'
            // function of the 'we-list' widget)."
            setTimeout(() => {
                this.anchor.click();
            }, 500);
        },
    }, {
        content: "Check the resulting field",
        trigger: ":iframe .s_website_form_field.s_website_form_custom:not(.s_website_form_required)" +
                    ":has(.radio:has(label:contains('After-sales Service')):has(input[type='radio']:not([required])))" +
                    ":has(.radio:has(label:contains('Invoicing Service')):has(input[type='radio']:not([required])))" +
                    ":has(.radio:has(label:contains('Development Service')):has(input[type='radio']:not([required])))" +
                    ":has(.radio:has(label:contains('Management Service')):has(input[type='radio']:not([required])))",
    },

    ...addCustomField('many2one', 'select', 'State', true),

    // Customize custom selection field
    {
        content: "Change Option 1 Label",
        trigger: 'we-list table input:eq(0)',
        run: "edit Germany",
    }, {
        content: "Change Option 2 Label",
        trigger: 'we-list table input:eq(1)',
        run: "edit Belgium",
    }, {
        content: "Change first Option 3 label",
        trigger: 'we-list table input:eq(2)',
        run: "edit France",
    },
    {
        // TODO: Fix code to avoid this behavior
        content: "Click outside focused element before click on add new checkbox otherwise button does'nt work",
        trigger: "we-list we-title",
        run: "click",
    },
    {
        content: "Click on Add new Checkbox",
        trigger: 'we-button.o_we_list_add_optional',
        run: "click",
    },
    {
        // TODO: Fix code to avoid this behavior
        content: "Click outside focused element before click on add new checkbox otherwise button does'nt work",
        trigger: "we-list we-title",
        run: "click",
    },
    {
        content: "Change last Option label",
        trigger: 'we-list table input:eq(3)',
        // TODO: Fix code to avoid blur event
        run: "edit Canada",
    }, {
        content: "Remove Germany Option",
        trigger: '.o_we_select_remove_option:eq(0)',
        run: "click",
    },
    {
        // TODO: Fix code to avoid this behavior
        content: "Click outside focused element before click on add new checkbox otherwise button does'nt work",
        trigger: "we-list we-title",
        run: "click",
    },
    {
        content: "Click on Add new Checkbox",
        trigger: 'we-list we-button.o_we_list_add_optional',
        run: "click",
    }, {
        content: "Change last option label with a number",
        trigger: 'we-list table input:eq(3)',
        run: "edit 44 - UK",
    }, {
        content: "Check that the input value is the full option value",
        trigger: 'we-list table input:eq(3)',
        run: () => {
            // We need this 'setTimeout' to ensure that the 'input' event of
            // the input has enough time to be executed (see the
            // '_onListItemBlurInput' function of the 'we-list' widget).
            setTimeout(() => {
                const addedOptionEl = document.querySelector('iframe.o_iframe').contentDocument.querySelector('.s_website_form_field select option[value="44 - UK"]');
                if (!addedOptionEl) {
                    console.error('The number option was not correctly added');
                }
            }, 500);
        },
    }, {
        content: "Check the resulting snippet",
        trigger: ":iframe .s_website_form_field.s_website_form_custom.s_website_form_required" +
                    ":has(label:contains('State'))" +
                    ":has(select[required])" +
                    ":has(option:contains('Belgium')):not([selected])" +
                    ":has(option:contains('France'))" +
                    ":has(option:contains('Canada'))" +
                    ":has(option:contains('44 - UK'))" +
                    ":not(:has(option:contains('Germany')))",
    },

    ...addExistingField('attachment_ids', 'file', 'Invoice Scan'),

    {
        content: "Insure the history step of the editor is not checking for unbreakable",
        trigger: ':iframe #wrapwrap',
        run: () => {
            const wysiwyg = $('iframe:not(.o_ignore_in_tour)').contents().find('#wrapwrap').data('wysiwyg');
            wysiwyg.odooEditor.historyStep(true);
        },
    },
    // Edit the submit button using linkDialog.
    {
        content: "Click submit button to show edit popover",
        trigger: ':iframe .s_website_form_send',
        run: "click",
    }, {
        content: "Click on Edit Link in Popover",
        trigger: ':iframe .o_edit_menu_popover .o_we_edit_link',
        run: "click",
    }, {
        content: "Check that no URL field is suggested",
        trigger: '.oe-toolbar:not(.oe-floating):has(#url_row:hidden)',
    }, {
        content: "Change button's style",
        trigger: '.dropdown:has([name="link_style_color"]) > button',
        run: "click",
    }, {
        trigger: "[data-value=custom]",
        run: "click",
    }, {
        trigger: ".dropdown:has([name=link_style_shape]) > button",
        run: "click",
    }, {
        trigger: "[data-value=rounded-circle]",
        run: "click",
    }, {
        trigger: ".dropdown:has([name=link_style_size]) > button",
        run: "click",
    }, {
        trigger: "[data-value=sm]",
        run: "click",
    }, {
        content: "Check the resulting button",
        trigger: ':iframe .s_website_form_send.btn.btn-sm.btn-custom.rounded-circle',
    },
    // Add a default value to a auto-fillable field.
    {
        content: 'Select the name field',
        trigger: ':iframe .s_website_form_field:eq(0)',
        run: "click",
    }, {
        content: 'Set a default value to the name field',
        trigger: 'we-input[data-attribute-name="value"] input',
        run: "edit John Smith",
    },

    // Add two fields: the 1st one's visibility is tied to the 2nd one
    // being set, and the 2nd one is autopopulated. As a result, both
    // should be visible by default.
    ...addCustomField("char", "text", "field A", false, {visibility: CONDITIONALVISIBILITY}),
    ...addCustomField("char", "text", "field B", false),
    ...selectFieldByLabel("field A"),
    ...selectButtonByData('data-set-visibility-dependency="field B"'),
    ...selectButtonByData('data-select-data-attribute="set"'),
    ...selectFieldByLabel("field B"),
    {
        content: "Insert default value",
        trigger: 'we-input[data-attribute-name="value"] input',
        run: "edit prefilled",
    },
    ...clickOnSave(),
    {
        content: 'Verify value attribute and property',
        trigger: ':iframe .s_website_form_field:eq(0) input[value="John Smith"]:value("Mitchell Admin")',
        run: "click",
    },
    {
        content: 'Verify that phone field is still auto-fillable',
        trigger: ':iframe .s_website_form_field input[data-fill-with="phone"]:value("+1 555-555-5555")',
        run: "click",
    },
    // Check that the resulting form behavior is correct.
    {
        content: "Check that field B prefill text is set",
        trigger: `:iframe ${triggerFieldByLabel("field B")}:has(input[value="prefilled"])`,
    }, {
        content: "Check that field A is visible",
        trigger: `:iframe .s_website_form:has(${triggerFieldByLabel("field A")}:visible)`,
    },
    // A) Check that if we edit again and save again the default value is
    // not deleted.
    // B) Add a 3rd field. Field A's visibility is tied to field B being set,
    // field B is autopopulated and its visibility is tied to field C being
    // set, and field C is empty.
    ...clickOnEditAndWaitEditMode(),
    {
        content: 'Edit the form',
        trigger: ':iframe .s_website_form_field:eq(0) input',
        run: 'click',
    },
    ...addCustomField("char", "text", "field C", false),
    ...selectFieldByLabel("field B"),
    ...selectButtonByText(CONDITIONALVISIBILITY),
    ...selectButtonByText(CONDITIONALVISIBILITY),
    {
        content: "Check that there is a comparator after two clicks on 'Visible only if'",
        trigger: "[data-attribute-name='visibilityComparator']",
        run: function () {
            if (!this.anchor.querySelector("we-button.active")) {
                console.error("A default comparator should be set");
            }
        },
    },
    ...selectButtonByData('data-set-visibility-dependency="field C"'),
    ...selectButtonByData('data-select-data-attribute="set"'),
    ...clickOnSave(),

    // Check that the resulting form behavior is correct.
    {
        content: 'Verify that the value has not been deleted',
        trigger: ':iframe .s_website_form_field:eq(0) input[value="John Smith"]',
        run: "click",
    }, {
        content: "Check that fields A and B are not visible and that field B's prefill text is still set",
        trigger: ":iframe .s_website_form" +
            `:has(${triggerFieldByLabel("field A")}:not(:visible))` +
            `:has(${triggerFieldByLabel("field B")}` +
            `:has(input[value="prefilled"]):not(:visible))`,
    }, {
        content: "Type something in field C",
        trigger: `:iframe ${triggerFieldByLabel("field C")} input`,
        run: "edit Sesame",
    }, {
        content: "Check that fields A and B are visible",
        trigger: `:iframe .s_website_form:has(${triggerFieldByLabel("field B")}:visible)` +
            `:has(${triggerFieldByLabel("field A")}:visible)`,
    },

    // Have field A's visibility tied to field B containing something,
    // while field B's visibility is also tied to another field.
    ...clickOnEditAndWaitEditMode(),
    ...selectFieldByLabel("field A"),
    {
        content: "Verify that the form editor appeared",
        trigger: ".o_we_customize_panel .snippet-option-WebsiteFormEditor",
    },
    ...selectButtonByData('data-select-data-attribute="contains"'),
    {
        content: "Tie the visibility of field A to field B containing 'peek-a-boo'",
        trigger: "we-input[data-name=hidden_condition_additional_text] input",
        run: "edit peek-a-boo",
    },
    ...clickOnSave(),

    // Check that the resulting form works and does not raise an error.
     {
        content: "Write anything in C",
        trigger: `:iframe ${triggerFieldByLabel("field C")} input`,
        run: "edit Mellon && press Tab",
    }, {
        content: "Check that field B is visible, but field A is not",
        trigger: `:iframe .s_website_form:has(${triggerFieldByLabel("field B")}:visible)` +
            `:has(${triggerFieldByLabel("field A")}:not(:visible))`,
    }, {
        content: "Insert 'peek-a-boo' in field B",
        trigger: `:iframe ${triggerFieldByLabel("field B")} input`,
        run: "edit peek-a-boo",
    }, {
        content: "Check that field A is visible",
        trigger: `:iframe .s_website_form:has(${triggerFieldByLabel("field A")}:visible)`,
    },
    ...clickOnEditAndWaitEditMode(),
    ...addCustomField("char", "text", "Philippe of Belgium", false),
    {
        content: "Select the 'Subject' field",
        trigger: ':iframe .s_website_form_field.s_website_form_model_required:has(label:contains("Subject"))',
        run: "click",
    },
    ...selectButtonByText(CONDITIONALVISIBILITY),
    ...selectButtonByData('data-set-visibility-dependency="Philippe of Belgium"'),
    ...selectButtonByData('data-select-data-attribute="set"'),
    {
        content: "Set a default value to the 'Subject' field",
        trigger: 'we-input[data-attribute-name="value"] input',
        run: "edit Default Subject",
    },
    {
        content: "Select the 'Your Message' field",
        trigger: ':iframe .s_website_form_field.s_website_form_required:has(label:contains("Your Message"))',
        run: "click",
    },
    ...selectButtonByText(CONDITIONALVISIBILITY),
    ...selectButtonByData('data-set-visibility-dependency="Philippe of Belgium"'),
    ...selectButtonByData('data-select-data-attribute="set"'),

    ...clickOnSave(),
    // Ensure that a field required for a model is not disabled when
    // conditionally hidden.
    {
        content: "Check that the 'Subject' field is not disabled",
        trigger: `:iframe .s_website_form:has(.s_website_form_model_required ` +
            `.s_website_form_input[value="Default Subject"]:not([disabled]):not(:visible))`,
    },
    // Ensure that a required field (but not for a model) is disabled when
    // conditionally hidden.
    {
        content: "Check that the 'Your Message' field is disabled",
        trigger: `:iframe .s_website_form:has(.s_website_form_required ` +
            `.s_website_form_input[name="body_html"][required][disabled]:not(:visible))`,
    },

    ...clickOnEditAndWaitEditMode(),
    {
        content: "Select the 'Subject' field",
        trigger: ':iframe .s_website_form_field.s_website_form_model_required:has(label:contains("Subject"))',
        run: "click",
    },
    ...selectButtonByData("data-set-visibility='visible'"),
    {
        content: "Empty the default value of the 'Subject' field",
        trigger: 'we-input[data-attribute-name="value"] input',
        run: "clear",
    },
    {
        content: "Select the 'Your Message' field",
        trigger: ':iframe .s_website_form_field.s_website_form_required:has(label:contains("Your Message"))',
        run: "click",
    },
    ...selectButtonByData("data-set-visibility='visible'"),
    // This step is to ensure select fields are properly cleaned before
    // exiting edit mode
    {
        content: "Click on the select field",
        trigger: ":iframe .s_website_form_field select",
        run: "click",
    },
    {
        content: 'Click on the submit button',
        trigger: ':iframe .s_website_form_send',
        run: 'click',
    },
    {
        content: 'Change the Recipient Email',
        trigger: '[data-field-name="email_to"] input',
        // TODO: remove && click we-title
        run: "edit test@test.test && click we-title",
    },
    // Test a field visibility when it's tied to another Date [Time] field
    // being set.
    ...addCustomField("char", "text", "field D", false, { visibility: CONDITIONALVISIBILITY }),
    ...addCustomField("date", "text", "field E", false),
    ...selectFieldByLabel("field D"),
    ...selectButtonByData('data-set-visibility-dependency="field E"'),
    ...selectButtonByData('data-select-data-attribute="after"'),
    {
        content: "Enter a date in the date input",
        trigger: "[data-name='hidden_condition_additional_date'] input",
        // TODO: remove && click .o_we_customize_panel
        run: "edit 03/28/2017 && click .o_we_customize_panel",
    },
    ...clickOnSave(),
    {
        content: "Enter an invalid date in field E",
        trigger: `:iframe ${triggerFieldByLabel("field E")} input`,
        run() {
            this.anchor.value = "25071981";
            this.anchor.dispatchEvent(new InputEvent("input", {bubbles: true}));
            // Adds a delay to let the input code run.
            setTimeout(() => {
                this.anchor.classList.add("invalidDate");
            }, 500);
        },
    },
    {
        content: "Enter an valid date in field E",
        trigger: `:iframe ${triggerFieldByLabel("field E")} input.invalidDate`,
        run() {
            this.anchor.classList.remove("invalidDate");
            this.anchor.value = "07/25/1981";
            this.anchor.dispatchEvent(new InputEvent("input", {bubbles: true}));
            // Adds a delay to let the input code run.
            setTimeout(() => {
                this.anchor.classList.add("validDate");
            }, 500);
        },
    },
    {
        content: "Click to open the date picker popover from field E",
        trigger: `:iframe ${triggerFieldByLabel("field E")} input.validDate`,
        run(actions) {
            this.anchor.classList.remove("validDate");
            actions.click();
        },
    },
    {
        content: "Select today's date from the date picker",
        trigger: ":iframe .o_datetime_picker .o_date_item_cell.o_today",
        run: "click",
    },
    {
        content: "Check that field D is visible",
        trigger: `:iframe .s_website_form:has(${triggerFieldByLabel("field D")}:visible)`,
    },
    ...clickOnEditAndWaitEditMode(),
    // The next four calls to "addCustomField" are there to ensure such
    // characters do not make the form editor crash.
    ...addCustomField("char", "text", "''", false),
    ...addCustomField("char", "text", '""', false),
    ...addCustomField("char", "text", "``", false),
    ...addCustomField("char", "text", "\\", false),

    // Ensure that the description option is working as wanted.
    ...addCustomField("char", "text", "Check description option", false),
    changeOption("WebsiteFieldEditor", "we-button[data-toggle-description] we-checkbox"),
    {
        content: "Ensure that the description has correctly been added on the field",
        trigger: ":iframe .s_website_form_field:contains('Check description option') .s_website_form_field_description",
    },

    ...clickOnSave(),
    {
        content: 'Verify that the recipient email has been saved',
        // We have to this that way because the input type = hidden.
        trigger: ':iframe form:has(input[name="email_to"][value="test@test.test"])',
    }
]);

function editContactUs(steps) {
return [
    {
        trigger: "#oe_snippets .oe_snippet_thumbnail",
    },
    {
        content: "Select the contact us form by clicking on an input field",
        trigger: ":iframe .s_website_form input",
        run: "click",
    },
    ...steps,
    ...clickOnSave(),
];
}

registerWebsitePreviewTour('website_form_contactus_edition_with_email', {
    url: '/contactus',
    edition: true,
}, () => editContactUs([
    {
        content: 'Change the Recipient Email',
        trigger: '[data-field-name="email_to"] input',
        // TODO: remove && click body
        run: "edit test@test.test && click body",
    },
]));
registerWebsitePreviewTour('website_form_contactus_edition_no_email', {
    url: '/contactus',
    edition: true,
}, () => editContactUs([
    {
        content: "Change a random option",
        trigger: '[data-set-mark] input',
        run: "edit ** && click body",
    }, {
        content: "Check that the recipient email is correct",
        trigger: 'we-input[data-field-name="email_to"] input:value("website_form_contactus_edition_no_email@mail.com")',
    },
]));

registerWebsitePreviewTour('website_form_conditional_required_checkboxes', {
    url: '/',
    edition: true,
}, () => [
    // Create a form with two checkboxes: the second one required but
    // invisible when the first one is checked. Basically this should allow
    // to have: both checkboxes are visible by default but the form can
    // only be sent if one of the checkbox is checked.
    {
        content: "Add the form snippet",
        trigger: '#oe_snippets .oe_snippet .oe_snippet_thumbnail[data-snippet=s_website_form]',
        run: "drag_and_drop :iframe #wrap",
    },
    {
        trigger: ":iframe .s_website_form_field",
    },
    {
        content: "Select the form by clicking on an input field",
        trigger: ':iframe section.s_website_form input',
        async run(actions) {
            await actions.click();

            // The next steps will be about removing non essential required
            // fields. For the robustness of the test, check that amount
            // of field stays the same.
            const requiredFields = this.anchor.closest("[data-snippet]").querySelectorAll(".s_website_form_required");
            if (requiredFields.length !== NB_NON_ESSENTIAL_REQUIRED_FIELDS_IN_DEFAULT_FORM) {
                console.error('The amount of required fields seems to have changed');
            }
        },
    },
    ...((function () {
        const steps = [];
        for (let i = 0; i < NB_NON_ESSENTIAL_REQUIRED_FIELDS_IN_DEFAULT_FORM; i++) {
            steps.push({
                content: "Select required field to remove",
                trigger: ':iframe .s_website_form_required .s_website_form_input',
                run: "click",
            });
            steps.push({
                content: "Remove required field",
                trigger: ':iframe .oe_overlay .oe_snippet_remove',
                run: "click",
            });
        }
        return steps;
    })()),
    ...addCustomField('boolean', 'checkbox', 'Checkbox 1', false),
    ...addCustomField('boolean', 'checkbox', 'Checkbox 2', true, {visibility: CONDITIONALVISIBILITY}),
    {
        content: "Open condition item select",
        trigger: 'we-select[data-name="hidden_condition_opt"] we-toggler',
        run: "click",
    }, {
        content: "Choose first checkbox as condition item",
        trigger: 'we-button[data-set-visibility-dependency="Checkbox 1"]',
        run: "click",
    }, {
        content: "Open condition comparator select",
        trigger: 'we-select[data-attribute-name="visibilityComparator"] we-toggler',
        run: "click",
    }, {
        content: "Choose 'not equal to' comparator",
        trigger: 'we-button[data-select-data-attribute="!selected"]',
        run: "click",
    },
    ...clickOnSave(),

    // Check that the resulting form behavior is correct
    {
        content: "Wait for page reload",
        trigger: 'body:not(.editor_enable) :iframe [data-snippet="s_website_form"]',
        run: function (actions) {
            // The next steps will be about removing non essential required
            // fields. For the robustness of the test, check that amount
            // of field stays the same.
            const essentialFields = this.anchor.querySelectorAll(".s_website_form_model_required");
            if (essentialFields.length !== ESSENTIAL_FIELDS_VALID_DATA_FOR_DEFAULT_FORM.length) {
                console.error('The amount of model-required fields seems to have changed');
            }
        },
    },
    {
        content: "Wait the form is loaded before fill it",
        trigger: ":iframe form:contains(checkbox 2)",
    },
    ...essentialFieldsForDefaultFormFillInSteps,
    {
        content: 'Try sending empty form',
        trigger: ':iframe .s_website_form_send',
        run: "click",
    }, {
        content: 'Check the form could not be sent',
        trigger: ':iframe #s_website_form_result.text-danger',
    }, {
        content: 'Check the first checkbox',
        trigger: ':iframe input[type="checkbox"][name="Checkbox 1"]',
        run: "click",
    }, {
        content: 'Check the second checkbox is now hidden',
        trigger: ':iframe .s_website_form:has(input[type="checkbox"][name="Checkbox 2"]:not(:visible))',
    }, {
        content: 'Try sending the form',
        trigger: ':iframe .s_website_form_send',
        run: "click",
    }, {
        content: "Check the form was sent (success page without form)",
        trigger: ':iframe body:not(:has([data-snippet="s_website_form"])) .fa-paper-plane',
    }, {
        content: "Go back to the form",
        trigger: ':iframe a.navbar-brand.logo',
        run: "click",
    },
    {
        content: "Wait the form is loaded before fill it",
        trigger: ":iframe form:contains(checkbox 2)",
    },
    ...essentialFieldsForDefaultFormFillInSteps,
    {
        content: 'Check the second checkbox',
        trigger: ':iframe input[type="checkbox"][name="Checkbox 2"]',
        run: "click",
    }, {
        content: 'Try sending the form again',
        trigger: ':iframe .s_website_form_send',
        run: "click",
    }, {
        content: "Check the form was again sent (success page without form)",
        trigger: ':iframe body:not(:has([data-snippet="s_website_form"])) .fa-paper-plane',
    }
]);

registerWebsitePreviewTour('website_form_contactus_change_random_option', {
    url: '/contactus',
    edition: true,
}, () => editContactUs([
    {
        content: "Change a random option",
        trigger: '[data-set-mark] input',
        // TODO: remove && click body
        run: "edit ** && click body",
    },
]));

registerWebsitePreviewTour("website_form_nested_forms", {
    url: "/my/account",
    edition: true,
},
() => [
    {
        trigger: ".o_website_preview.editor_enable.editor_has_snippets",
        noPrepend: true,
    },
    {
        trigger: `#oe_snippets .oe_snippet[name="Form"].o_we_draggable .oe_snippet_thumbnail:not(.o_we_already_dragging)`,
        content: "Try to drag the form into another form",
        run: "drag_and_drop :iframe #wrap .o_portal_details a",
    },
    {
        content: "Check the form was not dropped into another form",
        trigger:
            ":iframe form[action='/my/account']:not(:has([data-snippet='s_website_form']))",
        run: () => null,
    },
]);

// Check that the editable form content is actually editable.
registerWebsitePreviewTour("website_form_editable_content", {
    url: "/",
    edition: true,
}, () => [
    {
        trigger: ".o_website_preview.editor_enable.editor_has_snippets",
    },
    {
        trigger: `#oe_snippets .oe_snippet[name="Form"].o_we_draggable .oe_snippet_thumbnail:not(.o_we_ongoing_insertion)`,
        run: "drag_and_drop :iframe #wrap",
    },
    {
        trigger: ":iframe .s_website_form_field",
    },
    {
        content: "Check that a form field is not editable",
        trigger: ":iframe section.s_website_form input",
        run: function () {
            if (this.anchor.isContentEditable) {
                console.error("A form field should not be editable.");
            }
        },
    },
    {
        content: "Go back to blocks",
        trigger: ".o_we_add_snippet_btn",
        run: "click",
    },
    ...insertSnippet({id: "s_three_columns", name: "Columns", groupName: "Columns"}),
    {
        content: "Select the first column",
        trigger: ":iframe .s_three_columns .row > :nth-child(1)",
        run: "click",
    },
    {
        content: "Drag and drop the selected column inside the form",
        trigger: ":iframe .o_overlay_move_options .o_move_handle",
        run: "drag_and_drop :iframe section.s_website_form",
    },
    {
        trigger: ":iframe section.s_website_form .col-lg-4[contenteditable=true]",
    },
    {
        content: "Click on the text inside the dropped form column",
        trigger: ":iframe section.s_website_form h5.card-title",
        run: "dblclick",
    },
    {
        // Simulate a user interaction with the editable content.
        content: "Update the text inside the form column",
        trigger: ":iframe section.s_website_form h5.card-title",
        run: "editor ABC",
    },
    {
        content: "Check that the new text value was correctly set",
        trigger: ":iframe section.s_website_form h5:contains(/^ABC$/)",
    },
    {
        content: "Remove the dropped column",
        trigger: ":iframe .oe_overlay.oe_active .oe_snippet_remove:not(:visible)",
        run: "click",
    },
    ...clickOnSave(),
]);

registerWebsitePreviewTour("website_form_special_characters", {
    url: "/",
    edition: true,
}, () => [
    {
        trigger: ".o_website_preview.editor_enable.editor_has_snippets",
    },
    {
        trigger: `#oe_snippets .oe_snippet[name="Form"].o_we_draggable .oe_snippet_thumbnail:not(.o_we_ongoing_insertion)`,
        run: "drag_and_drop :iframe #wrap",
    },
    {
        trigger: ":iframe .s_website_form_field",
    },
    {
        content: "Select form by clicking on an input field",
        trigger: ":iframe section.s_website_form input",
        run: "click",
    },
    ...addCustomField("char", "text", `Test1"'`, false),
    ...addCustomField("char", "text", 'Test2`\\', false),
    ...clickOnSave(),
    ...essentialFieldsForDefaultFormFillInSteps,
    {
        content: "Complete 'Your Question' field",
        trigger: ":iframe textarea[name='description']",
        run: "edit test",
    }, {
        content: "Complete the first added field",
        trigger: `:iframe input[name="${CSS.escape("Test1&quot;'")}"]`,
        run: "edit test1",
    }, {
        content: "Complete the second added field",
        trigger: `:iframe input[name="${CSS.escape("Test2`\\")}"]`,
        run: "edit test2",
    }, {
        content: "Click on 'Submit'",
        trigger: ":iframe a.s_website_form_send",
        run: "click",
    }, {
        content: "Check the form was again sent (success page without form)",
        trigger: ":iframe body:not(:has([data-snippet='s_website_form'])) .fa-paper-plane",
    },
]);

return __exports;
});
;

/**************************************************************************
*  Filepath: /website/static/tests/tours/website_form_editor_frontend.js  *
*  Lines: 257                                                             *
**************************************************************************/
odoo.define('@website/../tests/tours/website_form_editor_frontend', ['@web/core/network/rpc', '@web/core/registry'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/
const { rpc } = require("@web/core/network/rpc");
const { registry } = require("@web/core/registry");

registry.category("web_tour.tours").add("website_form_editor_tour_submit", {
    steps: () => [
    {
        trigger:  "form[data-model_name='mail.mail']" +
                "[data-success-page='/contactus-thank-you']" +
                ":has(.s_website_form_field:has(label:contains('Your Name')):has(input[type='text'][name='name'][required]))" +
                ":has(.s_website_form_field:has(label:contains('Your Email')):has(input[type='email'][name='email_from'][required]))" +
                ":has(.s_website_form_field:has(label:contains('Your Question')):has(textarea[name='description'][required]))" +
                ":has(.s_website_form_field:has(label:contains('Subject')):has(input[type='text'][name='subject'][required]))" +
                ":has(.s_website_form_field:has(label:contains('Test Date')):has(input[type='text'][name='date'][required]))" +
                ":has(.s_website_form_field:has(label:contains('Awesome Label')):hidden)" +
                ":has(.s_website_form_field:has(label:contains('Your Message')):has(textarea[name='body_html'][required]))" +
                ":has(.s_website_form_field:has(label:contains('Products')):has(input[type='checkbox'][name='Products'][value='Iphone'][required]))" +
                ":has(.s_website_form_field:has(label:contains('Products')):has(input[type='checkbox'][name='Products'][value='Galaxy S'][required]))" +
                ":has(.s_website_form_field:has(label:contains('Products')):has(input[type='checkbox'][name='Products'][value='Xperia'][required]))" +
                ":has(.s_website_form_field:has(label:contains('Products')):has(input[type='checkbox'][name='Products'][value='Wiko Stairway'][required]))" +
                ":has(.s_website_form_field:has(label:contains('Service')):has(input[type='radio'][name='Service'][value='After-sales Service']:not([required])))" +
                ":has(.s_website_form_field:has(label:contains('Service')):has(input[type='radio'][name='Service'][value='Invoicing Service']:not([required])))" +
                ":has(.s_website_form_field:has(label:contains('Service')):has(input[type='radio'][name='Service'][value='Development Service']:not([required])))" +
                ":has(.s_website_form_field:has(label:contains('Service')):has(input[type='radio'][name='Service'][value='Management Service']:not([required])))" +
                ":has(.s_website_form_field:has(label:contains('State')):has(select[name='State'][required]:has(option[value='Belgium'])))" +
                ":has(.s_website_form_field.s_website_form_required:has(label:contains('State')):has(select[name='State'][required]:has(option[value='France'])))" +
                ":has(.s_website_form_field:has(label:contains('State')):has(select[name='State'][required]:has(option[value='Canada'])))" +
                ":has(.s_website_form_field:has(label:contains('Invoice Scan')))" +
                ":has(.s_website_form_field:has(input[name='email_to'][value='test@test.test']))" +
                ":has(.s_website_form_field:has(input[name='website_form_signature']))",
    },
    {
        content:  "Try to send the form with some required fields not filled in",
        trigger:  ".s_website_form_send",
        run: "click",
    },
    {
        trigger:  "form:has(#s_website_form_result.text-danger)" +
                ":has(.s_website_form_field:has(label:contains('Your Name')):not(.o_has_error))" +
                ":has(.s_website_form_field:has(label:contains('Email')).o_has_error)" +
                ":has(.s_website_form_field:has(label:contains('Your Question')).o_has_error)" +
                ":has(.s_website_form_field:has(label:contains('Subject')).o_has_error)" +
                ":has(.s_website_form_field:has(label:contains('Test Date')).o_has_error)" +
                ":has(.s_website_form_field:has(label:contains('Your Message')).o_has_error)" +
                ":has(.s_website_form_field:has(label:contains('Products')).o_has_error)" +
                ":has(.s_website_form_field:has(label:contains('Service')):not(.o_has_error))" +
                ":has(.s_website_form_field:has(label:contains('State')).o_has_error)" +
                ":has(.s_website_form_field:has(label:contains('Invoice Scan')):not(.o_has_error))",
    },
    {
        content:  "Check if required fields were detected and complete the Subject field",
        trigger:  "input[name=subject]",
        run:      "edit Jane Smith",
    },
    {
        content:  "Update required field status by trying to Send again",
        trigger:  ".s_website_form_send",
        run: "click",
    },
    {
        trigger:  "form:has(#s_website_form_result.text-danger)" +
                ":has(.s_website_form_field:has(label:contains('Your Name')):not(.o_has_error))" +
                ":has(.s_website_form_field:has(label:contains('Email')).o_has_error)" +
                ":has(.s_website_form_field:has(label:contains('Your Question')).o_has_error)" +
                ":has(.s_website_form_field:has(label:contains('Subject')):not(.o_has_error))" +
                ":has(.s_website_form_field:has(label:contains('Test Date')).o_has_error)" +
                ":has(.s_website_form_field:has(label:contains('Your Message')).o_has_error)" +
                ":has(.s_website_form_field:has(label:contains('Products')).o_has_error)" +
                ":has(.s_website_form_field:has(label:contains('Service')):not(.o_has_error))" +
                ":has(.s_website_form_field:has(label:contains('State')).o_has_error)" +
                ":has(.s_website_form_field:has(label:contains('Invoice Scan')):not(.o_has_error))",
    },
    {
        content:  "Check if required fields were detected and complete the Message field",
        trigger:  "textarea[name=body_html]",
        run:      "edit A useless message"
    },
    {
        content:  "Update required field status by trying to Send again",
        trigger:  ".s_website_form_send",
        run: "click",
    },
    {
        trigger:  "form:has(#s_website_form_result.text-danger)" +
                ":has(.s_website_form_field:has(label:contains('Your Name')):not(.o_has_error))" +
                ":has(.s_website_form_field:has(label:contains('Email')).o_has_error)" +
                ":has(.s_website_form_field:has(label:contains('Your Question')).o_has_error)" +
                ":has(.s_website_form_field:has(label:contains('Subject')):not(.o_has_error))" +
                ":has(.s_website_form_field:has(label:contains('Test Date')).o_has_error)" +
                ":has(.s_website_form_field:has(label:contains('Your Message')):not(.o_has_error))" +
                ":has(.s_website_form_field:has(label:contains('Products')).o_has_error)" +
                ":has(.s_website_form_field:has(label:contains('Service')):not(.o_has_error))" +
                ":has(.s_website_form_field:has(label:contains('State')).o_has_error)" +
                ":has(.s_website_form_field:has(label:contains('Invoice Scan')):not(.o_has_error))",
    },
    {
        content:  "Check if required fields was detected and check a product. If this fails, you probably broke the cleanForSave.",
        trigger:  "input[name=Products][value='Wiko Stairway']",
        run: "click",
    },
    {
        content:  "Open datetime picker",
        trigger:  ".s_website_form_datetime input",
        run:      "click",
    },
    {
        content:  "Complete Date field",
        trigger:  ".o_date_picker .o_today",
        run: "click",
    },
    {
        content:  "Check another product",
        trigger:  "input[name='Products'][value='Xperia']",
        run: "click",
    },
    {
        content:  "Check a service",
        trigger:  "input[name='Service'][value='Development Service']",
        run: "click",
    },
    {
        content:  "Select a State",
        trigger:  "select[name='State']",
        run:      "select Canada",
    },
    {
        content:  "Complete Your Name field",
        trigger:  "input[name='name']",
        run:      "edit chhagan",
    },
    {
        content:  "Complete Email field",
        trigger:  "input[name=email_from]",
        run:      "edit test@mail.com",
    },
    {
        content: "Complete Subject field",
        trigger: 'input[name="subject"]',
        run: "edit subject",
    },
    {
        content:  "Complete Your Question field",
        trigger:  "textarea[name='description']",
        run:      "edit magan",
    },
    {
        content: "Check if conditional field is visible, it shouldn't.",
        trigger: "body",
        run: function () {
            const style = window.getComputedStyle(this.anchor.getElementsByClassName('s_website_form_field_hidden_if')[0]);
            if (style.display !== 'none') {
                console.error('error This field should be invisible when the name is not odoo');
            }
        }
    },
    {
        content: "Change name input",
        trigger: "input[name='name']",
        run: "edit odoo",
    },
    {
        content: "Check if conditional field is visible, it should.",
        trigger: "input[name='email_cc']",
        run: "click",
    },
    {
        content: "Select state option",
        trigger: "select[name='State']",
        run: "select 44 - UK",
    },
    {
        content:  "Send the form",
        trigger:  ".s_website_form_send",
        run: "click",
    },
    {
        content:  "Check form is submitted without errors",
        trigger:  "#wrap:has(h1:contains('Thank You!'))",
    }
]});

registry.category("web_tour.tours").add("website_form_editor_tour_results", {
    steps: () => [
    {
        content: "Check mail.mail records have been created",
        trigger: "body",
        run: function () {
            var mailDef = rpc(`/web/dataset/call_kw/mail.mail/search_count`, {
                model: "mail.mail",
                method: "search_count",
                args: [[
                    ['email_to', '=', 'test@test.test'],
                    ['body_html', 'like', 'A useless message'],
                    ['body_html', 'like', 'Service : Development Service'],
                    ['body_html', 'like', 'State : 44 - UK'],
                    ['body_html', 'like', 'Products : Xperia,Wiko Stairway']
                ]],
                kwargs: {},
            });
            var success = function(model, count) {
                if (count > 0) {
                    const div = document.createElement("div");
                    div.id = `website_form_editor_success_test_tour_${model}`;
                    document.body.append(div);
                }
            };
            mailDef.then(success.bind(this, 'mail_mail'));
        }
    },
    {
        content:  "Check mail.mail records have been created",
        trigger:  "#website_form_editor_success_test_tour_mail_mail:not(:visible)",
    }
]});
registry.category("web_tour.tours").add('website_form_contactus_submit', {
    url: '/contactus',
    steps: () => [
    // As the demo portal user, only two inputs needs to be filled to send
    // the email
    {
        isActive: ["body:has(.o-livechat-root)"],
        trigger: ":shadow span:contains(select an option above)",
    },
    {
        content: "Fill in the subject",
        trigger: 'input[name="subject"]',
        run: "edit Test",
    },
    {
        content: 'Fill in the message',
        trigger: 'textarea[name="description"]',
        run: "edit Test",
    },
    {
        content: 'Send the form',
        trigger: '.s_website_form_send',
        run: "click",
    },
    {
        content: 'Check form is submitted without errors',
        trigger: '#wrap:has(h1:contains("Thank You!"))',
    },
]});
registry.category("web_tour.tours").add('website_form_contactus_check_changed_email', {
    url: '/contactus',
    steps: () => [
        {
            content: "Check that the recipient email is updated",
            trigger: 'form:has(input[name="email_to"][value="after.change@mail.com"])',
        },
]});

return __exports;
});
;

/*****************************************************************
*  Filepath: /website/static/tests/tours/website_navbar_menu.js  *
*  Lines: 30                                                     *
*****************************************************************/
odoo.define('@website/../tests/tours/website_navbar_menu', ['@web/core/registry'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { registry } = require("@web/core/registry");

registry.category("web_tour.tours").add("website_navbar_menu", {
    url: "/",
    steps: () => [
        {
            content: "Ensure menus are in DOM",
            trigger: ".top_menu .nav-item a:contains(Test Tour Menu)",
        },
        {
            content: "Ensure menus loading is done (so they are actually visible)",
            trigger: "body:not(:has(.o_menu_loading))",
        },
        {
            trigger: `.o_main_nav a[role="menuitem"]:contains(test tour menu)`,
            run: "click",
        },
        {
            trigger: `main:contains(We couldn't find the page you're looking for!)`,
        },
    ],
});

return __exports;
});
;

/*******************************************************************
*  Filepath: /website/static/tests/tours/website_no_dirty_page.js  *
*  Lines: 322                                                      *
*******************************************************************/
odoo.define('@website/../tests/tours/website_no_dirty_page', ['@web/core/browser/browser', '@website/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { browser } = require('@web/core/browser/browser');
const {
    clickOnEditAndWaitEditMode,
    clickOnSave,
    insertSnippet,
    registerWebsitePreviewTour,
} = require('@website/js/tours/tour_utils');

const makeSteps = (steps = []) => [
    ...insertSnippet({
        id: "s_text_image",
        name: "Text - Image",
        groupName: "Content",
    }), {
        content: "Click on Discard",
        trigger: '.o_we_website_top_actions [data-action="cancel"]',
        run: "click",
    }, {
        content: "Check that discarding actually warns when there are dirty changes, and cancel",
        trigger: ".modal-footer .btn-secondary",
        run: "click",
    },
    ...clickOnSave(),
    ...clickOnEditAndWaitEditMode(),
    {
        // This makes sure the last step about leaving edit mode at the end of
        // this tour makes sense.
        content: "Confirm we are in edit mode",
        trigger: 'body.editor_has_snippets',
    },
    ...steps,
    {
        // Makes sure the dirty flag does not happen after a setTimeout or
        // something like that.
        content: "Click elsewhere and wait for a few ms",
        trigger: ":iframe #wrap",
        async run(actions) {
            // TODO: use actions.click(); instead
            this.anchor.click();
            await new Promise((resolve) => {
                browser.setTimeout(() => {
                    document.body.classList.add("o_test_delay");
                    resolve();
                }, 999);
            });
        },
    },
    {
        trigger: "body.o_test_delay",
    },
    {
        content: "Click on Discard",
        trigger: '.o_we_website_top_actions [data-action="cancel"]',
        run: "click",
    }, {
        content: "Confirm we are not in edit mode anymore",
        trigger: 'body:not(.editor_has_snippets)',
    },
];

registerWebsitePreviewTour('website_no_action_no_dirty_page', {
    url: '/',
    edition: true,
}, () => makeSteps());

registerWebsitePreviewTour('website_no_dirty_page', {
    url: '/',
    edition: true,
}, () => makeSteps([
    {
        // This has been known to mark the page as dirty because of the "drag
        // the column on image move" feature.
        content: "Click on default image",
        trigger: ':iframe .s_text_image img',
        run: "click",
    }, {
        content: "Click on default paragraph",
        trigger: ':iframe .s_text_image h2 + p.o_default_snippet_text',
        run: "click",
    }, {
        // TODO this should be done in a dedicated test which would be testing
        // all default snippet texts behaviors. Will be done in master where a
        // task will review this feature.
        // TODO also test that applying an editor command removes that class.
        content: "Make sure the paragraph still acts as a default paragraph",
        trigger: ':iframe .s_text_image h2 + p.o_default_snippet_text',
    }, {
        content: "Click on button",
        trigger: ':iframe .s_text_image .btn',
        async run(actions) {
            await actions.click();
            const el = this.anchor;
            const sel = el.ownerDocument.getSelection();
            sel.collapse(el, 0);
            el.focus();
        },
    }, {
        content: "Add useless space at the end of the snippet class attribute, then click on it",
        trigger: ":iframe .s_text_image",
        async run(actions) {
            this.anchor.setAttribute("class", this.anchor.getAttribute("class") + " ");
            return actions.click();
        },
    },
]));

registerWebsitePreviewTour(
    "website_default_snippet_text",
    {
        url: "/",
        edition: true,
    },
    () => [
        ...insertSnippet({
            id: "s_text_image",
            name: "Text - Image",
            groupName: "Content",
        }),
        ...insertSnippet({
            id: "s_banner",
            name: "Banner",
            groupName: "Intro",
        }),
        {
            content: "Click on first paragraph",
            trigger: ":iframe .s_text_image p.o_default_snippet_text",
            run: "click",
        },
        {
            content: "Select the first word (Write)",
            trigger: ":iframe .s_text_image p.o_default_snippet_text",
            run() {
                const paragraph = this.anchor;
                const range = document.createRange();
                const text = paragraph.textContent;
                const firstWordLength = text.split(" ")[0].length;
                range.setStart(paragraph.firstChild, 0);
                range.setEnd(paragraph.firstChild, firstWordLength);
                const selection = this.anchor.ownerDocument.getSelection();
                selection.removeAllRanges();
                selection.addRange(range);
            },
        },
        {
            content: "Apply bold formatting",
            trigger: ".o_we_toolbar_wrapper #bold",
            run: "click",
        },
        {
            content: "Check if default_snippet_text class is removed",
            trigger: ":iframe .s_text_image p:eq(0)",
            run() {
                if (this.anchor.classList.contains("o_default_snippet_text")) {
                    console.error("The class o_default_snippet_text should be removed");
                }
            },
        },
        {
            content: "Click on second paragraph",
            trigger: ":iframe .s_text_image p.o_default_snippet_text",
            run: "click",
        },
        {
            content: "The paragraph should be selected",
            trigger: ":iframe .s_text_image p:eq(1)",
            run() {
                const pText = this.anchor.textContent;
                const selection = this.anchor.ownerDocument.getSelection();
                if (selection.toString() !== pText) {
                    console.error("The paragraph should be selected");
                }
            },
        },
        {
            content: "Replace the paragraph by typing something",
            trigger: ":iframe .s_text_image p:eq(1)",
            run(actions) {
                // We must invoke 'trigger' from a jQuery object because
                // the 'keyup.snippets_menu' event needs to be dispatched.
                // TODO: Replace this event trigger with vanilla JavaScript
                // once jQuery is removed from the snippets editor.
                $(this.anchor.ownerDocument.body).trigger("keyup.snippets_menu");
                actions.editor("Another brick in the wall");
            },
        },
        {
            content: "Check if default_snippet_text class is removed",
            trigger: ":iframe .s_text_image p:eq(1)",
            run() {
                if (this.anchor.classList.contains("o_default_snippet_text")) {
                    console.error("The class o_default_snippet_text should be removed");
                }
            },
        },
        {
            content: "Re-click on the paragraph",
            trigger: ":iframe .s_text_image p:eq(1)",
            run: "click",
        },
        {
            content: "The paragraph should not be selected",
            trigger: ":iframe .s_text_image p:eq(1)",
            run() {
                const pText = this.anchor.textContent;
                const selection = this.anchor.ownerDocument.getSelection();
                if (selection.toString() === pText) {
                    console.error("The paragraph should not be selected");
                }
            },
        },
        {
            content: "Click on the paragraph",
            trigger: ":iframe .s_banner p.o_default_snippet_text",
            run: "click",
        },
        {
            content: "The paragraph should be selected",
            trigger: ":iframe .s_banner p.o_default_snippet_text",
            run() {
                const pText = this.anchor.textContent.trim();
                const selectionText = this.anchor.ownerDocument.getSelection().toString().trim();
                if (selectionText !== pText) {
                    console.error("The paragraph should be selected: ", selectionText, pText);
                }
            },
        },
        {
            content: "Click elsewhere",
            trigger: ":iframe .s_banner img",
            run: "click",
        },
        {
            content: "Re-click on the paragraph",
            trigger: ":iframe .s_banner p.o_default_snippet_text",
            run: "click",
        },
        {
            content: "The paragraph should not be selected",
            trigger: ":iframe .s_banner p.o_default_snippet_text",
            run() {
                const pText = this.anchor.textContent.trim();
                const selectionText = this.anchor.ownerDocument.getSelection().toString().trim();
                if (selectionText === pText) {
                    console.error("The paragraph should not be selected: ", selectionText, pText);
                }
            },
        },
        ...clickOnSave(),
        ...clickOnEditAndWaitEditMode(),
        {
            content: "Click on the paragraph",
            trigger: ":iframe .s_banner p.o_default_snippet_text",
            run: "click",
        },
        {
            content: "The paragraph should be re-selected",
            trigger: ":iframe .s_banner p.o_default_snippet_text",
            run() {
                const pText = this.anchor.textContent.trim();
                const selectionText = this.anchor.ownerDocument.getSelection().toString().trim();
                if (selectionText !== pText) {
                    console.error("The paragraph should be re-selected: ", selectionText, pText);
                }
            },
        },
    ]
);

registerWebsitePreviewTour('website_no_dirty_lazy_image', {
    url: '/',
    edition: true,
}, () => [
    ...insertSnippet({
        id: 's_text_image',
        name: 'Text - Image',
        groupName: "Content",
    }),
    {
        // Ensure the test keeps testing what it should test (eg if we ever
        trigger: ':iframe img.o_lang_flag[loading="lazy"]',
    },
    {
        content: "Replace first paragraph, to insert a new link",
        // remove the lazy loading on those language img))
        trigger: ':iframe #wrap .s_text_image p',
        run: 'editor SomeTestText',
    },
    {
        trigger: ':iframe #wrap .s_text_image p:contains("SomeTestText")',
    },
    {
        content: "Click elsewhere to be sure the editor fully process the new content",
        trigger: ':iframe #wrap .s_text_image img',
        run: "click",
    },
    {
        trigger: '.o_we_user_value_widget[data-replace-media="true"]',
    },
    {
        content: "Check that there is no more than one dirty flag",
        trigger: ':iframe body',
        run: function () {
            const dirtyCount = this.anchor.querySelectorAll('.o_dirty').length;
            if (dirtyCount !== 1) {
                console.error(dirtyCount + " dirty flag(s) found");
            } else {
                this.anchor.querySelector('#wrap').classList.add('o_dirty_as_expected');
            }
        },
    }, {
        content: "Check previous step went through correctly about dirty flags",
        trigger: ':iframe #wrap.o_dirty_as_expected',
    }
]);

return __exports;
});
;

/******************************************************************
*  Filepath: /website/static/tests/tours/website_page_options.js  *
*  Lines: 95                                                      *
******************************************************************/
odoo.define('@website/../tests/tours/website_page_options', ['@website/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const {
    changeOption,
    clickOnEditAndWaitEditMode,
    clickOnSave,
    clickOnSnippet,
    registerWebsitePreviewTour,
} = require('@website/js/tours/tour_utils');


registerWebsitePreviewTour('website_page_options', {
    url: '/',
    edition: true,
}, () => [
    ...clickOnSnippet({id: 'o_header_standard', name: 'Header'}),
    changeOption('TopMenuVisibility', 'we-select:has([data-visibility]) we-toggler'),
    changeOption('TopMenuVisibility', 'we-button[data-visibility="transparent"]'),
    // It's important to test saving right after changing that option only as
    // this is why this test was made in the first place: the page was not
    // marked as dirty when that option was the only one that was changed.
    ...clickOnSave(),
    {
        content: "Check that the header is transparent",
        trigger: ':iframe #wrapwrap.o_header_overlay',
    },
    ...clickOnEditAndWaitEditMode(),
    ...clickOnSnippet({id: 'o_header_standard', name: 'Header'}),
    changeOption('topMenuColor', 'we-select.o_we_so_color_palette'),
    changeOption('topMenuColor', 'button[data-color="black-50"]', 'background color', 'bottom', true),
    ...clickOnSave(),
    {
        content: "Check that the header is in black-50",
        trigger: ':iframe header#top.bg-black-50',
    },
    ...clickOnEditAndWaitEditMode(),
    ...clickOnSnippet({id: 'o_header_standard', name: 'Header'}),
    changeOption("topMenuColor", '[data-page-option-name="header_text_color"]'),
    changeOption("topMenuColor", 'button[style="background-color:#FF0000;"]', "text color", "bottom", true),
    ...clickOnSave(),
    {
        content: "Check that text color of the header is in red",
        trigger: ':iframe header#top[style=" color: #FF0000;"]',
    },
    {
        content: "Enable the mobile view",
        trigger: ".o_mobile_preview > a",
        run: "click",
    },
    {
        content: "Check that text color of the navbar toggler icon is in red",
        trigger: ':iframe header#top [data-bs-toggle="offcanvas"] .navbar-toggler-icon',
        run: function () {
            if (getComputedStyle(this.anchor).color !== "rgb(255, 0, 0)") {
                console.error("The navbar toggler icon is not in red");
            }
        },
    },
    {
        content: "Disable the mobile view",
        trigger: ".o_mobile_preview > a",
        run: "click",
    },
    ...clickOnEditAndWaitEditMode(),
    ...clickOnSnippet({id: "o_header_standard", name: "Header"}),
    changeOption('TopMenuVisibility', 'we-select:has([data-visibility]) we-toggler'),
    changeOption('TopMenuVisibility', 'we-button[data-visibility="hidden"]'),
    ...clickOnSave(),
    {
        content: "Check that the header is hidden",
        trigger: ':iframe #wrapwrap:has(header#top.d-none.o_snippet_invisible)',
    },
    ...clickOnEditAndWaitEditMode(),
    {
        content: "Click on 'header' in the invisible elements list",
        trigger: '.o_we_invisible_el_panel .o_we_invisible_entry',
        run: "click",
    },
    ...clickOnSnippet({id: 'o_footer', name: 'Footer'}),
    changeOption('HideFooter', 'we-button[data-name="hide_footer_page_opt"] we-checkbox'),
    ...clickOnSave(),
    {
        trigger: ":iframe #wrapwrap header#top:not(.d-none)",
    },
    {
        content: "Check that the footer is hidden and the header is visible",
        trigger: ':iframe #wrapwrap:has(.o_footer.d-none.o_snippet_invisible)',
    },
]);

return __exports;
});
;

/**********************************************************************
*  Filepath: /website/static/tests/tours/website_seo_notification.js  *
*  Lines: 95                                                          *
**********************************************************************/
odoo.define('@website/../tests/tours/website_seo_notification', ['@website/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/
const {
    clickOnEditAndWaitEditMode,
    clickOnSave,
    insertSnippet,
    registerWebsitePreviewTour,
} = require("@website/js/tours/tour_utils");

registerWebsitePreviewTour(
    "website_seo_notification",
    {
        url: "/",
    },
    () => [
        // Part one checks that the SEO notification is displayed when the page title is not set.
        {
            content: "Open new page menu",
            trigger: ".o_menu_systray .o_new_content_container > a",
            run: "click",
        },
        {
            content: "Click on new page",
            trigger: ".o_new_content_element a",
            run: "click",
        },
        {
            content: "Click on Use this template",
            trigger: ".o_page_template .o_button_area:not(:visible)",
            run: "click",
        },
        {
            content: "Insert page name",
            trigger:
                ".modal:not(.o_inactive_modal):contains(new page) .modal-body input[type=text]",
            run: "edit Test Page",
        },
        {
            trigger: "input[type='text']:value(Test Page)",
        },
        {
            content: "Create page",
            trigger:
                ".modal:not(.o_inactive_modal):contains(new page) button.btn-primary:contains(create)",
            run: "click",
        },
        ...insertSnippet({
            id: "s_text_image",
            name: "Text - Image",
            groupName: "Content",
        }),
        ...clickOnSave(),
        {
            content: "Publish your website",
            trigger: ".o_menu_systray_item.o_website_publish_container a",
            run: "click",
        },
        {
            content: "Check the SEO notification is displayed",
            trigger: ".o_notification_manager .o_notification:contains('Page title not set.')",
        },
        {
            trigger: "body:not(:has(.o_notification_manager .o_notification))",
        },

        // Part 2 checks that the SEO notification is not displayed when we are in any page like /my or /shop etc.
        {
            content: "Open the dropdown menu",
            trigger:
                ":iframe #o_main_nav .navbar-nav .dropdown.o_no_autohide_item > a.dropdown-toggle",
            run: "click",
        },
        {
            content: "Click on My Account",
            trigger: ":iframe #o_main_nav .js_usermenu a.dropdown-item.ps-3:contains('My Account')",
            run: "click",
        },
        ...clickOnEditAndWaitEditMode(),
        ...insertSnippet({
            id: "s_text_image",
            name: "Text - Image",
            groupName: "Content",
        }),
        ...clickOnSave(),
        {
            content: "Check the SEO notification should not be displayed",
            trigger: "body:not(:has(.o_notification_manager .o_notification))",
        },
    ]
);

return __exports;
});
;

/************************************************************************
*  Filepath: /website/static/tests/tours/website_snippets_menu_tabs.js  *
*  Lines: 42                                                            *
************************************************************************/
odoo.define('@website/../tests/tours/website_snippets_menu_tabs', ['@website/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const {
    goToTheme,
    registerWebsitePreviewTour,
} = require('@website/js/tours/tour_utils');

registerWebsitePreviewTour("website_snippets_menu_tabs", {
    url: "/",
    edition: true,
}, () => [
    ...goToTheme(),
    {
        trigger: "we-customizeblock-option.snippet-option-ThemeColors",
    },
    {
        content: "Click on the empty 'DRAG BUILDING BLOCKS HERE' area.",
        trigger: ':iframe main > .oe_structure.oe_empty',
        run: 'click',
    },
    ...goToTheme(),
    {
        content: "Verify that the customize panel is not empty.",
        trigger: '.o_we_customize_panel > we-customizeblock-options',
    },
    {
        content: "Click on the style tab.",
        trigger: '#snippets_menu .o_we_customize_snippet_btn',
        run: "click",
    },
    ...goToTheme(),
    {
        content: "Verify that the customize panel is not empty.",
        trigger: '.o_we_customize_panel > we-customizeblock-options',
    },
]);

return __exports;
});
;

/*******************************************************************
*  Filepath: /website/static/tests/tours/website_style_edition.js  *
*  Lines: 148                                                      *
*******************************************************************/
odoo.define('@website/../tests/tours/website_style_edition', ['@web_editor/js/common/utils', '@website/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const weUtils = require("@web_editor/js/common/utils")[Symbol.for("default")];
const {
    clickOnEditAndWaitEditMode,
    clickOnSave,
    goToTheme,
    registerWebsitePreviewTour,
} = require('@website/js/tours/tour_utils');

const TARGET_FONT_SIZE = 20; // The max to not be impacted by the responsive font size system
const TARGET_BODY_BG_COLOR = '#00FF00';
const TARGET_BODY_BG_COLOR_V2 = 'rgb(0, 255, 0)';
const TARGET_BODY_COLOR = '#FF00FF';
const TARGET_BODY_COLOR_V2 = 'rgb(255, 0, 255)';

const checkFontSize = function () {
    const style = document.defaultView.getComputedStyle(this.anchor);
    if (
        !weUtils.areCssValuesEqual(
            style.fontSize,
            `${TARGET_FONT_SIZE}px`,
            "font-size",
            this.anchor
        )
    ) {
        console.error(`Expected the font-size to be equal to ${TARGET_FONT_SIZE}px but found ${style.fontSize} instead`);
    }
};
const checkBodyBgColor = function () {
    const style = document.defaultView.getComputedStyle(this.anchor);
    if (
        !weUtils.areCssValuesEqual(
            style.backgroundColor,
            `${TARGET_BODY_BG_COLOR}`,
            "background-color",
            this.anchor
        )
    ) {
        console.error(`Expected the background color to be equal to ${TARGET_BODY_BG_COLOR} but found ${style.backgroundColor} instead`);
    }
};
const checkBodyColor = function () {
    const style = document.defaultView.getComputedStyle(this.anchor);
    if (!weUtils.areCssValuesEqual(style.color, `${TARGET_BODY_COLOR}`, "color", this.anchor)) {
        console.error(`Expected the color to be equal to ${TARGET_BODY_COLOR} but found ${style.color} instead`);
    }
};

registerWebsitePreviewTour("website_style_edition", {
    url: '/',
    edition: true,
}, () => [
...goToTheme(),
{
    content: "Change font size",
    trigger: '[data-variable="font-size-base"] input',
    run: `edit ${TARGET_FONT_SIZE} && click body`,
},
{
    // Waiting the CSS to be reloaded: the code adds a new assets bundle with
    // a #t=... at the end then removes the old one.
    trigger: ':iframe html:not(:has(link[href$="web.assets_frontend.min.css"]))',
},
{
    content: "Check the font size was properly adapted",
    trigger: ':iframe #wrapwrap',
    run: checkFontSize,
}, {
    content: "Open the color combinations area",
    trigger: '.o_we_theme_presets_collapse we-toggler',
    run: "click",
}, {
    content: "Open a color combination",
    trigger: '.o_we_cc_preview_wrapper',
    run: "click",
}, {
    content: "Edit the background color of that color combination",
    trigger: '.o_we_theme_presets_collapse we-collapse .o_we_so_color_palette:eq(0)',
    run: "click",
}, {
    content: "Choose a color",
    trigger: `.o_we_color_btn[style*="background-color:${TARGET_BODY_BG_COLOR}"]`,
    run: "click",
},
{
    trigger: `
        .o_we_theme_presets_collapse we-collapse .o_we_so_color_palette:eq(0) .o_we_color_preview[style*="${TARGET_BODY_BG_COLOR}"],
        .o_we_theme_presets_collapse we-collapse .o_we_so_color_palette:eq(0) .o_we_color_preview[style*="${TARGET_BODY_BG_COLOR_V2}"]
    `,
},
{
    content: "Check the body background color was properly adapted",
    trigger: ':iframe body',
    run: checkBodyBgColor,
}, {
    content: "Edit the text color of that color combination",
    trigger: '.o_we_theme_presets_collapse we-collapse .o_we_so_color_palette:eq(1)',
    run: "click",
}, {
    content: "Choose a color",
    trigger: `.o_we_color_btn[style*="background-color:${TARGET_BODY_COLOR}"]`,
    run: "click",
},
{
    trigger: `
        .o_we_theme_presets_collapse we-collapse .o_we_so_color_palette:eq(1) .o_we_color_preview[style*="${TARGET_BODY_COLOR}"],
        .o_we_theme_presets_collapse we-collapse .o_we_so_color_palette:eq(1) .o_we_color_preview[style*="${TARGET_BODY_COLOR_V2}"]
    `,
},
{
    content: "Check the body color was properly adapted",
    trigger: ':iframe body',
    run: checkBodyColor,
},
...clickOnSave(),
{
    content: "Check the font size is still ok outside of edit mode",
    trigger: ':iframe body #wrapwrap',
    run: checkFontSize,
}, {
    content: "Check the body background color is still ok outside of edit mode",
    trigger: ':iframe body',
    run: checkBodyBgColor,
}, {
    content: "Check the body color is still ok outside of edit mode",
    trigger: ':iframe body',
    run: checkBodyColor,
},
...clickOnEditAndWaitEditMode(),
...goToTheme(),
{
    trigger: '[data-customize-body-bg-type="NONE"].active',
},
{
    content: "Click on the Background Image selection",
    trigger: '[data-customize-body-bg-type="\'image\'"]:not(.active)',
    run: "click",
}, {
    content: "The media dialog should open",
    trigger: '.o_select_media_dialog',
}]);

return __exports;
});
;

/******************************************************************
*  Filepath: /website/static/tests/tours/website_text_edition.js  *
*  Lines: 74                                                      *
******************************************************************/
odoo.define('@website/../tests/tours/website_text_edition', ['@website/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const {
    insertSnippet,
    goBackToBlocks,
    goToTheme,
    registerWebsitePreviewTour,
} = require('@website/js/tours/tour_utils');

const WEBSITE_MAIN_COLOR = '#ABCDEF';

registerWebsitePreviewTour('website_text_edition', {
    url: '/',
    edition: true,
}, () => [
    ...goToTheme(),
    {
        content: "Open colorpicker to change website main color",
        trigger: 'we-select[data-color="o-color-1"] .o_we_color_preview',
        run: "click",
    },
    {
        content: "Input the value for the new website main color (also make sure it is independent from the backend)",
        trigger: '.o_hex_input',
        run: `edit ${WEBSITE_MAIN_COLOR} && click body`,
    },
    goBackToBlocks(),
    ...insertSnippet({id: "s_text_block", name: "Text", groupName: "Text"}),
    {
        content: "Click on the text block first paragraph (to auto select)",
        trigger: ':iframe .s_text_block p',
        run: "click",
    },
    {
        content: "Open the foreground colorpicker",
        trigger: '#toolbar:not(.oe-floating) #oe-text-color',
        run: "click",
    },
    {
        content: "Go to the 'solid' tab",
        trigger: '.o_we_colorpicker_switch_pane_btn[data-target="custom-colors"]',
        run: "click",
    },
    {
        content: "Input the website main color explicitly",
        trigger: '.o_hex_input',
        run: `edit ${WEBSITE_MAIN_COLOR} && click body`,
    },
    {
        content: "Check that paragraph now uses the main color *class*",
        trigger: ':iframe .s_text_block p',
        run: function (actions) {
            const fontEl = this.anchor.querySelector("font");
            if (!fontEl) {
                console.error("A background color should have been applied");
                return;
            }
            if (fontEl.style.backgroundColor) {
                console.error("The paragraph should not have an inline style background color");
                return;
            }
            if (!fontEl.classList.contains('text-o-color-1')) {
                console.error("The paragraph should have the right background color class");
                return;
            }
        },
    }
]);

return __exports;
});
;

/********************************************************************
*  Filepath: /website/static/tests/tours/website_text_font_size.js  *
*  Lines: 150                                                       *
********************************************************************/
odoo.define('@website/../tests/tours/website_text_font_size', ['@website/js/tours/tour_utils', '@web_editor/js/editor/odoo-editor/src/utils/utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const {
    insertSnippet,
    goToTheme,
    registerWebsitePreviewTour,
} = require('@website/js/tours/tour_utils');
const {FONT_SIZE_CLASSES} = require('@web_editor/js/editor/odoo-editor/src/utils/utils');

const classNameInfo = new Map();
classNameInfo.set("display-1-fs", {scssVariableName: "display-1-font-size", start: 80, end: 90});
classNameInfo.set("display-2-fs", {scssVariableName: "display-2-font-size", start: 72, end: 80});
classNameInfo.set("display-3-fs", {scssVariableName: "display-3-font-size", start: 64, end: 70});
classNameInfo.set("display-4-fs", {scssVariableName: "display-4-font-size", start: 56, end: 60});
classNameInfo.set("h1-fs", {scssVariableName: "h1-font-size", start: 48, end: 50});
classNameInfo.set("h2-fs", {scssVariableName: "h2-font-size", start: 40, end: 42});
classNameInfo.set("h3-fs", {scssVariableName: "h3-font-size", start: 32, end: 38});
classNameInfo.set("h4-fs", {scssVariableName: "h4-font-size", start: 24, end: 34});
classNameInfo.set("h5-fs", {scssVariableName: "h5-font-size", start: 20, end: 30});
classNameInfo.set("h6-fs", {scssVariableName: "h6-font-size", start: 16, end: 26});
classNameInfo.set("base-fs", {scssVariableName: "font-size-base", start: 16, end: 26});
classNameInfo.set("o_small-fs", {scssVariableName: "small-font-size", start: 14, end: 24});

function checkComputedFontSize(fontSizeClass, stage) {
    return {
        content: `Check that the computed font size for ${fontSizeClass} is correct`,
        trigger: `:iframe #wrap .s_text_block .${fontSizeClass}`,
        run: function () {
            const computedFontSize = parseInt(getComputedStyle(this.anchor).fontSize);
            const expectedFontSize = classNameInfo.get(fontSizeClass)[stage];
            const gapBetweenSizes = Math.abs(computedFontSize - expectedFontSize);
            const gapTolerance = 7; // Because the font size is responsive.
            if (gapBetweenSizes > gapTolerance) {
                console.error(`When applied class ${fontSizeClass}, the font size is ` +
                    `${computedFontSize} instead of ~${expectedFontSize}`);
            }
        }
    };
}

function getFontSizeTestSteps(fontSizeClass) {
    return [
        ...insertSnippet({id: "s_text_block", name: "Text", groupName: "Text"}),
        {
            content: `[${fontSizeClass}] Click on the text block first paragraph (to auto select)`,
            trigger: ":iframe .s_text_block p",
            run: "click",
        }, {
            content: `Open the font size dropdown to select ${fontSizeClass}`,
            trigger: "#font-size button",
            run: "click",
        }, {
            content: `Select ${fontSizeClass} in the dropdown`,
            trigger: `a[data-apply-class="${fontSizeClass}"]:contains(${classNameInfo.get(fontSizeClass).start})`,
            run: "click",
        },
        checkComputedFontSize(fontSizeClass, "start"),
        ...goToTheme(),
        {
            content: `Open the collapse to see the font size of ${fontSizeClass}`,
            trigger: `we-collapse:has(we-input[data-variable="` +
            `${classNameInfo.get(fontSizeClass).scssVariableName}"]) we-toggler`,
            run: "click",
        }, {
            content: `Check that the setting for ${fontSizeClass} is correct`,
            trigger: `we-input[data-variable="${classNameInfo.get(fontSizeClass).scssVariableName}"]`
                + ` input:value("${classNameInfo.get(fontSizeClass).start}")`,
        }, {
            content: `Change the setting value of ${fontSizeClass}`,
            trigger: `[data-variable="${classNameInfo.get(fontSizeClass).scssVariableName}"] input`,
            // TODO: Remove "&& click body"
            run: `edit ${classNameInfo.get(fontSizeClass).end} && click body`,
        }, {
            content: `[${fontSizeClass}] Go to blocks tab`,
            trigger: ".o_we_add_snippet_btn",
            run: "click",
        }, {
            content: `[${fontSizeClass}] Wait to be in blocks tab`,
            trigger: ".o_we_add_snippet_btn.active",
            run: "click",
        },
        ...goToTheme(),
        {
            content: `Check that the setting of ${fontSizeClass} has been updated`,
            trigger: `we-input[data-variable="${classNameInfo.get(fontSizeClass).scssVariableName}"]`
                + ` input:value("${classNameInfo.get(fontSizeClass).end}")`,
        },
        {
            trigger: `body:not(:has(.o_we_ui_loading))`,
        },
        {
            content: `Close the collapse to hide the font size of ${fontSizeClass}`,
            trigger: `we-collapse:has(we-input[data-variable=` +
                `"${classNameInfo.get(fontSizeClass).scssVariableName}"]) we-toggler`,
            run: "click",
        },
        checkComputedFontSize(fontSizeClass, "end"),
        {
            content: `Click again on the text with class ${fontSizeClass}`,
            trigger: `:iframe #wrap .s_text_block .${fontSizeClass}`,
            run: "click",
        }, {
            content: `Remove the text snippet containing the text with class ${fontSizeClass}`,
            trigger: `.oe_snippet_remove`,
            async run(helpers) {
                await helpers.click();
                // TODO: Remove the below setTimeout or understand why it should be required.
                await new Promise((r) => setTimeout(r, 300));
            },
        }
    ];
}

function getAllFontSizesTestSteps() {
    const steps = [];
    const fontSizeClassesToSkip = [
        // This option is hidden by default because same value as base-fs.
        "h6-fs",
        // There is nothing related to these classes in the UI to test anymore.
        "small",
        "o_small_twelve-fs",
        "o_small_ten-fs",
        "o_small_eight-fs",
    ];
    for (const fontSizeClass of FONT_SIZE_CLASSES) {
        if (fontSizeClassesToSkip.includes(fontSizeClass)) {
            continue;
        }
        steps.push(...getFontSizeTestSteps(fontSizeClass));
    }
    return steps;
}

registerWebsitePreviewTour("website_text_font_size", {
    url: "/",
    edition: true,
}, () => [
    ...getAllFontSizesTestSteps(),
    // The last step has to be a check.
    {
        content: "Verify that the text block has been deleted",
        trigger: ":iframe #wrap:not(:has(.s_text_block))",
    },
]);

return __exports;
});
;

/*************************************************************************
*  Filepath: /website/static/tests/tours/website_update_column_count.js  *
*  Lines: 214                                                            *
*************************************************************************/
odoo.define('@website/../tests/tours/website_update_column_count', ['@website/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const {
    clickOnSnippet,
    insertSnippet,
    registerWebsitePreviewTour,
    toggleMobilePreview,
} = require('@website/js/tours/tour_utils');

const columnCountOptSelector = ".snippet-option-layout_column we-select[data-name='column_count_opt']";
const columnsSnippetRow = ":iframe .s_three_columns .row";
const textImageSnippetRow = ":iframe .s_text_image .row";
const changeFirstAndSecondColumnsMobileOrder = (snippetRowSelector, snippetName) => {
    return [{
        content: `Click on the first column of the '${snippetName}' snippet`,
        trigger: `${snippetRowSelector} > div:nth-child(1)`,
        run: "click",
    }, {
        content: "Change the orders of the 1st and 2nd columns",
        trigger: ":iframe .o_overlay_move_options [data-name='move_right_opt']",
        run: "click",
    }];
};

const addMobileOrderToTextImageSnippet = [
    ...changeFirstAndSecondColumnsMobileOrder(textImageSnippetRow, "Text-Image"),
    {
        content: "Check that the mobile order classes and styles are correct",
        trigger: `${textImageSnippetRow}:has(.order-lg-0[style*='order: 1;']:nth-child(1))`
            + ":has(.order-lg-0[style*='order: 0;']:nth-child(2))",
    },
];

const checkIfNoMobileOrder = (snippetRowSelector) => {
    return {
        content: "Check that the mobile order classes and styles were removed",
        trigger: `${snippetRowSelector}:not(:has(.order-lg-0[style*='order: ']))`,
    };
};

registerWebsitePreviewTour("website_update_column_count", {
    url: "/",
    edition: true,
}, () => [
...insertSnippet({
    id: "s_three_columns",
    name: "Columns",
    groupName: "Columns",
}),
...clickOnSnippet({
    id: "s_three_columns",
    name: "Columns",
}), {
    content: "Open the columns count select",
    trigger: columnCountOptSelector,
    run: "click",
}, {
    content: "Set 5 columns on desktop",
    trigger: `${columnCountOptSelector} we-button[data-select-count='5']`,
    run: "click",
}, {
    content: "Check that there are now 5 items on 5 columns, and that it didn't change the mobile layout",
    trigger: `${columnsSnippetRow}:has(.col-lg-2:nth-child(5):not(.col-2)):not(:has(:nth-child(6)))`,
}, {
    content: "Check that there is an offset on the 1st item to center the row on desktop, but not on mobile",
    trigger: `${columnsSnippetRow} > .offset-lg-1:not(.offset-1):first-child`,
}, {
    content: "Open the columns count select",
    trigger: columnCountOptSelector,
    run: "click",
}, {
    content: "Set 2 columns on desktop",
    trigger: `${columnCountOptSelector} we-button[data-select-count='2']`,
    run: "click",
}, {
    content: "Check that there are still 5 items in the row and click on the last one",
    trigger: `${columnsSnippetRow} > :nth-child(5)`,
    run: "click",
}, {
    content: "Delete the item",
    trigger: "we-title:contains('Card') .oe_snippet_remove",
    run: "click",
}, {
    content: "Toggle mobile view",
    trigger: ".o_we_website_top_actions [data-action='mobile']",
    run: "click",
}, {
    content: "Check that there is 1 column on mobile and click on the selector",
    trigger: `${columnCountOptSelector} we-toggler:contains('1')`,
    run: "click",
}, {
    content: "Set 3 columns on mobile",
    trigger: `${columnCountOptSelector} we-button[data-select-count='3']`,
    run: "click",
}, {
    content: "Check that there are still 4 items but on rows of 3 columns",
    trigger: `${columnsSnippetRow}:has(.col-lg-6.col-4:nth-child(4))`,
},
// As there is no practical way to resize the items through the handles, the
// next step approximates part of what could be reached.
{
    content: "Add a fake resized class on mobile to the 2nd item",
    trigger: `${columnsSnippetRow} > :nth-child(2)`,
    run() {
        this.anchor.classList.replace("col-4", "col-6");
        // As this is a hardcoded class replacement, a click is needed to
        // update the column count.
        this.anchor.previousElementSibling.click();
    },
}, {
    content: "Check that the counter shows 'Custom'",
    trigger: `${columnCountOptSelector} we-toggler:contains('Custom')`,
}, {
    content: "Click on the 2nd item",
    trigger: `${columnsSnippetRow} > :nth-child(2)`,
    run: "click",
}, {
    content: "Change the orders of the 2nd and 3rd items",
    trigger: ":iframe .o_overlay_move_options [data-name='move_right_opt']",
    run: "click",
},
{
    trigger: `${columnsSnippetRow}:has([style*='order: 2;'].order-lg-0:nth-child(2) + [style*='order: 1;'].order-lg-0:nth-child(3))`,
},
{
    content: "Check that the 1st item now has order: 0 and a class .order-lg-0 " +
             "and that order: 1, .order-lg-0 is set on the 3rd item, and order: 2, .order-lg-0 on the 2nd",
    trigger: `${columnsSnippetRow}:has([style*='order: 0;'].order-lg-0:first-child)`,
}, {
    content: "Toggle desktop view",
    trigger: ".o_we_website_top_actions [data-action='mobile']",
    run: "click",
}, {
    content: "Open the columns count select",
    trigger: columnCountOptSelector,
    run: "click",
}, {
    content: "Add 2 more items through the columns counter",
    trigger: `${columnCountOptSelector} we-button[data-select-count='6']`,
    run: "click",
}, {
    content: "Check that each item has a different mobile order from 0 to 5",
    trigger: `${columnsSnippetRow}${[0, 1, 2, 3, 4, 5].map(n => `:has([style*='order: ${n};'].order-lg-0)`).join("")}`,
}, {
    content: "Click on the 6th item",
    trigger: `${columnsSnippetRow} > :nth-child(6)`,
    run: "click",
}, {
    // TODO: remove this step. It should not be needed, but the build fails
    // without it.
    content: "Wait for move arrows to appear",
    trigger: ":iframe .o_overlay_move_options:has([data-name='move_left_opt'] + .d-none[data-name='move_right_opt'])",
}, {
    content: "Change the orders of the 5th and 6th items to override the mobile orders",
    trigger: ":iframe .o_overlay_move_options [data-name='move_left_opt']",
    run: "click",
}, {
    content: "Check that there are no orders anymore",
    trigger: `${columnsSnippetRow}:not(:has([style*='order: 0;'])):not(:has(.order-lg-0))`,
},
]);

registerWebsitePreviewTour("website_mobile_order_with_drag_and_drop", {
    url: "/",
    edition: true,
}, () => [
    ...insertSnippet({id: "s_three_columns", name: "Columns", groupName: "Columns"}),
    ...insertSnippet({id: "s_text_image", name: "Text - Image", groupName: "Content"}),
    ...toggleMobilePreview(true),
    // Add a mobile order to the "Columns" snippet columns.
    ...changeFirstAndSecondColumnsMobileOrder(columnsSnippetRow, "Columns"),
    {
        content: "Check that the mobile order classes and styles are correct",
        trigger: `${columnsSnippetRow}:has(.order-lg-0[style*='order: 1;']:nth-child(1))`
            + ":has(.order-lg-0[style*='order: 0;']:nth-child(2))"
            + ":has(.order-lg-0[style*='order: 2;']:nth-child(3))",
    },
    // Add a mobile order to the "Text-Image" snippet columns.
    ...addMobileOrderToTextImageSnippet,
    // Test the drag and drop in the same snippet.
    ...toggleMobilePreview(false),
    {
        content: "Drag a 'Text-Image' column and drop it in the same snippet",
        trigger: ":iframe .o_overlay_move_options .o_move_handle",
        run: `drag_and_drop ${textImageSnippetRow}`,
    },
    checkIfNoMobileOrder(textImageSnippetRow),
    // Add again a mobile order to the "Text-Image" snippet columns.
    ...toggleMobilePreview(true),
    ...addMobileOrderToTextImageSnippet,
    // Test the drag and drop from "Columns" to "Text-Image".
    ...toggleMobilePreview(false),
    {
        content: "Click on the second column of the 'Columns' snippet",
        trigger: `${columnsSnippetRow} > div:nth-child(2)`,
        run: "click",
    }, {
        content: "Drag the second column of 'Columns' and drop it in 'Text-Image'",
        trigger: ":iframe .o_overlay_move_options .o_move_handle",
        run: `drag_and_drop ${textImageSnippetRow}`,
    },
    checkIfNoMobileOrder(textImageSnippetRow),
    {
        content: "Check that the order gap left in 'Columns' was filled",
        trigger: `${columnsSnippetRow}:has(.order-lg-0[style*='order: 0;']:nth-child(1))`
            + ":has(.order-lg-0[style*='order: 1;']:nth-child(2))",
    },
]);

return __exports;
});
;

/**************************************************************
*  Filepath: /website/static/tests/tours/widget_lifecycle.js  *
*  Lines: 81                                                  *
**************************************************************/
odoo.define('@website/../tests/tours/widget_lifecycle', ['@website/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const {
    clickOnEditAndWaitEditMode,
    insertSnippet,
    registerWebsitePreviewTour,
} = require('@website/js/tours/tour_utils');

// Note: cannot import @website/../tests/tour_utils/widget_lifecycle_dep_widget
// here because that module requires web.public.widget which is not available
// in the backend, where this tour definition is loaded. Easier to duplicate
// that key for now rather than create a whole file to handle this localStorage
// key only.
const localStorageKey = 'widgetAndWysiwygLifecycle';

registerWebsitePreviewTour("widget_lifecycle", {
    url: "/",
    edition: true,
}, () => [
    ...insertSnippet({
        id: "s_countdown",
        name: "Countdown",
        groupName: "Content",
    }),
    {
        content: "Wait for the widget to be started and empty the widgetAndWysiwygLifecycle list",
        trigger: ":iframe .s_countdown.public_widget_started",
        run: () => {
            // Start recording the calls to the "start" and "destroy" method of
            // the widget and the wysiwyg.
            window.localStorage.setItem(localStorageKey, '[]');
        },
    },
    {
        trigger: "button[data-action=save]:enabled:contains(save)",
        run: "click",
    },
    {
        content: "Wait for the widget to be started",
        trigger: ":iframe .s_countdown.public_widget_started",
    },
    ...clickOnEditAndWaitEditMode(),
    {
        content: "Wait for the widget to be started and check the order of the lifecycle method call of the widget and the wysiwyg",
        trigger: ":iframe .s_countdown.public_widget_started",
        run() {
            const result = JSON.parse(window.localStorage.widgetAndWysiwygLifecycle);
            const expected = ["widgetStop", "wysiwygStop", "widgetStart",
                "widgetStop", "wysiwygStart", "wysiwygStarted", "widgetStart",
            ];
            const alternative = ["widgetStop", "widgetStart", "wysiwygStop",
                "widgetStop", "wysiwygStart", "wysiwygStarted", "widgetStart",
            ];
            const resultIsEqualTo = (arr) => {
                return arr.length === result.length
                    && arr.every((item, i) => item === result[i]);
            };
            if (!(resultIsEqualTo(expected) || resultIsEqualTo(alternative))) {
                // The "destroy" method of the wysiwyg is called two times when
                // leaving the edit mode: the first one comes explicitly from
                // the "leaveEditMode" of the "wysiwyg_adapter". The second
                // comes from the OWL mechanism as the wysiwyg is not present in
                // the DOM when the page is reloaded. Because it is not
                // guaranteed that this last call happens before the start of
                // the widget at the page reload, two sequences are acceptable
                // as a result.
                console.error(`
                    Expected: ${expected.toString()}
                    Or:       ${alternative.toString()}
                    Result:   ${result.toString()}
                `);
            }
        },
    },
]);

return __exports;
});
;

/*************************************************************************
*  Filepath: /web_enterprise/static/tests/tours/web_enterprise_tours.js  *
*  Lines: 23                                                             *
*************************************************************************/
odoo.define('@web_enterprise/../tests/tours/web_enterprise_tours', ['@web/core/registry'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module */
const { registry } = require("@web/core/registry");

registry.category("web_tour.tours").add("web_enterprise.test_studio_list_upsell", {
    steps: () => [
        {
            trigger: ".o_list_view",
        },
        {
            trigger: ".o_optional_columns_dropdown > button",
            run: "click",
        },
        {
            trigger: " .o-dropdown--menu .dropdown-item-studio",
        },
    ],
});

return __exports;
});
;

/**************************************************************************************
*  Filepath: /mail_enterprise/static/tests/tours/discuss_channel_expand_test_tour.js  *
*  Lines: 38                                                                          *
**************************************************************************************/
odoo.define('@mail_enterprise/../tests/tours/discuss_channel_expand_test_tour', ['@web/core/registry'], function (require) {
'use strict';
let __exports = {};
const { registry } = require("@web/core/registry");

/**
 * This tour depends on data created by python test in charge of launching it.
 * It is not intended to work when launched from interface. It is needed to test
 * an action (action manager) which is not possible to test with QUnit.
 * @see mail_enterprise/tests/test_discuss_channel_expand.py
 */
registry
    .category("web_tour.tours")
    .add("mail_enterprise/static/tests/tours/discuss_channel_expand_test_tour.js", {
        steps: () => [
            {
                content:
                    "Click on 'Open Actions Menu' in the chat window header to show expand button",
                trigger:
                    '.o-mail-ChatWindow:contains("test-mail-channel-expand-tour") [title="Open Actions Menu"]',
                run: "click",
            },
            {
                content: "Click on expand button to open channel in Discuss",
                trigger: '.o-dropdown-item:contains("Open in Discuss")',
                run: "click",
            },
            {
                content:
                    "Check that first message of #test-mail-channel-expand-tour is shown in Discuss app",
                trigger:
                    '.o-mail-Discuss-content .o-mail-Message-body:contains("test-message-mail-channel-expand-tour")',
            },
        ],
    });

return __exports;
});
;

/********************************************************************************************
*  Filepath: /account_accountant/static/tests/tours/test_tour_bank_rec_rainbowman_reset.js  *
*  Lines: 97                                                                                *
********************************************************************************************/
odoo.define('@account_accountant/../tests/tours/test_tour_bank_rec_rainbowman_reset', ['@web/core/registry', '@web_tour/tour_service/tour_utils', '@account/js/tours/account'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { registry } = require("@web/core/registry");
const { stepUtils } = require("@web_tour/tour_service/tour_utils");
const { accountTourSteps } = require("@account/js/tours/account");

registry.category("web_tour.tours").add("account_accountant_bank_rec_widget_rainbowman_reset", {
    url: "/odoo",
    steps: () => [
        stepUtils.showAppsMenuItem(),
        ...accountTourSteps.goToAccountMenu("Open the accounting module"),

        // Open the widget. The first line should be selected by default.
        {
            trigger: ".o_breadcrumb",
        },
        {
            content: "Open the bank reconciliation widget",
            trigger: "button.btn-secondary[name='action_open_reconcile']",
            run: "click",
        },
        {
            trigger: "div[name='line_ids'] td[field='name']:contains('line1')",
        },
        {
            content: "'line1' should be selected and form mounted",
            trigger: ".o_bank_rec_selected_st_line:contains('line1')",
        },
        // Rainbowman gets reset
        {
            content: "Mount invoice 2 for line 1",
            trigger:
                "div.bank_rec_widget_form_amls_list_anchor table.o_list_table td[name='move_id']:contains('INV/2019/00002')",
            run: "click",
        },
        {
            trigger:
                "div.bank_rec_widget_form_amls_list_anchor table.o_list_table tr.o_rec_widget_list_selected_item td[name='move_id']:contains('INV/2019/00002')",
        },
        {
            content: "Validate line1",
            trigger: "button:contains('Validate')",
            run: "click",
        },
        {
            trigger: ".o_bank_rec_selected_st_line:contains('line2')",
        },
        {
            content: "No records brings rainbows",
            trigger: "div.o_kanban_view .o_searchview_input",
            run: "fill thisShouldNotReturnAnyRecords",
        },
        {
            content: "Select the Journal Entry search option from the dropdown",
            trigger: ".o_searchview_autocomplete li:contains(Journal Entry)",
            run: "click",
        },
        {
            trigger: ".o_reward_rainbow_man:contains('You reconciled 1 transaction in')",
        },
        {
            content: "Remove the filter while rainbow man is on screen",
            trigger: ".o_kanban_view .o_searchview_facet:nth-child(3) .o_facet_remove",
            run: "click",
        },
        {
            trigger: ".o_bank_rec_st_line:contains('line2')",
        },
        {
            content: "Search for no results again",
            trigger: "div.o_kanban_view .o_searchview_input",
            run: "fill thisShouldNotReturnAnyRecords",
        },
        {
            content: "Select the Journal Entry search option from the dropdown",
            trigger: ".o_searchview_autocomplete li:contains(Journal Entry)",
            run: "click",
        },
        {
            content: "No content helper is displayed instead of rainbowman",
            trigger: ".o_view_nocontent_smiling_face",
        },
        // End
        ...stepUtils.toggleHomeMenu(),
        ...accountTourSteps.goToAccountMenu("Reset back to accounting module"),
        {
            content: "check that we're back on the dashboard",
            trigger: 'a:contains("Customer Invoices")',
        },
    ],
});

return __exports;
});
;

/******************************************************************************************************
*  Filepath: /account_accountant/static/tests/tours/test_tour_bank_rec_save_analytic_distribution.js  *
*  Lines: 75                                                                                          *
******************************************************************************************************/
odoo.define('@account_accountant/../tests/tours/test_tour_bank_rec_save_analytic_distribution', ['@web/core/registry', '@web_tour/tour_service/tour_utils', '@account/js/tours/account'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { registry } = require("@web/core/registry");
const { stepUtils } = require("@web_tour/tour_service/tour_utils");
const { accountTourSteps } = require("@account/js/tours/account");


registry.category("web_tour.tours").add('account_accountant_bank_rec_widget_save_analytic_distribution', {
    url: '/odoo',
    steps: () => [
        stepUtils.showAppsMenuItem(),
        ...accountTourSteps.goToAccountMenu("Open the accounting module"),
        {
            trigger: ".o_breadcrumb",
        },
        {
            content: "Open the bank reconciliation widget",
            trigger: "button.btn-secondary[name='action_open_reconcile']",
            run: "click",
        },
        {
            trigger: "div[name='line_ids']",
        },
        {
            content: "The 'line1' should be selected by default",
            trigger: "div[name='line_ids'] td[field='name']:contains('line1')",
            run: function() {},
        },
        {
            content: "Click on first line",
            trigger: "div[name='line_ids'] td[field='debit']:first",
            run: "click",
        },
        {
            content: "The 'manual_operations_tab' should be active now and the auto_balance line mounted in edit",
            trigger: "a.active[name='manual_operations_tab']",
            run: function() {},
        },
        {
            content: "Enter an analytic distribution",
            trigger: "div[name='analytic_distribution'] .o_input_dropdown",
            run: "click",
        },
        {
            content: "Select analytic distribution",
            trigger: "tr[name='line_0'] input",
            run: "edit analytic_account",
        },
        {
            trigger: ".ui-autocomplete",
        },
        {
            content: "Select analytic distribution",
            trigger: ".ui-autocomplete:visible li:contains('analytic_account')",
            run: "click",
        },
        {
            content: "Close the analytic distribution",
            trigger: ".o_button",
            run: "click",
        },
        ...stepUtils.toggleHomeMenu(),
        ...accountTourSteps.goToAccountMenu("Reset back to accounting module"),
        {
            content: "check that we're back on the dashboard",
            trigger: 'a:contains("Customer Invoices")',
        },
    ]
});

return __exports;
});
;

/**************************************************************************************
*  Filepath: /account_accountant/static/tests/tours/test_tour_bank_rec_statements.js  *
*  Lines: 101                                                                         *
**************************************************************************************/
odoo.define('@account_accountant/../tests/tours/test_tour_bank_rec_statements', ['@web/core/registry', '@web_tour/tour_service/tour_utils', '@account/js/tours/account'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { registry } = require("@web/core/registry");
const { stepUtils } = require("@web_tour/tour_service/tour_utils");
const { accountTourSteps } = require("@account/js/tours/account");

registry.category("web_tour.tours").add('account_accountant_bank_rec_widget_statements',
    {
        url: '/odoo',
        steps: () => [
        stepUtils.showAppsMenuItem(),
        ...accountTourSteps.goToAccountMenu("Open the accounting module"),
        {
            trigger: ".o_breadcrumb",
        },
        {
            content: "Open the bank reconciliation widget",
            trigger: "button.btn-secondary[name='action_open_reconcile']",
            run: "click",
        },
        {
            content: "Statement button",
            trigger:
                ".o_bank_rec_st_line:eq(2) a.oe_kanban_action:contains('Statement'):not(:visible)",
            run: "click",
        },
        {
            trigger: ".modal-dialog:contains('Create Statement')",
        },
        {
            content: "Save the statement with proposed values",
            trigger: ".o_form_button_save",
            run: "click",
        },
        {
            content: "Click the Valid Statement with $ 1,000.00 that is visible in Kanban",
            trigger: "span[name='kanban-subline-clickable-amount']:contains('$ 1,000.00')",
            run: "click",
        },
        {
            content: "Modify the end balance",
            trigger: "input[id='balance_end_real_0']",
            run: "edit 100 && click body",
        },
        {
            trigger: ".alert-warning:contains('The running balance')",
        },
        {
            content: "Dialog displays warning, save anyway",
            trigger: ".breadcrumb-item.o_back_button:nth-of-type(2)",
            run: "click",
        },
        {
            trigger: ".btn-link:contains('$ 2,100.00')",
        },
        {
            content: "Click the red statement, after checking the balance",
            trigger: "span[name='kanban-subline-clickable-amount']:contains('$ 100.00')",
            run: "click",
        },
        {
            content: "Back in the form view",
            trigger: ".alert-warning:contains('The running balance')",
        },
        {
            content: "Click on Action",
            trigger: ".o_cp_action_menus button",
            run: "click",
        },
        {
            content: "Click on Delete",
            trigger: ".o-dropdown--menu span:contains('Delete')",
            run: "click",
        },
        {
            content: "Confirm Deletion",
            trigger: ".btn-primary:contains('Delete')",
            run: "click",
        },
        {
            trigger: ".o_kanban_renderer:not(:has(.kanban-statement))",
        },
        {
            content: "balance displays $3000.00 and no statement",
            trigger: ".btn-link:contains('$ 3,000')",
        },
        // End
        ...stepUtils.toggleHomeMenu(),
        ...accountTourSteps.goToAccountMenu("Reset back to accounting module"),
        {
            content: "check that we're back on the dashboard",
            trigger: 'a:contains("Customer Invoices")',
        }
    ]
});

return __exports;
});
;

/******************************************************************************
*  Filepath: /account_accountant/static/tests/tours/test_tour_bank_rec_ui.js  *
*  Lines: 966                                                                 *
******************************************************************************/
odoo.define('@account_accountant/../tests/tours/test_tour_bank_rec_ui', ['@web/core/registry', '@web_tour/tour_service/tour_utils', '@web/core/utils/patch', '@account/js/tours/account'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { registry } = require("@web/core/registry");
const { stepUtils } = require("@web_tour/tour_service/tour_utils");
const { patch } = require("@web/core/utils/patch");
const { accountTourSteps } = require("@account/js/tours/account");

patch(accountTourSteps, {
    bankRecUiReportSteps() {
        return [
            {
                trigger: ".o_bank_rec_selected_st_line:contains('line1')",
            },
            {
                content: "balance is 2100",
                trigger: ".btn-link:contains('$ 2,100.00')",
            },
        ];
    },
});

registry.category("web_tour.tours").add("account_accountant_bank_rec_widget_ui", {
    url: "/odoo",
    steps: () => [
        stepUtils.showAppsMenuItem(),
        ...accountTourSteps.goToAccountMenu("Open the accounting module"),

        // Open the widget. The first line should be selected by default.
        {
            trigger: ".o_breadcrumb",
        },
        {
            content: "Open the bank reconciliation widget",
            trigger: "button.btn-secondary[name='action_open_reconcile']",
            run: "click",
        },
        {
            trigger: "div[name='line_ids'] td[field='name']:contains('line1')",
        },
        {
            content: "'line1' should be selected and form mounted",
            trigger: ".o_bank_rec_selected_st_line:contains('line1')",
        },
        // Select line2. It should remain selected when returning using the breadcrumbs.
        {
            trigger: ".o_bank_rec_st_line:contains('line3')",
        },
        {
            content: "select 'line2'",
            trigger: ".o_bank_rec_st_line:contains('line2')",
            run: "click",
        },
        {
            content: "'line2' should be selected",
            trigger: ".o_bank_rec_selected_st_line:contains('line2')",
        },
        {
            content: "View an invoice",
            trigger: "button.btn-secondary[name='action_open_business_doc']:eq(1)",
            run: "click",
        },
        {
            trigger: ".o_breadcrumb .active:contains('INV/2019/00001')",
        },
        {
            content: "Breadcrumb back to Bank Reconciliation from INV/2019/00001",
            trigger: ".breadcrumb-item:contains('Bank Reconciliation')",
            run: "click",
        },
        {
            trigger: ".o_bank_rec_st_line:contains('line1')",
        },
        {
            content: "'line2' should be selected after returning",
            trigger: ".o_bank_rec_selected_st_line:contains('line2')",
            run: "click",
        },
        {
            trigger: "div[name='line_ids'] td[field='name']:contains('line2')",
        },
        {
            content: "'line2' form mounted",
            trigger: ".o_bank_rec_selected_st_line:contains('line2')",
            run: "click",
        },
        // Keep AML search, and prepared entry (line_ids) when changing tabs, using breadcrumbs, and view switcher
        {
            trigger:
                "div.bank_rec_widget_form_amls_list_anchor table.o_list_table tr:nth-child(2) td[name='move_id']:contains('INV/2019/00001')",
        },
        {
            content: "AMLs list has both invoices",
            trigger:
                "div.bank_rec_widget_form_amls_list_anchor table.o_list_table tr:nth-child(1) td[name='move_id']:contains('INV/2019/00002')",
        },
        {
            trigger: "a.active[name='amls_tab']",
        },
        {
            content: "Search for INV/2019/00001",
            trigger: "div.bank_rec_widget_form_amls_list_anchor .o_searchview_input",
            run: "edit INV/2019/00001",
        },
        {
            content: "Select the Journal Entry search option from the dropdown",
            trigger: ".o_searchview_autocomplete li:contains(Journal Entry)",
            run: "click",
        },
        {
            content: "AMLs list only displays one invoice",
            trigger:
                "div.bank_rec_widget_form_amls_list_anchor table.o_list_table tr:nth-child(1) td[name='move_id']:contains('INV/2019/00001')",
        },
        {
            content: "Liquidity line displays debit '$ 1,000.00'",
            trigger:
                "div[name='line_ids'] table.o_list_table tr.o_bank_rec_liquidity_line td[field='debit']:contains('$ 1,000.00')",
        },
        {
            content: "Select the liquidity line",
            trigger: "tr.o_bank_rec_liquidity_line td[field='debit']",
            run: "click",
        },
        {
            content: "Modify the liquidity line amount",
            trigger: "div[name='amount_currency'] input",
            run: "edit 100.00 && click body",
        },
        {
            content: "Liquidity line displays debit '$ 100.00'",
            trigger:
                "div[name='line_ids'] table.o_list_table tr.o_bank_rec_liquidity_line td[field='debit']:contains('$ 100.00')",
        },
        {
            trigger: "div[name='partner_id'] input",
        },
        {
            content: "Select 'amls_tab'",
            trigger: "a[name='amls_tab']",
            run: "click",
        },
        {
            trigger:
                "div.bank_rec_widget_form_amls_list_anchor .o_searchview_facet:nth-child(1) .o_facet_value:contains('INV/2019/00001')",
        },
        {
            content: "AMLs list contains the search facet, and one invoice - select it",
            trigger:
                "div.bank_rec_widget_form_amls_list_anchor table.o_list_table tr:nth-child(1) td[name='move_id']:contains('INV/2019/00001')",
            run: "click",
        },
        {
            trigger:
                "div.bank_rec_widget_form_amls_list_anchor table.o_list_table tr.o_rec_widget_list_selected_item td[name='move_id']:contains('INV/2019/00001')",
        },
        {
            content: "Check INV/2019/00001 is well marked as selected",
            trigger:
                "div.bank_rec_widget_form_amls_list_anchor table.o_list_table tr.o_rec_widget_list_selected_item td[name='move_id']:contains('INV/2019/00001')",
        },
        {
            content: "View an invoice",
            trigger: "button.btn-secondary[name='action_open_business_doc']:nth-child(1)",
            run: "click",
        },
        {
            trigger: ".o_breadcrumb .active:contains('INV/2019/00001')",
        },
        {
            content: "Breadcrumb back to Bank Reconciliation from INV/2019/00001",
            trigger: ".breadcrumb-item:contains('Bank Reconciliation')",
            run: "click",
        },
        {
            trigger:
                "div.bank_rec_widget_form_amls_list_anchor .o_searchview_facet:nth-child(1) .o_facet_value:contains('INV/2019/00001')",
        },
        {
            content: "Check INV/2019/00001 is selected and still contains the search facet",
            trigger:
                "div.bank_rec_widget_form_amls_list_anchor table.o_list_table tr.o_rec_widget_list_selected_item td[name='move_id']:contains('INV/2019/00001')",
        },
        // Search should remove some lines, select the first unmatched record, and persist when returning with breadcrumbs
        {
            trigger: "a.active[name='amls_tab']",
        },
        {
            content: "Search for line2",
            trigger: "div.o_kanban_view .o_searchview_input",
            run: "fill line2",
        },
        {
            content: "Select the Transaction search option from the dropdown",
            trigger: ".o_searchview_autocomplete li:contains(Transaction)",
            run: "click",
        },
        {
            trigger: "div[name='line_ids'] td[field='name']:contains('line2')",
        },
        {
            content: "'line2' should be selected",
            trigger: ".o_bank_rec_st_line:last():contains('line2')",
        },
        {
            trigger:
                "div.bank_rec_widget_form_amls_list_anchor .o_searchview_facet:nth-child(1) .o_facet_value:contains('INV/2019/00001')",
        },
        {
            content:
                "Nothing has changed: INV/2019/00001 is selected and still contains the search facet",
            trigger:
                "div.bank_rec_widget_form_amls_list_anchor table.o_list_table tr.o_rec_widget_list_selected_item td[name='move_id']:contains('INV/2019/00001')",
        },
        {
            trigger: ".o_switch_view.o_kanban.active",
        },
        {
            content: "Switch to list view",
            trigger: ".o_switch_view.o_list",
            run: "click",
        },
        {
            trigger: ".o_switch_view.o_list.active",
        },
        {
            content: "Switch back to kanban",
            trigger: ".o_switch_view.o_kanban",
            run: "click",
        },
        {
            content: "Remove the kanban filter for line2",
            trigger: ".o_kanban_view .o_searchview_facet:nth-child(3) .o_facet_remove",
            run: "click",
        },
        {
            trigger:
                "div.bank_rec_widget_form_amls_list_anchor .o_searchview_facet:nth-child(1) .o_facet_value:contains('INV/2019/00001')",
        },
        {
            content:
                "Nothing has changed: INV/2019/00001 is still selected and contains the search facet",
            trigger:
                "div.bank_rec_widget_form_amls_list_anchor table.o_list_table tr.o_rec_widget_list_selected_item td[name='move_id']:contains('INV/2019/00001')",
        },
        // AML Search Facet is removed, and line_ids reset when changing line
        {
            trigger: ".o_bank_rec_st_line:contains('line3')",
        },
        {
            content: "selecting 'line1' should reset the AML search filter ",
            trigger: ".o_bank_rec_st_line:contains('line1')",
            run: "click",
        },
        {
            trigger: "div[name='line_ids'] td[field='name']:contains('line1')",
        },
        {
            content: "select 'line2' again",
            trigger: ".o_bank_rec_st_line:contains('line2')",
            run: "click",
        },
        {
            trigger: "div[name='line_ids'] td[field='name']:contains('line2')",
        },
        {
            content: "Bank Suspense Account is back",
            trigger: "div[name='line_ids'] .o_bank_rec_auto_balance_line",
        },
        {
            content: "AML Search Filter has been reset",
            trigger: ".o_list_view .o_searchview_input_container:not(:has(.o_searchview_facet))",
        },
        // Test statement line selection when using the pager
        {
            content: "Click Pager",
            trigger: ".o_pager_value:first()",
            run: "click",
        },
        {
            content: "Change pager to display lines 1-2",
            trigger: "input.o_pager_value",
            run: "edit 1-2 && click body",
        },
        {
            trigger: ".o_pager_value:contains('1-2')",
        },
        {
            content: "Last St Line is line2",
            trigger: ".o_bank_rec_st_line:last():contains('line2')",
        },
        {
            content: "Page Next",
            trigger: ".o_pager_next:first():not(:disabled)",
            run: "click",
        },
        {
            trigger: ".o_pager_value:contains('3-3')",
        },
        {
            content: "Statement line3 is selected",
            trigger: ".o_bank_rec_selected_st_line:contains('line3')",
        },
        {
            content: "Page to beginning",
            trigger: ".o_pager_next:first()",
            run: "click",
        },
        {
            trigger: "div[name='line_ids'] td[field='name']:contains('line1')",
        },
        {
            content: "Statement line1 is selected",
            trigger: ".o_bank_rec_selected_st_line:contains('line1')",
        },
        // HTML buttons
        {
            content: "Mount an invoice",
            trigger:
                "div.bank_rec_widget_form_amls_list_anchor table.o_list_table td[name='move_id']:contains('INV/2019/00003')",
            run: "click",
        },
        {
            trigger:
                "div[name='line_ids']:has(.text-decoration-line-through:contains('$ 2,000.00'))",
        },
        {
            content: "Select the mounted invoice line and check the strikethrough value",
            trigger:
                "div[name='line_ids'] tr.o_data_row:last() td[field='name']:contains('INV/2019/00003')",
            run: "click",
        },
        {
            trigger: "a.active[name='manual_operations_tab']",
        },
        {
            content: "Fully Paid button",
            trigger: "button[name='action_apply_line_suggestion']:contains('fully paid')",
            run: "click",
        },
        {
            content: "Check the remainder",
            trigger:
                "div[name='line_ids'] tr.o_data_row:contains('Suspense') td[field='debit']:contains('$ 1,000.00')",
        },
        {
            content: "Partial Payment",
            trigger: "button[name='action_apply_line_suggestion']:contains('partial payment')",
            run: "click",
        },
        {
            trigger: "button[name='action_apply_line_suggestion']:contains('fully paid')",
        },
        {
            content: "View Invoice 0003",
            trigger: "button[name='action_redirect_to_move']",
            run: "click",
        },
        {
            trigger: ".o_breadcrumb .active:contains('INV/2019/00003')",
        },
        {
            content: "Breadcrumb back to Bank Reconciliation from INV/2019/00003",
            trigger: ".breadcrumb-item:contains('Bank Reconciliation')",
            run: "click",
        },
        {
            content: "Select the mounted invoice line INV/2019/00003",
            trigger:
                "div[name='line_ids'] tr.o_data_row:last() td[field='name']:contains('INV/2019/00003')",
            run: "click",
        },
        // Match Existing entries tab is activated when line is removed
        {
            trigger: "a.active[name='manual_operations_tab']",
        },
        {
            content: "Remove the invoice",
            trigger: ".o_list_record_remove .fa-trash-o",
            run: "click",
        },
        {
            content: "amls_tab is activated",
            trigger: "a.active[name='amls_tab']",
        },
        {
            content: "Activate Manual Operations to add manual entries",
            trigger: "a[name='manual_operations_tab']",
            run: "click",
        },
        {
            content: "add manual entry 1",
            trigger: "div[name='amount_currency'] input",
            run: "edit -600.0 && click body",
        },
        {
            content: "mount the remaining opening balance line",
            trigger:
                "div[name='line_ids'] tr.o_data_row:contains('Suspense') td[field='credit']:contains('$ 400.00')",
            run: "click",
        },
        {
            trigger: "div[name='amount_currency'] input:value('-400.00'):focus-within",
        },
        {
            content: "Remove the manual entry",
            trigger: ".o_list_record_remove .fa-trash-o",
            run: "click",
        },
        {
            trigger:
                "div[name='line_ids'] tr.o_data_row:contains('Suspense') td[field='credit']:contains('$ 1,000.00')",
        },
        {
            content: "amls_tab is activated and auto balancing line is 1000",
            trigger: "a.active[name='amls_tab']",
        },
        {
            content: "Mount another invoice",
            trigger:
                "div.bank_rec_widget_form_amls_list_anchor table.o_list_table td[name='move_id']:contains('INV/2019/00001')",
            run: "click",
        },
        // After validating, line1 should disappear & line2 should be selected (due to filters)
        {
            trigger:
                "div.bank_rec_widget_form_amls_list_anchor table.o_list_table tr.o_rec_widget_list_selected_item td[name='move_id']:contains('INV/2019/00001')",
        },
        {
            content: "Validate line1",
            trigger: "button:contains('Validate')",
            run: "click",
        },
        {
            trigger: "div[name='line_ids'] td[field='name']:contains('line2')",
        },
        {
            content: "The 'line2' is the first kanban record and is selected",
            trigger: ".o_bank_rec_st_line:first():contains('line2')",
        },
        // Test Reset, "Matched" badge and double-click
        {
            content: "Remove the kanban filter for 'Not Matched'",
            trigger: ".o_kanban_view .o_searchview_facet:nth-child(2) .o_facet_remove",
            run: "click",
        },
        {
            trigger: "div[name='line_ids'] td[field='name']:contains('line2')",
        },
        {
            content: "The 'line1' is the first kanban record with line2 selected",
            trigger: ".o_bank_rec_st_line:first():contains('line1')",
        },
        {
            content: "Mount invoice 2 for line 2",
            trigger:
                "div.bank_rec_widget_form_amls_list_anchor table.o_list_table td[name='move_id']:contains('INV/2019/00002')",
            run: "click",
        },
        {
            trigger:
                "div.bank_rec_widget_form_amls_list_anchor table.o_list_table tr.o_rec_widget_list_selected_item td[name='move_id']:contains('INV/2019/00002')",
        },
        {
            content: "Validate line2 with double click",
            trigger: "button:contains('Validate')",
            run: "dblclick",
        },
        {
            trigger: ".o_bank_rec_st_line:contains('line2') .badge.text-bg-success",
        },
        {
            content: "Click Pager again after line2 is matched",
            trigger: ".o_pager_value:first()",
            run: "click",
        },
        {
            content: "Change pager to display lines 1-3",
            trigger: "input.o_pager_value",
            run: "edit 1-3 && click body",
        },
        {
            trigger: ".o_bank_rec_selected_st_line:contains('line3')",
        },
        {
            content: "manually select line2 again by clicking it's matched icon",
            trigger: ".badge.text-bg-success:last()",
            run: "click",
        },
        {
            trigger:
                "div[name='line_ids']:not(:has(.fa-trash-o)) td[field='name']:contains('line2')",
        },
        {
            content: "Reset line2",
            trigger: "button:contains('Reset')",
            run: "click",
        },
        {
            trigger: ".o_bank_rec_selected_st_line:contains('line2'):not(:has(div.badge))",
        },
        {
            content: "amls_tab is activated while still on line2 which doesn't contain a badge",
            trigger: ".o_notebook a.active[name='amls_tab']",
        },
        // Test view_switcher
        {
            trigger: ".o_switch_view.o_kanban.active",
        },
        {
            content: "Switch to list view",
            trigger: ".o_switch_view.o_list",
            run: "click",
        },
        {
            trigger: ".btn-secondary:contains('View')",
        },
        {
            content: "Select the first Match Button (line2)",
            trigger: ".btn-secondary:contains('Match')",
            run: "click",
        },
        {
            trigger: ".o_bank_rec_st_line:last():contains('line2')",
        },
        {
            content: "Last St Line is line2",
            trigger: ".o_bank_rec_selected_st_line:contains('line2')",
            run: "click",
        },
        {
            content: "Button To Check will reconcile since partner is saved on line2",
            trigger: ".btn-secondary:contains('To Check')",
            run: "click",
        },
        {
            trigger:
                ".o_bank_rec_selected_st_line:contains('line2'):has(div.badge[title='Matched'] i):has(span.badge:contains('To check'))",
        },
        {
            content: "both badges are visible, trash icon is not, manual operation tab is active",
            trigger:
                "div[name='line_ids']:not(:has(.fa-trash-o))+.o_notebook a.active[name='manual_operations_tab']",
        },
        {
            trigger: ".o_switch_view.o_kanban.active",
        },
        {
            content: "Switch to list view",
            trigger: ".o_switch_view.o_list",
            run: "click",
        },
        {
            trigger: ".o_switch_view.o_list.active",
        },
        {
            content: "Remove the line filter",
            trigger: ".o_searchview_facet:contains('0002') .o_facet_remove",
            run: "click",
        },
        {
            trigger: ".o_data_row:contains('line2'):has(.btn-secondary:contains('View'))",
        },
        {
            content: "Select the first Match Button (line3)",
            trigger: ".btn-secondary:contains('Match')",
            run: "click",
        },
        {
            trigger: ".o_bank_rec_stats_buttons",
        },
        {
            content: "Open search bar menu",
            trigger: ".o_searchview_dropdown_toggler:eq(0)",
            run: "click",
        },
        // Test Reco Model
        {
            trigger: ".o-dropdown--menu.o_search_bar_menu",
        },
        {
            content: "Choose a filter",
            trigger: ".o_search_bar_menu .dropdown-item:first()",
            run: "click",
        },
        {
            trigger: ".o-dropdown--menu",
        },
        {
            content: "Not Matched Filter",
            trigger: ".dropdown-item:contains('Not Matched')",
            run: "click",
        },
        {
            trigger: ".o_switch_view.o_kanban.active",
        },
        {
            content: "reco model dropdown",
            trigger: ".bank_rec_reco_model_dropdown i",
            run: "click",
        },
        {
            trigger: ".o-dropdown--menu",
        },
        {
            content: "create model",
            trigger: ".dropdown-item:contains('Create model')",
            run: "click",
        },
        {
            content: "model name",
            trigger: "input#name_0",
            run: "edit Bank Fees",
        },
        {
            content: "add an account",
            trigger: "a:contains('Add a line')",
            run: "click",
        },
        {
            content: "search for bank fees account",
            trigger: "[name='account_id'] input",
            run: "edit Bank Fees",
        },
        {
            trigger: ".o-autocomplete--dropdown-menu",
        },
        {
            content: "select the bank fees account",
            trigger: ".o-autocomplete--dropdown-item:contains('Bank Fees')",
            run: "click",
        },
        {
            trigger: ".o_breadcrumb .active > span:contains('New')",
        },
        {
            content: "Breadcrumb back to Bank Reconciliation from the model",
            trigger: ".breadcrumb-item:contains('Bank Reconciliation')",
            run: "click",
        },
        {
            content: "Choose Bank Fees Model",
            trigger: ".recon_model_button:contains('Bank Fees')",
            run: "click",
        },
        {
            content: "Validate line3",
            trigger: "button:contains('Validate').btn-primary",
            run: "dblclick",
        },
        {
            trigger: ".o_reward_rainbow_man",
        },
        {
            content:
                "Remove the kanbans 'not matched' filter to reset all lines - use the rainbow man button",
            trigger: "p.btn-primary:contains('All Transactions')",
            run: "click",
        },
        {
            trigger:
                ".o_kanban_view .o_searchview:first() .o_searchview_facet:last():contains('Bank')",
        },
        {
            content: "Wait for search model change and line3 to appear",
            trigger: ".o_bank_rec_st_line:last():contains('line3')",
        },
        {
            trigger: ".o_bank_rec_selected_st_line:contains('line2')",
        },
        {
            content: "'line2' should be selected, reset it",
            trigger: "button:contains('Reset')",
            run: "click",
        },
        {
            trigger: ".o_bank_rec_st_line:contains('line2'):not(:has(div.badge))",
        },
        {
            content: "select matched 'line3'",
            trigger: ".o_bank_rec_st_line:contains('line3')",
            run: "click",
        },
        {
            trigger: ".o_bank_rec_selected_st_line:contains('line3')",
        },
        {
            content: "'line3' should be selected, reset it",
            trigger: "button:contains('Reset')",
            run: "click",
        },
        {
            trigger: ".o_bank_rec_st_line:contains('line3'):not(:has(div.badge))",
        },
        {
            content: "select matched 'line1'",
            trigger: ".o_bank_rec_st_line:contains('line1')",
            run: "click",
        },
        {
            trigger: ".o_bank_rec_selected_st_line:contains('line1')",
        },
        {
            content: "'line1' should be selected, reset it",
            trigger: "button:contains('Reset')",
            run: "click",
        },
        {
            trigger: ".o_bank_rec_stats_buttons",
        },
        {
            content: "Open search bar menu",
            trigger: ".o_searchview_dropdown_toggler:eq(0)",
            run: "click",
        },
        {
            trigger: "button:contains('Validate')",
        },
        {
            content: "Filter Menu",
            trigger: ".o_search_bar_menu .dropdown-item:first()",
            run: "click",
        },
        {
            trigger: ".o-dropdown--menu",
        },
        {
            content: "Activate the Not Matched filter",
            trigger: ".dropdown-item:contains('Not Matched')",
            run: "click",
        },
        {
            trigger: ".o_searchview_facet:contains('Not Matched')",
        },
        {
            content: "Close the Filter Menu",
            trigger: ".o_searchview_dropdown_toggler:eq(0)",
            run: "click",
        },
        {
            trigger: ".o_searchview_facet:contains('Not Matched')",
        },
        {
            content: "select 'line2'",
            trigger: ".o_bank_rec_st_line:contains('line2')",
            run: "click",
        },
        {
            trigger: ".o_bank_rec_selected_st_line:contains('line2')",
        },
        {
            content: "Validate 'line2' again",
            trigger: "button:contains('Validate')",
            run: "click",
        },
        {
            trigger: ".o_bank_rec_selected_st_line:contains('line3')",
        },
        {
            content: "'line3' should be selected now",
            trigger: ".o_bank_rec_selected_st_line:contains('line3')",
        },
        // Test the Balance when changing journal and liquidity line
        ...stepUtils.toggleHomeMenu(),
        ...accountTourSteps.goToAccountMenu("Reset back to accounting module"),
        {
            trigger: ".o_breadcrumb",
        },
        {
            content: "Open the bank reconciliation widget for Bank2",
            trigger: "button.btn-secondary[name='action_open_reconcile']:last()",
            run: "click",
        },
        {
            content: "Remove the kanbans 'not matched' filter",
            trigger: ".o_kanban_view .o_searchview_facet:nth-child(2) .o_facet_remove",
            run: "click",
        },
        {
            content: "Remove the kanban 'journal' filter",
            trigger: ".o_kanban_view .o_searchview_facet:nth-child(1) .o_facet_remove",
            run: "click",
        },
        {
            content: "select 'line1' from another journal",
            trigger: ".o_bank_rec_st_line:contains('line1')",
            run: "click",
        },
        ...accountTourSteps.bankRecUiReportSteps(),
        {
            content: "select 'line4' from this journal",
            trigger: ".o_bank_rec_st_line:contains('line4')",
            run: "click",
        },
        {
            trigger: ".o_bank_rec_selected_st_line:contains('line4')",
        },
        {
            content: "balance is $222.22",
            trigger: ".btn-link:contains('$ 222.22')",
        },
        {
            content: "Select the liquidity line",
            trigger: "tr.o_bank_rec_liquidity_line td[field='debit']",
            run: "click",
        },
        {
            trigger: "div[name='amount_currency'] input:focus-within",
        },
        {
            content: "Modify the liquidity line amount",
            trigger: "div[name='amount_currency'] input",
            run: "edit -333.33 && click body",
        },
        {
            trigger: ".btn-link:contains('$ -333.33')",
        },
        {
            content: "balance displays $-333.33",
            trigger: ".btn-link:contains('$ -333.33')",
        },
        {
            content: "Modify the label",
            trigger: "div[name='name'] input",
            run: "edit Spontaneous Combustion && click body",
        },
        {
            content: "statement line displays combustion and $-333.33",
            trigger: ".o_bank_rec_selected_st_line:contains('Combustion'):contains('$ -333.33')",
        },
        // Test that changing the balance in the list view updates the right side of the kanban view
        // (including reapplying matching rules)
        {
            content: "select matched 'line2'",
            trigger: ".o_bank_rec_st_line:contains('line2')",
            run: "click",
        },
        {
            trigger: ".o_bank_rec_selected_st_line:contains('line2')",
        },
        {
            content: "'line2' should be selected, reset it",
            trigger: "button:contains('Reset')",
            run: "click",
        },
        {
            trigger: ".o_bank_rec_selected_st_line:contains('line2'):not(:has(div.badge))",
        },
        {
            content: "Liquidity line displays debit '$ 100.00'",
            trigger:
                "div[name='line_ids'] table.o_list_table tr.o_bank_rec_liquidity_line td[field='debit']:contains('$ 100.00')",
        },
        {
            trigger: ".o_switch_view.o_kanban.active",
        },
        {
            content: "Switch to list view",
            trigger: ".o_switch_view.o_list",
            run: "click",
        },
        {
            content: "Click amount field of 'line2'; Selects the row",
            trigger: "table.o_list_table tr.o_data_row:contains('line2') td[name='amount']",
            run: "click",
        },
        {
            content: "Set balance of 'line2' (selected row) to 500.00",
            trigger: "table.o_list_table tr.o_data_row.o_selected_row td[name='amount'] input",
            run: "edit 500.00 && click body",
        },
        {
            trigger: ".o_switch_view.o_list.active",
        },
        {
            content: "Switch back to kanban",
            trigger: ".o_switch_view.o_kanban",
            run: "click",
        },
        {
            content: "'line2' is still selected",
            trigger: ".o_bank_rec_st_line:contains('line2')",
        },
        {
            content: "Liquidity line displays debit '$ 500.00'",
            trigger:
                "div[name='line_ids'] table.o_list_table tr.o_bank_rec_liquidity_line td[field='debit']:contains('$ 500.00')",
        },
        {
            content:
                "'INV/2019/00001' has been selected as matching existing entry by matching rules",
            trigger:
                "div.bank_rec_widget_form_amls_list_anchor table.o_list_table tr.o_rec_widget_list_selected_item td[name='name']:contains('INV/2019/00001')",
        },
        // End
        ...stepUtils.toggleHomeMenu(),
        ...accountTourSteps.goToAccountMenu("Reset back to accounting module"),
        {
            content: "check that we're back on the dashboard",
            trigger: 'a:contains("Customer Invoices")',
        },
    ],
});

registry.category("web_tour.tours").add('account_accountant_bank_rec_widget_reconciliation_button',
    {
        url: '/odoo',
        steps: () => [
        stepUtils.showAppsMenuItem(),
        ...accountTourSteps.goToAccountMenu("Open the accounting module"),
        {
            content: "Open the bank reconciliation widget",
            trigger: "button.btn-secondary[name='action_open_reconcile']",
            run: "click",
        },
        {
            content: "Remove suggested line, if present",
            trigger: ".o_list_record_remove",
            run() {
                const button = document.querySelector('.fa-trash-o');
                if(button) {
                    button.click();
                }
            }
        },
        {
            content: "Wait for deletion",
            trigger: ".o_data_row:contains('Open balance')",
        },
        {
            content: "Select reconciliation model creating a new move",
            trigger: ".recon_model_button:contains('test reconcile')",
            run: "click",
        },
        {
            content: "Confirm move created through reconciliation model writeoff button",
            trigger: "button[name=action_post]",
            run: "click",
        },
        {
            trigger: ".o_breadcrumb",
        },
        {
            content: "Breadcrumb back to Bank Reconciliation from created move",
            trigger: ".breadcrumb-item:contains('Bank Reconciliation')",
            run: "click",
        },
        {
            content: "Validate created move added as a line in reco widget",
            trigger: "button:contains('Validate')",
            run: "click",
        },
        // End
        ...stepUtils.toggleHomeMenu(),
        ...accountTourSteps.goToAccountMenu("Reset back to accounting module"),
        {
            content: "check that we're back on the dashboard",
            trigger: 'a:contains("Customer Invoices")',
        },
    ],
});

return __exports;
});
;

/**********************************************************************************
*  Filepath: /account_accountant/static/tests/tours/test_tour_bank_rec_widget.js  *
*  Lines: 242                                                                     *
**********************************************************************************/
odoo.define('@account_accountant/../tests/tours/test_tour_bank_rec_widget', ['@web/core/registry', '@web_tour/tour_service/tour_utils', '@account/js/tours/account'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { registry } = require("@web/core/registry");
const { stepUtils } = require("@web_tour/tour_service/tour_utils");
const { accountTourSteps } = require("@account/js/tours/account");

registry.category("web_tour.tours").add("account_accountant_bank_rec_widget", {
    url: "/odoo",
    steps: () => [
        stepUtils.showAppsMenuItem(),
        ...accountTourSteps.goToAccountMenu("Open the accounting module"),

        // Open the widget. The first line should be selected by default.
        {
            trigger: ".o_breadcrumb",
        },
        {
            content: "Open the bank reconciliation widget",
            trigger: "button.btn-secondary[name='action_open_reconcile']",
            run: "click",
        },
        {
            trigger: "div[name='line_ids']",
        },
        {
            content: "The 'line1' should be selected by default",
            trigger: "div[name='line_ids'] td[field='name']:contains('line1')",
        },

        // Test 1: Check the loading of lazy notebook tabs.
        // Check 'amls_tab' (active by default).
        {
            trigger: "div.bank_rec_widget_form_amls_list_anchor table.o_list_table",
        },
        {
            content: "The 'amls_tab' should be active and the inner list view loaded",
            trigger: "a.active[name='amls_tab']",
        },
        // Check 'discuss_tab'.
        {
            trigger: "a.active[name='amls_tab']",
        },
        {
            content: "Click on the 'discuss_tab'",
            trigger: "a[name='discuss_tab']",
            run: "click",
        },
        {
            trigger: "a.active[name='discuss_tab']",
        },
        {
            content: "The 'discuss_tab' should be active and the chatter loaded",
            trigger: "div.bank_rec_widget_form_discuss_anchor div.o-mail-Chatter",
        },
        // Check 'manual_operations_tab'.
        {
            trigger: "tr.o_bank_rec_auto_balance_line",
        },
        {
            content: "Click on the 'auto_balance' to make the 'manual_operations_tab' visible",
            trigger: "tr.o_bank_rec_auto_balance_line td[field='name']",
            run: "click",
        },
        {
            content: "The 'manual_operations_tab' should be active",
            trigger: "a.active[name='manual_operations_tab']",
        },
        {
            content: "The 'name' field should be focus automatically",
            trigger: "div.o_notebook div[name='name'] input:focus",
        },
        {
            trigger: "tr.o_bank_rec_auto_balance_line",
        },
        {
            content: "Click on the 'credit' field to change the focus from 'name' to 'amount_currency'",
            trigger: "tr.o_bank_rec_auto_balance_line td[field='credit']",
            run: "click",
        },
        {
            content: "Wait to avoid non-deterministic errors on the next step",
            trigger: "tr.o_bank_rec_auto_balance_line td[field='credit']",
        },
        {
            content: "The 'balance' field should be focus now",
            trigger: "div.o_notebook div[name='amount_currency'] input:focus",
        },

        // Test 2: Test validation + auto select the next line.
        {
            trigger: "a.active[name='manual_operations_tab']",
        },
        {
            content: "Click on the 'amls_tab'",
            trigger: "a[name='amls_tab']",
            run: "click",
        },
        {
            trigger: "a.active[name='amls_tab']",
        },
        {
            content: "Mount INV/2019/00002",
            trigger:
                "div.bank_rec_widget_form_amls_list_anchor table.o_list_table td[name='move_id']:contains('INV/2019/00002')",
            run: "click",
        },
        {
            trigger:
                "div.bank_rec_widget_form_amls_list_anchor table.o_list_table tr.o_rec_widget_list_selected_item td[name='move_id']:contains('INV/2019/00002')",
        },
        {
            content: "Check INV/2019/00002 is well marked as selected",
            trigger:
                "div.bank_rec_widget_form_amls_list_anchor table.o_list_table tr.o_rec_widget_list_selected_item td[name='move_id']:contains('INV/2019/00002')",
        },
        {
            trigger:
                "div.bank_rec_widget_form_amls_list_anchor table.o_list_table tr.o_rec_widget_list_selected_item td[name='move_id']:contains('INV/2019/00002')",
        },
        {
            content: "Remove INV/2019/00002",
            trigger: "tr td.o_list_record_remove button",
            run: "click",
        },
        {
            trigger:
                "div.bank_rec_widget_form_amls_list_anchor table.o_list_table tr:not(.o_rec_widget_list_selected_item) td[name='move_id']:contains('INV/2019/00002')",
        },
        {
            content: "Mount INV/2019/00001",
            trigger:
                "div.bank_rec_widget_form_amls_list_anchor table.o_list_table td[name='move_id']:contains('INV/2019/00001')",
            run: "click",
        },
        {
            trigger:
                "div.bank_rec_widget_form_amls_list_anchor table.o_list_table tr.o_rec_widget_list_selected_item td[name='move_id']:contains('INV/2019/00001')",
        },
        {
            content: "Validate",
            trigger: "button:contains('Validate')",
            run: "click",
        },
        {
            trigger: "div[name='line_ids'] td[field='name']:contains('line2')",
        },
        {
            content: "The 'line2' is the next not already reconciled line",
            trigger: "div[name='line_ids'] td[field='name']:contains('line2')",
        },

        // Test 3: Test manual operations tab.
        {
            content: "Click on 'credit'",
            trigger: "div[name='line_ids'] td[field='credit']:last",
            run: "click",
        },
        {
            content:
                "The 'manual_operations_tab' should be active now and the auto_balance line mounted in edit",
            trigger: "a.active[name='manual_operations_tab']",
        },
        {
            content: "The last line should be selected",
            trigger: "div[name='line_ids'] tr.o_bank_rec_selected_line",
        },
        {
            content: "Search for 'partner_a'",
            trigger: "div[name='partner_id'] input",
            run: "edit partner_a",
        },
        {
            trigger: ".ui-autocomplete .o_m2o_dropdown_option a:contains('Create')",
        },
        {
            content: "Select 'partner_a'",
            trigger: ".ui-autocomplete:visible li:contains('partner_a')",
            run: "click",
        },
        {
            trigger:
                "tr:not(.o_bank_rec_auto_balance_line) td[field='partner_id']:contains('partner_a')",
        },
        {
            content: "Select the payable account",
            trigger: "button:contains('Payable')",
            run: "click",
        },
        {
            trigger:
                "tr:not(.o_bank_rec_auto_balance_line) td[field='account_id']:contains('Payable')",
        },
        {
            content: "Enter a tax",
            trigger: "div[name='tax_ids'] input",
            run: "edit 15",
        },
        {
            trigger: ".ui-autocomplete",
        },
        {
            content: "Select 'Tax 15% (Sales)'",
            trigger: ".ui-autocomplete:visible li:contains('Sales')",
            run: "click",
        },
        {
            content: "Tax column appears in list of lines",
            trigger: "div[name='line_ids'] td[field='tax_ids']",
        },
        {
            content: "Wait to avoid non-deterministic errors on the next step",
            trigger: "div[name='line_ids'] td:contains('Tax Received')",
        },
        {
            trigger: "button.btn-primary:contains('Validate')",
        },
        {
            content: "Validate",
            trigger: "button:contains('Validate')",
            run: "click",
        },
        {
            trigger: "div[name='line_ids'] td[field='name']:contains('line3')",
        },
        {
            content: "The 'line3' is the next not already reconciled line",
            trigger: "div[name='line_ids'] td[field='name']:contains('line3')",
        },
        ...stepUtils.toggleHomeMenu(),
        ...accountTourSteps.goToAccountMenu("Reset back to accounting module"),
        {
            content: "check that we're back on the dashboard",
            trigger: 'a:contains("Customer Invoices")',
        },
    ],
});

return __exports;
});
;

/***************************************************************************************
*  Filepath: /account_accountant/static/tests/tours/test_tour_journal_items_export.js  *
*  Lines: 57                                                                           *
***************************************************************************************/
odoo.define('@account_accountant/../tests/tours/test_tour_journal_items_export', ['@web/core/registry', '@web_tour/tour_service/tour_utils', '@account/js/tours/account'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { registry } = require("@web/core/registry");
const { stepUtils } = require("@web_tour/tour_service/tour_utils");
const { accountTourSteps } = require("@account/js/tours/account");

registry.category("web_tour.tours").add("account_accountant_journal_items_export", {
    url: "/web",
    steps: () => [
        stepUtils.showAppsMenuItem(),
        ...accountTourSteps.goToAccountMenu("Open the accounting module"),

        {
            content: "Open journal items list view",
            trigger: 'button[data-menu-xmlid="account.menu_finance_entries"]',
            run: "click",
        },
        {
            content: "Open journal items list view",
            trigger: 'a[data-menu-xmlid="account.menu_action_account_moves_all"]',
            run: "click",
        },
        {
            content: "Select all items",
            trigger: 'thead tr th.o_list_record_selector',
            run: "click",
        },
        {
            content: "Open export dialog",
            trigger: 'i.fa-cog',
            run: "click",
        },
        {
            content: "Open export dialog",
            trigger: 'i.fa-upload',
            run: "click",
        },
        {
            content: "Click on the cancel button",
            trigger: 'button.o_form_button_cancel',
            run: "click",
        },
        // End
        ...stepUtils.toggleHomeMenu(),
        ...accountTourSteps.goToAccountMenu("Reset back to accounting module"),
        {
            content: "check that we're back on the dashboard",
            trigger: 'a:contains("Customer Invoices")',
        },
    ],
});

return __exports;
});
;

/**************************************************************************
*  Filepath: /accountant/static/tests/tours/account_merge_wizard_tour.js  *
*  Lines: 67                                                              *
**************************************************************************/
odoo.define('@accountant/../tests/tours/account_merge_wizard_tour', ['@account/js/tours/account', '@web/core/registry'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module */

const { accountTourSteps } = require("@account/js/tours/account");
const { registry } = require("@web/core/registry");

registry.category("web_tour.tours").add("account_merge_wizard_tour", {
    url: "/odoo",
    steps: () => [
        ...accountTourSteps.goToAccountMenu("Go to Accounting"),
        {
            content: "Go to Configuration",
            trigger: 'span:contains("Configuration")',
            run: "click",
        },
        {
            content: "Go to Chart of Accounts",
            trigger: 'a:contains("Chart of Accounts")',
            run: "click",
        },
        {
            trigger: '.o_breadcrumb .text-truncate:contains("Chart of Accounts")',
        },
        {
            content: "Select accounts",
            trigger: "thead .o_list_record_selector",
            run: "click",
        },
        {
            content: "Check that exactly 4 accounts are present and selected",
            trigger: ".o_list_selection_box:contains(4):contains(selected)",
        },
        {
            content: "Open Actions menu",
            trigger: ".o_cp_action_menus .dropdown-toggle",
            run: "click",
        },
        {
            content: "Open Merge accounts wizard",
            trigger: 'span:contains("Merge accounts")',
            run: "click",
        },
        {
            content: "Group by name",
            trigger: 'div[name="is_group_by_name"] input',
            run: "click",
        },
        {
            content: "Wait for content to be updated",
            trigger: 'td:contains("Current Assets (Current Assets)")',
        },
        {
            content: "Merge accounts",
            trigger: 'button:not([disabled]) span:contains("Merge")',
            run: "click",
        },
        {
            content: "Check that there are now exactly 2 accounts",
            trigger: "tr.o_data_row:contains(2)",
        },
    ],
});

return __exports;
});
;

/**************************************************************
*  Filepath: /accountant/static/tests/tours/account_tours.js  *
*  Lines: 16                                                  *
**************************************************************/
odoo.define('@accountant/../tests/tours/account_tours', ['@web/core/utils/patch', '@account/js/tours/account', '@web_tour/tour_service/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/
const { patch } = require("@web/core/utils/patch");
const { accountTourSteps } = require("@account/js/tours/account");
const { stepUtils } = require("@web_tour/tour_service/tour_utils");

patch(accountTourSteps, {
    goToAccountMenu(description="Open Accounting Menu") {
        return stepUtils.goToAppSteps('accountant.menu_accounting', description);
    }
});

return __exports;
});
;

/*****************************************************************
*  Filepath: /project/static/tests/tours/personal_stage_tour.js  *
*  Lines: 86                                                     *
*****************************************************************/
odoo.define('@project/../tests/tours/personal_stage_tour', ['@web/core/registry', '@web_tour/tour_service/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module */

const { registry } = require("@web/core/registry");
const { stepUtils } = require("@web_tour/tour_service/tour_utils");

registry.category("web_tour.tours").add('personal_stage_tour', {
    url: '/odoo',
    steps: () => [stepUtils.showAppsMenuItem(), {
    trigger: '.o_app[data-menu-xmlid="project.menu_main_pm"]',
    run: "click",
}, {
    content: "Open Pig Project",
    trigger: '.o_kanban_record:contains("Pig")',
    run: "click",
}, {
    // Default is grouped by stage, user should not be able to create/edit a column
    content: "Check that there is no create column",
    trigger: "body:not(.o_column_quick_create)",
}, {
    content: "Check that there is no create column",
    trigger: "body:not(.o_column_edit)",
}, {
    content: "Check that there is no create column",
    trigger: "body:not(.o_column_delete)",
}, {
    content: "Go to tasks",
    trigger: 'button[data-menu-xmlid="project.menu_project_management"]',
    run: "click",
},{
    content: "Go to my tasks", // My tasks is grouped by personal stage by default
    trigger: 'a[data-menu-xmlid="project.menu_project_management_my_tasks"]',
    run: "click",
}, {
    content: "Check that we can create a new stage",
    trigger: '.o_column_quick_create .o_quick_create_folded',
    run: "click",
}, {
    content: "Create a new personal stage",
    trigger: 'input.form-control',
    run: "edit Never",
}, {
    content: "Confirm create",
    trigger: '.o_kanban_add',
    run: "click",
}, {
    content: "Check that column exists && Open column edit dropdown",
    trigger: ".o_kanban_header:contains(Never)",
    run: "hover && click .o_kanban_header:contains(Never) .dropdown-toggle",
}, {
    content: "Try editing inbox",
    trigger: ".dropdown-item.o_column_edit",
    run: "click",
}, {
    content: "Change title",
    trigger: 'div.o_field_char[name="name"] input',
    run: "edit ((Todo))",
}, {
    content: "Save changes",
    trigger: '.btn-primary:contains("Save")',
    run: "click",
}, {
    content: "Check that column was updated",
    trigger: '.o_kanban_header:contains("Todo")',
    run: "click",
}, {
    content: "Create a personal task from the quick create form",
    trigger: '.o-kanban-button-new',
    run: "click",
}, {
    content: "Create a new personal task",
    trigger: 'input.o_input:not(.o_searchview_input)',
    run: "edit New Test Task",
}, {
    content: "Confirm create",
    trigger: '.o_kanban_add',
    run: "click",
}, {
    content: "Check that task exists",
    trigger: '.o_kanban_record:contains("New Test Task")',
}]});

return __exports;
});
;

/*************************************************************************
*  Filepath: /project/static/tests/tours/project_burndown_chart_tour.js  *
*  Lines: 96                                                             *
*************************************************************************/
odoo.define('@project/../tests/tours/project_burndown_chart_tour', ['@web/core/registry', '@web_tour/tour_service/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module */

const { registry } = require("@web/core/registry");
const { stepUtils } = require("@web_tour/tour_service/tour_utils");

registry.category("web_tour.tours").add('burndown_chart_tour', {
    url: '/odoo',
    steps: () => [stepUtils.showAppsMenuItem(), {
    trigger: '.o_app[data-menu-xmlid="project.menu_main_pm"]',
    run: "click",
}, {
    content: 'Open "Burndown Chart Test" project menu',
            trigger: ".o_kanban_record:contains(Burndown Chart Test)",
    run: `hover && click .o_kanban_record:contains(Burndown Chart Test) .o_dropdown_kanban .dropdown-toggle`,
}, {
    content: `Open "Burndown Chart Test" project's "Burndown Chart" view`,
    trigger: '.o_kanban_manage_reporting div[role="menuitem"] a:contains("Burndown Chart")',
    run: "click",
},
{
    trigger: ".o_graph_renderer",
},
{
    content: 'The sort buttons are not rendered',
    trigger: '.o_graph_renderer:not(:has(.btn-group[role=toolbar][aria-label="Sort graph"]))',
    run: "click",
}, {
    content: 'Remove the project search "Burndown Chart Test"',
    trigger: ".o_searchview_facet:contains(Burndown Chart Test)",
    run: "hover && click .o_facet_remove",
}, {
    content: 'Search Burndown Chart',
    trigger: 'input.o_searchview_input',
    run: `edit Burndown`,
}, {
    content: 'Validate search',
    trigger: '.o_searchview_autocomplete .o_menu_item:contains("Project")',
    run: "click",
}, {
    content: 'Remove the group by "Date: Month > Stage"',
    trigger: '.o_searchview_facet:contains("Stage") .o_facet_remove',
    run: "click",
}, {
    content: 'A "The Burndown Chart must be grouped by Date and Stage" notification is shown when trying to remove the group by "Date: Month > Stage"',
    trigger: '.o_notification_manager .o_notification:contains("The report should be grouped either by ") button.o_notification_close',
    run: "click",
}, {
    content: 'Open the search panel menu',
    trigger: '.o_control_panel .o_searchview_dropdown_toggler',
    run: "click",
}, {
    content: 'The Stage group menu item is visible',
    trigger: '.o_group_by_menu .o_menu_item:contains("Stage")',
    run: "click",
}, {
    content: 'Open the Date group by sub menu',
    trigger: '.o_group_by_menu button.o_menu_item:contains("Date")',
    run: "click",
}, {
    content: 'Click on the selected Date sub menu',
    trigger: '.o_group_by_menu button.o_menu_item:contains("Date") + * .dropdown-item.selected',
    run: "click",
}, {
    content: 'A "The Burndown Chart must be grouped by Date" notification is shown when trying to remove the group by "Date: Month > Stage"',
    trigger: '.o_notification_manager .o_notification:contains("The Burndown Chart must be grouped by Date") button.o_notification_close',
    run: "click",
}, {
    content: 'Open the search panel menu',
    trigger: '.o_control_panel .o_searchview_dropdown_toggler',
    run: "click",
}, {
    content: 'Open the Date filter sub menu',
    trigger: '.o_filter_menu button.o_menu_item:contains("Date")',
    run: "click",
}, {
    content: 'Click on the first Date filter sub menu',
    trigger: '.o_filter_menu .o_menu_item:contains("Date") + * .dropdown-item:first-child',
    run: "click",
}, {
    content: 'Close the Date filter menu',
    trigger: '.o_graph_renderer',
    run: "click",
}, {
    content: 'Open the search panel menu',
    trigger: '.o_control_panel .o_searchview_dropdown_toggler',
    run: "click",
}, {
    content: 'The comparison menu is not rendered',
    trigger: ':not(:has(.o_comparison_menu))',
}]});

return __exports;
});
;

/******************************************************************
*  Filepath: /project/static/tests/tours/project_sharing_tour.js  *
*  Lines: 225                                                     *
******************************************************************/
odoo.define('@project/../tests/tours/project_sharing_tour', ['@web/core/registry', '@web_tour/tour_service/tour_utils'], function (require) {
'use strict';
let __exports = {};
const { registry } = require("@web/core/registry");
const { stepUtils } = require("@web_tour/tour_service/tour_utils");

const projectSharingSteps = [...stepUtils.goToAppSteps("project.menu_main_pm", 'Go to the Project App.'), {
    trigger: ".o_kanban_record:contains(Project Sharing)",
    content: 'Open the project dropdown.',
    run: "hover && click .o_kanban_record:contains(Project Sharing) .o_dropdown_kanban .dropdown-toggle",
}, {
    trigger: '.dropdown-menu a:contains("Share")',
    content: 'Start editing the project.',
    run: "click",
}, {
    trigger: '.modal div[name="collaborator_ids"] .o_field_x2many_list_row_add > a',
    content: 'Add a collaborator to the project.',
    run: "click",
}, {
    trigger: '.modal div[name="collaborator_ids"] div[name="partner_id"] input',
    content: 'Select the user portal as collaborator to the "Project Sharing" project.',
    run: "edit Georges",
}, {
    trigger: '.ui-autocomplete a.dropdown-item:contains("Georges")',
    run: "click",
}, {
    trigger: '.modal div[name="collaborator_ids"] div[name="access_mode"] select',
    content: 'Select "Edit" as Access mode in the "Share Project" wizard.',
    run: 'select "edit"',
}, {
    trigger: '.modal footer > button[name="action_share_record"]',
    content: 'Confirm the project sharing with this portal user.',
    run: "click",
},
{
    trigger: "body:not(:has(.modal))",
},
{
    trigger: '.o_web_client',
    content: 'Go to project portal view to select the "Project Sharing" project',
    run: function () {
        window.location.href = window.location.origin + '/my/projects';
    },
}, {
    id: 'project_sharing_feature',
    trigger: 'table > tbody > tr a:has(span:contains(Project Sharing))',
    content: 'Select "Project Sharing" project to go to project sharing feature for this project.',
    run: "click",
}, {
    trigger: ':iframe .o_project_sharing',
    content: 'Wait the project sharing feature be loaded',
}, {
    trigger: ':iframe button.o-kanban-button-new',
    content: 'Click "Create" button',
    run: 'click',
}, {
    trigger: ':iframe .o_kanban_quick_create .o_field_widget[name="name"] input',
    content: 'Create Task',
    run: "edit Test Create Task",
}, {
    content: "Check that task stages cannot be drag and dropped",
    trigger: ':iframe .o_kanban_group:not(.o_group_draggable)',
}, {
    trigger: ':iframe .o_kanban_quick_create .o_kanban_edit',
    content: 'Go to the form view of this new task',
    run: "click",
}, {
    trigger: ':iframe div[name="stage_id"] div.o_statusbar_status button[aria-checked="false"]:contains(Done)',
    content: 'Change the stage of the task.',
    run: "click",
}, {
    trigger: ':iframe .o-mail-Composer-input',
    content: 'Write a message in the chatter of the task',
    run: "edit I create a new task for testing purpose.",
}, {
    trigger: ':iframe .o-mail-Composer-send:enabled',
    content: 'Send the message',
    run: "click",
}, {
    trigger: ':iframe ol.breadcrumb > li.o_back_button > a:contains(Project Sharing)',
    content: 'Go back to the kanban view',
    run: "click",
}, {
    trigger: ':iframe .o_searchview_dropdown_toggler',
    content: 'open the search panel menu',
    run: "click",
}, {
    trigger: ':iframe .o_filter_menu .dropdown-item:first-child',
    content: 'click on the first item in the filter menu',
    run: "click",
}, {
    trigger: ':iframe .o_group_by_menu .dropdown-item:first-child',
    content: 'click on the first item in the group by menu',
    run: "click",
}, {
    trigger: ':iframe .o_favorite_menu .o_add_favorite',
    content: 'open accordion "save current search" in favorite menu',
    run: "click",
}, {
    trigger: ':iframe .o_favorite_menu .o_accordion_values .o_save_favorite',
    content: 'click to "save" button in favorite menu',
    run: "click",
}, {
    trigger: ':iframe .o_filter_menu .dropdown-item:first-child',
    content: 'click on the first item in the filter menu',
    run: "click",
}, {
    trigger: ':iframe .o_group_by_menu .dropdown-item:first-child',
    content: 'click on the first item in the group by menu',
    run: "click",
}, {
    trigger: ':iframe .o_favorite_menu .o_accordion_values .o_save_favorite',
    content: 'click to "save" button in favorite menu',
    run: "click",
}, {
    trigger: ':iframe button.o_switch_view.o_list',
    content: 'Go to the list view',
    run: "click",
}, {
    trigger: ':iframe .o_list_view',
}, {
    trigger: ':iframe .o_optional_columns_dropdown_toggle',
    run: "click",
}, {
    trigger: ':iframe .dropdown-item:contains("Milestone")',
}, {
    trigger: ':iframe .o_list_view',
    content: 'Check the list view',
}];

registry.category("web_tour.tours").add('project_sharing_tour', {
    url: '/odoo',
    steps: () => {
        return projectSharingSteps;
    }
});

registry.category("web_tour.tours").add("portal_project_sharing_tour", {
    url: "/my/projects",
    steps: () => {
        // The begining of the project sharing feature
        const projectSharingStepIndex = projectSharingSteps.findIndex(s => s?.id === 'project_sharing_feature');
        return projectSharingSteps.slice(projectSharingStepIndex, projectSharingSteps.length);
    }
});

registry.category("web_tour.tours").add("project_sharing_with_blocked_task_tour", {
    url: "/my/projects",
    steps: () => [{
        trigger: 'table > tbody > tr a:has(span:contains("Project Sharing"))',
        content: 'Click on the portal project.',
        run: "click",
    }, {
        trigger: ':iframe article.o_kanban_record',
        content: 'Click on the task',
        run: "click",
    }, {
        trigger: ':iframe a:contains("Blocked By")',
        content: 'Go to the Block by task tab',
        run: "click",
    }, {
        trigger: ':iframe i:contains("This task is currently blocked by")',
        content: 'Check that the blocked task is not visible',
    },
]});

registry.category("web_tour.tours").add("portal_project_sharing_tour_with_disallowed_milestones", {
    url: "/my/projects",
    steps: () => [
        {
            id: "project_sharing_feature",
            trigger: "table > tbody > tr a:has(span:contains(Project Sharing))",
            content:
                'Select "Project Sharing" project to go to project sharing feature for this project.',
            run: "click",
        },
        {
            trigger: ":iframe .o_project_sharing",
            content: "Wait the project sharing feature be loaded",
        },
        {
            trigger: ":iframe button.o_switch_view.o_list",
            content: "Go to the list view",
            run: "click",
        },
        {
            trigger: ":iframe .o_list_view",
        },
        {
            trigger: ":iframe .o_optional_columns_dropdown_toggle",
            run: "click",
        },
        {
            trigger: ":iframe .dropdown-item",
        },
        {
            trigger: ":iframe .dropdown-menu",
            run: function () {
                const optionalFields = Array.from(
                    this.anchor.ownerDocument.querySelectorAll(".dropdown-item")
                ).map((e) => e.textContent);

                if (optionalFields.includes("Milestone")) {
                    throw new Error(
                        "the Milestone field should be absent as allow_milestones is set to False"
                    );
                }
            },
        },
    ],
});

registry.category("web_tour.tours").add("test_04_project_sharing_chatter_message_reactions", {
    url: "/my/projects",
    steps: () => [
        { trigger: "table > tbody > tr a:has(span:contains(Project Sharing))", run: "click" },
        { trigger: ":iframe .o_project_sharing" },
        { trigger: ":iframe .o_kanban_record:contains('Test Task with messages')", run: "click" },
        { trigger: ":iframe .o-mail-Message" },
        { trigger: ":iframe .o-mail-Message .o-mail-MessageReaction:contains('')" },
    ],
});

return __exports;
});
;

/****************************************************************************
*  Filepath: /project/static/tests/tours/project_tags_filter_tour_tests.js  *
*  Lines: 73                                                                *
****************************************************************************/
odoo.define('@project/../tests/tours/project_tags_filter_tour_tests', ['@web/core/registry', '@web_tour/tour_service/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { registry } = require("@web/core/registry");
const { stepUtils } = require("@web_tour/tour_service/tour_utils");

function changeFilter(filterName) {
    return [
        {
            trigger: ".o_control_panel_actions .o_searchview_dropdown_toggler",
            content: "open searchview menu",
            run: "click",
        },
        {
            trigger: `.o_favorite_menu .dropdown-item span:contains("${filterName}")`,
            run: "click",
        },
        {
            trigger: ".o_control_panel_actions .o_searchview_dropdown_toggler",
            content: "close searchview menu",
            run: "click",
        },
    ];
}

registry.category("web_tour.tours").add("project_tags_filter_tour", {
    url: "/odoo",
    steps: () => [
        stepUtils.showAppsMenuItem(),
        {
            trigger: '.o_app[data-menu-xmlid="project.menu_main_pm"]',
            run: "click",
        },
        ...changeFilter("Corkscrew tail tag filter"),
        {
            trigger:
                '.o_kanban_group:has(.o_kanban_header:has(span:contains("goat"))):not(:has(.o_kanban_record))',
            content: "check that the corkscrew tail filter has taken effect",
        },
        {
            trigger:
                '.o_kanban_group:has(.o_kanban_header:has(span:contains("pig"))) .o_kanban_record:has(span:contains("Pigs"))',
            content: "check that the corkscrew tail filter has taken effect",
        },
        ...changeFilter("horned tag filter"),
        {
            trigger:
                '.o_kanban_group:has(.o_kanban_header:has(span:contains("pig"))):not(:has(.o_kanban_record))',
            content: "check that the horned filter has taken effect",
        },
        {
            trigger:
                '.o_kanban_group:has(.o_kanban_header:has(span:contains("goat"))) .o_kanban_record:has(span:contains("Goats"))',
            content: "check that the horned filter has taken effect",
        },
        ...changeFilter("4 Legged tag filter"),
        {
            trigger:
                '.o_kanban_group:has(.o_kanban_header:has(span:contains("pig"))) .o_kanban_record:has(span:contains("Pigs"))',
            content: "check that the 4 legged filter has taken effect",
        },
        {
            trigger:
                '.o_kanban_group:has(.o_kanban_header:has(span:contains("goat"))) .o_kanban_record:has(span:contains("Goats"))',
            content: "check that the 4 legged filter has taken effect",
        },
    ],
});

return __exports;
});
;

/******************************************************************
*  Filepath: /project/static/tests/tours/project_task_history.js  *
*  Lines: 189                                                     *
******************************************************************/
odoo.define('@project/../tests/tours/project_task_history', ['@web/core/registry', '@web_tour/tour_service/tour_utils'], function (require) {
'use strict';
let __exports = {};
/**
 * Project Task history tour.
 * Features tested:
 * - Create / edit a task description and ensure revisions are created on write
 * - Open the history dialog and check that the revisions are correctly shown
 * - Select a revision and check that the content / comparison are correct
 * - Click the restore button and check that the content is correctly restored
 */

const { registry } = require("@web/core/registry");
const { stepUtils } = require("@web_tour/tour_service/tour_utils");

const baseDescriptionContent = "Test project task history version";
function changeDescriptionContentAndSave(newContent) {
    const newText = `${baseDescriptionContent} ${newContent}`;
    return [
        {
            // force focus on editable so editor will create initial p (if not yet done)
            trigger: "div.note-editable.odoo-editor-editable",
            run: "click",
        },
        {
            trigger: `div.note-editable[spellcheck='true'].odoo-editor-editable`,
            run: `editor ${newText}`,
        },
        ...stepUtils.saveForm(),
    ];
}

registry.category("web_tour.tours").add("project_task_history_tour", {
    url: "/odoo",
    steps: () => [stepUtils.showAppsMenuItem(), {
        content: "Open the project app",
        trigger: ".o_app[data-menu-xmlid='project.menu_main_pm']",
        run: "click",
    },
    {
        content: "Open Test History Project",
        trigger: ".o_kanban_view .o_kanban_record:contains(Test History Project)",
        run: "click",
    },
    {
        content: "Open Test History Task",
        trigger: ".o_kanban_view .o_kanban_record:contains(Test History Task)",
        run: "click",
    },
        // edit the description content 3 times and save after each edit
        ...changeDescriptionContentAndSave("0"),
        ...changeDescriptionContentAndSave("1"),
        ...changeDescriptionContentAndSave("2"),
        ...changeDescriptionContentAndSave("3"),
    {
        content: "Go back to kanban view of tasks. this step is added because it takes some time to save the changes, so it's a sort of timeout to wait a bit for the save",
        trigger: ".o_back_button a",
        run: "click",
    },
    {
        content: "Open Test History Task",
        trigger: ".o_kanban_view .o_kanban_record:contains(Test History Task)",
        run: "click",
    },
    {
        content: "Open History Dialog",
        trigger: ".o_form_view .o_cp_action_menus i.fa-cog",
        run: "click",
    },
    {
        trigger: ".dropdown-menu",
    },
    {
        content: "Open History Dialog",
        trigger: ".o_menu_item i.fa-history",
        run: "click",
    }, {
        content: "Verify that 4 revisions are displayed (default empty description after the creation of the task + 3 edits)",
        trigger: ".modal .html-history-dialog .revision-list .btn",
        run: function () {
            const items = document.querySelectorAll(".revision-list .btn");
            if (items.length !== 4) {
                console.error("Expect 4 Revisions in the history dialog, got " + items.length);
            }
        },
    }, {
        content: "Verify that the active revision (revision 4) is related to the third edit",
        trigger: `.modal .history-container .tab-pane:contains("${baseDescriptionContent} 2")`,
        run: "click",
    }, {
        content: "Go to the third revision related to the second edit",
        trigger: ".modal .html-history-dialog .revision-list .btn:nth-child(2)",
        run: "click",
    }, {
        content: "Verify that the active revision is the one clicked in the previous step",
        trigger: `.modal .history-container .tab-pane:contains("${baseDescriptionContent} 1")`,
        run: "click",
    }, {
        content: "Go to comparison tab",
        trigger: ".modal .history-container .nav-item:contains(Comparison) a",
        run: "click",
    }, {
        content: "Verify comparaison text",
        trigger: ".modal .history-container .tab-pane",
        run: function () {
            const comparaisonHtml = this.anchor.innerHTML;
            const correctHtml = `<added>${baseDescriptionContent} 1</added><removed>${baseDescriptionContent} 3</removed>`;
            if (!comparaisonHtml.includes(correctHtml)) {
                console.error(`Expect comparison to be ${correctHtml}, got ${comparaisonHtml}`);
            }
        },
    }, {
        content: "Click on Restore History btn to get back to the selected revision in the previous step",
        trigger: ".modal button.btn-primary:contains(/^Restore history$/)",
        run: "click",
    }, {
        content: "Verify the confirmation dialog is opened",
        trigger: ".modal button.btn-primary:contains(/^Restore$/)",
        run: "click",
    }, {
        content: "Verify that the description contains the right text after the restore",
        trigger: `div.note-editable.odoo-editor-editable`,
        run: function () {
            const p = this.anchor?.innerText;
            const expected = `${baseDescriptionContent} 1`;
            if (p !== expected) {
                console.error(`Expect description to be ${expected}, got ${p}`);
            }
        }
    }, {
        content: "Go back to projects view.",
        trigger: 'a[data-menu-xmlid="project.menu_projects"]',
        run: "click",
    }, {
        trigger: ".o_kanban_view",
    }, {
        content: "Open Test History Project Without Tasks",
        trigger: ".o_kanban_view .o_kanban_record:contains(Without tasks project)",
        run: "click",
    }, {
        trigger: ".o_kanban_project_tasks",
    }, {
        content: "Switch to list view",
        trigger: ".o_switch_view.o_list",
        run: "click",
    }, {
        content: "Create a new task.",
        trigger: '.o_list_button_add',
        run: "click",
    }, {
        trigger: ".o_form_view",
    }, {
        trigger: 'div[name="name"] .o_input',
        content: 'Set task name',
        run: 'edit New task',
    },
    ...stepUtils.saveForm(),
        ...changeDescriptionContentAndSave("0"),
        ...changeDescriptionContentAndSave("1"),
        ...changeDescriptionContentAndSave("2"),
        ...changeDescriptionContentAndSave("3"),
    {
        trigger: ".o_form_view",
    }, {
        content: "Open History Dialog",
        trigger: ".o_cp_action_menus i.fa-cog",
        run: "click",
    }, {
        trigger: ".dropdown-menu",
    }, {
        content: "Open History Dialog",
        trigger: ".o_menu_item i.fa-history",
        run: "click",
    }, {
        content: "Close History Dialog",
        trigger: ".modal-header .btn-close",
        run: "click",
    }, {
        content: "Go back to projects view. this step is added because Tour can't be finished with an open form view in edition mode.",
        trigger: 'a[data-menu-xmlid="project.menu_projects"]',
        run: "click",
    }, {
        content: "Verify that we are on kanban view",
        trigger: 'button.o_switch_view.o_kanban.active',
    }
]});

return __exports;
});
;

/**********************************************************
*  Filepath: /project/static/tests/tours/project_tour.js  *
*  Lines: 162                                             *
**********************************************************/
odoo.define('@project/../tests/tours/project_tour', ['@web/core/registry', '@web_tour/tour_service/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module */

const { registry } = require("@web/core/registry");
const { stepUtils } = require("@web_tour/tour_service/tour_utils");

registry.category("web_tour.tours").add('project_test_tour', {
    url: '/odoo',
    steps: () => [
    stepUtils.showAppsMenuItem(), {
        trigger: '.o_app[data-menu-xmlid="project.menu_main_pm"]',
        run: "click",
    },
    {
        trigger: '.o_project_kanban',
    },
    {
        trigger: '.o-kanban-button-new',
        run: "click",
    }, {
        trigger: '.o_project_name input',
        run: 'edit New Project',
        id: 'project_creation',
    }, {
        trigger: '.o_open_tasks',
        run: "click .modal:visible .btn.btn-primary",
    }, {
        trigger: ".o_kanban_project_tasks .o_column_quick_create .input-group input",
        run: "edit New",
    }, {
        isActive: ["auto"],
        trigger: ".o_kanban_project_tasks .o_column_quick_create .o_kanban_add",
        run: "click",
    },
    {
        trigger: ".o_kanban_group",
    },
    {
        trigger: ".o_kanban_project_tasks .o_column_quick_create .input-group input",
        run: "edit Done",
    }, {
        isActive: ["auto"],
        trigger: ".o_kanban_project_tasks .o_column_quick_create .o_kanban_add",
        run: "click",
    },
    {
        trigger: ".o_kanban_group:eq(0)",
    },
    {
        trigger: '.o-kanban-button-new',
        run: "click",
    },
    {
        trigger: ".o_kanban_project_tasks",
    },
    {
        trigger: '.o_kanban_quick_create div.o_field_char[name=display_name] input',
        run: "edit New task",
    }, {
        trigger: '.o_kanban_quick_create .o_kanban_add',
        run: "click",
    }, {
        trigger: '.o_kanban_record span:contains("New task")',
        run: "click",
    }, {
        trigger: 'a[name="sub_tasks_page"]',
        content: 'Open sub-tasks notebook section',
        run: 'click',
    }, {
        trigger: '.o_field_subtasks_one2many .o_list_renderer a[role="button"]',
        content: 'Add a subtask',
        run: 'click',
    }, {
        trigger: '.o_field_subtasks_one2many div[name="name"] input',
        content: 'Set subtask name',
        run: "edit new subtask",
    }, {
        trigger: ".o_breadcrumb .o_back_button",
        content: 'Go back to kanban view',
        tooltipPosition: "right",
        run: "click",
    }, {
        trigger: ".o_kanban_record .o_widget_subtask_counter .subtask_list_button",
        content: 'open sub-tasks from kanban card',
        run: "click",
    },
    {
        trigger: ".o_widget_subtask_kanban_list .subtask_list",
    },
    {
        trigger: ".o_kanban_record .o_widget_subtask_kanban_list .subtask_create",
        content: 'Create a new sub-task',
        run: "click",
    },
    {
        trigger: ".subtask_create_input",
    },
    {
        trigger: ".o_kanban_record .o_widget_subtask_kanban_list .subtask_create_input input",
        content: 'Give the sub-task a name',
        run: "edit newer subtask && press Tab",
    },
    {
        content: "wait the new record is created",
        trigger: ".o_kanban_record .o_widget_subtask_kanban_list a:contains(newer subtask)",
    },
    {    
        trigger: ".o_kanban_record .o_widget_subtask_kanban_list .subtask_list_row:first-child .o_field_project_task_state_selection button",
        content: 'Change the subtask state',
        run: "click",
    },
    {
        trigger: ".dropdown-menu",
    },
    {
        trigger: ".dropdown-menu span.text-danger",
        content: 'Mark the task as Canceled',
        run: "click",
    }, {
        trigger: ".o_kanban_record .o_widget_subtask_counter .subtask_list_button:contains('1/2')",
        content: 'Close the sub-tasks list',
        id: "quick_create_tasks",
        run: "click",
    }, {
        trigger: '.o_field_text[name="name"] textarea',
        content: 'Set task name',
        run: "edit New task",
    }, {
        trigger: 'div[name="user_ids"].o_field_many2many_tags_avatar input',
        content: 'Assign the task to you',
        run: 'click',
    }, {
        trigger: 'ul.ui-autocomplete a .o_avatar_many2x_autocomplete',
        content: 'Assign the task to you',
        run: "click",
    }, {
        trigger: 'a[name="sub_tasks_page"]',
        content: 'Open sub-tasks notebook section',
        run: 'click',
    }, {
        trigger: '.o_field_subtasks_one2many .o_list_renderer a[role="button"]',
        content: 'Add a subtask',
        run: 'click',
    }, {
        trigger: '.o_field_subtasks_one2many div[name="name"] input',
        content: 'Set subtask name',
        run: "edit new subtask",
    },
    {
        trigger: '.o_field_many2many_tags_avatar .o_m2m_avatar',
    },
    {
        trigger: 'button[special="save"]',
        content: 'Save task',
        run: "click",
    },
]});

return __exports;
});
;

/***********************************************************************
*  Filepath: /project/static/tests/tours/project_update_tour_tests.js  *
*  Lines: 207                                                          *
***********************************************************************/
odoo.define('@project/../tests/tours/project_update_tour_tests', ['@web/core/registry', '@web_tour/tour_service/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { registry } = require("@web/core/registry");
const { stepUtils } = require("@web_tour/tour_service/tour_utils");

registry.category("web_tour.tours").add('project_update_tour', {
    url: '/odoo',
    steps: () => [stepUtils.showAppsMenuItem(), {
    trigger: '.o_app[data-menu-xmlid="project.menu_main_pm"]',
    run: "click",
},
{
    trigger: ".o_project_kanban",
},
{
    trigger: '.o-kanban-button-new',
    run: "click",
}, {
    trigger: '.o_project_name input',
    run: "edit New Project",
}, {
    trigger: '.o_open_tasks',
    run: "click .modal:visible .btn.btn-primary",
}, {
    trigger: ".o_kanban_project_tasks .o_column_quick_create .input-group input",
    run: "edit New",
}, {
    isActive: ["auto"],
    trigger: ".o_kanban_project_tasks .o_column_quick_create .o_kanban_add",
    run: "click",
},
{
    trigger: ".o_kanban_group",
},
{
    trigger: ".o_kanban_project_tasks .o_column_quick_create .input-group input",
    run: "edit Done",
}, {
    isActive: ["auto"],
    trigger: ".o_kanban_project_tasks .o_column_quick_create .o_kanban_add",
    run: "click",
},
{
    trigger: ".o_kanban_group:eq(0)",
},
{
    trigger: '.o-kanban-button-new',
    run: "click",
},
{
    trigger: ".o_kanban_project_tasks",
},
{
    trigger: '.o_kanban_quick_create div.o_field_char[name=display_name] input',
    run: "edit New task",
},
{
    trigger: ".o_kanban_project_tasks",
},
{
    trigger: '.o_kanban_quick_create .o_kanban_add',
    run: "click",
},
{
    trigger: ".o_kanban_group:eq(0)",
},
{
    trigger: '.o-kanban-button-new',
    run: "click",
},
{
    trigger: ".o_kanban_project_tasks",
},
{
    trigger: '.o_kanban_quick_create div.o_field_char[name=display_name] input',
    run: "edit Second task",
},
{
    trigger: ".o_kanban_project_tasks",
},
{
    trigger: '.o_kanban_quick_create .o_kanban_add',
    run: "click",
}, {
    trigger: ".o_kanban_group:nth-child(2) .o_kanban_header",
    run: "hover && click .o_kanban_group:nth-child(2) .o_kanban_header .dropdown-toggle",
}, {
    trigger: ".dropdown-item.o_column_edit",
    run: "click",
}, {
    trigger: ".modal .o_field_widget[name=fold] input",
    run: "click",
}, {
    trigger: ".modal .modal-footer button",
    run: "click",
},
{
    trigger: "body:not(:has(.modal))",
},
{
    trigger: '.o_kanban_project_tasks',
},
{
    trigger: ".o_kanban_record",
    run: "drag_and_drop(.o_kanban_group:eq(1))",
}, {
    trigger: ".o_control_panel_navigation button i.fa-sliders",
    content: 'Open embedded actions',
    run: "click",
}, {
    trigger: ".o_embedded_actions button i.fa-sliders",
    content: "Open embedded actions dropdown",
    run: "click",
}, {
    trigger: ".o-dropdown-item div span:contains('Dashboard')",
    content: "Put Dashboard in the embedded actions",
    run: "click",
}, {
    trigger: ".o_embedded_actions button span:contains('Dashboard')",
    content: "Open Dashboard",
    run: "click",
}, {
    trigger: ".o_add_milestone a",
    content: "Add a first milestone",
    run: "click",
}, {
    trigger: "div.o_field_widget[name=name] input",
    run: "edit New milestone",
}, {
    trigger: "input[data-field=deadline]",
    run: "edit 12/12/2099",
}, {
    trigger: ".modal-footer .o_form_button_save",
    run: "click",
},
{
    trigger: "body:not(:has(.modal))",
},
{
    trigger: ".o_add_milestone a",
    run: "click",
}, {
    trigger: "div.o_field_widget[name=name] input",
    run: "edit Second milestone",
}, {
    trigger: "input[data-field=deadline]",
    run: "edit 12/12/2022 && click body",
}, {
    trigger: ".modal-footer .o_form_button_save",
    run: "click",
},
{
    trigger: "body:not(:has(.modal))",
},
{
    trigger: ".o_rightpanel_milestone:eq(1) .o_milestone_detail",
    run: "click",
}, {
    trigger: "input[data-field=deadline]",
    run: "edit 12/12/2100 && click body",
}, {
    trigger: ".modal-footer .o_form_button_save",
    run: "click",
}, {
    trigger: ".o-kanban-button-new",
    content: "Create a new update",
    run: "click",
}, {
    trigger: "div.o_field_widget[name=name] input",
    run: "edit New update",
}, {
    trigger: ".o_form_button_save",
    run: "click",
}, {
    trigger: ".o_field_widget[name='description'] h1:contains('Activities')",
}, {
    trigger: ".o_field_widget[name='description'] h3:contains('Milestones')",
}, {
    trigger: ".o_field_widget[name='description'] div[name='milestone'] ul li:contains('(12/12/2099 => 12/12/2100)')",
}, {
    trigger: ".o_field_widget[name='description'] div[name='milestone'] ul li:contains('(due 12/12/2022)')",
}, {
    trigger: ".o_field_widget[name='description'] div[name='milestone'] ul li:contains('(due 12/12/2100)')",
}, {
    trigger: '.o_back_button',
    content: 'Go back to the kanban view the project',
    run: "click",
}, {
    trigger: '.o_switch_view.o_list',
    content: 'Open List View of Dashboard',
    run: "click",
},
{
    trigger: '.o_list_view',
},
{
    trigger: '.o_back_button',
    content: 'Go back to the kanban view the project',
    run: "click",
},
]});

return __exports;
});
;

/**************************************************************
*  Filepath: /website_payment/static/tests/tours/donation.js  *
*  Lines: 109                                                 *
**************************************************************/
odoo.define('@website_payment/../tests/tours/donation', ['@web/core/registry', '@website/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module */

const { registry } = require("@web/core/registry");
const {
    clickOnSave,
    registerWebsitePreviewTour,
    insertSnippet,
} = require("@website/js/tours/tour_utils");

// First part of the tour
registerWebsitePreviewTour(
    "donation_snippet_edition",
    {
        url: "/",
        edition: true,
    },
    () => [
        ...insertSnippet({
            id: "s_donation",
            name: "Donation",
            groupName: "Contact & Forms",
        }),
        ...clickOnSave(),
]);

// Second part of the tour
registry.category('web_tour.tours').add('donation_snippet_use', {
    url: '/',
    steps: () => [
        // -- Testing the minimum amount --
        {
            content: "Enter a custom amount smaller than the minimum, testing the minimum amount",
            trigger: "#s_donation_amount_input",
            run: "edit 1",
        },
        {
            content: "Donate with custom amount set",
            trigger: ".s_donation_donate_btn",
            run: "click",
        },
        {
            content: "Check if alert-danger element exists",
            trigger: "p.alert-danger",
        },
        // -- End of testing the minimum amount --
        {
            content: "Enter a custom amount",
            trigger: "#s_donation_amount_input",
            run: "edit 55",
        },
        {
            content: "Donate with custom amount set",
            trigger: ".s_donation_donate_btn",
            run: "click",
        },
        {
            content: "Check if custom amount radio input is selected",
            trigger: "input#other_amount:checked",
        },
        {
            content: "Check if custom amount radio input has value 55",
            trigger: 'input#other_amount[value="55.0"]',
        },
        {
            content: "Select the amount of 25",
            trigger: "input#amount_1",
            run: "click",
        },
        {
            content: "Verify that amount_1 is checked",
            trigger: "input#amount_1:checked",
        },
        {
            content: "Verify that other_amount is not checked",
            trigger: "input#other_amount:not(:checked)",
        },
        {
            content: "Change custom amount to 67",
            trigger: "input[name='o_donation_amount'][type='number']",
            run: "edit 67",
        },
        {
            content: "Select the custom amount radio button",
            trigger: "input#other_amount",
            run: "click",
        },
        {
            content: "Submit the donation form",
            trigger: "button[name='o_payment_submit_button']",
            run: "click",
        },
        {
            trigger: "body:contains(Your payment has been successfully processed.)",
        },
        {
            content: "Verify that the amount displayed is 67",
            trigger: 'span.oe_currency_value:contains("67.00")',
        },
        {
            trigger: "[name=o_payment_status_alert]:contains(thank you!)",
        },
    ],
});

return __exports;
});
;

/************************************************************************
*  Filepath: /website_sale/static/tests/tours/website_free_delivery.js  *
*  Lines: 48                                                            *
************************************************************************/
odoo.define('@website_sale/../tests/tours/website_free_delivery', ['@web/core/registry', '@website_sale/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { registry } = require("@web/core/registry");
const tourUtils = require("@website_sale/js/tours/tour_utils");

registry.category("web_tour.tours").add("check_free_delivery", {
    url: "/shop",
    steps: () => [
        // Part 1: Check free delivery
        ...tourUtils.addToCart({ productName: "Office Chair Black TEST" }),
        tourUtils.goToCart({ quantity: 1 }),
        tourUtils.goToCheckout(),
        {
            trigger: "#o_delivery_methods label:contains(/^Delivery Now Free Over 10$/)",
        },
        {
            content: "Check Free Delivery value to be zero",
            trigger: "#o_delivery_methods span:contains('0.0')",
            run: "click",
        },
        // Part 2: check multiple delivery & price loaded asynchronously
        {
            trigger: '#o_delivery_methods input[name="o_delivery_radio"]:checked',
        },
        {
            content: "Ensure price was loaded asynchronously",
            trigger:
                '#o_delivery_methods [name="o_delivery_method"]:contains("20.0"):contains("The Poste")',
        },
        tourUtils.confirmOrder(),
        {
            content: "Select `Wire Transfer` payment method",
            trigger: 'input[name="o_payment_radio"][data-payment-method-code="wire_transfer"]',
            run: "click",
        },
        tourUtils.pay(),
        {
            content: "Confirmation page should be shown",
            trigger: "#oe_structure_website_sale_confirmation_1:not(:visible)",
        },
    ],
});

return __exports;
});
;

/****************************************************************************************
*  Filepath: /website_sale/static/tests/tours/website_sale_add_to_cart_snippet_tour.js  *
*  Lines: 63                                                                            *
****************************************************************************************/
odoo.define('@website_sale/../tests/tours/website_sale_add_to_cart_snippet_tour', ['@website_sale/js/tours/tour_utils', '@website/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { assertCartContains } = require('@website_sale/js/tours/tour_utils');
const { registerWebsitePreviewTour, clickOnEditAndWaitEditMode, clickOnSnippet, insertSnippet, selectElementInWeSelectWidget, clickOnSave, clickOnElement } = require('@website/js/tours/tour_utils');


function editAddToCartSnippet() {
    return [
        ...clickOnEditAndWaitEditMode(),
        ...clickOnSnippet({id: 's_add_to_cart'})
    ]
}

registerWebsitePreviewTour('add_to_cart_snippet_tour', {
        url: '/',
        edition: true,
    },
    () => [
        ...insertSnippet({name: 'Add to Cart Button'}),

        // Basic product with no variants
        ...clickOnSnippet({id: 's_add_to_cart'}),
        ...selectElementInWeSelectWidget('product_template_picker_opt', 'Product No Variant', true),
        ...clickOnSave(),
        clickOnElement('add to cart button', ':iframe .s_add_to_cart_btn'),

        // Product with 2 variants with visitor choice (will open modal)
        ...editAddToCartSnippet(),
        ...selectElementInWeSelectWidget('product_template_picker_opt', 'Product Yes Variant 1', true),
        ...clickOnSave(),
        clickOnElement('add to cart button', ':iframe .s_add_to_cart_btn'),
        clickOnElement('continue shopping', ':iframe .modal button:contains(Continue Shopping)'),

        // Product with 2 variants with a variant selected
        ...editAddToCartSnippet(),
        ...selectElementInWeSelectWidget('product_template_picker_opt', 'Product Yes Variant 2', true),
        ...selectElementInWeSelectWidget('product_variant_picker_opt', 'Product Yes Variant 2 (Pink)'),
        ...clickOnSave(),
        clickOnElement('add to cart button', ':iframe .s_add_to_cart_btn'),

        // Basic product with no variants and action=buy now
        ...editAddToCartSnippet(),
        ...selectElementInWeSelectWidget('product_template_picker_opt', 'Product No Variant', true),
        ...selectElementInWeSelectWidget('action_picker_opt', 'Buy Now'),
        // At this point the "Add to cart" button was changed to a "Buy Now" button
        ...clickOnSave(),
        clickOnElement('"Buy Now" button', ':iframe .s_add_to_cart_btn'),
        {
            // wait for the page to load, as the next check was sometimes too fast
            content: "Wait for the redirection to the cart page",
            trigger: ":iframe h3:contains(order overview)",
        },
        assertCartContains({productName: 'Product No Variant', backend: true}),
        assertCartContains({productName: 'Product Yes Variant 1 (Red)', backend: true}),
        assertCartContains({productName: 'Product Yes Variant 2 (Pink)', backend: true}),
    ],
);

return __exports;
});
;

/*******************************************************************
*  Filepath: /website_sale/static/tests/tours/website_sale_buy.js  *
*  Lines: 31                                                       *
*******************************************************************/
odoo.define('@website_sale/../tests/tours/website_sale_buy', ['@web/core/registry', '@website_sale/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { registry } = require("@web/core/registry");
const tourUtils = require("@website_sale/js/tours/tour_utils");

registry.category("web_tour.tours").add('shop_buy_product', {
    url: '/shop',
    steps: () => [
        ...tourUtils.searchProduct("Storage Box"),
        {
            content: "select Storage Box",
            trigger: '.oe_product_cart:first a:contains("Storage Box")',
            run: "click",
        },
        {
            content: "click on add to cart",
            trigger: '#product_detail form[action^="/shop/cart/update"] #add_to_cart',
            run: "click",
        },
        tourUtils.goToCart(),
        tourUtils.goToCheckout(),
        tourUtils.confirmOrder(),
        ...tourUtils.payWithTransfer(true),
    ]
});

return __exports;
});
;

/*********************************************************************************
*  Filepath: /website_sale/static/tests/tours/website_sale_cart_notification.js  *
*  Lines: 84                                                                     *
*********************************************************************************/
odoo.define('@website_sale/../tests/tours/website_sale_cart_notification', ['@web/core/registry', '@website_sale/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { registry } = require("@web/core/registry");
const tourUtils = require("@website_sale/js/tours/tour_utils");

registry.category("web_tour.tours").add("website_sale_cart_notification", {
    url: "/shop",
    steps: () => [
        ...tourUtils.addToCart({ productName: "website_sale_cart_notification_product_1" }),
        {
            content: "check that 1 website_sale_cart_notification_product_1 was added",
            trigger: '.toast-body span:contains("1 x website_sale_cart_notification_product_1")',
        },
        {
            content: "check the price of 1 website_sale_cart_notification_product_1",
            trigger: '.toast-body div:contains("$ 1,000.00")',
        },
        {
            content: "close the notification",
            trigger: ".toast-header button.btn-close",
            run: "click",
        },
        {
            content: "check that the notification is closed",
            trigger: "div.position-fixed.w-100.h-100.top-0.pe-none",
            run() {
                if (this.anchor.querySelectorAll("div").length !== 1) {
                    console.error("The cart notification is not closed!");
                }
            },
        },
        ...tourUtils.searchProduct("website_sale_cart_notification_product_2"),
        {
            content: "select website_sale_cart_notification_product_2",
            trigger:
                '.oe_product_cart:first a:contains("website_sale_cart_notification_product_2")',
            run: "click",
        },
        {
            trigger: "#product_detail",
        },
        {
            content: "change quantity",
            trigger: '#product_detail form[action^="/shop/cart/update"] input[name=add_qty]',
            run: "edit 3",
        },
        {
            content: "click on add to cart",
            trigger: '#product_detail form[action^="/shop/cart/update"] #add_to_cart',
            run: "click",
        },
        {
            content: "check that 3 website_sale_cart_notification_product_2 was added",
            trigger: '.toast-body span:contains("3 x website_sale_cart_notification_product_2")',
        },
        {
            content: "check that the novariants/custom attributes are displayed.",
            trigger: '.toast-body span.text-muted.small:contains("Size: S")',
        },
        {
            content: "check the price of 1 website_sale_cart_notification_product_2",
            trigger: '.toast-body div:contains("$ 15,000.00")',
        },
        {
            content: "Go To Cart",
            trigger: '.toast-body a:contains("View cart")',
            run: "click",
        },
        tourUtils.assertCartContains({
            productName: "website_sale_cart_notification_product_1",
            backend: false,
        }),
        tourUtils.assertCartContains({
            productName: "website_sale_cart_notification_product_2",
            backend: false,
        }),
    ],
});

return __exports;
});
;

/**************************************************************************************************
*  Filepath: /website_sale/static/tests/tours/website_sale_category_page_and_products_snippet.js  *
*  Lines: 84                                                                                      *
**************************************************************************************************/
odoo.define('@website_sale/../tests/tours/website_sale_category_page_and_products_snippet', ['@website/js/tours/tour_utils', '@web/core/registry'], function (require) {
'use strict';
let __exports = {};
/** @odoo-modules */

const { clickOnSave, clickOnEditAndWaitEditMode, registerWebsitePreviewTour } = require('@website/js/tours/tour_utils');
const { registry } = require("@web/core/registry");


registerWebsitePreviewTour('category_page_and_products_snippet_edition', {
    url: '/shop',
}, () => [
    {
        content: "Navigate to category",
        trigger: ':iframe .o_wsale_filmstip > li:contains("Test Category") > a',
        run: "click",
    },
    ...clickOnEditAndWaitEditMode(),
    {
        trigger: ".o_website_preview.editor_enable.editor_has_snippets",
    },
    {
        content: "Drag and drop the Products snippet group inside the category area.",
        trigger: '#oe_snippets .oe_snippet[name="Products"] .oe_snippet_thumbnail:not(.o_we_ongoing_insertion)',
        run: "drag_and_drop :iframe #category_header",
    },
    {
        content: "Click on the s_dynamic_snippet_products snippet.",
        trigger: ':iframe .o_snippet_preview_wrap[data-snippet-id="s_dynamic_snippet_products"]',
        run: "click",
    },

    {
        content: "Click on the product snippet to show its options",
        trigger: ':iframe #category_header .s_dynamic_snippet_products',
        run: "click",
    },
    {
        content: "Open category option dropdown",
        trigger: 'we-select[data-attribute-name="productCategoryId"] we-toggler',
        run: "click",
    },
    {
        content: "Choose the option to use the current page's category",
        trigger: 'we-button[data-select-data-attribute="current"]',
        run: "click",
    },
    ...clickOnSave(),
]);

registry.category("web_tour.tours").add('category_page_and_products_snippet_use', {
    url: '/shop',
    steps: () => [
    {
        content: "Navigate to category",
        trigger: '.o_wsale_filmstip > li:contains("Test Category") > a',
        run: "click",
    },
    {
        content: "Check that the snippet displays the right products",
        // Wait for at least one shown product
        trigger: '#category_header .s_dynamic_snippet_products:has(.o_carousel_product_img_link)',
        run() {
            // Fetch the category's id from the url.
            const productCategoryId = window.location.href.match('/shop/category/test-category-(\\d+)')[1]
            const productGridEl = this.anchor.closest('#products_grid');
            const regex = new RegExp(`^/shop/[\\w-/]+-(\\d+)\\?category=${productCategoryId}$`);
            const allPageProductIDs = [...productGridEl.querySelectorAll('.oe_product_image_link')]
                .map(el => el.getAttribute('href').match(regex)[1]);

            const $shownProductLinks = this.anchor.querySelectorAll(".o_carousel_product_img_link");
            const regex2 = new RegExp(`^/shop/[\\w-/]+-(\\d+)(?:#attribute_values=\\d*)?$`);
            for (const shownProductLinkEl of $shownProductLinks) {
                const productID = shownProductLinkEl.getAttribute('href').match(regex2)[1];
                if (!allPageProductIDs.includes(productID)) {
                    console.error(`The snippet displays a product (${productID}) which does not belong to the current category (${allPageProductIDs})`);
                }
            }
        },
    },
]});

return __exports;
});
;

/**********************************************************************************
*  Filepath: /website_sale/static/tests/tours/website_sale_combo_configurator.js  *
*  Lines: 70                                                                      *
**********************************************************************************/
odoo.define('@website_sale/../tests/tours/website_sale_combo_configurator', ['@web/core/registry', '@odoo/hoot-dom', '@sale/js/tours/combo_configurator_tour_utils', '@sale/js/tours/product_configurator_tour_utils', '@website_sale/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
const { registry } = require('@web/core/registry');
const { queryValue, waitUntil } = require('@odoo/hoot-dom');
const comboConfiguratorTourUtils = require('@sale/js/tours/combo_configurator_tour_utils')[Symbol.for("default")];
const productConfiguratorTourUtils = require('@sale/js/tours/product_configurator_tour_utils')[Symbol.for("default")];
const wsTourUtils = require('@website_sale/js/tours/tour_utils');

registry
    .category('web_tour.tours')
    .add('website_sale_combo_configurator', {
        url: '/shop?search=Combo product',
        steps: () => [
            ...wsTourUtils.addToCart({ productName: "Combo product", search: false }),
            // Assert that the combo configurator behaves as expected.
            comboConfiguratorTourUtils.assertFooterButtonsDisabled(),
            comboConfiguratorTourUtils.setQuantity(3),
            comboConfiguratorTourUtils.selectComboItem("Product A1"),
            ...productConfiguratorTourUtils.selectAndSetCustomAttribute(
                "Product A1", "No variant attribute", "B", "Some custom value"
            ),
            ...productConfiguratorTourUtils.saveConfigurator(),
            comboConfiguratorTourUtils.selectComboItem("Product B2"),
            comboConfiguratorTourUtils.assertFooterButtonsEnabled(),
            // Assert that the cart's content is correct.
            {
                content: "Proceed to checkout",
                trigger: 'button:contains(Proceed to Checkout)',
                run: 'click',
            },
            wsTourUtils.assertCartContains({ productName: "Combo product" }),
            wsTourUtils.assertCartContains({ productName: "3 x Product A1" }),
            wsTourUtils.assertCartContains({ productName: "3 x Product B2" }),
            {
                content: "Verify the first combo item's attributes",
                trigger: 'div.o_cart_product:contains("No variant attribute: B: Some custom value")',
            },
            {
                content: "Verify the combo product's quantity",
                trigger: 'input.quantity',
                run: async () => await waitUntil(
                    () => queryValue('input.quantity') === '3', { timeout: 1000 }
                ),
            },
            {
                content: "Verify the combo product's price",
                trigger: 'div[name="website_sale_cart_line_price"]:contains(93.00)',
            },
            {
                content: "Verify the order's total price",
                trigger: 'tr#order_total_untaxed:contains(93.00)',
            },
            // Assert that the combo quantity can be updated in the cart.
            {
                content: "Edit the combo quantity",
                trigger: 'input.quantity',
                run: 'edit 2 && click body',
            },
            wsTourUtils.assertCartContains({ productName: "2 x Product A1" }),
            wsTourUtils.assertCartContains({ productName: "2 x Product B2" }),
            {
                content: "Verify the combo product's price",
                trigger: 'div[name="website_sale_cart_line_price"]:contains(62.00)',
            },
        ],
   });

return __exports;
});
;

/***********************************************************************************************************
*  Filepath: /website_sale/static/tests/tours/website_sale_combo_configurator_single_configurable_item.js  *
*  Lines: 21                                                                                               *
***********************************************************************************************************/
odoo.define('@website_sale/../tests/tours/website_sale_combo_configurator_single_configurable_item', ['@web/core/registry', '@website_sale/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
const { registry } = require('@web/core/registry');
const wsTourUtils = require('@website_sale/js/tours/tour_utils');

registry
    .category('web_tour.tours')
    .add('website_sale_combo_configurator_single_configurable_item', {
        url: '/shop?search=Combo product',
        steps: () => [
            ...wsTourUtils.addToCart({ productName: "Combo product", search: false }),
            {
                content: "Assert that the combo configurator is shown",
                trigger: '.sale-combo-configurator-dialog',
            },
        ],
   });

return __exports;
});
;

/*******************************************************************************************************
*  Filepath: /website_sale/static/tests/tours/website_sale_combo_configurator_single_configuration.js  *
*  Lines: 21                                                                                           *
*******************************************************************************************************/
odoo.define('@website_sale/../tests/tours/website_sale_combo_configurator_single_configuration', ['@web/core/registry', '@website_sale/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
const { registry } = require('@web/core/registry');
const wsTourUtils = require('@website_sale/js/tours/tour_utils');

registry
    .category('web_tour.tours')
    .add('website_sale_combo_configurator_single_configuration', {
        url: '/shop?search=Combo product',
        steps: () => [
            ...wsTourUtils.addToCart({ productName: "Combo product", search: false }),
            wsTourUtils.goToCart(),
            // Assert that the combo configurator wasn't shown.
            wsTourUtils.assertCartContains({ productName: "Combo product" }),
            wsTourUtils.assertCartContains({ productName: "1 x Test product" }),
        ],
   });

return __exports;
});
;

/*****************************************************************************
*  Filepath: /website_sale/static/tests/tours/website_sale_complete_flow.js  *
*  Lines: 508                                                                *
*****************************************************************************/
odoo.define('@website_sale/../tests/tours/website_sale_complete_flow', ['@web/core/network/rpc', '@web/core/registry', '@website_sale/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

    const { rpc } = require("@web/core/network/rpc");
    const { registry } = require("@web/core/registry");
    const tourUtils = require("@website_sale/js/tours/tour_utils");

    registry.category("web_tour.tours").add('website_sale_tour_1', {
        url: '/shop?search=Storage Box Test',
        steps: () => [
    // Testing b2c with Tax-Excluded Prices
    {
        content: "Open product page",
        trigger: '.oe_product_cart a:contains("Storage Box Test")',
        run: "click",
    },
    {
        content: "Add one more storage box",
        trigger: '.js_add_cart_json:eq(1)',
        run: "click",
    },
    {
        content: "Check b2b Tax-Excluded Prices",
        trigger: ".product_price .oe_price .oe_currency_value:contains(/^79.00$/)",
    },
    {
        content: "Click on add to cart",
        trigger: '#add_to_cart',
        run: "click",
    },
        tourUtils.goToCart({quantity: 2}),
    {
        content: "Check for 2 products in cart",
        trigger:
            '#cart_products div:has(a>h6:contains("Storage Box Test")) input.js_quantity:value(2)',
    },
    ...tourUtils.assertCartAmounts({
        taxes: '23.70',
        untaxed: '158.00',
        total: '181.70',
    }),
    {
        content: "Proceed to checkout",
        trigger: 'a[href*="/shop/checkout"]',
        run: "click",
    },
    {
        content: "Fulfill delivery address form",
        trigger: 'select[name="country_id"]',
        run: "selectByLabel Afghanistan",
    },
    {
        trigger: `input[name="name"]`,
        run: "edit abcd",
    },
    {
        trigger: `input[name="phone"]`,
        run: "edit 99999999",
    },
    {
        trigger: `input[name="email"]`,
        run: "edit abc@odoo.com",
    },
    {
        trigger: `input[name="street"]`,
        run: "edit SO1 Delivery Street, 33",
    },
    {
        trigger: `input[name="city"]`,
        run: "edit SO1DeliveryCity",
    },
    {
        trigger: `input[name="zip"]`,
        run: "edit 10000",
    },
    {
        content: "Click on next button",
        trigger: '.oe_cart .btn:contains("Continue checkout")',
        run: "click",
    },
    {
        content: "Billing address is not same as delivery address",
        trigger: '#use_delivery_as_billing',
        run: "click",
    },
    {
        content: "Add a billing address",
        trigger: '.all_billing a[href^="/shop/address"]:contains("Add address")',
        run: "click",
    },
    {
        trigger: 'h3:contains("Billing address")',
    },
    {
        content: "Fulfill billing address form",
        trigger: 'select[name="country_id"]',
        run: "selectByLabel Afghanistan",
    },
    {
        trigger: `input[name="name"]`,
        run: "edit def",
    },
    {
        trigger: `input[name="phone"]`,
        run: "edit 8888888888",
    },
    {
        trigger: `input[name="email"]`,
        run: "edit abc@odoo.com",
    },
    {
        trigger: `input[name="street"]`,
        run: "edit 17, SO1 Billing Road",
    },
    {
        trigger: `input[name="city"]`,
        run: "edit SO1BillingCity",
    },
    {
        trigger: `input[name="zip"]`,
        run: "edit 10000",
    },
    {
        content: "Click on next button",
        trigger: '.oe_cart .btn:contains("Save address")',
        run: "click",
    },
    {
        content: "Check selected delivery address is same as typed in previous step",
        trigger: '#delivery_address_row:contains(SO1 Delivery Street, 33):contains(SO1DeliveryCity):contains(Afghanistan)',
    },
    {
        content: "Check selected billing address is same as typed in previous step",
        trigger: '#billing_address_row:contains(17, SO1 Billing Road):contains(SO1BillingCity):contains(Afghanistan)',
    },
    {
        content: "Click for edit billing address",
        trigger: '.all_billing .js_edit_address:first',
        run: "click",
    },
    {
        trigger: 'h3:contains("Billing address")',
    },
    {
        content: "Change billing address form",
        trigger: 'select[name="country_id"]',
    },
    {
        trigger: `input[name="name"]`,
        run: "edit abcd",
    },
    {
        trigger: `input[name="phone"]`,
        run: "edit 11111111",
    },
    {
        trigger: `input[name="street"]`,
        run: "edit SO1 Billing Street Edited, 33",
    },
    {
        trigger: `input[name="city"]`,
        run: "edit SO1BillingCityEdited",
    },
    {
        content: "Click on next button",
        trigger: '.oe_cart .btn:contains("Save address")',
        run: "click",
    },
        tourUtils.confirmOrder(),
    {
        content: "Check selected billing address is same as typed in previous step",
        trigger: '#delivery_and_billing :contains(Billing:):contains(SO1 Billing Street Edited, 33):contains(SO1BillingCityEdited):contains(Afghanistan)',
    },
    {
        content: "Select `Wire Transfer` payment method",
        trigger: 'input[name="o_payment_radio"][data-payment-method-code="wire_transfer"]',
        run: "click",
    },
    {
        trigger:
            'input[name="o_payment_radio"][data-payment-method-code="wire_transfer"]:checked',
    },
    {
        content: "Pay Now",
        trigger: 'button[name="o_payment_submit_button"]:not(:disabled)',
        run: "click",
    },
    {
        content: "Sign up",
        trigger: '.oe_cart a:contains("Sign Up")',
        run: "click",
    },
    {
        trigger: `.oe_signup_form input[name="password"]`,
        run: "edit 1admin@admin",
    },
    {
        trigger: `.oe_signup_form input[name="confirm_password"]`,
        run: "edit 1admin@admin",
    },
    {
        content: "Submit login",
        trigger: `.oe_signup_form button[type="submit"]`,
        run: "click",
    },
    {
        content: "See Quotations",
        trigger: '.o_portal_docs a:contains("Quotations to review")',
        run: "click",
    },
    // Sign in as admin change config auth_signup -> b2b, sale_show_tax -> total and Logout
    {
        trigger: ".o_header_standard:not(.o_transitioning)",
    },
    {
        content: "Open Dropdown for logout",
        trigger: 'header#top li.dropdown:visible a:contains("abcd")',
        run: "click",
    },
    {
        content: "Logout",
        trigger: '#o_logout:contains("Logout")',
        run: "click",
    },
    {
        content: "Sign in as admin",
        trigger: 'header a[href="/web/login"]',
        run: "click",
    },
    {
        trigger: `.oe_login_form input[name="login"]`,
        run: "edit admin",
    },
    {
        trigger: `.oe_login_form input[name="password"]`,
        run: "edit admin",
    },
    {
        trigger: `.oe_login_form input[name="redirect"]:not(:visible)`,
        run(helpers) {
            this.anchor.value = "/";
        },
    },
    {
        content: "Submit login",
        trigger: `.oe_login_form button[type="submit"]`,
        run: "click"
    },
    {
        trigger: ".o_frontend_to_backend_nav", // Check if the user is connected
    },
    {
        content: "Configuration Settings for 'Tax Included' and sign up 'On Invitation'",
        trigger: '#wrapwrap',
        run: function () {
            var def1 = rpc(`/web/dataset/call_kw/res.config.settings/create`, {
                model: "res.config.settings",
                method: "create",
                args: [{
                    'auth_signup_uninvited': 'b2b',
                    'show_line_subtotals_tax_selection': 'tax_included',
                }],
                kwargs: {},
            });
            var def2 = def1.then(function (resId) {
                return rpc(`/web/dataset/call_kw/res.config.settings/execute`, {
                    model: "res.config.settings",
                    method: "execute",
                    args: [[resId]],
                    kwargs: {},
                });
            });
            def2.then(function () {
                window.location.href = '/web/session/logout?redirect=/shop?search=Storage Box Test';
            });
        },
    },
    // Testing b2b with Tax-Included Prices
    {
        content: "Open product page",
        trigger: '.oe_product_cart a:contains("Storage Box Test")',
        run: "click",
    },
    {
        content: "Add one more Storage Box Test",
        trigger: '.js_add_cart_json:eq(1)',
        run: "click",
    },
    {
        content: "Check b2c Tax-Included Prices",
        trigger: ".product_price .oe_price .oe_currency_value:contains(/^90.85$/)",
    },
    {
        content: "Click on add to cart",
        trigger: '#add_to_cart',
        run: "click",
    },
        tourUtils.goToCart({quantity: 2}),
        {
            content: "Check for 2 products in cart",
            trigger:
                '#cart_products div:has(a>h6:contains("Storage Box Test")) input.js_quantity:value(2)',
        },
        ...tourUtils.assertCartAmounts({
            taxes: "23.70",
            untaxed: "158.00",
            total: "181.70",
        }),
        {
            content: "Proceed to checkout",
            trigger: 'a[href*="/shop/checkout"]',
            run: "click",
        },
    {
        content: "Click on Sign in Button",
        trigger: `.oe_cart a:contains(Sign in)`,
        run: "click",
    },
    {
        trigger: `.oe_login_form input[name="login"]`,
        run: "edit abc@odoo.com",
    },
    {
        trigger: `.oe_login_form input[name="password"]`,
        run: "edit 1admin@admin",
    },
    {
        content: "Submit login",
        trigger: `.oe_login_form button[type="submit"]`,
        run: "click",
    },
    {
        content: "Add new delivery address",
        trigger: '.all_delivery a[href^="/shop/address"]:contains("Add address")',
        run: "click",
    },
    {
        content: "Fulfill delivery address form",
        trigger: 'select[name="country_id"]',
        run: "selectByLabel Afghanistan",
    },
    {
        trigger: `input[name="name"]`,
        run: "edit ghi",
    },
    {
        trigger: `input[name="phone"]`,
        run: "edit 7777777777",
    },
    {
        trigger: `input[name="street"]`,
        run: "edit SO2New Delivery Street, 5",
    },
    {
        trigger: `input[name="city"]`,
        run: "edit SO2NewDelivery",
    },
    {
        trigger: `input[name="zip"]`,
        run: "edit 1200",
    },
    {
        content: "Click on next button",
        trigger: '.oe_cart .btn:contains("Save address")',
        run: "click",
    },
        tourUtils.confirmOrder(),
    {
        content: "Select `Wire Transfer` payment method",
        trigger: 'input[name="o_payment_radio"][data-payment-method-code="wire_transfer"]',
        run: "click",
    },
    {
        trigger: 'input[name="o_payment_radio"][data-payment-method-code="wire_transfer"]:checked',
    },
    {
        content: "Pay Now",
        trigger: 'button[name="o_payment_submit_button"]:not(:disabled)',
        run: "click",
    },
    {
        trigger: '.oe_cart .oe_website_sale_tx_status',
    },
    {
        content: "Open Dropdown for See quotation",
        trigger: 'header#top li.dropdown:visible a:contains("abc")',
        run: "click",
    },
    {
        trigger: "header#top li.dropdown .js_usermenu.show",
    },
    {
        content: "My account",
        trigger: 'header#top .dropdown-menu a[href="/my/home"]:visible',
        run: "click",
    },

    // enable extra step on website checkout and check extra step on checkout process
    {
        trigger: ".o_header_standard:not(.o_transitioning)",
    },
    {
        content: "Open Dropdown for logout",
        trigger: 'header#top li.dropdown:visible a:contains("abc")',
        run: "click",
    },
    {
        content: "Logout",
        trigger: '#o_logout:contains("Logout")',
        run: "click",
    },
    {
        content: "Sign in as admin",
        trigger: 'header a[href="/web/login"]',
        run: "click",
    },
    {
        trigger: `.oe_login_form input[name="login"]`,
        run: "edit admin",
    },
    {
        trigger: `.oe_login_form input[name="password"]`,
        run: "edit admin",
    },
    {
        trigger: `.oe_login_form input[name="redirect"]:not(:visible)`,
        run(helpers) {
            this.anchor.value = "/shop/cart";
        },
    },
    {
        content: "Submit login",
        trigger: `.oe_login_form button[type="submit"]`,
        run: "click",
    }]});

    registry.category("web_tour.tours").add('website_sale_tour_2', {
        url: '/shop/cart',
        steps: () => [
    {
        trigger: '.o_wizard:contains("Extra Info")',
    },
    {
        content: "Open Dropdown for logout",
        trigger: 'header#top li.dropdown:visible a:contains("Mitchell Admin")',
        run: "click",
    },
    {
        content: "Logout",
        trigger: '#o_logout:contains("Logout")',
        run: "click",
    },
    {
        content: "Sign in as abc",
        trigger: 'header a[href="/web/login"]',
        run: "click",
    },
    {
        trigger: `.oe_login_form input[name="login"]`,
        run: "edit abc@odoo.com",
    },
    {
        trigger: `.oe_login_form input[name="password"]`,
        run: "edit 1admin@admin",
    },
    {
        trigger: `.oe_login_form input[name="redirect"]:not(:visible)`,
        run(helpers) {
            this.anchor.value = "/shop?search=Storage Box Test";
        },
    },
    {
        content: "Submit login",
        trigger: `.oe_login_form button[type="submit"]`,
        run: "click",
    },
    {
        content: "Open product page",
        trigger: '.oe_product_cart a:contains("Storage Box Test")',
        run: "click",
    },
    {
        content: "Click on add to cart",
        trigger: '#add_to_cart',
        run: "click",
    },
        tourUtils.goToCart(),
        tourUtils.goToCheckout(),
    {
        content: "Click on 'Confirm' button (redirect to the 'extra info' form)",
        trigger: 'a[href^="/shop/extra_info"]',
        run: "click",
    },
    {
        content: "Click on 'Continue checkout' button",
        trigger: '.oe_cart .btn:contains("Continue checkout")',
        run: "click",
    },
    ...tourUtils.payWithTransfer(),
    {
        content: "Check payment status confirmation window",
        trigger: ".oe_website_sale_tx_status[data-order-tracking-info]",
    }]});

return __exports;
});
;

/*************************************************************************************
*  Filepath: /website_sale/static/tests/tours/website_sale_complete_flow_backend.js  *
*  Lines: 30                                                                         *
*************************************************************************************/
odoo.define('@website_sale/../tests/tours/website_sale_complete_flow_backend', ['@website/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { clickOnSave, registerWebsitePreviewTour } = require('@website/js/tours/tour_utils');

registerWebsitePreviewTour('website_sale_tour_backend', {
    url: '/shop/cart',
    edition: true,
}, () => [
        {
            content: "open customize tab",
            trigger: '.o_we_customize_snippet_btn',
            run: "click",
        },
        {
            trigger: "#oe_snippets .o_we_customize_panel",
        },
        {
            content: "Enable Extra step",
            trigger: '[data-customize-website-views="website_sale.extra_info"] we-checkbox',
            run: "click",
        },
        ...clickOnSave(),
    ],
);

return __exports;
});
;

/************************************************************************************
*  Filepath: /website_sale/static/tests/tours/website_sale_fiscal_position_tour.js  *
*  Lines: 37                                                                        *
************************************************************************************/
odoo.define('@website_sale/../tests/tours/website_sale_fiscal_position_tour', ['@web/core/registry'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { registry } = require("@web/core/registry");

registry.category("web_tour.tours").add('website_sale_fiscal_position_portal_tour', {
    url: '/shop?search=Super%20Product',
    steps: () => [
        {
            content: "Check price",
            trigger: ".oe_product:contains('Super product') .product_price:contains('80.00')",
        },
]});

registry.category("web_tour.tours").add('website_sale_fiscal_position_public_tour', {
    url: '/shop?search=Super%20Product',
    steps: () => [
        {
            content: "Toggle Pricelist",
            trigger: ".o_pricelist_dropdown > .dropdown-toggle",
            run: 'click',
        },
        {
            content: "Change Pricelist",
            trigger: ".dropdown-item:contains('EUROPE EUR')",
            run: 'click',
        },
        {
            content: "Check price",
            trigger: ".oe_product:contains('Super product') .product_price:contains('92.00')",
        },
]});

return __exports;
});
;

/********************************************************************************
*  Filepath: /website_sale/static/tests/tours/website_sale_google_analytics.js  *
*  Lines: 72                                                                    *
********************************************************************************/
odoo.define('@website_sale/../tests/tours/website_sale_google_analytics', ['@web/core/registry', '@website_sale/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { registry } = require("@web/core/registry");
const tourUtils = require("@website_sale/js/tours/tour_utils");

odoo.loader.bus.addEventListener("module-started", (e) => {
    if (e.detail.moduleName === "@website_sale/js/website_sale_tracking") {
        //import websiteSaleTracking from "@website_sale/js/website_sale_tracking";
        e.detail.module[Symbol.for("default")].include({
            // Purposely don't call super to avoid call to third party (GA) during tests
            _onViewItem(event, data) {
                document.body.setAttribute("view-event-id", data.item_id);
            },
            _onAddToCart(event, data) {
                document.body.setAttribute("cart-event-id", data.item_id);
            },
        });
    }
});

let itemId;


registry.category("web_tour.tours").add('google_analytics_view_item', {
    url: '/shop?search=Colored T-Shirt',
    steps: () => [
    {
        content: "select Colored T-Shirt",
        trigger: '.oe_product_cart a:contains("Colored T-Shirt")',
        run: "click",
    },
    {
        content: "wait until `_getCombinationInfo()` rpc is done",
        trigger: 'body[view-event-id]',
        timeout: 25000,
        run: () => {
            itemId = document.body.getAttribute("view-event-id");
        }
    },
    {
        content: 'select another variant',
        trigger:
            "ul.js_add_cart_variants ul.list-inline li:has(label.active) + li:has(label) input:not(:visible)",
        run: "click",
    },
    {
        content: 'wait until `_getCombinationInfo()` rpc is done (2)',
        // a new view event should have been generated, for another variant
        trigger: `body[view-event-id]:not([view-event-id="${itemId}"])`,
        timeout: 25000,
    },
]});

registry.category("web_tour.tours").add('google_analytics_add_to_cart', {
    url: '/shop?search=Basic Shirt',
    steps: () => [
    ...tourUtils.addToCart({productName: 'Basic Shirt', search: false}),
    {
        trigger: "body[cart-event-id]",
    },
    {
        content: 'check add to cart event',
        trigger: "a:has(.my_cart_quantity:contains(/^1$/))",
        timeout: 25000,
    },
]});

return __exports;
});
;

/*******************************************************************************************
*  Filepath: /website_sale/static/tests/tours/website_sale_preconfigured_variant_price.js  *
*  Lines: 27                                                                               *
*******************************************************************************************/
odoo.define('@website_sale/../tests/tours/website_sale_preconfigured_variant_price', ['@web/core/registry', '@sale/js/tours/product_configurator_tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { registry } = require("@web/core/registry");
const configuratorTourUtils = require("@sale/js/tours/product_configurator_tour_utils")[Symbol.for("default")];

registry.category("web_tour.tours").add('website_sale_product_configurator_optional_products_tour', {
    steps: () => [
        {
            trigger: 'ul.js_add_cart_variants span:contains("Aluminium") ~ span.badge:contains("50.40")',
        },
        {
    content: 'Click Aluminium Option',
    trigger: 'ul.js_add_cart_variants span:contains("Aluminium")',
    run: "click",
}, {
    content: 'Add to cart',
    trigger: '#add_to_cart',
    run: "click",
},
configuratorTourUtils.assertPriceTotal("800.40"),
]});

return __exports;
});
;

/********************************************************************************************************
*  Filepath: /website_sale/static/tests/tours/website_sale_product_configurator_strikethrough_price.js  *
*  Lines: 25                                                                                            *
********************************************************************************************************/
odoo.define('@website_sale/../tests/tours/website_sale_product_configurator_strikethrough_price', ['@web/core/registry', '@sale/js/tours/product_configurator_tour_utils', '@website_sale/js/tours/product_configurator_tour_utils', '@website_sale/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
const { registry } = require('@web/core/registry');
const configuratorTourUtils = require('@sale/js/tours/product_configurator_tour_utils')[Symbol.for("default")];
const websiteConfiguratorTourUtils = require('@website_sale/js/tours/product_configurator_tour_utils')[Symbol.for("default")];
const wsTourUtils = require('@website_sale/js/tours/tour_utils');

registry
    .category('web_tour.tours')
    .add('website_sale_product_configurator_strikethrough_price', {
        url: '/shop?search=Main product',
        steps: () => [
            ...wsTourUtils.addToCart({ productName: "Main product", search: false }),
            configuratorTourUtils.assertProductPrice("Main product", '55.00'),
            websiteConfiguratorTourUtils.assertProductStrikethroughPrice("Main product", '110.00'),
            configuratorTourUtils.assertOptionalProductPrice("Optional product", '5.50'),
            websiteConfiguratorTourUtils.assertOptionalProductStrikethroughPrice(
                "Optional product", '10.00'
            ),
        ],
   });

return __exports;
});
;

/************************************************************************************************
*  Filepath: /website_sale/static/tests/tours/website_sale_product_configurator_zero_priced.js  *
*  Lines: 31                                                                                    *
************************************************************************************************/
odoo.define('@website_sale/../tests/tours/website_sale_product_configurator_zero_priced', ['@web/core/registry', '@sale/js/tours/product_configurator_tour_utils', '@website_sale/js/tours/product_configurator_tour_utils', '@website_sale/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
const { registry } = require('@web/core/registry');
const configuratorTourUtils = require('@sale/js/tours/product_configurator_tour_utils')[Symbol.for("default")];
const websiteConfiguratorTourUtils = require('@website_sale/js/tours/product_configurator_tour_utils')[Symbol.for("default")];
const wsTourUtils = require('@website_sale/js/tours/tour_utils');

registry
    .category('web_tour.tours')
    .add('website_sale_product_configurator_zero_priced', {
        url: '/shop?search=Main product',
        steps: () => [
            ...wsTourUtils.addToCart({ productName: "Main product", search: false }),
            // Assert that the "Zero-priced" variant of the optional product can't be sold.
            ...websiteConfiguratorTourUtils.assertOptionalProductZeroPriced(
                "Optional product (Zero-priced)"
            ),
            // Add the "Zero-priced" variant by selecting the "Nonzero-priced" variant, adding it,
            // and selecting the "Zero-priced" variant again.
            configuratorTourUtils.selectAttribute("Optional product", "Price", "Nonzero-priced"),
            configuratorTourUtils.addOptionalProduct("Optional product (Nonzero-priced)"),
            configuratorTourUtils.selectAttribute("Optional product", "Price", "Zero-priced"),
            // Assert that the "Zero-priced" variant of the optional product still can't be sold.
            ...websiteConfiguratorTourUtils.assertProductZeroPriced("Optional product (Zero-priced)"),
            configuratorTourUtils.assertFooterButtonsDisabled(),
        ],
    });

return __exports;
});
;

/************************************************************************************************
*  Filepath: /website_sale/static/tests/tours/website_sale_product_reviews_reactions_public.js  *
*  Lines: 59                                                                                    *
************************************************************************************************/
odoo.define('@website_sale/../tests/tours/website_sale_product_reviews_reactions_public', ['@web/core/registry'], function (require) {
'use strict';
let __exports = {};
const { registry } = require("@web/core/registry");

registry
    .category('web_tour.tours')
    .add('website_sale_product_reviews_reactions_public', {
        url: '/shop?search=Storage Box Test',
        steps: () => [
            {
                trigger: '.oe_product_cart a:contains("Storage Box Test")',
                run: "click",
            },
            {
                trigger: '.o_product_page_reviews_title',
                run: "click",
            },
            {
                trigger: "#chatterRoot:shadow .o-mail-Message-textContent:contains(Bad box!)",
                run: "hover && click",
            },
            {
                trigger: "#chatterRoot:shadow .o-mail-Message-actions",
                run: async () => {
                    const addReactionButton = document.querySelector('#chatterRoot').shadowRoot.querySelector("[title='Add a Reaction']")
                    if (addReactionButton) {
                        throw new Error("Non-authenticated user should not be able to add a reaction to a message");
                    }
                },
            },
            {
                trigger: "#chatterRoot:shadow .o-mail-Message-core",
                run: () => {
                    const reactionButton = document.querySelector("#chatterRoot").shadowRoot.querySelector(".o-mail-MessageReaction")
                    reactionButton.dispatchEvent(new Event("mouseenter"));
                },
            },
            {
                trigger: "#chatterRoot:shadow .o-mail-MessageReactionList-preview",
                run: "click",
            },
            {
                trigger: "#chatterRoot:shadow .o-mail-MessageReactionMenu",
            },
            {
                trigger: "#chatterRoot:shadow .o-mail-Message-core",
                run: () => {
                    const addReaction = document.querySelector("#chatterRoot").shadowRoot.querySelector(".o-mail-MessageReactions-add")
                    if (addReaction) {
                        throw new Error("Non-authenticated user should not be able to add a reaction to a message");
                    }
                },
            },
        ],
   });

return __exports;
});
;

/************************************************************************************
*  Filepath: /website_sale/static/tests/tours/website_sale_remove_product_image.js  *
*  Lines: 80                                                                        *
************************************************************************************/
odoo.define('@website_sale/../tests/tours/website_sale_remove_product_image', ['@website/js/tours/tour_utils', '@web_tour/tour_service/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const {
    clickOnEditAndWaitEditMode,
    clickOnSave,
    registerWebsitePreviewTour,
} = require('@website/js/tours/tour_utils');
const { stepUtils } = require("@web_tour/tour_service/tour_utils");

const clickOnImgAndWaitForLoad = [
    {
        content: "Click on the product image",
        trigger: ":iframe #o-carousel-product img[alt='Test Remove Image']",
        run: "click",
    },
    {
        content: "Check that the snippet editor of the clicked image has been loaded",
        trigger: "we-customizeblock-options:has(we-title:contains('Re-order'))",
    },
];
const enterEditModeOfTestProduct = () => [
    stepUtils.waitIframeIsReady(),
    {
        content: "Click on the product anchor",
        trigger: ":iframe a:contains('Test Remove Image')",
        run: "click",
    },
    ...clickOnEditAndWaitEditMode(),
];

const removeImg = [
    {
        content: "Click on Remove",
        trigger: "we-customizeblock-options:has(we-title:contains('Image')) we-button[data-name='media_wsale_remove']",
        run: "click",
    },
    // If the snippet editor is not visible, the remove process is considered as
    // finished.
    {
        content: "Check that the snippet editor is not visible",
        trigger: ".o_we_customize_panel:not(:has(we-customizeblock-options:has(we-title:contains('Re-order'))))",
    },
];

registerWebsitePreviewTour("add_and_remove_main_product_image_no_variant", {
    url: "/shop?search=Test Remove Image",
}, () => [
    ...enterEditModeOfTestProduct(),
    {
        content: "Double click on the product image",
        trigger: ":iframe #o-carousel-product img[alt='Test Remove Image']",
        run: "dblclick",
    },
    {
        content: "Click on the new image",
        trigger: ".o_select_media_dialog img[title='s_default_image.jpg']",
        run: "click",
    },
    {
        content: "Check that the snippet editor of the clicked image has been loaded",
        trigger: "we-customizeblock-options:has(we-title:contains('Re-order'))",
    },
    ...removeImg,
]);
registerWebsitePreviewTour("remove_main_product_image_with_variant", {
    url: "/shop?search=Test Remove Image",
}, () => [
    ...enterEditModeOfTestProduct(),
    ...clickOnImgAndWaitForLoad,
    ...clickOnSave(),
    ...clickOnEditAndWaitEditMode(),
    ...clickOnImgAndWaitForLoad,
    ...removeImg,
]);

return __exports;
});
;

/***********************************************************************************
*  Filepath: /website_sale/static/tests/tours/website_sale_reorder_from_portal.js  *
*  Lines: 111                                                                      *
***********************************************************************************/
odoo.define('@website_sale/../tests/tours/website_sale_reorder_from_portal', ['@web/core/registry', '@website_sale/js/tours/tour_utils', '@website/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { registry } = require("@web/core/registry");
const { assertCartContains } = require('@website_sale/js/tours/tour_utils');
const { clickOnElement } = require('@website/js/tours/tour_utils');

registry.category("web_tour.tours").add('website_sale_reorder_from_portal', {
        url: '/my/orders',
        steps: () => [
        // Initial reorder, nothing in cart
        {
            content: 'Select first order',
            trigger: '.o_portal_my_doc_table a:first',
            run: "click",
        },
        clickOnElement('Reorder Again', '.o_wsale_reorder_button'),
        clickOnElement('Confirm', '.o_wsale_reorder_confirm'),
        assertCartContains({productName: 'Reorder Product 1'}),
        assertCartContains({productName: 'Reorder Product 2'}),
        {
            content: "Check that quantity is 1",
            trigger: ".js_quantity[value='1']",
            run: "edit Test",
        },
        // Second reorder, add reorder to cart
        {
            content: "Go back to my orders",
            trigger: "body",
            run() {
                window.location = "/my/orders";
            }
        },
        {
            content: 'Select first order',
            trigger: '.o_portal_my_doc_table a:first',
            run: "click",
        },
        clickOnElement('Reorder Again', '.o_wsale_reorder_button'),
        clickOnElement('Confirm', '.o_wsale_reorder_confirm'),
        clickOnElement('No', 'button:contains(No)'),
        assertCartContains({productName: 'Reorder Product 1'}),
        assertCartContains({productName: 'Reorder Product 2'}),
        {
            content: "Check that quantity is 2",
            trigger: ".js_quantity[value='2']",
            run: "edit Test",
        },
        // Third reorder, clear cart and reorder
        {
            content: "Go back to my orders",
            trigger: "body",
            run() {
                window.location = "/my/orders";
            }
        },
        {
            content: 'Select first order',
            trigger: '.o_portal_my_doc_table a:first',
            run: "click",
        },
        clickOnElement('Reorder Again', '.o_wsale_reorder_button'),
        clickOnElement('Confirm', '.o_wsale_reorder_confirm'),
        clickOnElement('Yes', 'button:contains(Yes)'),
        assertCartContains({productName: 'Reorder Product 1'}),
        assertCartContains({productName: 'Reorder Product 2'}),
        {
            content: "Check that quantity is 1",
            trigger: ".js_quantity[value='1']",
        },
        // Fourth reorder making sure confirmation dialog doesn't pop up unnecessary
        {
            content: "Deleting All products from cart",
            trigger: 'div.js_cart_lines',
            run: async () => {
                $('a.js_delete_product:first').click();
                await new Promise((r) => setTimeout(r, 1000));
                $('a.js_delete_product:first').click();
                await new Promise((r) => setTimeout(r, 1000));
                $('a.js_delete_product:first').click();
                await new Promise((r) => setTimeout(r, 1000));
                $('a.js_delete_product:first').click();
                await new Promise((r) => setTimeout(r, 1000));
            }
        },
        {
            content: "Go to my orders",
            trigger: 'body',
            run: () => {
                window.location = '/my/orders';
            }
        },
        {
            content: "Select first order",
            trigger: '.o_portal_my_doc_table a:first',
            run: "click",
        },
        clickOnElement('Reorder Again', '.o_wsale_reorder_button'),
        clickOnElement('Confirm', '.o_wsale_reorder_confirm'),
        assertCartContains({productName: 'Reorder Product 1'}),
        {
            content: "Check that quantity is 1",
            trigger: ".js_quantity[value='1']",
        },
    ]
});

return __exports;
});
;

/************************************************************************************
*  Filepath: /website_sale/static/tests/tours/website_sale_restricted_editor_ui.js  *
*  Lines: 60                                                                        *
************************************************************************************/
odoo.define('@website_sale/../tests/tours/website_sale_restricted_editor_ui', ['@website/js/tours/tour_utils', '@web_tour/tour_service/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-modules */

const { registerWebsitePreviewTour } = require('@website/js/tours/tour_utils');
const { stepUtils } = require("@web_tour/tour_service/tour_utils");

registerWebsitePreviewTour('website_sale_restricted_editor_ui', {
    url: `/shop`,
}, () => [
    {
        content: "Open the site menu to check what is inside",
        trigger: '[data-menu-xmlid="website.menu_site"]',
        run: "click",
    },
    {
        // Not very robust but still nice to have an extra check as this is the
        // main purpose of this tour
        content: "First check the user is not a designer",
        trigger: '.dropdown-menu:has([data-menu-xmlid="website_sale.menu_product_pages"]):not(:has([data-menu-xmlid="website.menu_website_pages_list"]))',
        run: "click",
    },
    {
        // Wait for the possibility to edit to appear
        trigger: ".o_menu_systray .o_edit_website_container a",
    },
    {
        content: "Ensure the publish and 'edit-in-backend' buttons are not shown",
        trigger: '.o_menu_systray:not(:has(.form-switch)):not(:has(.o_website_edit_in_backend))',
        run: "click",
    },
    stepUtils.waitIframeIsReady(),
    {
        content: "Navigate to the first product",
        trigger: ':iframe .oe_product_image_link',
        run: "click",
    },
    {
        content: "Click on publish/unpublish",
        trigger: '.o_website_publish_container a:has(input:checked)',
        run: "click",
    },
    {
        trigger:
            ".o_menu_systray_item:not([data-processing]) .form-switch:has(input:not(:checked))",
    },
    {
        content: "Click on edit-in-backend",
        trigger: '.o_menu_systray .o_website_edit_in_backend a',
        run: "click",
    },
    {
        content: "Check that you landed on a form view and that the record was unpublished",
        trigger: '.o-form-buttonbox [name="is_published"] .fa-globe.text-danger',
    },
]);

return __exports;
});
;

/*******************************************************************************************
*  Filepath: /website_sale/static/tests/tours/website_sale_shop_archived_variant_multi.js  *
*  Lines: 114                                                                              *
*******************************************************************************************/
odoo.define('@website_sale/../tests/tours/website_sale_shop_archived_variant_multi', ['@web/core/registry'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { registry } = require("@web/core/registry");

function fail(errorMessage) {
    const tour = registry.get("tourManager");
    tour._consume_tour(tour.running_tour, errorMessage);
}

function assert(current, expected, info) {
    if (current !== expected) {
        fail(info + ': "' + current + '" instead of "' + expected + '".');
    }
}

registry.category("web_tour.tours").add('tour_shop_archived_variant_multi', {
    url: '/shop?search=Test Product 2',
    steps: () => [
    {
        content: "select Test Product",
        trigger: ".oe_product_cart a:contains(/^Test Product 2$/)",
        run: "click",
    },
    {
        content: 'click on the first variant',
        trigger: 'input[data-attribute_name="Size"][data-value_name="Small"]',
        run: "click",
    },
    {
        content: "click on the second variant",
        trigger: 'input[data-attribute_name="Color"][data-value_name="Black"]',
        run: "click",
    },
    {
        content: "Check that brand b is not available",
        trigger: '.css_not_available',
    },
    {
        content: "select brand b even though it's not available",
        trigger: 'input[data-attribute_name="Brand"][data-value_name="Brand B"]',
        run: "click",
    },
    {
        content: "check combination is not possible",
        trigger: '.js_main_product.css_not_available .css_not_available_msg:contains("This combination does not exist.")',
    },
    {
        content: "check add to cart not possible",
        trigger: '#add_to_cart.disabled',
    },
    {
        content: "change second variant to remove warning",
        trigger: 'input[data-attribute_name="Color"][data-value_name="White"]',
        run: "click",
    },
    {
        content: "Check that brand b is not available",
        trigger: '.css_not_available',
    },
    {
        content: "Check that second variant is disabled",
        trigger: '.css_not_available input[data-attribute_name="Color"][data-value_name="Black"]',
    },
]});

registry.category("web_tour.tours").add('test_09_pills_variant', {
    url: '/shop?search=Test Product 2',
    steps: () => [
    {
        content: "select Test Product",
        trigger: ".oe_product_cart a:contains(/^Test Product 2$/)",
        run: "click",
    },
    {
        content: "check there are two radio boxes, both hidden",
        trigger: '.js_main_product',
        run: function() {
            var buttons = [...document.querySelectorAll('input.js_variant_change')];

            function isVisuallyHidden(elem) {
                const style = window.getComputedStyle(elem);
                return style.display === "none" ||
                    style.visibility === "hidden" ||
                    style.opacity === "0" ||
                    (style.width === "0px" && style.height === "0px")
            }

            assert(buttons.length, 2, "there should be two radio inputs")
            assert(isVisuallyHidden(buttons[0]), true, "first radio input is not hidden")
            assert(isVisuallyHidden(buttons[1]), true, "second radio input is not hidden")
            assert(buttons[0].checked, true, "first radio input should be checked")
        },
    },
    {
        content: "click on the second variant label",
        trigger: 'label:contains("Small")',
        run: "click",
    },
    {
        content: 'check second variant is selected',
        trigger: 'li.o_variant_pills.active:contains("Small")',
        run: function () {
            var button = [...document.querySelectorAll('input.js_variant_change[data-attribute_name="Size"][data-value_name="Small"]')];
            assert(button.length, 1, "there should be one radio input")
            assert(button[0].checked, true, "the radio input should be checked")
        }
    },
]});

return __exports;
});
;

/**********************************************************************************
*  Filepath: /website_sale/static/tests/tours/website_sale_shop_cart_recovery.js  *
*  Lines: 113                                                                     *
**********************************************************************************/
odoo.define('@website_sale/../tests/tours/website_sale_shop_cart_recovery', ['@odoo/hoot-dom', '@web/core/browser/browser', '@web/core/registry', '@website_sale/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { queryOne } = require("@odoo/hoot-dom");
const { browser } = require("@web/core/browser/browser");
const { registry } = require("@web/core/registry");
const tourUtils = require("@website_sale/js/tours/tour_utils");

var orderIdKey = 'website_sale.tour_shop_cart_recovery.orderId';
var recoveryLinkKey = 'website_sale.tour_shop_cart_recovery.recoveryLink';

registry.category("web_tour.tours").add('shop_cart_recovery', {
    url: '/shop',
    steps: () => [
        ...tourUtils.addToCart({productName: "Acoustic Bloc Screens"}),
        tourUtils.goToCart(),
    {
        content: "check product is in cart, get cart id, logout, go to login",
        trigger: 'div:has(a>h6:contains("Acoustic Bloc Screens"))',
        run: function () {
            const orderId = document.querySelector(".my_cart_quantity").dataset["orderId"];
            browser.localStorage.setItem(orderIdKey, orderId);
            window.location.href = "/web/session/logout?redirect=/web/login";
        },
    },
    {
        content: "edit login input",
        trigger: '.oe_login_form input[name="login"]',
        run: "edit admin",
    },
    {
        content: "edit password input",
        trigger: '.oe_login_form input[name="password"]',
        run: "edit admin",
    },
    {
        content: "edit hidden redirect input",
        trigger: '.oe_login_form input[name="redirect"]:hidden',
        run() {
            const orderId = browser.localStorage.getItem(orderIdKey);
            const url = "/odoo/action-sale.action_orders/" + orderId;
            this.anchor.value = url;
        }
    },
    {
        content: "login as admin and go to the SO (backend)",
        trigger: ".oe_login_form .oe_login_buttons button:contains(log in)",
        run: "click",
    },
    {
        content: "click action",
        trigger: '.o_cp_action_menus .dropdown-toggle',
        run: "click",
    },
    {
        content: "click Send an Email",
        trigger: "span:contains(/^Send an email$/)",
        run: "click",
    },
    {
        content: "Wait the modal is opened and form is fullfilled",
        trigger: ".modal main .o_form_view_container [name=subject] input:value(/^S0/)",
    },
    {
        content: "select template",
        trigger: ".mail-composer-template-dropdown-btn",
        run: "click",
    },
    {
        content: 'Select the "Ecommerce: Cart Recovery" template from the list.',
        trigger: '.mail-composer-template-dropdown.popover .o-dropdown-item:contains("Ecommerce: Cart Recovery")',
        run: 'click'
    },
    {
        content: "click Send email",
        trigger: '.btn.o_mail_send',
        run: "click",
    },
    {
        content: "check the mail is sent, grab the recovery link, and logout",
        trigger: ".o-mail-Message-body a:contains(/^Resume order$/)",
        run: function () {
            var link = queryOne('.o-mail-Message-body a:contains("Resume order")').getAttribute('href');
            browser.localStorage.setItem(recoveryLinkKey, link);
            window.location.href = "/web/session/logout?redirect=/";
        }
    },
    {
        content: "go to the recovery link",
        trigger: 'a[href="/web/login"]',
        run: function () {
            const localStorage = browser.localStorage;
            window.location.href = localStorage.getItem(recoveryLinkKey);
        },
    },
    {
        trigger: 'p:contains("This is your current cart")',
    },
    {
        content: "check the page is working, click on restore",
        trigger: 'p:contains("restore") a:contains("Click here")',
        run: "click",
    },
    {
        content: "check product is in restored cart",
        trigger: 'div>a>h6:contains("Acoustic Bloc Screens")',
    },
]});

return __exports;
});
;

/*************************************************************************************************
*  Filepath: /website_sale/static/tests/tours/website_sale_shop_compare_list_price_pricelist.js  *
*  Lines: 42                                                                                     *
*************************************************************************************************/
odoo.define('@website_sale/../tests/tours/website_sale_shop_compare_list_price_pricelist', ['@web/core/registry', '@website_sale/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { registry } = require("@web/core/registry");
const tourUtils = require('@website_sale/js/tours/tour_utils');

registry.category("web_tour.tours").add('compare_list_price_price_list_display', {
        url: '/shop?search=test_product',
        steps: () => [
        tourUtils.assertProductPrice("price_reduce", "1,000", "test_product_default"),
        tourUtils.assertProductPrice("price_reduce", "2,000", "test_product_with_compare_list_price"),
        tourUtils.assertProductPrice("base_price",   "2,500", "test_product_with_compare_list_price"),
        tourUtils.assertProductPrice("price_reduce", "2,000", "test_product_with_pricelist"),
        tourUtils.assertProductPrice("price_reduce", "4,000", "test_product_with_pricelist_and_compare_list_price"),
        tourUtils.assertProductPrice("base_price",   "4,500", "test_product_with_pricelist_and_compare_list_price"),

        ...tourUtils.selectPriceList('pricelist_with_discount'),

        tourUtils.assertProductPrice("price_reduce", "1,000", "test_product_default"),
        tourUtils.assertProductPrice("price_reduce", "2,000", "test_product_with_compare_list_price"),
        tourUtils.assertProductPrice("base_price",   "2,500", "test_product_with_compare_list_price"),
        tourUtils.assertProductPrice("price_reduce", "1,500", "test_product_with_pricelist"),
        tourUtils.assertProductPrice("price_reduce", "3,500", "test_product_with_pricelist_and_compare_list_price"),
        tourUtils.assertProductPrice("base_price",   "4,000", "test_product_with_pricelist_and_compare_list_price"),

        ...tourUtils.selectPriceList('pricelist_without_discount'),

        tourUtils.assertProductPrice("price_reduce", "1,000", "test_product_default"),
        tourUtils.assertProductPrice("price_reduce", "2,000", "test_product_with_compare_list_price"),
        tourUtils.assertProductPrice("base_price",   "2,500", "test_product_with_compare_list_price"),
        tourUtils.assertProductPrice("price_reduce", "1,500", "test_product_with_pricelist"),
        tourUtils.assertProductPrice("base_price",   "2,000", "test_product_with_pricelist"),
        tourUtils.assertProductPrice("price_reduce", "3,500", "test_product_with_pricelist_and_compare_list_price"),
        tourUtils.assertProductPrice("base_price",   "4,000", "test_product_with_pricelist_and_compare_list_price"),

    ]
});

return __exports;
});
;

/*******************************************************************************************
*  Filepath: /website_sale/static/tests/tours/website_sale_shop_custom_attribute_value.js  *
*  Lines: 41                                                                               *
*******************************************************************************************/
odoo.define('@website_sale/../tests/tours/website_sale_shop_custom_attribute_value', ['@web/core/registry'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

    const { registry } = require("@web/core/registry");

    registry.category("web_tour.tours").add("shop_custom_attribute_value", {
        url: "/shop?search=Customizable Desk",
        steps: () => [{
        content: "click on Customizable Desk",
        trigger: '.oe_product_cart a:contains("Customizable Desk (TEST)")',
        run: "click",
    },
    {
        trigger: "li.js_attribute_value",
    },
    {
        trigger: 'li.js_attribute_value span:contains(Custom)',
        run: 'click',
    }, {
        trigger: 'input.variant_custom_value',
        run: "edit Wood",
    }, {
        id: 'add_cart_step',
        trigger: 'a:contains(Add to cart)',
        run: 'click',
    },
    {
        trigger: 'button:contains(Proceed to Checkout)',
        run: 'click',
    },
    {
        trigger: "#cart_products",
    },
    {
        trigger: 'span:contains(Custom: Wood)',
    }]});

return __exports;
});
;

/********************************************************************************************
*  Filepath: /website_sale/static/tests/tours/website_sale_shop_custom_attributes_value.js  *
*  Lines: 61                                                                                *
********************************************************************************************/
odoo.define('@website_sale/../tests/tours/website_sale_shop_custom_attributes_value', ['@web/core/registry', '@sale/js/tours/product_configurator_tour_utils', '@website_sale/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { registry } = require("@web/core/registry");
const configuratorTourUtils = require("@sale/js/tours/product_configurator_tour_utils")[Symbol.for("default")];
const tourUtils = require('@website_sale/js/tours/tour_utils');

let optionVariantImage;

registry.category("web_tour.tours").add("a_shop_custom_attribute_value", {
    url: "/shop?search=Customizable Desk",
    steps: () => [{
        content: "click on Customizable Desk",
        trigger: '.oe_product_cart a:contains("Customizable Desk (TEST)")',
        run: "click",
}, {
    trigger: 'a.js_add_cart_json:has(i.fa-plus)',
    run: 'click',
}, {
    trigger: 'span.oe_currency_value:contains(750)',
}, {
    id: 'add_cart_step',
    trigger: 'a:contains(Add to cart)',
    run: 'click',
}, {
    trigger: configuratorTourUtils.optionalProductSelector("Conference Chair (TEST) (Steel)"),
    run: function () {
        optionVariantImage =
            configuratorTourUtils.optionalProductImageSrc("Conference Chair (TEST) (Steel)")
    }
},
configuratorTourUtils.selectAttribute("Conference Chair", "Legs", "Aluminium"),
{
    trigger: configuratorTourUtils.optionalProductSelector("Conference Chair (TEST) (Aluminium)"),
    run: function () {
        const newOptionVariantImage =
            configuratorTourUtils.optionalProductImageSrc("Conference Chair (TEST) (Aluminium)")
        if (newOptionVariantImage === optionVariantImage) {
            console.error("The variant image wasn't updated");
        }
    }
},
configuratorTourUtils.assertOptionalProductPrice("Conference Chair", "22.90"),
configuratorTourUtils.selectAttribute("Conference Chair", "Legs", "Steel"),
configuratorTourUtils.addOptionalProduct("Conference Chair"),
configuratorTourUtils.addOptionalProduct("Chair floor protection"),
configuratorTourUtils.assertPriceTotal("1,528.50"),
{
    trigger: 'button:contains(Proceed to Checkout)',
    run: 'click',
},
tourUtils.assertCartContains({
    productName: "Customizable Desk (TEST)",
    backend: false,
}),
]});

return __exports;
});
;

/******************************************************************************
*  Filepath: /website_sale/static/tests/tours/website_sale_shop_customize.js  *
*  Lines: 176                                                                 *
******************************************************************************/
odoo.define('@website_sale/../tests/tours/website_sale_shop_customize', ['@website_sale/js/tours/tour_utils', '@website/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { goToCart } = require('@website_sale/js/tours/tour_utils');
const {
    clickOnEditAndWaitEditMode,
    clickOnSave,
    registerWebsitePreviewTour,
} = require('@website/js/tours/tour_utils');


registerWebsitePreviewTour('shop_customize', {
    url: '/shop',
    edition: true,
},
    () => [
        ...clickOnSave(),
        {
            content: "select product attribute Steel",
            trigger: ':iframe form.js_attributes input:not(:checked) + label:contains(Steel - Test)',
            run: "click",
        },
        {
            content: "check the selection",
            trigger: ':iframe form.js_attributes input:checked + label:contains(Steel - Test)',
        },
        {
            trigger: ":iframe body:not(:has(.oe_website_sale .oe_product_cart:eq(3)))",
        },
        {
            content: "select product",
            trigger: ':iframe .oe_product_cart a:contains("Test Product")',
            run: "click",
        },
        {
            trigger: ":iframe #product_detail",
        },
        {
            content: "check list view of variants is disabled initially",
            trigger: ':iframe body:not(:has(.js_product_change))',
        },
        ...clickOnEditAndWaitEditMode(),
        {
            content: "open customize tab",
            trigger: '.o_we_customize_snippet_btn',
            run: "click",
        },
        {
            trigger: "#oe_snippets .o_we_customize_panel",
        },
        {
            content: "open 'Variants' selector",
            trigger: '[data-name="variants_opt"] we-toggler',
            run: "click",
        },
        {
            content: "click on 'Products List' of the 'Variants' selector",
            trigger: 'we-button[data-name="variants_products_list_opt"]',
            run: "click",
        },
        ...clickOnSave(),
        {
            content: "check variant price",
            trigger: ':iframe .form-check:contains("Aluminium") .badge:contains("+") .oe_currency_value:contains("50.4")',
        },
        {
            content: "check price is 750",
            trigger: ":iframe .product_price .oe_price .oe_currency_value:contains(/^750.00$/)",
        },
        {
            content: "switch to another variant",
            trigger: ":iframe .js_product label:contains('Aluminium')",
            run: "click",
        },
        {
            content: "verify that price has changed when changing variant",
            trigger: ":iframe .product_price .oe_price .oe_currency_value:contains(/^800.40$/)",
        },
        ...clickOnEditAndWaitEditMode(),
        {
            content: "open customize tab",
            trigger: '.o_we_customize_snippet_btn',
            run: "click",
        },
        {
            trigger: "#oe_snippets .o_we_customize_panel",
        },
        {
            content: "open 'Variants' selector",
            trigger: '[data-name="variants_opt"] we-toggler',
            run: "click",
        },
        {
            content: "click on 'Options' of the 'Variants' selector",
            trigger: 'we-button[data-name="variants_options_opt"]',
            run: "click",
        },
        ...clickOnSave(),
        {
            content: "check page loaded after list of variant customization disabled",
            trigger: ":iframe .js_product:not(:has(.js_product_change))",
        },
        {
            content: "check price is 750",
            trigger: ":iframe .product_price .oe_price .oe_currency_value:contains(/^750.00$/)",
        },
        {
            content: "switch to Aluminium variant",
            trigger: ':iframe .js_product input[data-value_name="Aluminium"]',
            run: "click",
        },
        {
            content: "verify that price has changed when changing variant",
            trigger: ":iframe .product_price .oe_price .oe_currency_value:contains(/^800.40$/)",
        },
        {
            content: "switch back to Steel variant",
            trigger: ":iframe .js_product label:contains('Steel - Test')",
            run: "click",
        },
        {
            content: "check price is 750",
            trigger: ":iframe .product_price .oe_price .oe_currency_value:contains(/^750.00$/)",
        },
        {
            content: "click on 'Add to Cart' button",
            trigger: ":iframe a:contains(Add to cart)",
            run: "click",
        },
        {
            content: "check quantity",
            trigger: ":iframe .my_cart_quantity:contains(/^1$/),.o_extra_menu_items .fa-plus",
        },
        goToCart({backend: true}),
        {
            trigger: ":iframe body:not(:has(#products_grid_before .js_attributes))",
        },
        {
            content: "click on shop",
            trigger: ":iframe a:contains(Continue shopping)",
            run: "click",
        },
        ...clickOnEditAndWaitEditMode(),
        {
            content: "open customize tab",
            trigger: '.o_we_customize_snippet_btn',
            run: "click",
        },
        {
            trigger: "#oe_snippets .o_we_customize_panel",
        },
        {
            content: "remove 'Attributes'",
            trigger: 'we-button[data-name="attributes_opt"]',
            run: "click",
        },
        ...clickOnSave(),
        {
            content: "wait to exit edit mode",
            trigger: '.o_website_preview:not(.editor_has_snippets)',
            run: "click",
        },
        {
            trigger: ":iframe body:not(:has(#products_grid_before .js_attributes))",
        },
        {
            content: "finish",
            trigger: ':iframe #wrap:not(:has(li:has(.my_cart_quantity):visible))',
        },
    ],
);

return __exports;
});
;

/**********************************************************************************************
*  Filepath: /website_sale/static/tests/tours/website_sale_shop_deleted_archived_variants.js  *
*  Lines: 64                                                                                  *
**********************************************************************************************/
odoo.define('@website_sale/../tests/tours/website_sale_shop_deleted_archived_variants', ['@web/core/registry'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { registry } = require("@web/core/registry");

// This tour relies on a data created from the python test.
registry.category("web_tour.tours").add('tour_shop_deleted_archived_variants', {
    url: '/shop?search=Test Product 2',
    steps: () => [
    {
        content: "check price on /shop (template price)",
        trigger: '.oe_product_cart .oe_currency_value:contains("1.00")',
        run: "click",
    },
    {
        content: "select Test Product 2",
        trigger: ".oe_product_cart a:contains(/^Test Product 2$/)",
        run: "click",
    },
    {
        content: "check price (3rd variant)",
        trigger: '.oe_currency_value:contains("31.00")',
        run: "click",
    },
    {
        content: "click on the second variant",
        trigger: 'input[data-attribute_name="My Attribute"][data-value_name="My Value 2"]',
        run: "click",
    },
    {
        content: "check combination is not possible",
        trigger: '.js_main_product.css_not_available .css_not_available_msg:contains("This combination does not exist.")',
        run: "click",
    },
    {
        content: "click on the 3rd variant to reset the warning",
        trigger: 'input[data-attribute_name="My Attribute"][data-value_name="My Value 3"]',
        run: "click",
    },
    {
        content: "check price (3rd variant)",
        trigger: '.oe_currency_value:contains("31.00")',
        run: "click",
    },
    {
        content: "click on the first variant",
        trigger: 'input[data-attribute_name="My Attribute"][data-value_name="My Value 1"]',
        run: "click",
    },
    {
        content: "check combination is not possible",
        trigger: '.js_main_product.css_not_available .css_not_available_msg:contains("This combination does not exist.")',
        run: "click",
    },
    {
        content: "check add to cart not possible",
        trigger: '#add_to_cart.disabled',
    }
]});

return __exports;
});
;

/*************************************************************************************
*  Filepath: /website_sale/static/tests/tours/website_sale_shop_dynamic_variants.js  *
*  Lines: 43                                                                         *
*************************************************************************************/
odoo.define('@website_sale/../tests/tours/website_sale_shop_dynamic_variants', ['@web/core/registry', '@website_sale/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { registry } = require("@web/core/registry");
const tourUtils = require("@website_sale/js/tours/tour_utils");

// This tour relies on a data created from the python test.
registry.category("web_tour.tours").add('tour_shop_dynamic_variants', {
    url: '/shop?search=Dynamic Product',
    steps: () => [
    {
        content: "select Dynamic Product",
        trigger: ".oe_product_cart a:contains(/^Dynamic Product$/)",
        run: "click",
    },
    {
        content: "click on the second variant",
        trigger: 'input[data-attribute_name="Dynamic Attribute"][data-value_name="Dynamic Value 2"]',
        run: "click",
    },
    {
        content: "wait for variant to be loaded",
        trigger: '.oe_price .oe_currency_value:contains("0.00")',
    },
    {
        trigger: 'body:has(input[type="hidden"][name="product_id"][value="0"])',
    },
    {
        content: "click add to cart",
        trigger: '#add_to_cart',
        run: "click",
    },
        tourUtils.goToCart(),
    {
        content: "check the variant is in the cart",
        trigger: 'div>a>h6:contains(Dynamic Product (Dynamic Value 2))',
    },
]});

return __exports;
});
;

/********************************************************************************
*  Filepath: /website_sale/static/tests/tours/website_sale_shop_editor_tour.js  *
*  Lines: 59                                                                    *
********************************************************************************/
odoo.define('@website_sale/../tests/tours/website_sale_shop_editor_tour', ['@website/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { clickOnSave, registerWebsitePreviewTour } = require('@website/js/tours/tour_utils');

registerWebsitePreviewTour("shop_editor", {
    url: "/shop",
    edition: true,
}, () => [{
    content: "Click on pricelist dropdown",
    trigger: ":iframe div.o_pricelist_dropdown a[data-bs-toggle=dropdown]",
    run: "click",
},
{
    trigger: ":iframe div.o_pricelist_dropdown a[data-bs-toggle=dropdown][aria-expanded=true]",
},
{
    trigger: ":iframe input[name=search]",
    content: "Click somewhere else in the shop.",
    run: "click",
},
{
    trigger: ":iframe div.o_pricelist_dropdown a[data-bs-toggle=dropdown][aria-expanded=false]",
},
{
    trigger: ":iframe div.o_pricelist_dropdown a[data-bs-toggle=dropdown]",
    content: "Click on the pricelist again.",
    run: "click",
}, {
    trigger: ":iframe div.o_pricelist_dropdown a[data-bs-toggle=dropdown][aria-expanded=true]",
    content: "Check pricelist dropdown opened",
}]);

registerWebsitePreviewTour("shop_editor_set_product_ribbon", {
    url: "/shop",
    edition: true,
}, () => [{
    content: "Click on first product",
    trigger: ":iframe .oe_product:first",
    run: "click",
}, {
    content: "Open the ribbon selector",
    trigger: ".o_wsale_ribbon_select we-toggler",
    run: "click",
}, {
    content: "Select a ribbon",
    trigger: '.o_wsale_ribbon_select we-button:contains("Sale")',
    run: "click",
},
...clickOnSave(),
{
    content: "Check that the ribbon was properly saved",
    trigger: ':iframe .oe_product:first .o_ribbon:contains("Sale")',
}]);

return __exports;
});
;

/**********************************************************************************
*  Filepath: /website_sale/static/tests/tours/website_sale_shop_list_view_b2c.js  *
*  Lines: 90                                                                      *
**********************************************************************************/
odoo.define('@website_sale/../tests/tours/website_sale_shop_list_view_b2c', ['@website_sale/js/tours/tour_utils', '@website/js/tours/tour_utils', '@web_tour/tour_service/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { goToCart } = require('@website_sale/js/tours/tour_utils');
const {
    clickOnEditAndWaitEditMode,
    clickOnSave,
    registerWebsitePreviewTour,
} = require('@website/js/tours/tour_utils');
const { stepUtils } = require("@web_tour/tour_service/tour_utils");

registerWebsitePreviewTour('shop_list_view_b2c', {
    url: '/shop?search=Test Product',
},
    () => [
        stepUtils.waitIframeIsReady(),
        {
            content: "check price on /shop",
            trigger: ':iframe .oe_product_cart .oe_currency_value:contains("825.00")',
        },
        {
            content: "select product",
            trigger: ':iframe .oe_product_cart a:contains("Test Product")',
            run: "click",
        },
        {
            trigger: ":iframe #product_details",
        },
        {
            content: "check products list is disabled initially (when on /product page)",
            trigger: ':iframe body:not(:has(.js_product_change))',
        },
        ...clickOnEditAndWaitEditMode(),
        {
            content: "open customize tab",
            trigger: '.o_we_customize_snippet_btn',
            run: "click",
        },
        {
            trigger: "#oe_snippets .o_we_customize_panel",
        },
        {
            content: "open 'Variants' selector",
            trigger: '[data-name="variants_opt"] we-toggler',
            run: "click",
        },
        {
            content: "click on 'Products List' of the 'Variants' selector",
            trigger: 'we-button[data-name="variants_products_list_opt"]',
            run: "click",
        },
        ...clickOnSave(),
        {
            content: "check page loaded after 'Products List' enabled",
            trigger: ':iframe .js_product_change',
        },
        {
            content: "check variant price",
            trigger: ':iframe .form-check:contains("Aluminium") .badge:contains("+") .oe_currency_value:contains("55.44")',
        },
        {
            content: "check price is 825",
            trigger: ":iframe .product_price .oe_price .oe_currency_value:contains(/^825.00$/)",
        },
        {
            content: "switch to another variant",
            trigger: ':iframe .js_product label:contains("Aluminium")',
            run: "click",
        },
        {
            content: "verify that price has changed when changing variant",
            trigger: ":iframe .product_price .oe_price .oe_currency_value:contains(/^880.44$/)",
        },
        {
            content: "click on 'Add to Cart' button",
            trigger: ':iframe a:contains(Add to cart)',
            run: "click",
        },
        goToCart({backend: true}),
        {
            content: "check price on /cart",
            trigger: ":iframe #cart_products .oe_currency_value:contains(/^880.44$/)",
        },
    ],
);

return __exports;
});
;

/*************************************************************************
*  Filepath: /website_sale/static/tests/tours/website_sale_shop_mail.js  *
*  Lines: 71                                                             *
*************************************************************************/
odoo.define('@website_sale/../tests/tours/website_sale_shop_mail', ['@web/core/registry', '@website_sale/js/tours/tour_utils', '@web/core/utils/urls'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { registry } = require("@web/core/registry");
const tourUtils = require("@website_sale/js/tours/tour_utils");
const { redirect } = require("@web/core/utils/urls");

registry.category("web_tour.tours").add('shop_mail', {
    url: '/shop?search=Acoustic Bloc Screens',
    steps: () => [
        ...tourUtils.addToCart({productName: 'Acoustic Bloc Screens', search: false}),
        tourUtils.goToCart(),
    {
        content: "check product is in cart, get cart id, go to backend",
        trigger: 'div:has(a>h6:contains("Acoustic Bloc Screens"))',
        run: function () {
            const orderId = document.querySelector(".my_cart_quantity").dataset["orderId"];
            redirect("/odoo/action-sale.action_orders/" + orderId);
        },
    },
    {
        content: "click confirm",
        trigger: '.btn[name="action_confirm"]',
        run: "click",
    },
    {
        trigger: '.o_statusbar_status .o_arrow_button_current:contains("Sales Order")',
    },
    {
        content: "click send by email",
        trigger: '.btn[name="action_quotation_send"]',
        run: "click",
    },
    {
        isActive: ["body:not(:has(.modal-footer button[name='action_send_mail']))"],
        trigger: ".modal-footer button[name='document_layout_save']",
        content: "let's continue",
        tooltipPosition: "bottom",
        run: "click",
    },
    {
        content: "Open recipients dropdown",
        trigger: ".modal .o_field_many2many_tags_email[name=partner_ids] input",
        run: 'edit Interior24',
    },
    {
        content: "Select azure interior",
        trigger: ".modal .ui-menu-item a:contains(Interior24)",
        run: "click",
    },
    {
        trigger: '.modal .o_badge_text:contains("Azure")',
    },
    {
        content: "click Send email",
        trigger: '.modal .btn.o_mail_send',
        run: "click",
    },
    {
        trigger: "body:not(:has(.modal))",
    },
    {
        content: "wait mail to be sent, and go see it",
        trigger: '.o-mail-Message-body:contains("Your"):contains("order")',
    },
]});

return __exports;
});
;

/***********************************************************************************
*  Filepath: /website_sale/static/tests/tours/website_sale_shop_multi_checkbox.js  *
*  Lines: 102                                                                      *
***********************************************************************************/
odoo.define('@website_sale/../tests/tours/website_sale_shop_multi_checkbox', ['@web/core/registry', '@website_sale/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { registry } = require("@web/core/registry");
const tourUtils = require("@website_sale/js/tours/tour_utils");

// This tour relies on a data created from the python test.
registry.category("web_tour.tours").add('tour_shop_multi_checkbox', {
    url: '/shop?search=Product Multi',
    steps: () => [
    {
        content: "select Product",
        trigger: ".oe_product_cart a:contains(/^Product Multi$/)",
        run: "click",
    },
    {
        content: "check price",
        trigger: '.oe_currency_value:contains("750")',
    },
    {
        content: 'click on the first option to select it',
        trigger: 'input[data-attribute_name="Options"][data-value_name="Option 1"]',
        run: "click",
    },
    {
        content: 'click on the third option to select it',
        trigger: 'input[data-attribute_name="Options"][data-value_name="Option 3"]',
        run: "click",
    },
    {
        content: 'check combination is not possible',
        trigger: '.js_main_product.css_not_available .css_not_available_msg:contains("This combination does not exist.")',
        timeout: 30000,
        run: "click",
    },
    {
        content: "check add to cart not possible",
        trigger: '#add_to_cart.disabled',
    },
    {
        content: 'click on the third option to unselect it',
        trigger: 'input[data-attribute_name="Options"][data-value_name="Option 3"]',
        run: "click",
    },
    {
        content: 'click on the second option to select it',
        trigger: 'input[data-attribute_name="Options"][data-value_name="Option 2"]',
        run: "click",
    },
    {
        content: "check price of options is correct",
        trigger: '.oe_currency_value:contains("753")',
    },
    {
        content: "add to cart",
        trigger: 'a:contains(Add to cart)',
        run: "click",
    },
        tourUtils.goToCart(),
    {
        content: "check price is correct",
        trigger: '#cart_products div div.text-muted>span:contains("Options: Option 1, Option 2")',
    },
]});

registry.category("web_tour.tours").add('tour_shop_multi_checkbox_single_value', {
    url: '/shop?search=Burger',
    steps: () => [
    {
        content: "select Product",
        trigger: '.oe_product_cart a:contains(/^Burger$/)',
        run: "click",
    },
    {
        content: "check price",
        trigger: '.oe_currency_value:contains("750")',
    },
    {
        content: 'click on the first option to select it',
        trigger: 'input[data-attribute_name="Toppings"][data-value_name="cheese"]',
        run: "click",
    },
    {
        content: "check price of options is correct",
        trigger: '.oe_currency_value:contains("750")',
    },
    {
        content: "add to cart",
        trigger: 'a:contains(Add to cart)',
        run: "click",
    },
        tourUtils.goToCart(),
    {
        content: "check choice was correctly saved",
        trigger: '#cart_products div div.text-muted>span:contains("Toppings: cheese")',
    },
]});

return __exports;
});
;

/*****************************************************************************************
*  Filepath: /website_sale/static/tests/tours/website_sale_shop_no_variant_attribute.js  *
*  Lines: 35                                                                             *
*****************************************************************************************/
odoo.define('@website_sale/../tests/tours/website_sale_shop_no_variant_attribute', ['@web/core/registry', '@website_sale/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { registry } = require("@web/core/registry");
const tourUtils = require("@website_sale/js/tours/tour_utils");

// This tour relies on a data created from the python test.
registry.category("web_tour.tours").add('tour_shop_no_variant_attribute', {
    url: '/shop?search=Test Product 3',
    steps: () => [
    {
        content: "select Test Product 3",
        trigger: ".oe_product_cart a:contains(/^Test Product 3$/)",
        run: "click",
    },
    {
        content: "check price",
        trigger: '.oe_currency_value:contains("1.00")',
    },
    {
        content: "add to cart",
        trigger: 'a:contains(Add to cart)',
        run: "click",
    },
        tourUtils.goToCart(),
    {
        content: "check price is correct",
        trigger: 'div[name="website_sale_cart_line_price"]:contains(11.0)',
    },
]});

return __exports;
});
;

/***********************************************************************************
*  Filepath: /website_sale/static/tests/tours/website_sale_shop_pricelist_tour.js  *
*  Lines: 41                                                                       *
***********************************************************************************/
odoo.define('@website_sale/../tests/tours/website_sale_shop_pricelist_tour', ['@web/core/registry'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { registry } = require("@web/core/registry");

registry.category("web_tour.tours").add(
    "website_sale.website_sale_shop_pricelist_tour",
    {
        url: '/shop',
        steps: () => [
            {
                content: "Check pricelist",
                trigger: ".o_pricelist_dropdown .dropdown-toggle:not(:contains('User Pricelist'))",
            },
            {
                content: "Go to login page",
                trigger: "a:contains('Sign in')",
                run: "click",
            },
            {
                content: "Submit login",
                trigger: '.oe_login_form',
                run: function () {
                    document.querySelector('.oe_login_form input[name="login"]').value = "toto";
                    document.querySelector('.oe_login_form input[name="password"]').value = "long_enough_password";
                    document.querySelector('.oe_login_form input[name="redirect"]').value = "/shop";
                    document.querySelector('.oe_login_form').submit();
                }
            },
            {
                content: "Check pricelist",
                trigger: ".o_pricelist_dropdown .dropdown-toggle:contains('User Pricelist')",
            },
        ]
    }
);

return __exports;
});
;

/*************************************************************************
*  Filepath: /website_sale/static/tests/tours/website_sale_shop_zoom.js  *
*  Lines: 57                                                             *
*************************************************************************/
odoo.define('@website_sale/../tests/tours/website_sale_shop_zoom', ['@web/core/registry'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { registry } = require("@web/core/registry");

var imageSelector = '#o-carousel-product .carousel-item.active img';
var imageName = "A Colorful Image";
var nameGreen = "Forest Green";

// This tour relies on a data created from the python test.
registry.category("web_tour.tours").add('shop_zoom', {
    url: '/shop?debug=1&search=' + imageName,
    steps: () => [
    {
        content: "select " + imageName,
        trigger: `.oe_product_cart a:contains(/^${imageName}$/)`,
        run: "click",
    },
    {
        content: "click on the image",
        trigger: imageSelector,
        run: "click",
    },
    {
        content: "check that the image viewer opened",
        trigger: '.o_wsale_image_viewer',
    },
    {
        content: "close the image viewer",
        trigger: '.o_wsale_image_viewer_header span.fa-times',
        run: "click",
    },
    {
        content: "change variant",
        trigger: `input[data-attribute_name='Beautiful Color'][data-value_name='${nameGreen}']:not(:visible)`,
        run: 'click',
    },
    {
        content: "wait for variant to be loaded",
        trigger: '.oe_currency_value:contains("21.00")',
        run: "click",
    },
    {
        content: "click on the image",
        trigger: imageSelector,
        run: "click",
    },
    {
        content: "check there is a zoom on that big image",
        trigger: '.o_wsale_image_viewer',
    },
]});

return __exports;
});
;

/********************************************************************************
*  Filepath: /website_sale/static/tests/tours/website_sale_snippet_products.js  *
*  Lines: 95                                                                    *
********************************************************************************/
odoo.define('@website_sale/../tests/tours/website_sale_snippet_products', ['@odoo/hoot-dom', '@website/js/tours/tour_utils', '@website_sale/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module */

const { queryFirst } = require('@odoo/hoot-dom');
const {
    changeOption,
    clickOnSave,
    clickOnSnippet,
    insertSnippet,
    registerWebsitePreviewTour,
} = require('@website/js/tours/tour_utils');
const { goToCart } = require('@website_sale/js/tours/tour_utils');

const optionBlock = 'dynamic_snippet_products';
const productsSnippet = {id: "s_dynamic_snippet_products", name: "Products", groupName: "Products"};
const templates = [
    "dynamic_filter_template_product_product_add_to_cart",
    "dynamic_filter_template_product_product_view_detail",
    "dynamic_filter_template_product_product_mini_image",
    "dynamic_filter_template_product_product_mini_price",
    "dynamic_filter_template_product_product_mini_name",
    "dynamic_filter_template_product_product_centered",
    "dynamic_filter_template_product_product_borderless_1",
    "dynamic_filter_template_product_product_borderless_2",
    "dynamic_filter_template_product_product_banner",
    "dynamic_filter_template_product_product_horizontal_card",
    "dynamic_filter_template_product_product_horizontal_card_2",
    "dynamic_filter_template_product_product_card_group",
];

function changeTemplate(templateKey) {
    const templateClass = templateKey.replace(/dynamic_filter_template_/, "s_");
    return [
        changeOption(optionBlock, 'we-select[data-name="template_opt"] we-toggler', 'template'),
        changeOption(optionBlock, `we-button[data-select-data-attribute="website_sale.${templateKey}"]`),
        {
            content: 'Check the template is applied',
            trigger: `:iframe .s_dynamic_snippet_products.${templateClass} .carousel`,
        },
    ];
}

registerWebsitePreviewTour('website_sale.snippet_products', {
    url: '/',
    edition: true,
},
() => {
    let templatesSteps = [];
    for (const templateKey of templates) {
        templatesSteps = templatesSteps.concat(changeTemplate(templateKey));
    }
    return [
        ...insertSnippet(productsSnippet),
        ...clickOnSnippet(productsSnippet),
        ...templatesSteps,
        ...changeTemplate('dynamic_filter_template_product_product_add_to_cart'),
        ...clickOnSave(),
        {
            trigger: ":iframe .s_dynamic_snippet_products .o_carousel_product_card_body .js_add_cart",
            run: 'click',
        },
        goToCart({backend: true}),
    ]
});

registerWebsitePreviewTour('website_sale.products_snippet_recently_viewed', {
    url: '/',
    edition: true,
},
() => [
    ...insertSnippet(productsSnippet),
    ...clickOnSnippet(productsSnippet),
    ...changeTemplate('dynamic_filter_template_product_product_add_to_cart'),
    changeOption(optionBlock, 'we-select[data-name="filter_opt"] we-toggler', 'filter'),
    changeOption(optionBlock, 'we-select[data-name="filter_opt"] we-button:contains("Recently Viewed")', 'filter'),
    ...clickOnSave(),
    {
        content: 'make delete icon appear',
        trigger: ':iframe .s_dynamic_snippet_products .o_carousel_product_card',
        run() {
            queryFirst(
                `:iframe .o_carousel_product_card:has(a img[alt="Storage Box"]) .js_remove`,
            ).style.display = "block";
        }
    },
    {
        trigger: ':iframe .s_dynamic_snippet_products .o_carousel_product_card .js_remove',
        run: 'click',
    },
]);

return __exports;
});
;

/******************************************************************************
*  Filepath: /website_sale/static/tests/tours/website_sale_update_address.js  *
*  Lines: 44                                                                  *
******************************************************************************/
odoo.define('@website_sale/../tests/tours/website_sale_update_address', ['@web/core/registry', '@website_sale/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { registry } = require("@web/core/registry");
const tourUtils = require("@website_sale/js/tours/tour_utils");

registry.category("web_tour.tours").add('update_billing_shipping_address', {
    url: '/shop',
    steps: () => [
        ...tourUtils.addToCart({productName: "Office Chair Black TEST"}),
        tourUtils.goToCart({quantity: 1}),
        tourUtils.goToCheckout(),
        tourUtils.confirmOrder(),
        {
            content: "Edit Address",
            trigger: '#delivery_and_billing a:contains("Edit")',
            run: "click",
        },
        {
            content: "Edit  billing address which is shipping address too",
            trigger: 'a.js_edit_address',
            run: "click",
        },
        {
            content: "Empty the phone field",
            trigger: 'input[name="phone"]',
            run: "clear",
        },
        {
            content: "Save address",
            trigger: 'button#save_address',
            run: "click",
        },
        {
            content: "Check there is a warning for required field.",
            trigger: ':invalid',
        },
    ],
});

return __exports;
});
;

/***************************************************************************
*  Filepath: /website_sale/static/tests/tours/website_sale_update_cart.js  *
*  Lines: 82                                                               *
***************************************************************************/
odoo.define('@website_sale/../tests/tours/website_sale_update_cart', ['@web/core/registry', '@website_sale/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const {registry} = require('@web/core/registry');
const tourUtils = require('@website_sale/js/tours/tour_utils');

registry.category('web_tour.tours').add('shop_update_cart', {
    url: '/shop',
    steps: () => [
        ...tourUtils.searchProduct("conference chair"),
        {
            content: "select conference chair",
            trigger: '.oe_product_cart:first a:contains("Conference Chair")',
            run: "click",
        },
        {
            trigger: "#product_detail",
        },
        {
            content: "select Conference Chair Aluminium",
            trigger: 'label:contains(Aluminium) input',
            run: "click",
        },
        {
            trigger: "#product_detail",
        },
        {
            content: "select Conference Chair Steel",
            trigger: 'label:contains(Steel) input',
            run: "click",
        },
        {
            trigger: "label:contains(Steel) input:checked",
        },
        {
            content: "click on add to cart",
            trigger: '#product_detail form[action^="/shop/cart/update"] #add_to_cart',
            run: "click",
        },
        {
            content: "click in modal on 'Proceed to checkout' button",
            trigger: 'button:contains("Proceed to Checkout")',
            run: "click",
        },
        {
            content: "add suggested",
            trigger: '.js_cart_lines:has(a:contains("Storage Box")) a:contains("Add to cart")',
            run: "click",
        },
        {
            trigger: '#cart_products div>a>h6:contains("Storage Box")',
        },
        {
            content: "add one more",
            trigger: '#cart_products div:has(div>a>h6:contains("Steel")) a.js_add_cart_json:eq(1)',
            run: "click",
        },
        {
            trigger:
                '#cart_products div:has(div>a>h6:contains("Steel")) input.js_quantity:value(2)',
        },
        {
            content: "remove Storage Box",
            trigger:
                '#cart_products div:has(div>a>h6:contains("Storage Box")) a.js_add_cart_json:first',
            run: "click",
        },
        {
            trigger: '#wrap:not(:has(#cart_products div>a>h6:contains("Storage Box")))',
        },
        {
            content: "set one",
            trigger: '#cart_products input.js_quantity',
            run: "edit 1",
        },
    ],
});

return __exports;
});
;

/*************************************************************************************
*  Filepath: /website_sale/static/tests/tours/website_sale_variants_modal_window.js  *
*  Lines: 78                                                                         *
*************************************************************************************/
odoo.define('@website_sale/../tests/tours/website_sale_variants_modal_window', ['@web/core/registry'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

    const { registry } = require("@web/core/registry");

    // This tour relies on a data created from the python test.
    registry.category("web_tour.tours").add('tour_variants_modal_window', {
        url: '/shop?search=Short (TEST)',
        steps: () => [
        {
            content: "Select the Short (TEST) product",
            trigger: `.oe_product_cart a:contains(/^Short \\(TEST\\)$/)`,
            run: "click",
        },
        {
            content: "Click on the always variant",
            trigger: 'input[data-attribute_name="Always attribute size"][data-value_name="M always"]',
            run: "check",
        },
        {
            content: "Click on the dynamic variant",
            trigger: 'input[data-attribute_name="Dynamic attribute size"][data-value_name="M dynamic"]',
            run: "check",
        },
        {
            content: "Click on the never variant",
            trigger: 'input[data-attribute_name="Never attribute size"][data-value_name="M never"]',
            run: "check",
        },
        {
            content: "Click on the never custom variant",
            trigger: 'input[data-attribute_name="Never attribute size custom"][data-value_name="Yes never custom"]',
            run: "check",
        },
        {
            trigger: 'input.variant_custom_value',
            run: "edit TEST",
        },
        {
            content: "Click add to cart",
            trigger: '#add_to_cart',
            run: "click",
        },
        {
            trigger:
                ".modal:contains(configure your product) table.o_sale_product_configurator_table",
        },
        {
            content: "Go through the modal window of the product configurator",
            trigger: ".modal:contains(configure your product) button:contains(Proceed to Checkout)",
            run: "click",
        },
        {
            content: "Check the product is in the cart",
            trigger: 'div>a>h6:contains(Short (TEST))',
        },
        {
            content: "Check always variant",
            trigger: 'div>a>h6:contains(M always)',
        },
        {
            content: "Check dynamic variant",
            trigger: 'div>a>h6:contains(M dynamic)',
        },
        {
            content: "Check never variant",
            trigger: 'div.text-muted>span:contains(Never attribute size: M never)',
        },
        {
            content: "Check never custom variant",
            trigger: 'div.text-muted>span:contains(Never attribute size custom: Yes never custom: TEST)',
        }
    ]});

return __exports;
});
;

/***********************************************************************************
*  Filepath: /website_sale/static/tests/tours/website_sale_zero_priced_product.js  *
*  Lines: 49                                                                       *
***********************************************************************************/
odoo.define('@website_sale/../tests/tours/website_sale_zero_priced_product', ['@web/core/registry'], function (require) {
'use strict';
let __exports = {};
const { registry } = require('@web/core/registry');

registry.category('web_tour.tours').add('website_sale_contact_us_button', {
    steps: () => [
        {
            content: "Check that the red color attribute is selected",
            trigger: '.js_attribute_value:has([checked]):contains(red)',
        },
        {
            content: "Zero-priced product should be unavailable",
            trigger: '#product_unavailable',
        },
        {
            content: "Price should be hidden",
            trigger: '.product_price:not(:visible)',
        },
        {
            content: '"Add to Cart" button should be hidden',
            trigger: '#add_to_cart_wrap:not(:visible)',
        },
        {
            content: '"Contact Us" button should be visible',
            trigger: '#contact_us_wrapper',
        },
        {
            content: "Select attribute with price extra value",
            trigger: '.js_attribute_value:contains(blue):contains(20.00) input',
            run: 'click',
        },
        {
            content: "Product price should be updated",
            trigger: '.product_price .oe_currency_value:contains(20.00)',
        },
        {
            content: '"Add to Cart" button should now be visibile',
            trigger: '#add_to_cart_wrap',
        },
        {
            content: '"Contact Us" button should now be hidden',
            trigger: '#contact_us_wrapper:not(:visible)',
        },
    ],
});

return __exports;
});
;

/***********************************************************************************
*  Filepath: /website_sale/static/src/js/tours/product_configurator_tour_utils.js  *
*  Lines: 76                                                                       *
***********************************************************************************/
odoo.define('@website_sale/js/tours/product_configurator_tour_utils', ['@sale/js/tours/product_configurator_tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const configuratorTourUtils = require('@sale/js/tours/product_configurator_tour_utils')[Symbol.for("default")];

function assertProductStrikethroughPrice(productName, price) {
    return {
        content: `Assert that ${productName} was reduced from ${price}`,
        trigger: `
            ${configuratorTourUtils.productSelector(productName)}
            td.o_sale_product_configurator_price
            .oe_striked_price:contains("${price}")
        `,
    };
}

function assertOptionalProductStrikethroughPrice(productName, price) {
    return {
        content: `Assert that ${productName} was reduced from ${price}`,
        trigger: `
            ${configuratorTourUtils.optionalProductSelector(productName)}
            td.o_sale_product_configurator_qty
            .oe_striked_price:contains("${price}")
        `,
    };
}

function assertProductZeroPriced(productName) {
    return [
        {
            content: `Assert that ${productName} is not available for sale`,
            trigger: `
                ${configuratorTourUtils.productSelector(productName)}
                td.o_sale_product_configurator_qty:contains("Not available for sale")
            `,
        },
        {
            content: `Assert that ${productName} has no quantity`,
            trigger: `
                ${configuratorTourUtils.productSelector(productName)}
                td.o_sale_product_configurator_qty:not(:has(input[name="sale_quantity"]))
            `,
        },
    ];
}

function assertOptionalProductZeroPriced(productName) {
    return [
        {
            content: `Assert that ${productName} is not available for sale`,
            trigger: `
                ${configuratorTourUtils.optionalProductSelector(productName)}
                td.o_sale_product_configurator_price:contains("Not available for sale")
            `,
        },
        {
            content: `Assert that ${productName} has no "Add" button`,
            trigger: `
                ${configuratorTourUtils.optionalProductSelector(productName)}
                td.o_sale_product_configurator_price:not(:has(button:contains("Add")))
            `,
        },
    ];
}

__exports[Symbol.for("default")] = {
    assertProductStrikethroughPrice,
    assertOptionalProductStrikethroughPrice,
    assertProductZeroPriced,
    assertOptionalProductZeroPriced,
};

return __exports;
});
;

/*************************************************************
*  Filepath: /web_studio/static/tests/tours/export_tours.js  *
*  Lines: 80                                                 *
*************************************************************/
odoo.define('@web_studio/../tests/tours/export_tours', ['@web/core/registry'], function (require) {
'use strict';
let __exports = {};
const { registry } = require("@web/core/registry");

registry.category("web_tour.tours").add("can_export_new_module", {
    url: "/odoo",
    steps: () => [
        {
            trigger: ".o_home_menu_background .o_home_menu",
        },
        {
            trigger: ".o_web_studio_navbar_item > .o_nav_entry",
            run: "click",
        },
        {
            trigger: ".o_app.o_web_studio_new_app",
            run: "click",
        },
        {
            trigger: ".o_web_studio_app_creator_next",
            run: "click",
        },
        {
            trigger: ".o_input[name='appName']",
            run: "edit My New App",
        },
        {
            trigger: ".o_web_studio_app_creator_next",
            run: "click",
        },
        {
            trigger: ".o_input[name='menuName']",
            run: "edit My App Records",
        },
        {
            trigger: ".o_web_studio_app_creator_next",
            run: "click",
        },
        {
            trigger: ".o_web_studio_model_configurator_next",
            run: "click",
        },
        {
            trigger: ".o_form_renderer div:contains(description)",
        },
        {
            trigger: ".o_web_studio_leave > a",
            run: "click",
        },
        {
            trigger: ".o_form_renderer h1 input[placeholder^='Name']",
        },
        {
            trigger: ".o_menu_toggle:contains(my new app)",
            run: "click",
        },
        {
            trigger: ".o_web_studio_navbar_item > .o_nav_entry",
            run: "click",
        },
        {
            trigger: ".o_web_studio_export",
            run: "click",
        },
        {
            content: "check that export feature is blazing fast",
            trigger: ".modal .modal-footer button:contains(export)",
            run: "click",
        },
        {
            content: "close modal",
            trigger: ".modal .modal-footer button:contains(cancel)",
            run: "click",
        },
    ],
});

return __exports;
});
;

/*************************************************************
*  Filepath: /web_studio/static/tests/tours/tour_helpers.js  *
*  Lines: 29                                                 *
*************************************************************/
odoo.define('@web_studio/../tests/tours/tour_helpers', [], function (require) {
'use strict';
let __exports = {};
/** @odoo-module */

__exports.assertEqual = assertEqual; function assertEqual(actual, expected) {
    if (actual !== expected) {
        throw new Error(`Assert failed: expected: ${expected} ; got: ${actual}`);
    }
}

__exports.nextTick = nextTick; async function nextTick() {
    await new Promise((resolve) => setTimeout(resolve));
    await new Promise((resolve) => requestAnimationFrame(resolve));
}

__exports.stepNotInStudio = stepNotInStudio; function stepNotInStudio(trigger) {
    return [
        {
            trigger: "body:not(:has(.o_studio))",
        },
        {
            trigger: trigger || "body",
        },
    ];
}

return __exports;
});
;

/***********************************************************
*  Filepath: /web_studio/static/tests/tours/web_studio.js  *
*  Lines: 34                                               *
***********************************************************/
odoo.define('@web_studio/../tests/tours/web_studio', ['@web/core/l10n/translation', '@web/core/registry', '@odoo/owl'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module */

const { _t } = require("@web/core/l10n/translation");
const { registry } = require("@web/core/registry");
const { markup } = require("@odoo/owl");

registry.category("web_tour.tours").add("web_studio_home_menu_background_tour", {
    url: "/odoo",
    steps: () => [
        {
            trigger: ".o_home_menu_background",
        },
        {
            trigger: ".o_web_studio_navbar_item",
            content: markup(
                _t("Want to customize the background? Lets activate <b>Odoo Studio</b>.")
            ),
            tooltipPosition: "bottom",
            run: "click",
        },
        {
            trigger: ".o_web_studio_change_background",
            content: markup(_t("Change the <b>background</b>, make it yours.")),
            tooltipPosition: "bottom",
            run: "click",
        },
    ],
});

return __exports;
});
;

/**********************************************************************
*  Filepath: /web_studio/static/tests/tours/web_studio_main_tours.js  *
*  Lines: 2334                                                        *
**********************************************************************/
odoo.define('@web_studio/../tests/tours/web_studio_main_tours', ['@web/core/browser/browser', '@web/core/registry', '@web_studio/utils', '@web_studio/../tests/tours/tour_helpers'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module */

const { browser } = require("@web/core/browser/browser");
const { registry } = require("@web/core/registry");
const { randomString } = require("@web_studio/utils");
const { assertEqual, stepNotInStudio } = require("@web_studio/../tests/tours/tour_helpers");

const localStorage = browser.localStorage;
let createdAppString = null;
let createdMenuString = null;

registry.category("web_tour.tours").add("web_studio_main_and_rename", {
    url: "/odoo?debug=1",
    steps: () => [
        {
            trigger: ".o_home_menu_background",
        },
        {
            // open studio
            trigger: ".o_main_navbar .o_web_studio_navbar_item",
            run: "click",
        },
        {
            trigger: ".o_web_studio_new_app",
            run: "click",
        },
        {
            // the next steps are here to create a new app
            trigger: ".o_web_studio_app_creator_next",
            run: "click",
        },
        {
            trigger: ".o_web_studio_app_creator_name > input",
            run: `edit ${(createdAppString = randomString(6))}`,
        },
        {
            trigger: ".o_web_studio_app_creator_next.is_ready",
            run: "click",
        },
        {
            trigger: ".o_web_studio_menu_creator > input",
            run: `edit ${(createdMenuString = randomString(6))}`,
        },
        {
            trigger: ".o_web_studio_app_creator_next.is_ready",
            run: "click",
        },
        {
            // disable chatter in model configurator, we'll test adding it on later
            trigger: 'input[name="use_mail"]',
            run: "click",
        },
        {
            trigger: ".o_web_studio_model_configurator_next",
            run: "click",
        },
        {
            trigger: ".o_menu_toggle:not(.o_menu_toggle_back)",
        },
        {
            // toggle the home menu outside of studio and come back in studio
            trigger: ".o_web_studio_leave > a.btn",
            timeout: 60000 /* previous step reloads registry, etc. - could take a long time */,
            run: "click",
        },
        {
            trigger: `.o_web_client:not(.o_in_studio)` /* wait to be out of studio */,
        },
        {
            trigger: ".o_menu_toggle:not(.o_menu_toggle_back)",
            timeout: 60000 /* previous step reloads registry, etc. - could take a long time */,
            run: "click",
        },
        {
            trigger: ".o_home_menu_background",
        },
        {
            trigger: ".o_main_navbar .o_web_studio_navbar_item",
            run: "click",
        },
        {
            // open the app creator and leave it
            trigger: ".o_web_studio_new_app",
            run: "click",
        },
        {
            trigger: ".o_web_studio_app_creator",
        },
        {
            trigger: ".o_web_studio_leave > a.btn",
            run: "click",
        },
        {
            // go back to the previous app
            trigger: ".o_home_menu",
            run: "press Escape",
        },
        {
            trigger: `.o_web_client:not(.o_in_studio) .o_menu_brand:contains(${createdAppString})`,
        },
        {
            // this should open the previous app outside of studio
            // go back to the home menu
            trigger: ".o_menu_toggle:not(.o_menu_toggle_back)",
            run: "click",
        },
        {
            trigger: "input.o_search_hidden",
            // Open Command Palette
            run: `edit ${createdMenuString[0]}`,
        },
        {
            trigger: ".o_command_palette_search input",
            run: `edit /${createdMenuString}`,
        },
        {
            trigger: `.o_command.focused:contains(${createdAppString} / ${createdMenuString})`,
        },
        {
            // search results should have been updated
            trigger: ".o_command_palette",
            // Close the Command Palette
            run: "press Escape",
        },
        {
            // enter Studio
            trigger: ".o_main_navbar .o_web_studio_navbar_item",
            run: "click",
        },
        {
            trigger: ".o_studio_home_menu",
        },
        {
            // edit an app
            trigger: `.o_app[data-menu-xmlid*="studio"]:contains(${createdAppString})`,
            run: function () {
                // We can't emulate a hover to display the edit icon
                const editIcon = this.anchor.querySelector(".o_web_studio_edit_icon");
                editIcon.style.visibility = "visible";
                editIcon.click();
            },
        },
        {
            // design the icon
            // TODO: we initially tested this (change an app icon) at the end but a
            // long-standing bug (KeyError: ir.ui.menu.display_name, caused by a registry
            // issue with multiple workers) on runbot prevent us from doing it. It thus have
            // been moved at the beginning of this test to avoid the registry to be reloaded
            // before the write on ir.ui.menu.
            trigger: ".o_web_studio_selector_background > button",
            run: "click",
        },
        {
            trigger: ".o-dropdown--menu .o_web_studio_selector_value",
            run: "click",
        },
        {
            trigger: ".modal-footer .btn.btn-primary",
            run: "click",
        },
        {
            // click on the created app
            trigger: `.o_app[data-menu-xmlid*="studio"]:contains(${createdAppString})`,
            run: "click",
        },
        {
            // create a new menu
            trigger: ".o_main_navbar .o_web_edit_menu",
            run: "click",
        },
        {
            trigger: "footer.modal-footer .js_add_menu",
            run: "click",
        },
        {
            trigger: 'input[name="menuName"]',
            run: `edit ${(createdMenuString = randomString(6))}`,
        },
        {
            trigger: 'div.o_web_studio_menu_creator_model_choice input[value="existing"]',
            run: "click",
        },
        {
            trigger: "div.o_web_studio_menu_creator_model .o_record_selector input",
            run: "edit a",
        },
        {
            trigger:
                ".o_record_selector .o-autocomplete--dropdown-menu > li > a:not(:has(.fa-spin))",
            run: "click",
        },
        {
            trigger: ".o_record_selector :not(.o-autocomplete dropdown-menu)",
        },
        {
            trigger: ".o_web_studio_add_menu_modal button:contains(Confirm):not(.disabled)",
            run: "click",
        },
        {
            trigger: ":not(.o_inactive_modal) .o-web-studio-appmenu-editor",
        },
        {
            trigger: ".o-web-studio-appmenu-editor button:contains(Confirm):not(.disabled)",
            run: "click",
        },
        {
            trigger: ".o_web_studio_menu",
        },
        {
            // check that the Studio menu is still there
            // switch to form view
            trigger: '.o_web_studio_views_icons > a[title="Form"]',
            run: "click",
        },
        {
            trigger: ".o_web_studio_form_view_editor",
        },
        {
            // wait for the form editor to be rendered because the sidebar is the same
            // unfold 'Existing Fieldqs' section
            trigger: ".o_web_studio_existing_fields_header",
            run: "click",
        },
        {
            // add an new field
            trigger:
                ".o_web_studio_sidebar .o_web_studio_field_type_container:eq(1) .o_web_studio_field_char",
            run: "drag_and_drop .o_web_studio_form_view_editor .o_inner_group",
        },
        {
            trigger: '.o_web_studio_sidebar input[name="technical_name"]',
        },
        {
            // click on the field
            trigger: ".o_web_studio_form_view_editor .o_wrap_label:first label",
            // when it's there
            run: "click",
        },
        {
            // rename the label
            trigger: '.o_web_studio_sidebar input[name="string"]',
            run: "edit My Coucou Field && click .o_web_studio_sidebar",
        },
        {
            // verify that the field name has changed and change it
            trigger: '.o_web_studio_sidebar input[name="technical_name"]',
            async run(helper) {
                assertEqual(this.anchor.value, "my_coucou_field");
                await helper.edit("coucou");
                await helper.click(".o_web_studio_sidebar");
            },
            // the rename operation (/web_studio/rename_field + /web_studio/edit_view)
            // takes a while and sometimes reaches the default 10s timeout
            timeout: 20000,
        },
        {
            // click on "Add" tab
            trigger: ".o_web_studio_sidebar .o_web_studio_new",
            // the rename operation (/web_studio/rename_field + /web_studio/edit_view)
            // takes a while and sometimes reaches the default 10s timeout
            timeout: 20000,
            run: "click",
        },
        {
            // add a new field
            trigger:
                ".o_web_studio_sidebar .o_web_studio_field_type_container:eq(1) .o_web_studio_field_char",
            run: "drag_and_drop .o_web_studio_form_view_editor .o_inner_group",
        },
        {
            // rename the field with the same name
            trigger: '.o_web_studio_sidebar input[name="technical_name"]',
            run: "edit coucou && click body",
        },
        {
            // an alert dialog should be opened
            trigger: ".modal-footer > button:first",
            run: "click",
        },
        {
            // rename the label
            trigger: '.o_web_studio_sidebar input[name="string"]',
            run: "edit COUCOU && click body",
        },
        {
            // verify that the field name has changed (post-fixed by _1)
            trigger: '.o_web_studio_sidebar input[name="technical_name"]',
            run(helper) {
                assertEqual(this.anchor.value, "coucou_1");
            },
            // the rename operation (/web_studio/rename_field + /web_studio/edit_view)
            // takes a while and sometimes reaches the default 10s timeout
            timeout: 20000,
        },
        {
            trigger: ".o_web_studio_sidebar .o_web_studio_new",
            run: "click",
        },
        {
            // add a monetary field --> create a currency field
            trigger:
                ".o_web_studio_sidebar .o_web_studio_field_type_container:eq(1) .o_web_studio_field_monetary",
            run: "drag_and_drop (.o_inner_group:first .o_web_studio_hook:eq(1))",
        },
        {
            // verify that the monetary field is in the view
            trigger:
                '.o_web_studio_form_view_editor .o_wrap_label:eq(1) label:contains("New Monetary")',
        },
        {
            // switch the two first fields
            trigger: ".o_web_studio_form_view_editor .o_inner_group:first .o-draggable:eq(1)",
            run: "drag_and_drop .o_inner_group:first .o_web_studio_hook:first",
        },
        {
            // click on "Add" tab
            trigger:
                '.o_web_studio_form_view_editor .o_wrap_label:eq(0) label:contains("New Monetary")',
        },
        {
            trigger: ".o_web_studio_sidebar .o_web_studio_new",
            run: "click",
        },
        {
            // verify that the fields have been switched
            trigger:
                '.o_web_studio_form_view_editor .o_wrap_label:eq(0) label:contains("New Monetary")',
        },
        {
            // add a m2m field
            trigger:
                ".o_web_studio_sidebar .o_web_studio_field_type_container:eq(1) .o_web_studio_field_many2many",
            run: "drag_and_drop .o_inner_group:first .o_web_studio_hook:first",
        },
        {
            // type something in the modal
            trigger:
                '.modal:not(.o_inactive_modal) [name="relation_id"] input.o-autocomplete--input',
            // we are sure "Activity" exists since studio depends on mail.
            //Also, it is determinisic and field names should not conflict too much.
            run: "fill mail.activity",
        },
        {
            // select Activity as model
            trigger:
                '.modal:not(.o_inactive_modal) [name="relation_id"] .o-autocomplete--dropdown-menu li a:not(:has(.fa-spin)):contains(Activity):not(:contains("Activity "))',
            run: "click",
        },
        {
            trigger: ".modal:not(.o_inactive_modal) button:contains(Confirm):not(.disabled)",
            run: "click",
        },
        {
            // select the m2m to set its properties
            trigger: ".o_wrap_input:has(.o_field_many2many)",
            timeout: 15000, // creating M2M relations can take some time...
            run: "click",
        },
        {
            // change the `widget` attribute
            trigger: '.o_web_studio_sidebar [name="widget"] .o_select_menu_toggler_slot',
            run: "click",
        },
        {
            trigger: ".o-dropdown--menu .o_select_menu_item_label:contains('(many2many_tags)')",
            run: "click",
        },
        {
            // use colors on the m2m tags
            trigger: '.o_web_studio_sidebar [name="color_field"]',
            run: "click",
        },
        {
            // add a statusbar
            trigger: ".o_web_studio_statusbar_hook",
            run: "click",
        },
        {
            trigger: ".modal-footer .btn.btn-primary",
            run: "click",
        },
        {
            trigger: ".o_statusbar_status",
            run: "click",
        },
        {
            // verify that a default value has been set for the statusbar
            trigger:
                '.o_web_studio_sidebar [name="default_value"] .o_select_menu_toggler_slot:contains(First Status)',
        },
        {
            trigger: ".o_web_studio_views_icons a[aria-label=Form]",
            run: "click",
        },
        {
            // verify Chatter can be added after changing view to form
            trigger: ".o_web_studio_add_chatter",
        },
        {
            // edit action
            trigger: ".o_web_studio_menu .o_menu_sections li a:contains(Views)",
            run: "click",
        },
        {
            // edit form view
            trigger:
                ".o_web_studio_view_category .o_web_studio_thumbnail_item.o_web_studio_thumbnail_form",
            run: "click",
        },
        {
            // verify Chatter can be added after changing view to form
            trigger: ".o_web_studio_add_chatter",
        },
        {
            // switch in list view
            trigger: '.o_web_studio_menu .o_web_studio_views_icons a[title="List"]',
            run: "click",
        },
        {
            // wait for the list editor to be rendered because the sidebar is the same
            trigger: ".o_web_studio_list_view_editor",
        },
        {
            // unfold 'Existing Fieldqs' section
            trigger: ".o_web_studio_existing_fields_header",
            run: "click",
        },
        {
            // add an existing field (display_name)
            trigger:
                ".o_web_studio_sidebar .o_web_studio_existing_fields_section .o_web_studio_field_char:contains(COUCOU)",
            run: "drag_and_drop .o_web_studio_list_view_editor th.o_web_studio_hook:first",
        },
        {
            // verify that the field is correctly named
            trigger: '.o_web_studio_list_view_editor th:contains("COUCOU")',
        },
        {
            // leave Studio
            trigger: ".o_web_studio_leave > a.btn",
            run: "click",
        },
        {
            // come back to the home menu to check if the menu data have changed
            trigger: ".o_web_client:not(.o_in_studio)",
        },
        {
            trigger: ".o_menu_toggle:not(.o_menu_toggle_back)",
            run: "click",
        },
        {
            trigger: "input.o_search_hidden",
            // Open Command Palette
            run: `edit ${createdMenuString[0]}`,
        },
        {
            trigger: ".o_command_palette_search input",
            run: `edit /${createdMenuString}`,
        },
        {
            // search results should have been updated
            trigger: `.o_command.focused:contains(${createdAppString} / ${createdMenuString})`,
        },
        {
            trigger: ".o_command_palette",
            // Close the Command Palette
            run: `press Escape`,
        },
        {
            trigger: ".o_home_menu",
            // go back again to the app (using keyboard)
            run: `press Escape`,
        },
        {
            // wait to be back in the list view
            trigger: ".o_list_view",
        },
        {
            // re-open studio
            trigger: ".o_web_studio_navbar_item",
            run: "click",
        },
        {
            // modify the list view
            trigger: ".o_web_studio_sidebar .o_web_studio_view",
            run: "click",
        },
        {
            //select field you want to sort and based on that sorting will be applied on List view
            trigger:
                '.o_web_studio_sidebar .o_web_studio_sidebar_select[name="sort_by"] .o_select_menu_toggler',
            run: "click",
        },
        {
            trigger: ".dropdown-menu .dropdown-item",
            run: "click",
        },
        {
            //change order of sorting, Select order and change it
            trigger:
                '.o_web_studio_sidebar .o_web_studio_sidebar_select[name="sort_order"] .o_select_menu_toggler',
            run: "click",
        },
        {
            trigger: ".dropdown-menu .dropdown-item:nth-child(2)",
            run: "click",
        },
        {
            // edit action
            trigger: '.o_web_studio_menu .o_menu_sections li a:contains("Views")',
            run: "click",
        },
        {
            // add a kanban
            trigger: ".o_web_studio_view_category .o_web_studio_thumbnail_kanban.disabled",
            run: "click",
        },
        {
            trigger: ".o_notebook .o_web_studio_new",
            run: "click",
        },
        {
            // add a menu
            trigger: ".o_web_studio_component.o_web_studio_field_menu",
            async run(helpers) {
                const hook = ".o_web_studio_hook[data-structures='t,kanban_colorpicker']";
                document.querySelector(hook).style.setProperty("transition", "none", "important");
                await helpers.drag_and_drop(hook);
            },
        },
        {
            // add an aside
            trigger: ".o_web_studio_component.o_web_studio_field_aside",
            async run(helpers) {
                const hook = ".o_web_studio_hook[data-structures='aside']";
                document.querySelector(hook).style.setProperty("transition", "none", "important");
                await helpers.drag_and_drop(hook);
            },
        },
        {
            trigger: ".o_kanban_record main",
            content: "card content has been wrapped in a <main> element",
        },
        {
            trigger: ".o_kanban_record aside",
        },
        {
            // add a colorpicker
            trigger: ".o_web_studio_component.o_web_studio_field_color_picker",
            async run(helpers) {
                const hook = ".o_web_studio_hook[data-structures='t,kanban_colorpicker']";
                document.querySelector(hook).style.setProperty("transition", "none", "important");
                await helpers.drag_and_drop(hook);
            },
        },
        {
            // select the menu for edition
            trigger: ".o_dropdown_kanban",
            run: "click",
        },
        {
            // select the colorpicker for edition
            trigger: "button.o_web_studio_field_color_picker:contains(Edit Color Picker)",
            run: "click",
        },
        {
            trigger: ".o_notebook_content h3:contains(Field)",
            content: "sidebar is editing the color field",
        },
        {
            trigger: ".o_notebook .o_web_studio_view",
            run: "click",
        },
        {
            trigger:
                ".o_web_studio_property_highlight_color .o_select_menu_toggler:contains(Card color)",
        },
        {
            // edit action
            trigger: '.o_web_studio_menu .o_menu_sections li a:contains("Views")',
            run: "click",
        },
        {
            // check that the kanban view is now active
            trigger: ".o_web_studio_view_category .o_web_studio_thumbnail_kanban:not(.disabled)",
        },
        {
            // add an activity view
            trigger: ".o_web_studio_view_category .o_web_studio_thumbnail_activity.disabled",
            run: "click",
        },
        {
            trigger: ".o_activity_view",
        },
        {
            // edit action
            trigger: '.o_web_studio_menu .o_menu_sections li a:contains("Views")',
            timeout: 20000, // activating a view takes a while and sometimes reaches the default 10s timeout
            run: "click",
        },
        {
            // add a graph view
            trigger: ".o_web_studio_view_category .o_web_studio_thumbnail_graph.disabled",
            run: "click",
        },
        {
            trigger: ".o_graph_renderer",
        },
        {
            trigger: '.o_web_studio_menu .o_menu_sections li a:contains("Views")',
            run: "click",
        },
        {
            trigger: ".o_web_studio_views",
        },
        {
            run: "click",
            // edit the search view
            trigger:
                ".o_web_studio_view_category .o_web_studio_thumbnail_item.o_web_studio_thumbnail_search",
        },
        {
            trigger: ".o_web_studio_search_view_editor",
        },
        {
            run: "click",
            trigger: ".o_menu_toggle:not(.o_menu_toggle_back)",
        },
        {
            // export all modifications
            trigger: ".o_web_studio_export",
            run: "click",
        },
        {
            content: "check that export feature is blazing fast",
            trigger: ".modal .modal-footer button:contains(export)",
            run: "click",
        },
        {
            content: "close modal",
            trigger: ".modal .modal-footer button:contains(cancel)",
            run: "click",
        },
        {
            // click on the created app
            trigger: '.o_app[data-menu-xmlid*="studio"]:last',
            run: "click",
        },
        {
            // switch to form view
            trigger: '.o_web_studio_views_icons > a[title="Form"]',
            run: "click",
        },
        {
            trigger: ".o_web_studio_form_view_editor",
        },
        {
            // click on the view tab
            trigger: ".o_web_studio_view",
            run: "click",
        },
        {
            // click on the restore default view button
            trigger: ".o_web_studio_restore",
            run: "click",
        },
        {
            // click on the ok button
            trigger: ".modal-footer .btn.btn-primary",
            run: "click",
        },
        {
            // checks that the field doesn't exist anymore
            trigger: ".o_web_studio_form_view_editor:not(:has(.o_form_label))",
        },
        {
            trigger: ".o_web_studio_leave > a.btn",
            run: "click",
        },
        ...stepNotInStudio(".o_form_view"),
    ],
});

registry.category("web_tour.tours").add("web_studio_hide_fields_tour", {
    url: "/odoo/action-studio?mode=home_menu&debug=1",
    steps: () => [
        {
            trigger: ".o_web_studio_new_app",
            run: "click",
        },
        {
            trigger: ".o_web_studio_app_creator_next",
            run: "click",
        },
        {
            trigger: `
        .o_web_studio_app_creator_name
        > input`,
            run: `edit ${randomString(6)}`,
        },
        {
            // make another interaction to show "next" button
            trigger: `
        .o_web_studio_selectors
        .o_web_studio_selector_icon > button`,
            run: "click",
        },
        {
            trigger: ".o_web_studio_app_creator_next",
            run: "click",
        },
        {
            trigger: `
        .o_web_studio_menu_creator
        > input`,
            run: `edit ${randomString(6)}`,
        },
        {
            trigger: ".o_web_studio_app_creator_next",
            run: "click",
        },
        {
            trigger: ".o_web_studio_model_configurator_next",
            run: "click",
        },
        {
            // check that the Studio menu is still there
            trigger: ".o_web_studio_menu",
        },
        {
            trigger: ".o_web_studio_leave > a.btn",
            timeout: 60000 /* previous step reloads registry, etc. - could take a long time */,
            run: "click",
        },
        {
            trigger: ".oe_title input",
            run: "edit Test",
        },
        {
            trigger: ".o_form_button_save",
            run: "click",
        },
        {
            trigger: ".o_web_studio_navbar_item",
            run: "click",
        },
        {
            trigger: ".o_web_studio_menu",
        },
        {
            run: "click",
            trigger: `
        .o_web_studio_views_icons
        > a[title="List"]`,
        },
        {
            // wait for the list editor to be rendered because the sidebar is the same
            trigger: ".o_web_studio_list_view_editor",
        },
        {
            trigger: ".o_web_studio_existing_fields_header",
            run: "click",
        },
        {
            trigger: `
        .o_web_studio_sidebar
        .o_web_studio_existing_fields
        .o_web_studio_component:has(.o_web_studio_component_description:contains(display_name))`,
            run: "drag_and_drop .o_web_studio_list_view_editor .o_web_studio_hook",
        },
        {
            trigger: `
        .o_list_table
        th[data-name="display_name"]`,
            run: "click",
        },
        {
            trigger: `
        .o_web_studio_sidebar
        [name="optional"] .o_select_menu_toggler`,
            run: "click",
        },
        {
            trigger: ".o-dropdown--menu .o_select_menu_item:contains(Hide by default)",
            run: "click",
        },
        {
            trigger: '.o_list_table:not(:has(th[data-name="display_name"]))',
        },
        {
            trigger: `
        .o_web_studio_sidebar
        .o_web_studio_view`,
            run: "click",
        },
        {
            trigger: `
        .o_web_studio_sidebar_checkbox
        input#show_invisible`,
            run: "click",
        },
        {
            trigger: `
        .o_list_table
        th[data-name="display_name"].o_web_studio_show_invisible`,
        },
        {
            trigger: ".o_web_studio_leave > a.btn",
            run: "click",
        },
        ...stepNotInStudio(".o_list_view"),
    ],
});

registry.category("web_tour.tours").add("web_studio_model_option_value_tour", {
    url: "/odoo/action-studio?mode=home_menu&debug=tests",
    steps: () => [
        {
            trigger: ".o_web_studio_new_app",
            run: "click",
        },
        {
            trigger: ".o_web_studio_app_creator_next",
            run: "click",
        },
        {
            trigger: `
        .o_web_studio_app_creator_name
        > input`,
            run: `edit ${randomString(6)}`,
        },
        {
            trigger: `
        .o_web_studio_selectors
        .o_web_studio_selector_icon > button`,
            run: "click",
        },
        {
            trigger: ".o_web_studio_app_creator_next",
            run: "click",
        },
        {
            trigger: `
        .o_web_studio_menu_creator
        > input`,
            run: `edit ${randomString(6)}`,
        },
        {
            trigger: ".o_web_studio_app_creator_next",
            run: "click",
        },
        {
            // check monetary value in model configurator
            trigger: 'input[name="use_value"]',
            run: "click",
        },
        {
            // check lines value in model configurator
            trigger: 'input[name="lines"]',
            run: "click",
        },
        {
            trigger: ".o_web_studio_model_configurator_next",
            run: "click",
        },
        {
            trigger: '.o_web_studio_menu .o_web_studio_views_icons > a[title="Graph"]',
            timeout: 60000 /* previous step reloads registry, etc. - could take a long time */,
            run: "click",
        },
        {
            // wait for the graph editor to be rendered and also check for sample data
            trigger: ".o_view_sample_data .o_graph_renderer",
        },
        {
            trigger: '.o_web_studio_menu .o_web_studio_views_icons a[title="Pivot"]',
            run: "click",
        },
        {
            // wait for the pivot editor to be rendered and also check for sample data
            trigger: ".o_pivot_view .o_view_sample_data .o_view_nocontent_empty_folder",
        },
        {
            trigger: ".o_web_studio_leave > a.btn",
            run: "click",
        },
        ...stepNotInStudio(".o_pivot_view"),
    ],
});

registry.category("web_tour.tours").add("web_studio_new_submenu_tour", {
    url: "/odoo",
    steps: () => [
        {
            trigger: ".o_home_menu_background",
        },
        {
            // open studio
            trigger: ".o_main_navbar .o_web_studio_navbar_item",
            run: "click",
        },
        {
            trigger: "body.o_in_studio",
        },
        {
            // click on the created app
            trigger: '.o_app[data-menu-xmlid*="studio"]:first',
            run: "click",
        },
        {
            // create a new menu
            trigger: ".o-studio--menu .o_web_create_new_model",
            run: "click",
        },
        {
            trigger: "input[name=model_name]",
            run: `edit second menu ${randomString(6)}`,
        },
        {
            trigger: ".confirm_button",
            run: "click",
        },
        {
            trigger: ".o_web_studio_model_configurator_next",
            run: "click",
        },
        {
            // leave studio
            trigger: ".o_web_studio_leave > a.btn",
            run: "click",
        },
        {
            trigger: ".o_web_client:not(.o_in_studio)",
        },
        {
            // open studio again to check the new menu can be edited
            trigger: ".o_main_navbar .o_web_studio_navbar_item",
            run: "click",
        },
        {
            // check we are back in studio
            trigger: ".o_in_studio",
        },
    ],
});

registry.category("web_tour.tours").add("web_studio_new_report_tour", {
    url: "/odoo",
    steps: () => [
        {
            trigger: ".o_home_menu_background",
        },
        {
            // open studio
            trigger: ".o_main_navbar .o_web_studio_navbar_item",
            run: "click",
        },
        {
            trigger: "body.o_in_studio",
        },
        {
            // click on the created app
            trigger: '.o_app[data-menu-xmlid*="studio"]:first',
            run: "click",
        },
        {
            // edit reports
            trigger: ".o_web_studio_menu li a:contains(Reports)",
            run: "click",
        },
        {
            // create a new report
            trigger: ".o_control_panel .o-kanban-button-new",
            run: "click",
        },
        {
            // select external layout
            trigger: '.o_web_studio_report_layout_dialog div[data-layout="web.external_layout"]',
            run: "click",
        },
        {
            // edit report name
            trigger: '.o_web_studio_sidebar input[id="name"]',
            run: "edit My Awesome Report && click body",
        },
        {
            // add a new group on the node
            trigger: '.o_web_studio_sidebar .o_field_many2many_tags[name="groups_id"] input',
            run: "click",
        },
        {
            trigger: ".o-autocomplete--dropdown-menu li:contains(Access Rights)",
            run: "click",
        },
        {
            // wait for the group to appear
            trigger:
                '.o_web_studio_sidebar .o_field_many2many_tags[name="groups_id"] .o_tag_badge_text:contains(Access Rights)',
        },
        {
            trigger:
                ".o-web-studio-report-editor-wysiwyg :iframe .odoo-editor-editable div.page div",
            run() {
                this.anchor.ownerDocument.getSelection().setPosition(this.anchor);
                assertEqual(
                    this.anchor.outerHTML,
                    `<div class="oe_structure o-paragraph" o-diff-key="3"><br></div>`
                );
            },
        },
        {
            trigger:
                ".o-web-studio-report-editor-wysiwyg :iframe .odoo-editor-editable div.page div",
            run() {
                assertEqual(this.anchor.classList.contains("o-we-hint"), true);
            },
        },
        {
            trigger:
                ".o-web-studio-report-editor-wysiwyg :iframe .odoo-editor-editable div.page div",
            run: "editor some new text",
        },
        {
            trigger: ".o_web_studio_menu .o-web-studio-save-report.btn-primary",
            run: "click",
        },
        {
            // The report has been saved
            trigger: ".o_web_studio_menu .o-web-studio-save-report:not(.btn-primary)",
        },
        {
            trigger: ".o_web_studio_breadcrumb .o_back_button:contains(Reports)",
            run: "click",
        },
        {
            content: "open the dropdown",
            trigger: ".o_kanban_record:contains(My Awesome Report) .dropdown-toggle:not(:visible)",
            run: "click",
        },
        {
            // duplicate the report
            trigger: ".dropdown-menu a:contains(Duplicate)",
            run: "click",
        },
        {
            // open the duplicate report
            trigger: ".o_kanban_record:contains(My Awesome Report copy(1))",
            run: "click",
        },
        {
            // switch to 'Report' tab
            trigger: ".o_web_studio_sidebar input[id='name']",
            run() {
                assertEqual(this.anchor.value, "My Awesome Report copy(1)");
            },
        },
        {
            trigger: ".o-web-studio-report-editor-wysiwyg :iframe div.page div",
            run() {
                assertEqual(this.anchor.textContent, "some new text");
            },
        },
        {
            trigger:
                '.o_web_studio_sidebar .o_field_many2many_tags[name="groups_id"] .o_tag_badge_text:contains(Access Rights)',
        },
        {
            trigger: ".o_web_studio_leave > a.btn",
            run: "click",
        },
        ...stepNotInStudio(),
    ],
});

registry.category("web_tour.tours").add("web_studio_new_report_basic_layout_tour", {
    url: "/odoo",
    steps: () => [
        {
            trigger: ".o_home_menu_background",
        },
        {
            // open studio
            trigger: ".o_main_navbar .o_web_studio_navbar_item",
            run: "click",
        },
        {
            trigger: "body.o_in_studio",
        },
        {
            // click on the created app
            trigger: '.o_app[data-menu-xmlid*="studio"]:first',
            run: "click",
        },
        {
            // edit reports
            trigger: ".o_web_studio_menu li a:contains(Reports)",
            run: "click",
        },
        {
            // create a new report
            trigger: ".o_control_panel .o-kanban-button-new",
            run: "click",
        },
        {
            // select basic layout
            trigger: '.o_web_studio_report_layout_dialog div[data-layout="web.basic_layout"]',
            run: "click",
        },
        {
            // edit report name
            trigger: '.o_web_studio_sidebar input[id="name"]',
            run: "edit My Awesome basic layout Report && click body",
        },
        {
            // add a new group on the node
            trigger: '.o_web_studio_sidebar .o_field_many2many_tags[name="groups_id"] input',
            run: "click",
        },
        {
            trigger: ".o-autocomplete--dropdown-menu li:contains(Access Rights)",
            run: "click",
        },
        {
            // wait for the group to appear
            trigger:
                '.o_web_studio_sidebar .o_field_many2many_tags[name="groups_id"] .o_tag_badge_text:contains(Access Rights)',
        },
        {
            trigger: ".o_web_studio_menu .o-web-studio-save-report.btn-primary",
            run: "click",
        },
        {
            // The report has been saved
            trigger: ".o_web_studio_menu .o-web-studio-save-report:not(.btn-primary)",
        },
        {
            // leave the report
            trigger: ".o_web_studio_breadcrumb .o_back_button:contains(Reports)",
            run: "click",
        },
        {
            content: "open the dropdown",
            trigger: ".o_kanban_record:contains(My Awesome basic layout Report)",
            run: "hover && click .o_kanban_record:contains(My Awesome basic layout Report) .dropdown-toggle",
        },
        {
            // duplicate the report
            trigger: ".dropdown-menu .dropdown-item:contains(Duplicate)",
            run: "click",
        },
        {
            // open the duplicate report
            trigger: ".o_kanban_record:contains(My Awesome basic layout Report copy(1))",
            run: "click",
        },
        {
            trigger: '.o_web_studio_sidebar input[id="name"]',
            run() {
                assertEqual(this.anchor.value, "My Awesome basic layout Report copy(1)");
            },
        },
        {
            trigger: ".o_web_studio_leave > a.btn",
            run: "click",
        },
        ...stepNotInStudio(),
    ],
});

registry.category("web_tour.tours").add("web_studio_approval_tour", {
    url: "/odoo?debug=1",
    steps: () => [
        {
            // go to Apps menu
            trigger: '.o_app[data-menu-xmlid="base.menu_management"]',
            run: "click",
        },
        {
            trigger: ".o_cp_switch_buttons",
        },
        {
            // open studio
            trigger: ".o_main_navbar .o_web_studio_navbar_item",
            run: "click",
        },
        {
            // switch to form view editor
            trigger: '.o_web_studio_views_icons > a[title="Form"]',
            run: "click",
        },
        {
            trigger: ".o_web_studio_form_view_editor",
        },
        {
            trigger: ".o_web_studio_sidebar .o_web_studio_view",
            run: "click",
        },
        {
            trigger: ".o_web_studio_sidebar #show_invisible",
            run: "click",
        },
        {
            content: "click on first button it finds that has a node id",
            trigger:
                ".o_web_studio_form_view_editor button[name='button_immediate_upgrade'].o-web-studio-editor--element-clickable",
            run: "click",
        },
        {
            // enable approvals for the button
            trigger: '.o_web_studio_sidebar_approval [name="create_approval_rule"]',
            run: "click",
        },
        {
            trigger: ".o_web_studio_snackbar .fa-check",
        },
        {
            // add approval rule
            trigger: '.o_web_studio_sidebar_approval [name="create_approval_rule"]',
            run: "click",
        },
        {
            // set approval message
            trigger: '.o_web_studio_sidebar_approval input[name*="approval_message"]',
            run: "edit nope",
        },
        {
            trigger: ".o_studio_sidebar_approval_rule:eq(1)",
        },
        {
            // set domain on first rule
            trigger: ".o_web_studio_sidebar_approval .o_approval_domain",
            run: "click",
        },
        {
            // set stupid domain that is always truthy
            trigger: ".o_domain_selector_debug_container textarea",
            run: function () {
                this.anchor.focus();
                this.anchor.value = '[["id", "!=", False]]';
                this.anchor.dispatchEvent(new Event("change", { bubbles: true }));
            },
        },
        {
            // save domain and close modal
            trigger: " .modal-footer .btn-primary",
            run: "click",
        },
        {
            trigger: ".o_web_studio_snackbar .fa-check",
        },
        {
            // add second approval rule when the first is set
            trigger: '.o_web_studio_sidebar_approval [name="create_approval_rule"]',
            run: "click",
        },
        {
            trigger: ".o_web_studio_snackbar .fa-check",
        },
        {
            // enable 'force different users' for one rule (doesn't matter which)
            trigger: '.o_web_studio_sidebar label[for*="exclusive_user"]',
            run: "click",
        },
        {
            // switch to kanban view editor
            trigger: '.o_web_studio_views_icons > a[title="Kanban"]',
            run: "click",
        },
        {
            // leave studio
            trigger: ".o_web_studio_leave > a.btn",
            run: "click",
        },
        {
            trigger: ".o_web_client:not(.o_in_studio)",
        },
        {
            // TODO: add breacrumb to access multi-record view when closing studio and close studio from form instead of from kanban
            // trigger: ".o_breadcrumb .o_back_button",
            trigger: "body",
        },
        {
            trigger: ".o_searchview_dropdown_toggler",
            run: "click",
        },
        {
            trigger: ".o-dropdown-item:contains(Installed)",
            run: "click",
        },
        {
            trigger: ".o_searchview_input",
            run: "edit web_studio",
        },
        {
            trigger: ".o_menu_item.dropdown-item:contains(Module)",
            run: "click",
        },
        {
            trigger: ".o_kanban_record:not(.o_kanban_ghost):only",
        },
        {
            content:
                "open first record (should be the one that was used, so the button should be there)",
            trigger:
                ".o_kanban_view .o_kanban_record:not(.o_kanban_ghost):not(:has(button[name='button_immediate_install'])) .o_dropdown_kanban .dropdown-toggle",
            run: "click",
        },
        {
            trigger: ".o-dropdown--menu .dropdown-item",
            run: "click",
        },
        {
            // try to do the action
            trigger: "button[name='button_immediate_upgrade']",
            run: "click",
        },
        {
            // there should be a warning
            trigger: ".o_notification_bar.bg-warning",
            run: "click",
        },
        {
            trigger: ".breadcrumb .o_back_button",
            run: "click",
        },
        {
            trigger: "body .o_modules_kanban",
        },
    ],
});

registry.category("web_tour.tours").add("web_studio_custom_field_tour", {
    url: "/odoo",
    steps: () => [
        {
            // go to Apps menu
            trigger: '.o_app[data-menu-xmlid="base.menu_management"]',
            run: "click",
        },
        {
            // click on the list view
            trigger: ".o_switch_view.o_list",
            run: "click",
        },
        {
            // click on optional column dropdown
            trigger: ".o_optional_columns_dropdown_toggle",
            run: "click",
        },
        {
            // click on add custom field
            trigger: ".dropdown-item-studio",
            run: "click",
        },
        {
            trigger: ".o_web_client.o_in_studio",
        },
        {
            // go to home menu
            trigger: ".o_menu_toggle",
            run: "click",
        },
        {
            //leave studio
            trigger: ".o_web_studio_leave > a.btn",
            run: "click",
        },
        {
            trigger: ".o_web_client:not(.o_in_studio)",
        },
        {
            // studio left.
            trigger: '.o_app[data-menu-xmlid="base.menu_management"]',
            run: "click",
        },
    ],
});

registry.category("web_tour.tours").add("web_studio_local_storage_tour", {
    url: "/odoo",
    steps: () => [
        {
            trigger: '.o_app[data-menu-xmlid="base.menu_management"]',
            run: function () {
                localStorage.setItem("openStudioOnReload", "main");
                window.location.reload();
            },
        },
        {
            trigger: ".o_web_client.o_in_studio",
        },
        {
            // should be directly in studio mode
            trigger: '.o_app[data-menu-xmlid="base.menu_management"]',
            run: "click",
        },
        {
            trigger: ".o_menu_toggle",
            run: "click",
        },
        {
            trigger: ".o_web_studio_leave > a.btn",
            run: "click",
        },
        {
            trigger: ".o_web_client:not(.o_in_studio)",
        },
        {
            // studio left.
            trigger: '.o_app[data-menu-xmlid="base.menu_management"]',
            run: function () {
                window.location.reload();
            },
        },
        {
            trigger: ".o_web_client:not(.o_in_studio)",
        },
        {
            // studio left after refresh.
            trigger: '.o_app[data-menu-xmlid="base.menu_management"]',
            run: "click",
        },
    ],
});

registry.category("web_tour.tours").add("web_studio_custom_background_tour", {
    url: "/odoo",
    steps: () => [
        {
            content: "class for custom background must be enabled (outside studio)",
            trigger: ".o_home_menu_background_custom.o_home_menu_background:not(.o_in_studio)",
            run: () => null,
        },
        {
            content: "opening studio",
            trigger: ".o_main_navbar .o_web_studio_navbar_item",
            run: "click",
        },
        {
            content: "class for custom background must be enabled (in studio)",
            trigger: ".o_home_menu_background_custom.o_home_menu_background.o_in_studio",
            run: () => null,
        },
        {
            content: "reset the background",
            trigger: ".o_web_studio_reset_default_background",
            run: "click",
        },
        {
            content: "validate the reset of the background",
            trigger: ".modal-dialog .btn-primary",
            run: "click",
        },
        {
            content: "class for custom background must be disabled (inside studio)",
            trigger: ".o_home_menu_background.o_in_studio:not(.o_home_menu_background_custom)",
            run: () => null,
        },
        {
            content: "leaving studio",
            trigger: ".o_web_studio_leave a",
            run: "click",
        },
        {
            content: "class for custom background must be disabled (outside studio)",
            trigger: ".o_home_menu_background:not(.o_in_studio.o_home_menu_background_custom)",
            run: () => null,
        },
    ],
});

registry.category("web_tour.tours").add("web_studio_create_app_with_pipeline_and_user_assignment", {
    steps: () => [
        {
            trigger: ".o_home_menu_background",
        },
        {
            // open studio
            trigger: ".o_main_navbar .o_web_studio_navbar_item",
            run: "click",
        },
        {
            trigger: ".o_web_studio_new_app",
            run: "click",
        },
        {
            // the next steps are here to create a new app
            trigger: ".o_web_studio_app_creator_next",
            run: "click",
        },
        {
            trigger: ".o_web_studio_app_creator_name > input",
            run: `edit ${(createdAppString = randomString(6))}`,
        },
        {
            trigger: ".o_web_studio_app_creator_next.is_ready",
            run: "click",
        },
        {
            trigger: ".o_web_studio_menu_creator > input",
            run: `edit ${(createdAppString = randomString(6))}`,
        },
        {
            trigger: ".o_web_studio_app_creator_next.is_ready",
            run: "click",
        },
        {
            trigger: "input#use_stages",
            run: "click",
        },
        {
            trigger: "input#use_responsible",
            run: "click",
        },
        {
            trigger: ".o_web_studio_model_configurator_next",
            run: "click",
        },
        {
            trigger: ".o_web_studio_editor .o_menu_sections a:contains(Views)",
            run: "click",
        },
        {
            trigger: ".o_web_studio_thumbnail_item.o_web_studio_thumbnail_kanban",
            run: "click",
        },
        {
            trigger: ".o_web_studio_kanban_view_editor",
        },
        {
            trigger: ".o_avatar.o_m2o_avatar",
            run() {
                const avatarImg = document.querySelector(".o_avatar.o_m2o_avatar a");
                if (!avatarImg.getAttribute("title") === "Assign") {
                    throw new Error(
                        "It should be possible to assign a record, when no one is currently selected"
                    );
                }
            },
        },
    ],
});

registry.category("web_tour.tours").add("web_studio_alter_field_existing_in_multiple_views_tour", {
    steps: () => [
        {
            trigger: ".o_home_menu_background",
        },
        {
            // open studio
            trigger: ".o_main_navbar .o_web_studio_navbar_item button",
            run: "click",
        },
        {
            trigger: ".o_web_studio_new_app",
            run: "click",
        },
        {
            // the next steps are here to create a new app
            trigger: ".o_web_studio_app_creator_next",
            run: "click",
        },
        {
            trigger: ".o_web_studio_app_creator_name > input",
            run: `edit ${(createdAppString = randomString(6))}`,
        },
        {
            trigger: ".o_web_studio_app_creator_next.is_ready",
            run: "click",
        },
        {
            trigger: ".o_web_studio_menu_creator > input",
            run: `edit ${createdAppString}`,
        },
        {
            trigger: ".o_web_studio_app_creator_next.is_ready",
            run: "click",
        },
        {
            trigger: ".o_web_studio_model_configurator_next",
            run: "click",
        },
        {
            trigger: ".o_web_studio_sidebar",
        },
        {
            // unfold 'Existing Fieldqs' section
            trigger: ".o_web_studio_existing_fields_header",
            timeout: 60000,
            run: "click",
        },
        {
            // add an existing field (the one we created)
            trigger:
                ".o_web_studio_sidebar .o_web_studio_field_type_container:eq(2) .o_web_studio_field_many2many:contains(Followers (Partners))",
            run: "drag_and_drop .o_inner_group:first .o_web_studio_hook:first",
        },
        {
            trigger: ".o_web_studio_new ",
            run: "click",
        },
        {
            trigger:
                ".o_web_studio_sidebar .o_web_studio_field_type_container:eq(1) .o_web_studio_field_many2many",
            run: "drag_and_drop div.o_web_studio_hook:last",
        },
        {
            trigger: ".modal-body",
        },
        {
            trigger: '.modal:not(.o_inactive_modal) [name="relation_id"] input',
            run: `edit ${createdAppString}`,
        },
        {
            // select the first model
            trigger:
                ".modal:not(.o_inactive_modal) .o-autocomplete--dropdown-menu > li > a:not(:has(.fa-spin))",
            run: "click",
        },
        {
            trigger: "button:contains(Confirm)",
            run: "click",
        },
        {
            // edit list view
            trigger: ".o_web_studio_editX2Many",
            run: "click",
        },
        {
            // wait for list view to be loaded
            trigger: ".o_web_studio_list_view_editor",
        },
        {
            // go to view
            trigger: ".o_web_studio_view ",
            run: "click",
        },
        {
            // show invisible elements
            trigger: 'label[for="show_invisible"]',
            run: "click",
        },
        {
            trigger: ".o_web_studio_new ",
            run: "click",
        },
        {
            // unfold 'Existing Fieldqs' section
            trigger: ".o_web_studio_existing_fields_header",
            run: "click",
        },
        {
            // add an existing field (the one we created)
            trigger:
                ".o_web_studio_sidebar .o_web_studio_field_type_container:eq(1) .o_web_studio_field_many2many:contains(Followers (Partners))",
            run: "drag_and_drop .o_web_studio_list_view_editor th.o_web_studio_hook:first",
        },
        {
            // select field
            trigger: "th[data-name='message_partner_ids']",
            run: "click",
        },
        {
            // make it invisible
            trigger: "#invisible",
            run: "click",
        },
        {
            trigger: ".o_web_studio_snackbar .fa.fa-check",
        },
        {
            // check if the invisible option is checked
            trigger: "#invisible:checked",
        },
    ],
});

const buttonToogleStudio = {
    trigger: `button[title="Toggle Studio"]`,
    run: "click",
};
const addActionButtonModalSteps = (
    ActionLabel = "web_studio_new_button_action_name",
    ActionName = "Privacy Lookup"
) => [
    {
        trigger: ".o-web-studio-editor--add-button-action",
        run: "click",
    },
    {
        trigger: ".o-web-studio-editor--modal-add-action input#set_label",
        run: `edit ${ActionLabel}`,
    },
    {
        trigger: ".o-web-studio-editor--modal-add-action input#set_button_type_to_action",
        run: "click",
    },
    {
        trigger: ".o-web-studio-editor--modal-add-action .o_record_selector input",
        run: `edit ${ActionName}`,
    },
    {
        trigger: `.o-web-studio-editor--modal-add-action .o-autocomplete--dropdown-menu li a:not(:has(.fa-spin)):contains(${ActionName})`,
        run: "click",
    },
    {
        trigger: "footer button.o-web-studio-editor--add-button-confirm",
        run: "click",
    },
];

const addMethodButtonModalSteps = () => [
    {
        trigger: ".o-web-studio-editor--add-button-action",
        run: "click",
    },
    {
        trigger: ".o-web-studio-editor--modal-add-action input#set_label",
        run: `edit test`,
    },
    {
        trigger: ".o-web-studio-editor--modal-add-action input#set_button_type_to_object",
        run: "click",
    },
    {
        trigger: ".o-web-studio-editor--modal-add-action  input#set_method",
        run: `edit demo && click body`,
    },
];

registry.category("web_tour.tours").add("web_studio_check_method_in_model", {
    steps: () => [
        {
            trigger: "a[data-menu-xmlid='web_studio.studio_test_partner_menu']",
            run: "click",
        },
        {
            trigger: ".o_form_view .o_form_editable",
            run: "click",
        },
        buttonToogleStudio,
        ...addMethodButtonModalSteps(),
        {
            trigger: "div.text-danger",
            run() {
                const div_error = document.querySelector("div.text-danger");
                assertEqual(
                    div_error.innerHTML,
                    "The method demo does not exist on the model res.partner()."
                );
            },
        },
    ],
});

registry.category("web_tour.tours").add("web_studio_test_create_action_button_in_form_view", {
    steps: () => [
        {
            trigger: "a[data-menu-xmlid='web_studio.studio_test_partner_menu']",
            run: "click",
        },
        {
            trigger: ".o_form_view .o_form_editable",
            run: "click",
        },
        buttonToogleStudio,
        ...addActionButtonModalSteps(),
        {
            trigger: ".o_web_studio_leave a",
            run: "click",
        },
        ...stepNotInStudio(".o_form_view"),
    ],
});

registry
    .category("web_tour.tours")
    .add("web_studio_test_create_second_action_button_in_form_view", {
        steps: () => [
            {
                trigger: "a[data-menu-xmlid='web_studio.studio_test_partner_menu']",
                run: "click",
            },
            {
                trigger: ".o_form_view .o_form_editable",
                run: "click",
            },
            buttonToogleStudio,
            ...addActionButtonModalSteps("web_studio_other_button_action_name", "Download (vCard)"),
            {
                trigger: ".o_web_studio_leave a",
                run: "click",
            },
            ...stepNotInStudio(".o_form_view"),
        ],
    });

registry.category("web_tour.tours").add("web_studio_test_create_action_button_in_list_view", {
    steps: () => [
        {
            trigger: "a[data-menu-xmlid='web_studio.studio_test_partner_menu']",
            run: "click",
        },
        {
            trigger: ".o_form_view .o_form_editable",
            run: "click",
        },
        buttonToogleStudio,
        {
            trigger: ".o_web_studio_views_icons a[aria-label='List']",
            run: "click",
        },
        {
            trigger: ".o_optional_columns_dropdown button",
            run: "click",
        },
        ...addActionButtonModalSteps(),
        {
            trigger: ".o_web_studio_leave a",
            run: "click",
        },
        ...stepNotInStudio(".o_list_view"),
    ],
});

registry.category("web_tour.tours").add("web_studio_test_remove_action_button_in_form_view", {
    steps: () => [
        {
            trigger: "a[data-menu-xmlid='web_studio.studio_test_partner_menu']",
            run: "click",
        },
        {
            trigger: ".o_form_view .o_form_editable",
            run: "click",
        },
        buttonToogleStudio,
        {
            trigger: 'button[studioxpath="/form[1]/header[1]/button[1]"]',
            run: "click",
        },
        {
            trigger: "button.o_web_studio_remove",
            run: "click",
        },
        {
            trigger: "footer.modal-footer>button.btn-primary",
            run: "click",
        },
        {
            trigger: ".o_web_studio_leave a",
            run: "click",
        },
        ...stepNotInStudio(".o_form_view"),
    ],
});

registry.category("web_tour.tours").add("web_studio_test_remove_action_button_in_list_view", {
    steps: () => [
        {
            trigger: "a[data-menu-xmlid='web_studio.studio_test_partner_menu']",
            run: "click",
        },
        {
            trigger: ".o_form_view .o_form_editable",
            run: "click",
        },
        buttonToogleStudio,
        {
            trigger: ".o_web_studio_views_icons a[aria-label='List']",
            run: "click",
        },
        {
            trigger: ".o_optional_columns_dropdown button",
            run: "click",
        },
        {
            trigger: 'button[studioxpath="/list[1]/header[1]/button[1]"]',
            run: "click",
        },
        {
            trigger: "button.o_web_studio_remove",
            run: "click",
        },
        {
            trigger: "footer.modal-footer>button.btn-primary",
            run: "click",
        },
        {
            trigger: ".o_web_studio_leave a",
            run: "click",
        },
        ...stepNotInStudio(".o_list_view"),
    ],
});

registry.category("web_tour.tours").add("web_studio_monetary_create", {
    url: "/odoo?debug=1",
    steps: () => [
        // This tour drag&drop a monetary field and verify that a currency is created
        {
            trigger: ".o_home_menu_background",
        },
        {
            // open studio
            trigger: ".o_main_navbar .o_web_studio_navbar_item",
            run: "click",
        },
        {
            trigger: ".o_web_studio_new_app",
        },
        {
            trigger: ".o_app[data-menu-xmlid='web_studio.studio_app_menu']",
            run: "click",
        },
        // drag&drop a monetary and verify that the currency is in the view
        {
            // add a new monetary field
            trigger: ".o_web_studio_sidebar .o_web_studio_field_monetary",
            run: "drag_and_drop .o_web_studio_form_view_editor .o_inner_group",
        },
        {
            // verify that the currency is set
            trigger: ".o_web_studio_sidebar .o_web_studio_property_currency_field .text-start",
            run() {
                assertEqual(this.anchor.textContent, "Currency (x_studio_currency_id)");
            },
        },
        {
            // currency field is in the view
            trigger: ".o_web_studio_view_renderer div[data-field-name='x_studio_currency_id']",
            run: "click",
        },
        {
            trigger: ".o_web_studio_properties.active",
        },
    ],
});

registry.category("web_tour.tours").add("web_studio_monetary_change_currency_name", {
    url: "/odoo?debug=1",
    steps: () => [
        // Changing currency name also change the currency name in the monetary currency selection
        {
            trigger: ".o_home_menu_background",
        },
        {
            // open studio
            trigger: ".o_main_navbar .o_web_studio_navbar_item",
            run: "click",
        },
        {
            trigger: ".o_web_studio_new_app",
        },
        {
            trigger: ".o_app[data-menu-xmlid='web_studio.studio_app_menu']",
            run: "click",
        },
        {
            // currency field is in the view and click on it
            trigger: ".o_web_studio_view_renderer [data-field-name='x_studio_currency_test']",
            run: "click",
        },
        {
            // change the currency name
            trigger: "input[name='string']",
            run: "edit NewCurrency && click body",
        },
        {
            // click on monetary
            trigger: "div[data-field-name^='x_studio_monetary_test']",
            run: "click",
        },
        {
            // verify that the currency name changed in the monetary field
            trigger: ".o_web_studio_sidebar .o_web_studio_property_currency_field .text-start",
            run() {
                assertEqual(this.anchor.textContent, "NewCurrency (x_studio_currency_test)");
            },
        },
    ],
});

registry.category("web_tour.tours").add("web_studio_related_monetary_creation", {
    url: "/odoo?debug=1",
    steps: () => [
        {
            trigger: ".o_home_menu_background",
        },
        {
            // open studio
            trigger: ".o_main_navbar .o_web_studio_navbar_item",
            run: "click",
        },
        {
            trigger: ".o_web_studio_new_app",
        },
        {
            trigger: ".o_app[data-menu-xmlid='web_studio.studio_app_menu']",
            run: "click",
        },
        {
            // add a new related field
            trigger: ".o_web_studio_sidebar .o_web_studio_field_related",
            run: "drag_and_drop .o_web_studio_form_view_editor .o_inner_group",
        },
        {
            trigger: ".o_model_field_selector_value",
            run: "click",
        },
        {
            trigger: ".o_model_field_selector_popover_search input",
            run: "edit X Test",
        },
        {
            run: "click",
            trigger:
                ".o_model_field_selector_popover_item[data-name='x_test'] .o_model_field_selector_popover_item_relation",
        },
        {
            trigger: ".o_model_field_selector_popover_search input",
            run: "edit X Studio Monetary Test",
        },
        {
            run: "click",
            trigger:
                ".o_model_field_selector_popover_item[data-name='x_studio_monetary_test'] button",
        },
        {
            trigger: ".modal-footer button.btn-primary",
            run: "click",
        },
        {
            // The related monetary is created
            trigger: ".o_web_studio_view_renderer .o_form_label:contains('New Related Field')",
            run: "click",
        },
        {
            // The currency is created
            trigger: ".o_web_studio_view_renderer [data-field-name='x_studio_currency_id']",
        },
    ],
});

registry.category("web_tour.tours").add("web_studio_monetary_change_currency_field", {
    url: "/odoo",
    steps: () => [
        // Change currency and verify that the view take the changes into account (the dollar appears)
        {
            // open the custom app form view
            trigger: "a[data-menu-xmlid='web_studio.studio_app_menu']",
            run: "click",
        },
        {
            // fill the required char input
            trigger: ".o_field_char input",
            run: "edit title",
        },
        {
            // fill the new currency (many2one) input #1
            trigger: "div [name='x_studio_currency_test2'] input",
            run: "edit USD",
        },
        {
            // add a new currency field step #2
            trigger: '.ui-menu-item a:contains("USD")',
            run: "click",
        },
        {
            // save the view form
            trigger: "button.o_form_button_save",
            run: "click",
        },
        {
            trigger: ".o_form_saved",
        },
        {
            // open studio with the record
            trigger: ".o_main_navbar .o_web_studio_navbar_item button",
            run: "click",
        },
        {
            // check that there is no currency symbol in renderer
            trigger: "div[name='x_studio_monetary_test'] span",
            run() {
                assertEqual(this.anchor.textContent, "0.00");
            },
        },
        {
            // click on the monetary field
            trigger: "div[data-field-name='x_studio_monetary_test']",
            run: "click",
        },
        {
            // change the currency_field in the monetary
            trigger: ".o_web_studio_sidebar .o_web_studio_property_currency_field button",
            run: "click",
        },
        {
            // click on the second currency, which is "X Studio Currency Test2"
            trigger: ".o-dropdown--menu .o_select_menu_item:nth-child(2)",
            run: "click",
        },
        {
            //wait until the currency has been set (also test the reactivity)
            trigger:
                ".o_web_studio_sidebar .o_web_studio_property_currency_field span.text-start:contains('X Studio Currency Test2')",
        },
        {
            // by changing the currency, we should have a $ symbol in the renderer
            trigger: "div[name^='x_studio_monetary'] span",
            run() {
                assertEqual(this.anchor.textContent, "$0.00");
            },
        },
    ],
});

registry.category("web_tour.tours").add("web_studio_monetary_change_currency_not_in_view", {
    url: "/odoo",
    steps: () => [
        // Change a currency that is not present in the view insert it in the view
        {
            trigger: ".o_home_menu_background",
        },
        {
            // open studio
            trigger: ".o_main_navbar .o_web_studio_navbar_item",
            run: "click",
        },
        {
            trigger: ".o_web_studio_new_app",
        },
        {
            trigger: ".o_app[data-menu-xmlid='web_studio.studio_app_menu']",
            run: "click",
        },
        {
            // click on the monetary field
            trigger: "div[data-field-name='x_studio_monetary_test']",
            run: "click",
        },
        {
            // change the currency_field in the monetary
            trigger: ".o_web_studio_sidebar .o_web_studio_property_currency_field button",
            run: "click",
        },
        {
            // click on the second currency, which is "X Studio Currency Test2"
            trigger: ".o-dropdown--menu .o_select_menu_item:nth-child(2)",
            run: "click",
        },
        {
            // wait until the currency has been set
            trigger:
                ".o_web_studio_sidebar .o_web_studio_property_currency_field span.text-start:contains('X Studio Currency Test2')",
        },
        {
            // go to view tab
            trigger: ".o_web_studio_view",
            run: "click",
        },
        {
            // currency field is in the view and click on it
            trigger: ".o_web_studio_view_renderer div[data-field-name='x_studio_currency_test2']",
            run: "click",
        },
        {
            trigger: ".o_web_studio_properties.active",
        },
    ],
});

registry.category("web_tour.tours").add("web_studio_monetary_add_existing_monetary", {
    url: "/odoo?debug=1",
    steps: () => [
        // Add an existing monetary trough the "existing fields" and verify that the currency
        // is added to the view
        {
            trigger: ".o_home_menu_background",
        },
        {
            // open studio
            trigger: ".o_main_navbar .o_web_studio_navbar_item",
            run: "click",
        },
        {
            trigger: ".o_web_studio_new_app",
        },
        {
            trigger: ".o_app[data-menu-xmlid='web_studio.studio_app_menu']",
            run: "click",
        },
        {
            // click on "existing fields"
            trigger: ".o_web_studio_existing_fields_header",
            run: "click",
        },
        {
            // add the existing monetary field
            trigger: ".o_web_studio_existing_fields_section .o_web_studio_field_monetary",
            run: "drag_and_drop .o_form_renderer .o_web_studio_hook",
        },
        {
            // monetary exist and click on monetary
            trigger: "div[data-field-name='x_studio_monetary_test']",
            run: "click",
        },
        {
            // verify that the currency name changed in the monetary field
            trigger: ".o_web_studio_sidebar .o_web_studio_property_currency_field .text-start",
            run() {
                assertEqual(
                    this.anchor.textContent,
                    "X Studio Currency Test (x_studio_currency_test)"
                );
            },
        },
        {
            // currency field is in the view
            trigger: "div[data-field-name='x_studio_currency_test']",
        },
    ],
});

registry
    .category("web_tour.tours")
    .add("web_studio_monetary_create_monetary_with_existing_currency", {
        url: "/odoo?debug=1",
        steps: () => [
            // Add a new monetary field, since a currency already exists, it should take it instead
            // of creating a new one
            {
                trigger: ".o_home_menu_background",
            },
            {
                // open studio
                trigger: ".o_main_navbar .o_web_studio_navbar_item",
                run: "click",
            },
            {
                trigger: ".o_web_studio_new_app",
            },
            {
                trigger: ".o_app[data-menu-xmlid='web_studio.studio_app_menu']",
                run: "click",
            },
            {
                // go to Add tab
                trigger: ".o_web_studio_new",
                run: "click",
            },
            {
                // add a new monetary field
                trigger: ".o_web_studio_sidebar .o_web_studio_field_monetary",
                async run(helpers) {
                    await helpers.drag_and_drop(
                        `.o_web_studio_form_view_editor .o_inner_group .o_web_studio_hook:eq(1)`,
                        {
                            position: {
                                bottom: 0,
                            },
                            relative: true,
                        }
                    );
                },
            },
            {
                // there is only one occurence of the currency field in the view
                trigger: ".o_form_renderer div[data-field-name^='x_studio_monetary']",
                run() {
                    const o2mNumber = document.querySelectorAll("div.o_field_many2one");
                    assertEqual(o2mNumber.length, 1);
                },
            },
        ],
    });

registry.category("web_tour.tours").add("web_studio_add_field_into_empty_group_by", {
    url: "/odoo?debug=1",
    steps: () => [
        {
            trigger: ".o_home_menu_background",
        },
        {
            trigger: ".o_main_navbar .o_web_studio_navbar_item",
            run: "click",
        },
        {
            trigger: ".o_web_studio_new_app",
            run: "click",
        },
        {
            trigger: ".o_web_studio_app_creator_next",
            run: "click",
        },
        {
            trigger: ".o_web_studio_app_creator_name > input",
            run: `edit ${randomString(6)}`,
        },
        {
            trigger: ".o_web_studio_app_creator_next.is_ready",
            run: "click",
        },
        {
            trigger: ".o_web_studio_menu_creator > input",
            run: `edit ${randomString(6)}`,
        },
        {
            trigger: ".o_web_studio_app_creator_next.is_ready",
            run: "click",
        },
        {
            trigger: ".o_web_studio_model_configurator_next",
            run: "click",
        },
        {
            trigger: ".o_web_studio_views_icons a:last",
            run: "click",
        },
        {
            trigger: `
        .o_web_studio_sidebar
        .o_web_studio_existing_fields
        .o_web_studio_component:has(.o_web_studio_component_description:contains(create_date))`,
            run: "drag_and_drop .o-web-studio-search--groupbys .o_web_studio_hook",
        },
    ],
});

return __exports;
});
;

/*************************************************************************************
*  Filepath: /web_studio/static/tests/tours/web_studio_test_ui_unit_report_tours.js  *
*  Lines: 1603                                                                       *
*************************************************************************************/
odoo.define('@web_studio/../tests/tours/web_studio_test_ui_unit_report_tours', ['@web/core/registry', '@web/core/network/download', '@web/core/utils/patch', '@web/core/utils/xml', '@web_studio/../tests/tours/tour_helpers', '@web/core/browser/cookie', '@html_editor/editor', '@html_editor/utils/position'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module */
const { registry } = require("@web/core/registry");
const { download } = require("@web/core/network/download");
const { patch } = require("@web/core/utils/patch");
const { parseXML, serializeXML } = require("@web/core/utils/xml");
const { assertEqual, stepNotInStudio, nextTick } = require("@web_studio/../tests/tours/tour_helpers");
const { cookie } = require("@web/core/browser/cookie");
const { Editor } = require("@html_editor/editor");
const { nodeSize } = require("@html_editor/utils/position");

const getBoundingClientRect = Element.prototype.getBoundingClientRect;

const editorsWeakMap = new WeakMap();
patch(Editor.prototype, {
    attachTo(editable) {
        editorsWeakMap.set(editable.ownerDocument, this);
        return super.attachTo(...arguments);
    },
});

function normalizeXML(str) {
    const doc = parseXML(str);
    /* Recursively trim text nodes conditionally
     * if they start or end with a newline (\n).
     * In that case we make the assumption that all whitespaces
     * are materializing indentation.
     * If there are only spaces (\s), we make the assumption that they
     * are actual spaces that are visible to the naked eye of the user.
     */
    const nodes = [...doc.childNodes];
    for (const node of nodes) {
        if (node.nodeType === Node.TEXT_NODE) {
            let nodeValue = node.nodeValue;
            if (nodeValue.startsWith("\n")) {
                nodeValue = nodeValue.trimStart();
            }
            if (nodeValue.endsWith("\n")) {
                nodeValue = nodeValue.trimEnd();
            }
            node.nodeValue = nodeValue;
        }
        if (node.nodeType === Node.ELEMENT_NODE) {
            nodes.push(...node.childNodes);
        }
    }

    return serializeXML(doc);
}

function insertText(element, text, offsets = null) {
    const doc = element.ownerDocument;
    const sel = doc.getSelection();
    let range;
    if (sel && sel.rangeCount) {
        range = sel.getRangeAt(sel.rangeCount - 1);
    }
    if (offsets || !range) {
        const { start, end } = offsets || {};
        sel.removeAllRanges();
        range = doc.createRange();
        range.setStart(element, start || 0);
        range.setEnd(element, end || start || 0);
        sel.addRange(range);
    }

    const evOptions = {
        view: doc.defaultView,
        bubbles: true,
        composed: true,
        cancelable: true,
        isTrusted: true,
    };

    for (const char of text) {
        element.dispatchEvent(
            new KeyboardEvent("keydown", {
                ...evOptions,
                key: char,
            })
        );
        element.dispatchEvent(
            new KeyboardEvent("keypress", {
                ...evOptions,
                key: char,
            })
        );
        element.dispatchEvent(
            new InputEvent("input", {
                ...evOptions,
                inputType: "insertText",
                data: char,
            })
        );
        const newNode = doc.createTextNode(char);
        element.append(newNode);
        range.setEndAfter(newNode);

        element.dispatchEvent(
            new KeyboardEvent("keyup", {
                ...evOptions,
                key: char,
            })
        );
    }
}

function openEditorPowerBox(element, offsets = null) {
    return insertText(element, "/", offsets);
}

/* global ace */

// This function allows to use and test the feature that automatically
// saves when we leave the reportEditor.
// Implem detail: it is done at willUnmount, so we need to wait for the promise
// to be sure we leave the tour when the save is done.
function patchReportEditorModelForSilentSave() {
    const saveProms = [];
    const { ReportEditorModel } = odoo.loader.modules.get(
        "@web_studio/client_action/report_editor/report_editor_model"
    );
    const _unpatch = patch(ReportEditorModel.prototype, {
        saveReport() {
            const prom = super.saveReport(...arguments);
            saveProms.push(prom);
            return prom;
        },
    });

    return {
        wait: async (unpatch = true) => {
            await Promise.all(saveProms);
            if (unpatch) {
                _unpatch();
            }
        },
        saveProms,
        unpatch: _unpatch,
    };
}

let silentPatch;
registry.category("web_tour.tours").add("web_studio.test_basic_report_edition", {
    steps: () => [
        {
            trigger: ".o_web_studio_sidebar input[id='name']",
            run: "edit modified in test && click body",
        },
        {
            trigger: ".o_web_studio_menu .breadcrumb-item.active",
            run() {
                assertEqual(this.anchor.textContent, "modified in test");
            },
        },
        {
            trigger: ".o-web-studio-report-editor-wysiwyg :iframe .odoo-editor-editable p:eq(0)",
            run: "editor edited with odoo editor",
        },
        {
            trigger: ".o-web-studio-report-editor-wysiwyg :iframe .odoo-editor-editable p:eq(2)",
            run: "editor edited with odoo editor 2",
        },
        {
            // Don't explicitly save, this is a feature
            trigger: ".o_web_studio_leave a",
            run(helpers) {
                silentPatch = patchReportEditorModelForSilentSave();
                helpers.click();
            },
        },
        ...stepNotInStudio(),
        {
            trigger: "body",
            run() {
                return silentPatch.wait();
            },
        },
    ],
});

registry.category("web_tour.tours").add("web_studio.test_basic_report_edition_xml", {
    steps: () => [
        {
            trigger: ".o_web_studio_sidebar button[name='report_edit_sources']",
            run: "click",
        },
        {
            trigger: ".o_web_studio_xml_resource_selector .o_web_studio_xml_resource_select_menu",
            run() {
                assertEqual(
                    this.anchor.textContent,
                    "web_studio.test_report_document (web_studio.test_report_document)"
                );
            },
        },
        {
            trigger: ".o_web_studio_code_editor.ace_editor",
            run() {
                ace.edit(this.anchor)
                    .getSession()
                    .insert(
                        { row: 2, column: 0 },
                        '<span class="test-added-0">in document view</span>\n'
                    );
            },
        },
        {
            trigger: ".o_web_studio_xml_resource_selector .o_select_menu_toggler",
            run: "click",
        },
        {
            trigger: ".o-dropdown--menu",
            run(helpers) {
                const mainView = Array.from(
                    this.anchor.querySelectorAll(".o_select_menu_item")
                ).find(
                    (el) =>
                        el.textContent ===
                        "web_studio.test_report (web_studio.studio_test_report_view)"
                );
                helpers.click(mainView);
            },
        },
        {
            trigger: ".o_web_studio_code_editor.ace_editor",
            run() {
                ace.edit(this.anchor)
                    .getSession()
                    .insert(
                        { row: 2, column: 0 },
                        '<span class="test-added-1">in main view</span>\n'
                    );
            },
        },
        {
            trigger: ".o-web-studio-save-report.btn-primary",
            run: "click",
        },
        {
            trigger: ".o-web-studio-save-report:not(.btn-primary)",
        },
        {
            trigger: ".o-web-studio-report-container :iframe body",
            run() {
                assertEqual(
                    this.anchor.querySelector(".test-added-0").textContent,
                    "in document view"
                );
                assertEqual(this.anchor.querySelector(".test-added-1").textContent, "in main view");
            },
        },
    ],
});

registry.category("web_tour.tours").add("web_studio.test_basic_report_edition_discard", {
    steps: () => [
        {
            trigger: ".o_web_studio_sidebar input[id='name']",
            run: "edit modified in test && click body",
        },
        {
            trigger: ".o_web_studio_menu .breadcrumb-item.active",
            run() {
                assertEqual(this.anchor.textContent, "modified in test");
            },
        },
        {
            trigger: ".o-web-studio-report-editor-wysiwyg :iframe .odoo-editor-editable p:eq(0)",
            run: "editor edited with odoo editor",
        },
        {
            trigger: ".o-web-studio-report-editor-wysiwyg :iframe .odoo-editor-editable p:eq(2)",
            run: "editor edited with odoo editor 2",
        },
        {
            trigger: ".o-web-studio-discard-report.btn-secondary",
            run: "click",
        },
        {
            trigger: ".modal-dialog .btn-primary",
            run: "click",
        },
        {
            trigger: ".o-web-studio-report-editor-wysiwyg :iframe .odoo-editor-editable p:eq(0)",
            run() {
                assertEqual(this.anchor.textContent, "");
            },
        },
    ],
});

registry.category("web_tour.tours").add("web_studio.test_basic_report_edition_cancel_discard", {
    steps: () => [
        {
            trigger: ".o_web_studio_sidebar input[id='name']",
            run: "edit modified in test && click body",
        },
        {
            trigger: ".o_web_studio_menu .breadcrumb-item.active",
            run() {
                assertEqual(this.anchor.textContent, "modified in test");
            },
        },
        {
            trigger: ".o-web-studio-report-editor-wysiwyg :iframe .odoo-editor-editable p:eq(0)",
            run: "editor edited with odoo editor",
        },
        {
            trigger: ".o-web-studio-discard-report.btn-secondary",
            run: "click",
        },
        {
            trigger: ".modal-dialog .btn-secondary",
            run: "click",
        },
        {
            trigger: ".o-web-studio-report-editor-wysiwyg :iframe .odoo-editor-editable p:eq(0)",
            run() {
                assertEqual(this.anchor.textContent, "edited with odoo editor");
            },
        },
        {
            trigger: ".o-web-studio-save-report.btn-primary",
            run: "click",
        },
        {
            trigger: ".o-web-studio-save-report:not(.btn-primary)",
        },
    ],
});

registry.category("web_tour.tours").add("web_studio.test_basic_report_edition_xml_discard", {
    steps: () => [
        {
            trigger: ".o_web_studio_sidebar button[name='report_edit_sources']",
            run: "click",
        },
        {
            trigger: ".o_web_studio_code_editor.ace_editor",
            run() {
                ace.edit(this.anchor)
                    .getSession()
                    .insert({ row: 2, column: 0 }, '<span class="test-added">in main view</span>');
            },
        },
        {
            trigger: ".o-web-studio-discard-report.btn-secondary",
            run: "click",
        },
        {
            trigger: ".o-web-studio-report-container :iframe body",
            run() {
                const element = this.anchor.querySelector(".test-added");
                if (element) {
                    throw new Error("The changes should have been discarded");
                }
            },
        },
    ],
});

registry.category("web_tour.tours").add("web_studio.test_basic_report_edition_error", {
    steps: () => [
        {
            trigger: ".o-web-studio-report-editor-wysiwyg :iframe .odoo-editor-editable p:eq(0)",
            run: "editor edited with odoo editor",
        },
        {
            // Brutally add a t-else: this will crash in python on save
            trigger: ".o-web-studio-report-editor-wysiwyg :iframe .odoo-editor-editable",
            run() {
                const editor = editorsWeakMap.get(this.anchor.ownerDocument);
                const telse = editor.document.createElement("t");
                telse.setAttribute("t-else", "");
                editor.shared.dom.insert(telse);
                editor.shared.history.addStep();
            },
        },
        {
            trigger: ".o-web-studio-report-editor-wysiwyg :iframe .odoo-editor-editable p:eq(2)",
            run: "editor edited with odoo editor 2",
        },
        {
            trigger: ".o-web-studio-save-report.btn-primary",
            run: "click",
        },
        {
            trigger: ".o_notification .o_notification_title",
            run() {
                assertEqual(this.anchor.textContent, "Report edition failed");
            },
        },
        {
            trigger: ".o-web-studio-report-editor-wysiwyg :iframe .odoo-editor-editable p:eq(0)",
            run() {
                // The iframe shouldn't have been reset after an error
                assertEqual(this.anchor.textContent, "edited with odoo editor");
            },
        },
    ],
});

registry.category("web_tour.tours").add("web_studio.test_basic_report_edition_xml_error", {
    steps: () => [
        {
            trigger: ".o_web_studio_sidebar button[name='report_edit_sources']",
            run: "click",
        },
        {
            trigger: ".o_web_studio_code_editor.ace_editor",
            run() {
                ace.edit(this.anchor)
                    .getSession()
                    .insert(
                        { row: 2, column: 0 },
                        '<span t-else="" class="test-added">in main view</span>'
                    );
            },
        },
        {
            trigger: ".o-web-studio-save-report.btn-primary",
            run: "click",
        },
        {
            trigger: ".o_notification .o_notification_title",
            run() {
                assertEqual(this.anchor.textContent, "Report edition failed");
            },
        },
        {
            trigger: ".o-web-studio-report-container :iframe body",
            run() {
                const element = this.anchor.querySelector(".test-added");
                if (element) {
                    throw new Error("The changes should have been discarded");
                }
            },
        },
    ],
});

registry.category("web_tour.tours").add("web_studio.test_report_reset_archs", {
    steps: () => [
        {
            trigger: ".o_web_studio_sidebar button[name='report_reset_archs']",
            run: "click",
        },
        {
            trigger: ".modal-footer",
            run(helpers) {
                const button = Array.from(this.anchor.querySelectorAll("button")).find(
                    (el) => el.textContent === "Reset report" && el.classList.contains("btn-danger")
                );
                helpers.click(button);
            },
        },
        {
            trigger: ".o-web-studio-report-editor-wysiwyg :iframe .odoo-editor-editable p:eq(1)",
            run() {
                assertEqual(this.anchor.textContent, "from file");
            },
        },
    ],
});

let downloadProm;
const steps = [];
registry.category("web_tour.tours").add("web_studio.test_print_preview", {
    steps: () => [
        {
            trigger: ".o_web_studio_sidebar button[name='report_print_preview']",
            run(helpers) {
                downloadProm = new Promise((resolve) => {
                    const unpatch = patch(download, {
                        _download(options) {
                            steps.push("download report");
                            const context = JSON.parse(options.data.context);
                            assertEqual(context["report_pdf_no_attachment"], true);
                            assertEqual(context["discard_logo_check"], true);
                            assertEqual(context["active_ids"].length, 1);
                            unpatch();
                            resolve();
                        },
                    });
                });
                return helpers.click();
            },
        },
        {
            trigger: ".o-web-studio-report-editor-wysiwyg",
            async run() {
                await downloadProm;
                assertEqual(steps.length, 1);
                assertEqual(steps[0], "download report");
            },
        },
    ],
});

registry.category("web_tour.tours").add("web_studio.test_table_rendering", {
    steps: () => [
        {
            trigger:
                ".o-web-studio-report-editor-wysiwyg :iframe .odoo-editor-editable .valid_table",
            run() {
                assertEqual(
                    this.anchor.outerHTML.replace(/\n\s*/g, ""),
                    `<table class="valid_table" o-diff-key="3">
                        <tbody o-diff-key="4"><tr o-diff-key="5"><td o-diff-key="6">I am valid</td></tr>
                    </tbody></table>`.replace(/\n\s*/g, "")
                );
            },
        },
        {
            trigger:
                ".o-web-studio-report-editor-wysiwyg :iframe .odoo-editor-editable .invalid_table",
            run() {
                assertEqual(
                    this.anchor.outerHTML.replace(/\n\s*/g, ""),
                    `<q-table class="invalid_table oe_unbreakable" o-diff-key="7" style="--q-table-col-count: 1;">
                    <t t-foreach="doc.child_ids" t-as="child" o-diff-key="8" oe-context="{&quot;docs&quot;: {&quot;model&quot;: &quot;res.partner&quot;, &quot;name&quot;: &quot;Contact&quot;, &quot;in_foreach&quot;: false}, &quot;company&quot;: {&quot;model&quot;: &quot;res.company&quot;, &quot;name&quot;: &quot;Companies&quot;, &quot;in_foreach&quot;: false}, &quot;doc&quot;: {&quot;model&quot;: &quot;res.partner&quot;, &quot;name&quot;: &quot;Contact&quot;, &quot;in_foreach&quot;: true}, &quot;child&quot;: {&quot;model&quot;: &quot;res.partner&quot;, &quot;name&quot;: &quot;Contact&quot;, &quot;in_foreach&quot;: true}}">
                        <q-tr o-diff-key="9" class="oe_unbreakable"><q-td o-diff-key="10" class="oe_unbreakable">I am not valid</q-td></q-tr>
                    </t>
                </q-table>`.replace(/\n\s*/g, "")
                );
            },
        },
        {
            trigger:
                ".o-web-studio-report-editor-wysiwyg :iframe .odoo-editor-editable .invalid_table q-td",
            run: "editor edited with odooEditor",
        },
        {
            trigger: ".o-web-studio-report-editor-wysiwyg :iframe .odoo-editor-editable p:eq(1)",
            run: "editor p edited with odooEditor",
        },
        {
            trigger: ".o_web_studio_sidebar input[id='name']",
            run: "edit modified && click body",
        },
        {
            trigger: ".o-web-studio-save-report.btn-primary",
            run: "click",
        },
        {
            trigger: ".o-web-studio-save-report:not(.btn-primary)",
        },
    ],
});

registry.category("web_tour.tours").add("web_studio.test_field_placeholder", {
    steps: () => [
        {
            // 1 sec delay to make sure we call the download route
            trigger: ".o-web-studio-report-editor-wysiwyg :iframe .odoo-editor-editable p:eq(2)",
            async run(helpers) {
                const el = this.anchor;
                openEditorPowerBox(el);
            },
        },
        {
            trigger: ".o-we-powerbox .o-we-command-description:contains(Insert a field)",
            run: "click",
        },
        {
            trigger: ".o-web-studio-field-dynamic-placeholder",
        },
        {
            trigger:
                ".o-web-studio-report-editor-wysiwyg div:has(> .o-web-studio-report-container)",
            async run() {
                const placeholderBox = getBoundingClientRect.call(
                    document.querySelector(".o-web-studio-field-dynamic-placeholder")
                );
                assertEqual(this.anchor.scrollTop, 0);
                this.anchor.scrollTop = 9999;
                await new Promise(requestAnimationFrame);
                const newPlaceholderbox = getBoundingClientRect.call(
                    document.querySelector(".o-web-studio-field-dynamic-placeholder")
                );
                // The field placeholder should have followed its anchor, and it happens that the anchor's container
                // has been scrolled, so the anchor has moved upwards (and is actually outside of the viewPort, to the top)
                assertEqual(placeholderBox.top > newPlaceholderbox.top, true);
            },
        },
        {
            trigger:
                ".o-web-studio-field-dynamic-placeholder .o_model_field_selector_popover_search input",
            run: "edit Job Position",
        },
        {
            trigger:
                ".o-web-studio-field-dynamic-placeholder .o_model_field_selector_popover_item_name:contains(Job Position)",
            run: "click",
        },
        {
            trigger:
                ".o-web-studio-field-dynamic-placeholder .o_model_field_selector_default_value_input input",
            run: "edit some default value",
        },
        {
            trigger: ".o-web-studio-field-dynamic-placeholder .o_model_field_selector_popover",
            run: "press Enter",
        },
        {
            trigger:
                ".o-web-studio-report-editor-wysiwyg :iframe .odoo-editor-editable span[t-field='doc.function'][title='doc.function']",
        },
        {
            trigger: ".o-web-studio-save-report.btn-primary",
        },
        {
            trigger: ".o-web-studio-report-editor-wysiwyg :iframe .odoo-editor-editable p:eq(0)",
            run() {
                insertText(this.anchor, "edited with odooEditor");
            },
        },
        {
            trigger: ".o-web-studio-save-report.btn-primary",
            run: "click",
        },
        {
            trigger: ".o-web-studio-save-report:not(.btn-primary)",
        },
    ],
});

registry.category("web_tour.tours").add("web_studio.test_add_field_blank_report", {
    steps: () => [
        {
            // edit reports
            trigger: ".o_web_studio_menu li a:contains(Reports)",
            run: "click",
        },
        {
            // create a new report
            trigger: ".o_control_panel .o-kanban-button-new",
            run: "click",
        },
        {
            // select basic layout
            trigger: '.o_web_studio_report_layout_dialog div[data-layout="web.basic_layout"]',
            run: "click",
        },
        {
            trigger: ":iframe .odoo-editor-editable .page div",
            async run(helpers) {
                const el = this.anchor;
                openEditorPowerBox(el);
            },
        },
        {
            trigger: ".o-we-powerbox .o-we-command-description:contains(Insert a field)",
            run: "click",
        },
        {
            trigger: ".o-web-studio-field-dynamic-placeholder",
        },
        {
            trigger:
                ".o-web-studio-report-editor-wysiwyg div:has(> .o-web-studio-report-container)",
            async run() {
                const placeholderBox = getBoundingClientRect.call(
                    document.querySelector(".o-web-studio-field-dynamic-placeholder")
                );
                assertEqual(this.anchor.scrollTop, 0);
                this.anchor.scrollTop = 9999;
                await new Promise(requestAnimationFrame);
                const newPlaceholderbox = getBoundingClientRect.call(
                    document.querySelector(".o-web-studio-field-dynamic-placeholder")
                );
                // The field placeholder should have followed its anchor, and it happens that the anchor's container
                // has been scrolled, so the anchor has moved upwards (and is actually outside of the viewPort, to the top)
                assertEqual(placeholderBox.top > newPlaceholderbox.top, true);
            },
        },
        {
            trigger:
                ".o-web-studio-field-dynamic-placeholder .o_model_field_selector_popover_search input",
            run: "edit Job Position",
        },
        {
            trigger:
                ".o-web-studio-field-dynamic-placeholder .o_model_field_selector_popover_item_name:contains(Job Position)",
            run: "click",
        },
        {
            trigger:
                ".o-web-studio-field-dynamic-placeholder .o_model_field_selector_default_value_input input",
            run: "edit some default value",
        },
        {
            trigger: ".o-web-studio-field-dynamic-placeholder .o_model_field_selector_popover",
            run: "press Enter",
        },
        {
            // check that field was added successfully
            trigger: ":iframe .odoo-editor-editable .page div > span:contains(some default value)",
        },
        {
            trigger: ":iframe .odoo-editor-editable .page div",
            run() {
                insertText(this.anchor, "Custo");
            },
        },
        {
            trigger: ".o-web-studio-save-report.btn-primary",
            run: "click",
        },
        {
            trigger: ".o-web-studio-save-report:not(.btn-primary)",
        },
    ],
});

registry.category("web_tour.tours").add("web_studio.test_toolbar_appearance", {
    steps: () => [
        {
            trigger: ".o-web-studio-report-editor-wysiwyg :iframe .odoo-editor-editable .to_edit",
            run() {
                const anchor = this.anchor;
                const doc = anchor.ownerDocument;
                const selection = doc.getSelection();
                selection.removeAllRanges();
                const range = doc.createRange();
                range.selectNode(anchor.firstChild);
                selection.addRange(range);
            },
        },
        {
            trigger: ".o-we-toolbar",
        },
        {
            trigger: ".o-we-toolbar button[name='bold']",
            run: "click",
        },
        {
            trigger: ".o-we-toolbar button[name='italic']",
            run: "click",
        },
        {
            trigger: ".o-web-studio-discard-report",
            run: "click",
        },
        {
            trigger: "body:not(:has(.o-we-toolbar))",
        },
    ],
});

registry.category("web_tour.tours").add("web_studio.test_edition_without_lang", {
    steps: () => [
        {
            trigger: ".o-web-studio-report-editor-wysiwyg :iframe .odoo-editor-editable p:eq(1)",
            run() {
                assertEqual(this.anchor.textContent, "original term");
            },
        },
        {
            trigger: ".o-web-studio-report-editor-wysiwyg :iframe .odoo-editor-editable p:eq(1)",
            async run() {
                insertText(this.anchor, " edited");
            },
        },
        {
            trigger: ".o_web_studio_sidebar button[name='report_edit_sources']",
            run: "click",
        },
        {
            trigger: ".o_web_studio_xml_resource_select_menu button.o_select_menu_toggler",
            run: "click",
        },
        {
            trigger:
                ".o-dropdown--menu .o_select_menu_item_label:contains(report_editor_customization_diff)",
            run: "click",
        },
        {
            trigger: ".o_web_studio_code_editor_info .o_field_translate",
            run: "click",
        },
        {
            trigger: ".o_translation_dialog .row:eq(1)",
            run() {
                assertEqual(this.anchor.children[0].textContent.trim(), "French / Franais");
                assertEqual(this.anchor.children[1].textContent.trim(), "original term edited");
            },
        },
        {
            trigger: ".o_translation_dialog .row:eq(1) textarea",
            run: "edit translated edited term && click body",
        },
        {
            trigger: ".modal-footer button.btn-primary",
            run: "click",
        },
        {
            trigger: ".o_web_studio_editor",
        },
    ],
});

registry.category("web_tour.tours").add("web_studio.test_report_xml_other_record", {
    steps: () => [
        {
            trigger: ".o_web_studio_sidebar button[name='report_edit_sources']",
            run: "click",
        },
        {
            trigger: ".o_web_studio_xml_editor",
        },
        {
            trigger: ".o-web-studio-report-container :iframe body p:contains(partner_1)",
            run() {
                assertEqual(
                    document.querySelector(".o-web-studio-report-search-record input").value,
                    "partner_1"
                );
            },
        },
        {
            trigger: ".o-web-studio-report-pager .o_pager_next",
            run: "click",
        },
        {
            trigger: ".o-web-studio-report-container :iframe body p:contains(partner_2)",
            run() {
                assertEqual(
                    document.querySelector(".o-web-studio-report-search-record input").value,
                    "partner_2"
                );
            },
        },
    ],
});

registry.category("web_tour.tours").add("web_studio.test_partial_eval", {
    steps: () => [
        {
            trigger: ".o-web-studio-report-container :iframe .odoo-editor-editable .lol",
            run() {
                const closestContextElement = this.anchor.closest("[oe-context]");
                const oeContext = closestContextElement.getAttribute("oe-context");
                const expected = {
                    docs: { model: "res.partner", name: "Contact", in_foreach: false },
                    company: { model: "res.company", name: "Companies", in_foreach: false },
                    doc: { model: "res.partner", name: "Contact", in_foreach: true },
                    my_children: { model: "res.partner", name: "Contact", in_foreach: false },
                    child: { model: "res.partner", name: "Contact", in_foreach: true },
                };
                assertEqual(JSON.stringify(JSON.parse(oeContext)), JSON.stringify(expected));
            },
        },
        {
            trigger: ".o-web-studio-report-container :iframe .odoo-editor-editable .couic",
        },
    ],
});

registry.category("web_tour.tours").add("web_studio.test_render_multicompany", {
    steps: () => [
        {
            trigger: ".o-web-studio-report-container :iframe .odoo-editor-editable .test_layout",
        },
        {
            trigger: ".o-web-studio-report-container :iframe .odoo-editor-editable img",
            run() {
                const cids = cookie.get("cids").split("-");
                assertEqual(this.anchor.getAttribute("src"), `/logo.png?company=${cids[0]}`);
            },
        },
    ],
});

registry.category("web_tour.tours").add("web_studio.test_add_non_searchable_field", {
    steps: () => [
        {
            trigger: ".o-web-studio-report-editor-wysiwyg :iframe .odoo-editor-editable p:eq(2)",
            async run(helpers) {
                const el = this.anchor;
                openEditorPowerBox(el);
            },
        },
        {
            trigger: ".o-we-powerbox .o-we-command-description:contains(Insert a field)",
            run: "click",
        },
        {
            trigger:
                ".o-web-studio-field-dynamic-placeholder .o_model_field_selector_popover_search input",
            run: "edit Avatar",
        },
        {
            trigger: "[data-name=avatar_1024] > button.o_model_field_selector_popover_item_name",
            run: "click",
        },
        {
            trigger:
                ".o-web-studio-field-dynamic-placeholder .o_model_field_selector_default_value_input input",
            run: "edit file default value",
        },
        {
            trigger: ".o-web-studio-field-dynamic-placeholder .o_model_field_selector_popover",
            run: "press Enter",
        },
        {
            trigger: ".o-web-studio-save-report.btn-primary",
            run: "click",
        },
        {
            trigger: ".o-web-studio-save-report:not(.btn-primary)",
        },
    ],
});

registry.category("web_tour.tours").add("web_studio.test_report_edition_binary_field", {
    steps: () => [
        {
            trigger: ".o-web-studio-report-editor-wysiwyg :iframe .odoo-editor-editable p:eq(2)",
            async run(helpers) {
                const el = this.anchor;
                openEditorPowerBox(el);
            },
        },
        {
            trigger: ".o-we-powerbox .o-we-command-description:contains(Insert a field)",
            run: "click",
        },
        {
            trigger:
                ".o-web-studio-field-dynamic-placeholder .o_model_field_selector_popover_search input",
            run: "edit Company",
        },
        {
            trigger: "[data-name=company_id] > button.o_model_field_selector_popover_item_relation",
            run: "click",
        },
        {
            trigger:
                ".o-web-studio-field-dynamic-placeholder .o_model_field_selector_popover_search input",
            run: "edit New File",
        },
        {
            trigger:
                ".o_model_field_selector_popover_item_name:contains(New File):not(:contains(filename))",
            run: "click",
        },
        {
            trigger:
                ".o-web-studio-field-dynamic-placeholder .o_model_field_selector_default_value_input input",
            run: "edit file default value",
        },
        {
            trigger: ".o-web-studio-field-dynamic-placeholder .o_model_field_selector_popover",
            run: "press Enter",
        },
        {
            trigger: ".o-web-studio-report-editor-wysiwyg :iframe .odoo-editor-editable p:eq(2)",
            async run(helpers) {
                const el = this.anchor;
                openEditorPowerBox(el, { start: nodeSize(el) }); // after the file field
            },
        },
        {
            trigger: ".o-we-powerbox .o-we-command-description:contains(Insert a field)",
            run: "click",
        },
        {
            trigger:
                ".o-web-studio-field-dynamic-placeholder .o_model_field_selector_popover_search input",
            run: "edit Company",
        },
        {
            trigger: "[data-name=company_id] > button.o_model_field_selector_popover_item_relation",
            run: "click",
        },
        {
            trigger:
                ".o-web-studio-field-dynamic-placeholder .o_model_field_selector_popover_search input",
            run: "edit New Image",
        },
        {
            trigger: ".o_model_field_selector_popover_item_name:contains(New Image)",
            run: "click",
        },
        {
            trigger:
                ".o-web-studio-field-dynamic-placeholder .o_model_field_selector_default_value_input input",
            run: "edit image default value",
        },
        {
            trigger: ".o-web-studio-field-dynamic-placeholder .o_model_field_selector_popover",
            run: "press Enter",
        },
        {
            trigger: ".o-web-studio-save-report.btn-primary",
            run: "click",
        },
        {
            trigger: ".o-web-studio-save-report:not(.btn-primary)",
        },
    ],
});

registry.category("web_tour.tours").add("web_studio.test_report_edition_dynamic_table", {
    steps: () => [
        {
            trigger: ".o-web-studio-report-editor-wysiwyg :iframe .odoo-editor-editable p:eq(2)",
            async run(helpers) {
                const el = this.anchor;
                openEditorPowerBox(el);
            },
        },
        {
            trigger:
                ".o-we-powerbox .o-we-command-description:contains(Insert a table based on a relational field)",
            run: "click",
        },
        {
            trigger:
                ".o-web-studio-field-dynamic-placeholder .o_model_field_selector_popover_search input",
            run: "edit Activities",
        },
        {
            trigger: "[data-name=activity_ids] > button.o_model_field_selector_popover_item_name",
            run: "click",
        },
        {
            trigger:
                ".o-web-studio-field-dynamic-placeholder .o_model_field_selector_default_value_input input",
            run: "edit First Column",
        },
        {
            trigger: ".o-web-studio-field-dynamic-placeholder .o_model_field_selector_popover",
            run: "press Enter",
        },
        {
            trigger:
                ".o-web-studio-report-editor-wysiwyg :iframe .odoo-editor-editable table tr td:contains(First Column)",
        },
        {
            trigger:
                ".o-web-studio-report-editor-wysiwyg :iframe .odoo-editor-editable table tr[t-foreach]",
            run() {
                const el = this.anchor;
                const context = JSON.parse(el.getAttribute("oe-context"));
                assertEqual(context.x2many_record.model, "mail.activity");
            },
        },
        {
            trigger:
                ".o-web-studio-report-editor-wysiwyg :iframe .odoo-editor-editable table tr td:contains(Insert a field...)",
            run() {
                openEditorPowerBox(this.anchor);
            },
        },
        {
            trigger: ".o-we-powerbox .o-we-command-description:contains(Insert a field)",
            run: "click",
        },
        {
            trigger:
                ".o-web-studio-field-dynamic-placeholder .o_model_field_selector_popover_search input",
            run: "edit Summary",
        },
        {
            trigger:
                ".o-web-studio-field-dynamic-placeholder .o_model_field_selector_popover_item_name:contains(Summary)",
            run: "click",
        },
        {
            trigger:
                ".o-web-studio-field-dynamic-placeholder .o_model_field_selector_default_value_input input",
            run: "edit Some Summary",
        },
        {
            trigger: ".o-web-studio-field-dynamic-placeholder .o_model_field_selector_popover",
            run: "press Enter",
        },
        {
            trigger:
                ".o-web-studio-report-editor-wysiwyg :iframe .odoo-editor-editable table td span[t-field='x2many_record.summary']",
        },
        {
            trigger: ".o-web-studio-save-report.btn-primary",
            run: "click",
        },
        {
            trigger: ".o-web-studio-save-report:not(.btn-primary)",
        },
    ],
});

registry.category("web_tour.tours").add("web_studio.test_saving_xml_editor_reload", {
    steps: () => [
        {
            trigger: "button[name='report_edit_sources']",
            run: "click",
        },
        {
            trigger: ".o-web-studio-save-report:not(.btn-primary)",
        },
        {
            trigger: ".o_web_studio_xml_editor .ace_editor",
            run() {
                ace.edit(this.anchor)
                    .getSession()
                    .insert(
                        { row: 2, column: 0 },
                        '<span class="test-added-0">in document view</span>\n'
                    );
            },
        },
        {
            trigger: ".o-web-studio-save-report.btn-primary",
            run: "click",
        },
        {
            trigger: ".o-web-studio-save-report:not(.btn-primary)",
        },
        {
            trigger: ".o_web_studio_xml_editor .ace_editor",
            run() {
                const aceValue = ace.edit(this.anchor).getSession().getValue();

                assertEqual(
                    normalizeXML(aceValue),
                    normalizeXML(`
                        <t t-name="web_studio.test_report_document">
                            <div><p t-field="doc.name"/></div>
                            <span class="test-added-0">in document view</span>
                            <p><br/></p>
                        </t>`)
                );
            },
        },
    ],
});

registry.category("web_tour.tours").add("web_studio.test_error_at_loading", {
    steps: () => [
        {
            trigger: "body:not(:has(.o_error_dialog)) .o-web-studio-report-editor",
            run: "click",
        },
        {
            trigger: ":iframe div",
            run() {
                assertEqual(
                    this.anchor.textContent,
                    "The report could not be rendered due to an error"
                );
            },
        },
        {
            trigger: "button[name='report_edit_sources']",
            run: "click",
        },
        {
            trigger: ".o_web_studio_xml_editor",
        },
    ],
});

registry.category("web_tour.tours").add("web_studio.test_error_at_loading_debug", {
    steps: () => [
        {
            trigger: "body:not(:has(.o_error_dialog)) .o-web-studio-report-editor",
            run: "click",
        },
        {
            trigger: ".o-web-studio-report-container:not(:has(iframe))",
            run: "click",
        },
        {
            trigger: ".o-web-studio-report-container strong:contains(builtins.ValueError)",
            run: "click",
        },
        {
            trigger: "button[name='report_edit_sources']",
            run: "click",
        },
        {
            trigger: ".o_web_studio_xml_editor",
            run: "click",
        },
        {
            trigger: ".o-web-studio-report-container:not(:has(iframe))",
            run: "click",
        },
        {
            trigger:
                ".o-web-studio-report-container strong:contains(odoo.addons.base.models.ir_qweb.QWebException)",
        },
    ],
});

registry.category("web_tour.tours").add("web_studio.test_xml_and_form_diff", {
    steps: () => [
        {
            trigger: ".o-web-studio-report-editor-wysiwyg :iframe .odoo-editor-editable p:eq(2)",
            run() {
                insertText(this.anchor, "edited with odooEditor");
            },
        },
        {
            trigger: "button[name='report_edit_sources']",
            run: "click",
        },
        {
            trigger:
                ".o_web_studio_xml_resource_select_menu button.o_select_menu_toggler .o_select_menu_toggler_slot",
            run() {
                const currentViewKey = this.anchor.textContent.split(" (")[0];
                assertEqual(
                    currentViewKey,
                    "web_studio.report_editor_customization_diff.view._web_studio.test_report_document"
                );
            },
        },
        {
            trigger: ".o_web_studio_xml_resource_select_menu button.o_select_menu_toggler",
            run: "click",
        },
        {
            trigger:
                ".o-dropdown--menu .o_select_menu_item_label:contains(web_studio.test_report_document)",
            run: "click",
        },
        {
            trigger: "button[name='view_diff']",
            run: "click",
        },
        {
            trigger: ".o_form_view table.diff",
            run() {
                assertEqual(
                    document.querySelector(".o_form_view .o_field_widget[name='view_name']")
                        .textContent,
                    "web_studio.test_report_document"
                );
                assertEqual(
                    document.querySelector(
                        ".o_form_view .o_field_widget[name='compare_view_id'] input"
                    ).value,
                    "web_studio_backup__web_studio.test_report_document"
                );
            },
        },
    ],
});

registry.category("web_tour.tours").add("web_studio.test_record_model_differs_from_action", {
    steps: () => {
        const stepsToAssert = [];

        return [
            {
                trigger: ".o_studio_report_kanban_view",
                run() {
                    const { ReportEditorModel } = odoo.loader.modules.get(
                        "@web_studio/client_action/report_editor/report_editor_model"
                    );

                    patch(ReportEditorModel.prototype, {
                        async loadReportEditor() {
                            await super.loadReportEditor(...arguments);
                            stepsToAssert.push(
                                `report editor loaded. actionModel: "${this._services.studio.editedAction.res_model}". reportModel: "${this.reportResModel}"`
                            );
                        },
                    });
                },
            },
            {
                trigger: ".o_studio_report_kanban_view .o_searchview input",
                run: "fill dummy test",
            },
            {
                trigger:
                    ".o_studio_report_kanban_view .o_searchview .o_menu_item:contains(Report):contains(dummy test)",
                run: "click",
            },
            {
                trigger: ".o_facet_remove",
                run: "click",
            },
            {
                trigger: ".o_kanban_record:contains(dummy test)",
                run: "click",
            },
            {
                trigger: ".o-web-studio-report-editor-wysiwyg",
                run() {
                    assertEqual(
                        JSON.stringify(stepsToAssert),
                        JSON.stringify([
                            `report editor loaded. actionModel: "res.partner". reportModel: "x_dummy.test"`,
                        ])
                    );
                },
            },
        ];
    },
});

registry.category("web_tour.tours").add("web_studio.test_remove_branding_on_copy", {
    steps: () => [
        {
            trigger: "body :iframe .odoo-editor-editable#wrapwrap",
            async run() {
                const doc = this.anchor.ownerDocument;
                const editor = editorsWeakMap.get(doc);
                const originNode = this.anchor.querySelector(`[ws-view-id]`);
                const copy = originNode.cloneNode(true);
                originNode.insertAdjacentElement("afterend", copy);
                editor.shared.history.addStep();
                // Wait for a full macrotask tick and a frame to let the mutation observer
                // of the ReportEditorWysiwyg to catch up on the change and finish its operations
                await nextTick();
                const attributeCopy = {};
                for (const attr of copy.attributes) {
                    attributeCopy[attr.name] = attr.value;
                }
                assertEqual(JSON.stringify(attributeCopy), `{"contenteditable":"true"}`);
            },
        },
    ],
});

registry.category("web_tour.tours").add("web_studio.test_different_view_document_name", {
    steps: () => [
        {
            trigger: ".o_web_studio_sidebar button[name='report_edit_sources']",
            run: "click",
        },
        {
            trigger: ".o_web_studio_xml_resource_selector .o_select_menu_toggler",
            run: "click",
        },
        {
            trigger: ".o-dropdown--menu",
            run() {
                const sources = Array.from(this.anchor.querySelectorAll(".o_select_menu_item")).map(
                    (e) => e.textContent
                );
                assertEqual(
                    sources.includes(
                        "Uses: web_studio.test_report_document (web_studio.test_report_document_1)"
                    ),
                    true
                );
            },
        },
    ],
});

registry.category("web_tour.tours").add("web_studio.test_edit_main_arch", {
    steps: () => [
        {
            trigger: ":iframe .odoo-editor-editable .outside-t-call",
            async run() {
                const doc = this.anchor.ownerDocument;
                const editor = editorsWeakMap.get(doc);
                const newNode = doc.createElement("div");
                newNode.classList.add("added");
                this.anchor.insertAdjacentElement("beforebegin", newNode);
                editor.shared.history.addStep();
                await nextTick();
            },
        },
        {
            trigger: ".o-web-studio-save-report.btn-primary",
            run: "click",
        },
        {
            trigger: ".o-web-studio-save-report:not(.btn-primary)",
        },
    ],
});

registry.category("web_tour.tours").add("web_studio.test_edit_in_t_call", {
    steps: () => [
        {
            trigger: ":iframe .odoo-editor-editable .in-t-call",
            async run() {
                const doc = this.anchor.ownerDocument;
                const editor = editorsWeakMap.get(doc);
                const newNode = doc.createElement("div");
                newNode.classList.add("added");
                this.anchor.insertAdjacentElement("beforebegin", newNode);
                editor.shared.history.addStep();
                await nextTick();
            },
        },
        {
            trigger: ".o-web-studio-save-report.btn-primary",
            run: "click",
        },
        {
            trigger: ".o-web-studio-save-report:not(.btn-primary)",
        },
    ],
});

registry.category("web_tour.tours").add("web_studio.test_edit_main_and_in_t_call", {
    steps: () => [
        {
            trigger: ":iframe .odoo-editor-editable#wrapwrap",
            async run() {
                const doc = this.anchor.ownerDocument;
                const editor = editorsWeakMap.get(doc);
                const newNode0 = doc.createElement("div");
                newNode0.classList.add("added0");
                const target0 = this.anchor.querySelector(".outside-t-call");
                target0.insertAdjacentElement("beforebegin", newNode0);
                editor.shared.history.addStep();
                await nextTick();
                const newNode1 = doc.createElement("div");
                newNode1.classList.add("added1");
                const target1 = this.anchor.querySelector(".in-t-call");
                target1.insertAdjacentElement("beforebegin", newNode1);
                editor.shared.history.addStep();
                await nextTick();
            },
        },
        {
            trigger: ".o-web-studio-save-report.btn-primary",
            run: "click",
        },
        {
            trigger: ".o-web-studio-save-report:not(.btn-primary)",
        },
    ],
});

registry.category("web_tour.tours").add("web_studio.test_image_crop", {
    steps: () => [
        {
            trigger: "body :iframe .odoo-editor-editable .myimg",
            run: "click",
        },
        {
            trigger: ".o-we-toolbar button[name='image_crop']",
            run: "click",
        },
        {
            trigger: ".o-main-components-container .o_we_crop_widget .cropper-container",
        },
    ],
});

registry.category("web_tour.tours").add("web_studio.test_translations_are_copied", {
    steps: () => [
        {
            trigger: "body :iframe .odoo-editor-editable#wrapwrap div:contains(term2)",
            run() {
                const doc = this.anchor.ownerDocument;
                const editor = editorsWeakMap.get(doc);
                const newNode = doc.createElement("div");
                (newNode.textContent = "term3 from edition"),
                    this.anchor.insertAdjacentElement("beforebegin", newNode);
                editor.shared.history.addStep();
                return nextTick();
            },
        },
        {
            trigger: ".o-web-studio-save-report.btn-primary",
            run: "click",
        },
        {
            trigger: ".o-web-studio-save-report:not(.btn-primary)",
        },
    ],
});

registry.category("web_tour.tours").add("web_studio.test_reports_view_concurrence", {
    steps: () => [
        {
            trigger: ".o_menu_sections li:contains('Reports')",
            run: "click",
        },
        {
            trigger: ".o_kanban_record[data-id] ",
            run: "dblclick",
        },
        {
            trigger: ".o-web-studio-report-editor",
        },
    ],
});

registry.category("web_tour.tours").add("web_studio.test_dont_translate_on_save", {
    steps: () => [
        {
            trigger: "body :iframe .odoo-editor-editable#wrapwrap p.test-origin",
            async run() {
                const doc = this.anchor.ownerDocument;
                const el = doc.createElement("span");
                el.textContent = "new content";
                this.anchor.insertAdjacentElement("beforebegin", el);
                const editor = editorsWeakMap.get(doc);
                editor.shared.history.addStep();
                await nextTick();
            },
        },
        {
            trigger: ".o-web-studio-save-report.btn-primary",
            run: "click",
        },
        {
            trigger: ".o-web-studio-save-report:not(.btn-primary)",
        },
        {
            trigger: "body :iframe .odoo-editor-editable#wrapwrap span",
            run() {
                const doc = this.anchor.ownerDocument;
                const selection = doc.getSelection();
                selection.removeAllRanges();
                const range = doc.createRange();
                range.selectNode(this.anchor);
                selection.addRange(range);
            },
        },
        {
            trigger: ".o-we-toolbar button[name='bold']",
            run: "click",
        },
        {
            trigger: ".o-web-studio-save-report.btn-primary",
            run: "click",
        },
        {
            trigger: ".o-web-studio-save-report:not(.btn-primary)",
        },
    ],
});

registry.category("web_tour.tours").add("web_studio.test_do_not_delete_unspecial_spans", {
    steps: () => [
        {
            trigger: "body :iframe .odoo-editor-editable#wrapwrap span",
            run() {
                insertText(this.anchor, "added");
            },
        },
        {
            trigger: ".o-web-studio-save-report.btn-primary",
            run: "click",
        },
        {
            trigger: ".o-web-studio-save-report:not(.btn-primary)",
        },
    ],
});

registry.category("web_tour.tours").add("web_studio.test_edit_header_only_company", {
    steps: () => [
        {
            trigger: "body :iframe .odoo-editor-editable#wrapwrap .header img",
            run() {
                const el = this.anchor;
                const span = el.ownerDocument.createElement("span");
                span.classList.add("studio-added");
                el.insertAdjacentElement("afterend", span);
                openEditorPowerBox(span);
            },
        },
        {
            trigger: ".o-we-powerbox .o-we-command:contains(Insert a field)",
            run: "click",
        },
        {
            trigger: ".o_model_field_selector_popover_item_name:contains(Company ID)",
            run: "click",
        },
        {
            trigger: ".o_model_field_selector_default_value_input input",
            run: "edit studio company id",
        },
        {
            trigger: ".o_model_field_selector_popover button:contains(Insert)",
            run: "click",
        },
        {
            trigger:
                "body :iframe .odoo-editor-editable#wrapwrap .header [t-field]:contains(studio company id)",
        },
        {
            trigger: ".o-web-studio-save-report.btn-primary",
            run: "click",
        },
        {
            trigger: ".o-web-studio-save-report:not(.btn-primary)",
        },
    ],
});

return __exports;
});
;

/******************************************************************************
*  Filepath: /web_studio/static/tests/tours/web_studio_test_ui_unit_tours.js  *
*  Lines: 2009                                                                *
******************************************************************************/
odoo.define('@web_studio/../tests/tours/web_studio_test_ui_unit_tours', ['@web/core/registry', '@web_studio/../tests/tours/tour_helpers', '@odoo/hoot-dom', '@web/core/network/rpc'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module */
const { registry } = require("@web/core/registry");
const { stepNotInStudio, assertEqual } = require("@web_studio/../tests/tours/tour_helpers");
const { queryFirst, drag, waitFor } = require("@odoo/hoot-dom");
const { rpcBus } = require("@web/core/network/rpc");

registry
    .category("web_tour.tours")
    .add("web_studio_test_form_view_not_altered_by_studio_xml_edition", {
        url: "/odoo?debug=1",
        steps: () => [
            {
                trigger: "a[data-menu-xmlid='web_studio.studio_test_partner_menu']",
                run: "click",
            },
            {
                trigger: ".o_form_view .o_form_editable",
                run: "click",
            },
            {
                trigger: ".o_web_studio_navbar_item button:enabled",
                run: "click",
            },
            {
                trigger: ".o_web_studio_sidebar .o_web_studio_view",
                run: "click",
            },
            {
                trigger: ".o_web_studio_open_xml_editor",
                run: "click",
            },
            {
                trigger: ".o_web_studio_code_editor_info",
            },
            {
                trigger: ".o_web_studio_leave",
                run: "click",
            },
            ...stepNotInStudio(".o_form_view .o_form_editable"),
        ],
    });

/* global ace */
registry.category("web_tour.tours").add("web_studio_test_edit_with_xml_editor", {
    url: "/odoo?debug=1",
    steps: () => [
        {
            trigger: "a[data-menu-xmlid='web_studio.studio_test_partner_menu']",
            run: "click",
        },
        {
            trigger: ".someDiv:not(:visible)",
        },
        {
            trigger: ".o_web_studio_navbar_item button:enabled",
            run: "click",
        },
        {
            trigger: ".o_web_studio_sidebar .o_web_studio_view",
            run: "click",
        },
        {
            trigger: ".o_web_studio_open_xml_editor",
            run: "click",
        },
        {
            trigger: ".o_web_studio_xml_editor",
        },
        {
            trigger: ".o_web_studio_xml_resource_selector .o_select_menu_toggler",
            run: "click",
        },
        {
            trigger: ".o-dropdown--menu .o_select_menu_item:contains(Odoo Studio)",
            run: "click",
        },
        {
            trigger: ".ace_content",
            run() {
                ace.edit(document.querySelector(".ace_editor")).setValue("<data/>");
            },
        },
        {
            trigger: ".o_web_studio_xml_editor .o_web_studio_xml_resource_selector .btn-primary",
            run: "click",
        },
        {
            trigger: ".o_web_studio_snackbar:not(:has(.fa-spin))",
            run: "click",
        },
        {
            trigger: ".o_form_view",
            run() {
                if (document.querySelector(".someDiv")) {
                    throw new Error("The edition of the view's arch via the xml editor failed");
                }
            },
        },
    ],
});

registry.category("web_tour.tours").add("web_studio_enter_x2many_edition_and_add_field", {
    steps: () => [
        {
            trigger: "a[data-menu-xmlid='web_studio.studio_test_partner_menu']",
            run: "click",
        },
        {
            trigger: ".o_form_view .o_form_editable",
            run: "click",
        },
        {
            trigger: ".o_web_studio_navbar_item button:enabled",
            run: "click",
        },
        {
            trigger: ".o_web_studio_form_view_editor .o_field_widget[name='user_ids']",
            run: "click",
        },
        {
            trigger: ".o-web-studio-edit-x2manys-buttons",
        },
        {
            trigger: ".o_web_studio_editX2Many[data-type='form']",
            run: "click",
        },
        {
            trigger: ".o_view_controller.o_form_view.test-user-form",
        },
        {
            trigger: ".o_web_studio_sidebar .o_web_studio_existing_fields_header",
            run: "click",
        },
        {
            trigger: ".o_web_studio_existing_fields_section:not(.d-none)",
        },
        {
            trigger:
                ".o_web_studio_sidebar .o_web_studio_existing_fields_section .o_web_studio_component:contains(User log entries)",
            run() {
                queryFirst(
                    ".o_web_studio_sidebar .o_web_studio_existing_fields_section .o_web_studio_component:contains(User log entries)"
                ).scrollIntoView();
            },
        },
        {
            trigger:
                ".o_web_studio_sidebar .o_web_studio_existing_fields_section .o_web_studio_component:contains(User log entries)",
            run: "drag_and_drop(.o_web_studio_form_view_editor .o_web_studio_hook:eq(1))",
        },
        {
            trigger: ".o_web_studio_form_view_editor .o_field_widget[name='log_ids']",
            run() {
                const countFields = document.querySelectorAll(
                    ".o_web_studio_form_view_editor .o_field_widget"
                ).length;
                if (!countFields === 2) {
                    throw new Error("There should be 2 fields in the form view");
                }
            },
        },
    ],
});

registry.category("web_tour.tours").add("web_studio_enter_x2many_auto_inlined_subview", {
    steps: () => [
        {
            trigger: "a[data-menu-xmlid='web_studio.studio_test_partner_menu']",
            run: "click",
        },
        {
            trigger: ".o_form_view .o_form_editable",
            run: "click",
        },
        {
            trigger: ".o_web_studio_navbar_item button:enabled",
            run: "click",
        },
        {
            trigger:
                ".o_web_studio_form_view_editor .o_field_widget[name='user_ids'] .o_field_x2many_list",
            run: "click",
        },
        {
            trigger: ".o-web-studio-edit-x2manys-buttons",
        },
        {
            trigger: ".o_web_studio_editX2Many[data-type='list']",
            run: "click",
        },
        {
            trigger: ".o_view_controller.o_list_view.test-user-list",
        },
        {
            trigger: ".o_web_studio_sidebar .o_web_studio_existing_fields_header",
            run: "click",
        },
        {
            trigger: ".o_web_studio_existing_fields_section:not(.d-none)",
        },
        {
            trigger:
                ".o_web_studio_sidebar .o_web_studio_existing_fields_section .o_web_studio_component:contains(User log entries)",
            run() {
                queryFirst(
                    ".o_web_studio_sidebar .o_web_studio_existing_fields_section .o_web_studio_component:contains(User log entries)"
                ).scrollIntoView();
            },
        },
        {
            trigger:
                ".o_web_studio_sidebar .o_web_studio_existing_fields_section .o_web_studio_component:contains(User log entries)",
            run: "drag_and_drop(.o_web_studio_list_view_editor .o_web_studio_hook:eq(1))",
        },
        {
            trigger: ".o_web_studio_list_view_editor th[data-name='log_ids']",
            run() {
                const countFields = document.querySelectorAll(
                    ".o_web_studio_form_view_editor th[data-name]"
                ).length;
                if (!countFields === 2) {
                    throw new Error("There should be 2 fields in the form view");
                }
            },
        },
    ],
});

registry
    .category("web_tour.tours")
    .add("web_studio_enter_x2many_auto_inlined_subview_with_multiple_field_matching", {
        steps: () => [
            {
                trigger: "a[data-menu-xmlid='web_studio.studio_test_partner_menu']",
                run: "click",
            },
            {
                trigger: ".o_form_view .o_form_editable",
                run: "click",
            },
            {
                trigger: ".o_web_studio_navbar_item button:enabled",
                run: "click",
            },
            {
                trigger:
                    ".o_web_studio_form_view_editor .o_field_widget[name='user_ids']:eq(1) .o_field_x2many_list",
                run: "click",
            },
            {
                trigger: ".o-web-studio-edit-x2manys-buttons",
            },
            {
                trigger: ".o_web_studio_editX2Many[data-type='list']",
                run: "click",
            },
            {
                trigger: ".o_view_controller.o_list_view.test-user-list",
            },
            {
                trigger: ".o_web_studio_sidebar .o_web_studio_existing_fields_header",
                run: "click",
            },
            {
                trigger: ".o_web_studio_existing_fields_section:not(.d-none)",
            },
            {
                trigger:
                    ".o_web_studio_sidebar .o_web_studio_existing_fields_section .o_web_studio_component:contains(User log entries)",
                run() {
                    queryFirst(
                        ".o_web_studio_sidebar .o_web_studio_existing_fields_section .o_web_studio_component:contains(User log entries)"
                    ).scrollIntoView();
                },
            },
            {
                trigger:
                    ".o_web_studio_sidebar .o_web_studio_existing_fields_section .o_web_studio_component:contains(User log entries)",
                run: "drag_and_drop(.o_web_studio_list_view_editor .o_web_studio_hook:eq(1))",
            },
            {
                trigger: ".o_web_studio_list_view_editor th[data-name='log_ids']",
                run() {
                    const countFields = document.querySelectorAll(
                        ".o_web_studio_form_view_editor th[data-name]"
                    ).length;
                    if (!countFields === 2) {
                        throw new Error("There should be 2 fields in the form view");
                    }
                },
            },
        ],
    });

registry.category("web_tour.tours").add("web_studio_boolean_field_drag_and_drop", {
    steps: () => [
        {
            trigger: "a[data-menu-xmlid='web_studio.studio_test_partner_menu']",
            run: "click",
        },
        {
            trigger: ".o_form_view .o_form_editable",
            run: "click",
        },
        {
            trigger: ".o_web_studio_navbar_item button:enabled",
            run: "click",
        },
        {
            trigger: ".o_web_studio_sidebar .o_web_studio_new_fields .o_web_studio_field_boolean",
            run: "drag_and_drop(.o_web_studio_form_view_editor .o_web_studio_hook:eq(0))",
        },
        {
            trigger: ".o_web_studio_form_view_editor",
        },
        {
            trigger: ".o_wrap_field_boolean .o_wrap_label",
            run: "drag_and_drop(.o_web_studio_form_view_editor .o_web_studio_hook:eq(2))",
        },
        {
            trigger: ".o_wrap_label:eq(1):contains('New CheckBox')",
        },
    ],
});

registry.category("web_tour.tours").add("web_studio_field_with_group", {
    steps: () => [
        {
            trigger: "a[data-menu-xmlid='web_studio.studio_test_partner_menu']",
            run: "click",
        },
        {
            trigger: ".o_list_view",
            run: "click",
        },
        {
            trigger: ".o_web_studio_navbar_item button:enabled",
            run: "click",
        },
        {
            trigger: ".o_web_studio_list_view_editor th[data-name='function']",
        },
        {
            trigger: ".o_web_studio_sidebar .o_web_studio_existing_fields_header",
            run: "click",
        },
        {
            trigger: ".o_web_studio_existing_fields_section:not(.d-none)",
        },
        {
            trigger:
                ".o_web_studio_sidebar .o_web_studio_existing_fields_section .o_web_studio_component:contains(Website Link)",
            run() {
                queryFirst(
                    ".o_web_studio_sidebar .o_web_studio_existing_fields_section .o_web_studio_component:contains(Website Link)"
                ).scrollIntoView();
            },
        },
        {
            trigger:
                ".o_web_studio_sidebar .o_web_studio_existing_fields_section .o_web_studio_component:contains(Website Link)",
            run: "drag_and_drop(.o_web_studio_list_view_editor th.o_web_studio_hook:eq(2))",
        },
        {
            trigger:
                ".o_web_studio_list_view_editor th.o_web_studio_hook:not(.o_web_studio_nearest_hook)",
        },
        {
            trigger: ".o_web_studio_list_view_editor th[data-name='website']",
            run() {
                const countFields = document.querySelectorAll(
                    ".o_web_studio_list_view_editor th[data-name]"
                ).length;
                if (!countFields === 3) {
                    throw new Error("There should be 3 fields in the form view");
                }
            },
        },
    ],
});

registry.category("web_tour.tours").add("web_studio_set_tree_node_conditional_invisibility", {
    steps: () => [
        {
            trigger: "a[data-menu-xmlid='web_studio.studio_test_partner_menu']",
            run: "click",
        },
        {
            trigger: ".o_list_view",
        },
        {
            trigger: ".o_web_studio_navbar_item button:enabled",
            run: "click",
        },
        {
            trigger: ".o_web_studio_list_view_editor th[data-name='title']",
            run: "click",
        },
        {
            trigger: ".o_web_studio_attrs[data-type=invisible]",
            run: "click",
        },
        {
            trigger: ".o_model_field_selector_value",
            run: "click",
        },
        {
            trigger: ".o_model_field_selector_popover_item_name:contains('Display Name')",
            run: "click",
        },
        {
            trigger: ".o_tree_editor_condition input.o_input",
            run: "edit Robert && click body",
        },
        {
            trigger: ".modal-footer .btn-primary",
            run: "click",
        },
        {
            trigger: ".o_web_studio_list_view_editor th[data-name='title']",
        },
    ],
});

registry.category("web_tour.tours").add("web_studio_elements_with_groups_form", {
    steps: () => [
        {
            trigger: "a[data-menu-xmlid='web_studio.studio_test_partner_menu']",
            run: "click",
        },
        {
            trigger: ".o_form_view",
            run: "click",
        },
        {
            trigger: ".o_web_studio_navbar_item button:enabled",
            run: "click",
        },
        {
            trigger: ".o_web_studio_form_view_editor",
        },
        {
            trigger: ".o_web_studio_sidebar .o_web_studio_existing_fields_header",
            run: "click",
        },
        {
            trigger: ".o_web_studio_existing_fields_section:not(.d-none)",
        },
        {
            trigger:
                ".o_web_studio_sidebar .o_web_studio_existing_fields_section .o_web_studio_component:contains(Website Link)",
            run() {
                queryFirst(
                    ".o_web_studio_sidebar .o_web_studio_existing_fields_section .o_web_studio_component:contains(Website Link)"
                ).scrollIntoView();
            },
        },
        {
            trigger:
                ".o_web_studio_sidebar .o_web_studio_existing_fields_section .o_web_studio_component:contains(Website Link)",
            run: "drag_and_drop(.o_web_studio_form_view_editor .o_inner_group .o_web_studio_hook:eq(1))",
        },
        {
            trigger:
                ".o_web_studio_form_view_editor .o_web_studio_hook:not(.o_web_studio_nearest_hook)",
        },
        {
            trigger: ".o_web_studio_form_view_editor .o_field_widget[name='website']:not(:visible)",
            run() {
                const countFields = document.querySelectorAll(
                    ".o_web_studio_form_view_editor .o_field_widget[name]"
                ).length;
                if (!countFields === 2) {
                    throw new Error("There should be 2 fields in the form view");
                }
            },
        },
    ],
});

registry.category("web_tour.tours").add("test_element_group_in_sidebar", {
    steps: () => [
        {
            trigger: "a[data-menu-xmlid='web_studio.studio_test_partner_menu']",
            run: "click",
        },
        {
            trigger: ".o_form_view .o_form_editable",
            run: "click",
        },
        {
            trigger: ".o_web_studio_navbar_item button:enabled",
            run: "click",
        },
        {
            trigger: ".o_web_studio_form_view_editor .o_field_widget[name='display_name']",
        },
        {
            trigger: ".o_web_studio_form_view_editor .o_field_widget[name='display_name']",
            run: "click",
        },
        {
            trigger: ".o_field_many2many_tags[name='groups_id'] .badge",
            run() {
                const tag = document.querySelector(
                    ".o_field_many2many_tags[name='groups_id'] .badge"
                );
                if (!tag || !tag.textContent.includes("Test Group")) {
                    throw new Error("The groups should be displayed in the sidebar");
                }
            },
        },
    ],
});

registry.category("web_tour.tours").add("web_studio_custom_selection_field_edit_values", {
    steps: () => [
        {
            trigger: "a[data-menu-xmlid='web_studio.studio_test_partner_menu']",
            run: "click",
        },
        {
            trigger: ".o_form_view",
        },
        {
            trigger: ".o_web_studio_navbar_item button:enabled",
            run: "click",
        },
        {
            trigger: ".o_web_studio_sidebar .o_web_studio_new_fields .o_web_studio_field_selection",
            run: "drag_and_drop(.o_web_studio_hook:eq(0))",
        },
        {
            trigger: ".o_web_studio_add_selection .o-web-studio-interactive-list-item-input",
            run: "edit some value",
        },
        {
            trigger: ".modal-footer .btn-primary",
            run: "click",
        },
        {
            trigger: "body:not(:has(.modal))",
        },
        {
            trigger: ".o_web_studio_leave",
            run: "click",
        },
        {
            trigger: ".o_form_view",
        },
        {
            trigger: ".o_web_studio_navbar_item button:enabled",
            run: "click",
        },
        {
            trigger: ".o_web_studio_form_view_editor .o_wrap_input:has(.o_field_selection)",
            run: "click",
        },
        {
            trigger: ".o_web_studio_sidebar .o_web_studio_edit_selection_values",
            run: "click",
        },
        {
            trigger:
                ".modal:not(.o_inactive_modal) .o_web_studio_add_selection .o-web-studio-interactive-list-item-input",
            run: "edit another value cancel",
        },
        {
            trigger: ".o_web_studio_add_selection .o-web-studio-interactive-list-edit-item",
            run: "click",
        },
        {
            trigger: ".o_web_studio_selection_editor li:nth-child(2)",
            async run() {
                assertEqual(this.anchor.textContent, "another value cancel");
            },
        },
        {
            trigger: ".modal-footer .btn-secondary",
            run: "click",
        },
        {
            trigger: ".o_web_studio_sidebar .o_web_studio_edit_selection_values",
            run: "click",
        },
        {
            trigger: ".o_web_studio_selection_editor li",
            run() {
                assertEqual(this.anchor.textContent, "some value");
            },
        },
        {
            trigger:
                ".modal:not(.o_inactive_modal) .o_web_studio_add_selection .o-web-studio-interactive-list-item-input",
            run: "edit another value",
        },
        {
            trigger: ".modal-footer .btn-primary",
            run: "click",
        },
        {
            trigger: "body:not(:has(.modal))",
        },
        {
            trigger: ".o_web_studio_leave",
            run: "click",
        },
        ...stepNotInStudio(),
    ],
});

registry.category("web_tour.tours").add("web_studio_test_create_one2many_lines_then_edit_name", {
    steps: () => [
        {
            trigger: "a[data-menu-xmlid='web_studio.studio_test_partner_menu']",
            run: "click",
        },
        {
            trigger: ".o_form_view",
        },
        {
            trigger: ".o_web_studio_navbar_item button:enabled",
            run: "click",
        },
        {
            trigger: ".o_web_studio_sidebar .o_web_studio_new_fields .o_web_studio_field_lines",
            run: "drag_and_drop(.o_web_studio_hook:eq(0))",
        },
        {
            trigger: ".o_field_x2many_list",
        },
        {
            trigger: ".o_form_label",
            timeout: 20000,
            run: "click",
        },
        {
            trigger: ".o_web_studio_sidebar .o_web_studio_properties.active",
        },
        {
            trigger: "input[name='string']",
            run: "edit new name && click body",
        },
        {
            trigger: ".o_web_studio_leave",
            timeout: 20000,
            run: "click",
        },
        ...stepNotInStudio(".o_form_view"),
    ],
});

registry.category("web_tour.tours").add("web_studio_test_address_view_id_no_edit", {
    steps: () => [
        {
            trigger: "a[data-menu-xmlid='web_studio.studio_test_partner_menu']",
            run: "click",
        },
        {
            trigger: ".o_form_view",
        },
        {
            trigger: ".o_address_format",
            run: function () {
                if (
                    this.anchor.querySelectorAll("[name=lang]").length ||
                    !this.anchor.querySelectorAll("[name=street]").length
                ) {
                    throw new Error(
                        "The address view id set on the company country should be displayed"
                    );
                }
            },
        },
        {
            trigger: ".o_web_studio_navbar_item button:enabled",
            run: "click",
        },
        {
            trigger: ".o_web_studio_view_renderer",
        },
        {
            trigger: ".o_address_format",
            run: function () {
                if (
                    this.anchor.querySelectorAll("[name=street]").length ||
                    !this.anchor.querySelectorAll("[name=lang]").length
                ) {
                    throw new Error(
                        "The address view id set on the company country shouldn't be editable"
                    );
                }
            },
        },
        {
            trigger: ".o_field_widget[name='lang']",
            run: "click",
        },
        {
            trigger: ".o_web_studio_sidebar input[id='required']",
            run: "click",
        },
        {
            trigger: ".o_web_studio_snackbar .fa-check",
        },
        {
            trigger: ".o_address_format",
            run: function () {
                if (
                    this.anchor.querySelectorAll("[name=street]").length ||
                    !this.anchor.querySelectorAll("[name=lang]").length
                ) {
                    throw new Error(
                        "The address view id set on the company country shouldn't be editable"
                    );
                }
            },
        },
    ],
});

registry.category("web_tour.tours").add("web_studio_test_create_new_model_from_existing_view", {
    steps: () => [
        {
            trigger: "a[data-menu-xmlid='web_studio.studio_test_partner_menu']",
            run: "click",
        },
        {
            trigger: ".o_kanban_view",
        },
        {
            trigger: ".o_web_studio_navbar_item button:enabled",
            run: "click",
        },
        {
            trigger: ".o_web_create_new_model",
            run: "click",
        },
        {
            trigger: ".modal-dialog",
        },
        {
            trigger: "input[name='model_name']",
            run: "edit new model",
        },
        {
            trigger: ".confirm_button",
            run: "click",
        },
        {
            trigger: ".o_web_studio_model_configurator_next",
            run: "click",
        },
        {
            trigger: ".o_form_view",
        },
    ],
});

registry.category("web_tour.tours").add("web_studio_test_create_model_with_clickable_stages", {
    steps: () => [
        {
            trigger: "a[data-menu-xmlid='web_studio.studio_test_partner_menu']",
            run: "click",
        },
        {
            trigger: ".o_form_view",
        },
        {
            trigger: ".o_web_studio_navbar_item button:enabled",
            run: "click",
        },
        {
            trigger: ".o_web_create_new_model",
            run: "click",
        },
        {
            trigger: ".modal-dialog",
        },
        {
            trigger: "input[name='model_name']",
            run: "edit new model",
        },
        {
            trigger: ".modal:not(.o_inactive_modal) .confirm_button",
            run: "click",
        },
        {
            trigger: ".modal:not(.o_inactive_modal) .modal-body #use_stages",
            run: "check",
        },
        {
            trigger: ".modal:not(.o_inactive_modal) .o_web_studio_model_configurator_next",
            run: "click",
        },
        {
            content: "Wait the modal is closed before continue",
            trigger: "body:not(:has(.modal))",
        },
        {
            trigger: ".o_web_studio_leave",
            run: "click",
        },
        {
            trigger: ".o_form_view",
        },
        {
            trigger: "input#x_name_0",
            run: "edit new record",
        },
        {
            trigger: ".o_arrow_button:contains(In Progress)",
            run: "click",
        },
        {
            trigger: ".o_arrow_button_current:contains(In Progress)",
        },
        {
            trigger: ".o_form_button_save:not(:visible)",
            run: "click",
        },
        {
            // trigger: ".o_back_button", TODO: add breacrumb to access multi-record view when closing studio
            trigger: ".o_nav_entry:contains(new model)",
            run: "click",
        },
        {
            trigger:
                ".o_kanban_group:contains(In Progress) div[name=studio_auto_kanban_header] span.h5:contains(new record)",
        },
    ],
});

registry
    .category("web_tour.tours")
    .add("web_studio_test_enter_x2many_edition_with_multiple_subviews", {
        steps: () => [
            {
                trigger: "a[data-menu-xmlid='web_studio.studio_test_partner_menu']",
                run: "click",
            },
            {
                trigger: ".o_form_view span:contains('Address Type')",
            },
            {
                trigger: ".o_web_studio_navbar_item button:enabled",
                run: "click",
            },
            {
                trigger: ".o_list_renderer span:contains('Address Type')",
            },
            {
                trigger:
                    ".o_web_studio_form_view_editor .o_field_widget[name='child_ids'] .o_field_x2many_list",
                run: "click",
            },
            {
                trigger: ".o-web-studio-edit-x2manys-buttons",
            },
            {
                trigger: ".o_web_studio_editX2Many[data-type='list']",
                run: "click",
            },
            {
                trigger: ".o_content > .o_list_renderer span:contains('Address Type')",
            },
        ],
    });

registry
    .category("web_tour.tours")
    .add("web_studio_test_enter_x2many_edition_with_multiple_subviews_correct_xpath", {
        steps: () => [
            {
                trigger: "a[data-menu-xmlid='web_studio.studio_test_partner_menu']",
                run: "click",
            },
            {
                trigger: ".o_form_view",
            },
            {
                trigger: ".o_web_studio_navbar_item button:enabled",
                run: "click",
            },
            {
                trigger:
                    ".o_web_studio_form_view_editor .o_field_widget[name='child_ids'] .o_field_x2many_list",
                run: "click",
            },
            {
                trigger: ".o-web-studio-edit-x2manys-buttons",
            },
            {
                trigger: ".o_web_studio_editX2Many[data-type='list']",
                run: "click",
            },
            {
                trigger: ".o_view_controller.o_list_view.test-subview-list",
            },
            {
                trigger: ".o_web_studio_sidebar .o_web_studio_existing_fields_header",
                run: "click",
            },
            {
                trigger: ".o_web_studio_sidebar .o_web_studio_existing_fields_section",
            },
            {
                trigger: `.o_web_studio_sidebar .o_web_studio_existing_fields_section .o_web_studio_component[data-drop='${JSON.stringify(
                    { fieldName: "active" }
                )}']`,
                run: "drag_and_drop(.o_web_studio_hook:eq(0))",
            },
            {
                content: "Check that the active field has been added",
                trigger: ".o_web_studio_view_renderer .o_list_view thead th[data-name='active']",
            },
        ],
    });

registry.category("web_tour.tours").add("web_studio_test_studio_view_is_last", {
    steps: () => [
        {
            trigger: "a[data-menu-xmlid='web_studio.studio_test_partner_menu']",
            run: "click",
        },
        {
            trigger: ".o_form_view",
        },
        {
            trigger: ".o_web_studio_navbar_item button:enabled",
            run: "click",
        },
        {
            trigger: ".o_web_studio_sidebar .o_web_studio_existing_fields_header",
            run: "click",
        },
        {
            trigger: ".o_web_studio_existing_fields_section:not(.d-none)",
        },
        {
            trigger:
                ".o_web_studio_sidebar .o_web_studio_existing_fields_section .o_web_studio_component:contains(Website Link)",
            run() {
                queryFirst(
                    ".o_web_studio_sidebar .o_web_studio_existing_fields_section .o_web_studio_component:contains(Website Link)"
                ).scrollIntoView();
            },
        },
        {
            trigger:
                ".o_web_studio_sidebar .o_web_studio_existing_fields_section .o_web_studio_component:contains(Website Link)",
            run: "drag_and_drop(.o_web_studio_form_view_editor .o_inner_group .o_web_studio_hook:last)",
        },
        {
            trigger: ".o_web_studio_form_view_editor .o_field_widget[name='website']:not(:visible)",
        },
    ],
});

registry.category("web_tour.tours").add("web_studio_test_edit_form_subview_attributes", {
    steps: () => [
        {
            trigger: "a[data-menu-xmlid='web_studio.studio_test_partner_menu']",
            run: "click",
        },
        {
            trigger: ".o_form_view",
        },
        {
            trigger: ".o_web_studio_navbar_item button:enabled",
            run: "click",
        },
        {
            trigger:
                ".o_web_studio_form_view_editor .o_field_widget[name='child_ids'] .o_field_x2many_list",
            run: "click",
        },
        {
            trigger: ".o-web-studio-edit-x2manys-buttons",
        },
        {
            trigger: ".o_web_studio_editX2Many[data-type='form']",
            run: "click",
        },
        {
            trigger: ".o_view_controller.o_form_view.test-subview-form",
        },
        {
            trigger: ".o_web_studio_sidebar.o_notebook .nav-link:contains(View)",
            run: "click",
        },
        {
            trigger: ".o_web_studio_sidebar input[name='create']:checked",
            run: "click",
        },
        {
            trigger: ".o_web_studio_sidebar input[name='create']:not(:checked)",
        },
    ],
});

registry.category("web_tour.tours").add("web_studio_x2many_two_levels_edition", {
    steps: () => [
        {
            trigger: "a[data-menu-xmlid='web_studio.studio_test_partner_menu']",
            run: "click",
        },
        {
            trigger: ".o_form_view .o_form_editable",
            run: "click",
        },
        {
            trigger: ".o_web_studio_navbar_item button:enabled",
            run: "click",
        },
        {
            trigger: ".o_web_studio_form_view_editor .o_field_widget[name='user_ids']",
            run: "click",
        },
        {
            trigger: ".o-web-studio-edit-x2manys-buttons",
        },
        {
            trigger: ".o_web_studio_editX2Many[data-type='form']",
            run: "click",
        },
        {
            trigger: ".o_view_controller.o_form_view.test-subview-form-1",
        },
        {
            trigger: ".o_web_studio_form_view_editor .o_field_widget[name='log_ids']",
            run: "click",
        },
        {
            trigger: ".o_web_studio_editX2Many[data-type='form']",
            run: "click",
        },
        {
            trigger: ".o_view_controller.o_form_view.test-subview-form-2",
        },
        {
            trigger: ".o_web_studio_sidebar .o_web_studio_existing_fields_header",
            run: "click",
        },
        {
            trigger: ".o_web_studio_existing_fields",
        },
        {
            trigger:
                ".o_web_studio_sidebar .o_web_studio_existing_fields_section .o_web_studio_component:contains(Created on)",
            run: "drag_and_drop .o_web_studio_hook",
        },
        {
            trigger: ".o_web_studio_form_view_editor [data-field-name='create_date']",
        },
    ],
});

registry.category("web_tour.tours").add("web_studio_field_group_studio_no_fetch", {
    steps: () => [
        {
            trigger: "a[data-menu-xmlid='web_studio.studio_test_partner_menu']",
            run: "click",
        },
        {
            trigger: ".o_form_view .o_form_editable",
            run: "click",
        },
        {
            trigger: ".o_web_studio_navbar_item button:enabled",
            run: "click",
        },
        {
            trigger: ".o_web_studio_form_view_editor",
            run() {
                assertEqual(this.anchor.querySelectorAll(".o_field_widget").length, 1);
                assertEqual(
                    this.anchor.querySelectorAll(".o_field_widget")[0].dataset.studioXpath,
                    "/form[1]/field[2]"
                );
            },
        },
        {
            trigger: ".o_web_studio_views_icons a[title='List']",
            run: "click",
        },
        {
            trigger: ".o_web_studio_list_view_editor",
            run() {
                assertEqual(this.anchor.querySelectorAll("th:not(.o_web_studio_hook)").length, 1);
                assertEqual(
                    this.anchor.querySelectorAll("th:not(.o_web_studio_hook)")[0].dataset
                        .studioXpath,
                    "/list[1]/field[2]"
                );
            },
        },
        {
            trigger: ".o_web_studio_views_icons a[title='Kanban']",
            run: "click",
        },
        {
            trigger: ".o_web_studio_kanban_view_editor",
            run() {
                assertEqual(
                    this.anchor.querySelectorAll(
                        ".o_kanban_record:not(.o_kanban_demo):not(.o_kanban_ghost) .o-web-studio-editor--element-clickable"
                    ).length,
                    1
                );
                assertEqual(
                    this.anchor
                        .querySelectorAll(
                            ".o_kanban_record:not(.o_kanban_demo):not(.o_kanban_ghost) .o-web-studio-editor--element-clickable"
                        )[0]
                        .getAttribute("studioxpath"),
                    "/kanban[1]/t[1]/field[2]"
                );
            },
        },
    ],
});

registry.category("web_tour.tours").add("web_studio_test_move_similar_field", {
    steps: () => [
        {
            trigger: "a[data-menu-xmlid='web_studio.studio_test_partner_menu']",
            run: "click",
        },
        {
            trigger: ".o_form_view",
        },
        {
            trigger: ".o_web_studio_navbar_item button:enabled",
            run: "click",
        },
        {
            trigger: ".o_web_studio_form_view_editor",
        },
        {
            trigger: ".o_notebook_headers a:contains('two')",
            run: "click",
        },
        {
            trigger: ".tab-pane.active [data-field-name=display_name]",
            run: "drag_and_drop(.o_web_studio_form_view_editor .o_web_studio_hook:eq(1))",
        },
        {
            trigger: ".o_web_studio_leave",
        },
    ],
});

registry.category("web_tour.tours").add("web_studio_test_related_file", {
    steps: () => [
        {
            trigger: "a[data-menu-xmlid='web_studio.studio_test_user_menu']",
            run: "click",
        },
        {
            trigger: ".o_form_view",
        },
        {
            content: "second",
            trigger: ".o_web_studio_navbar_item button:enabled",
            run: "click",
        },
        {
            trigger: ".o_web_studio_form_view_editor",
        },
        {
            trigger: ".o_web_studio_field_related",
            run: "drag_and_drop(.o_inner_group)",
        },
        {
            trigger: ".modal-dialog",
        },
        {
            trigger: ".o_model_field_selector_value",
            run: "click",
        },
        {
            trigger: ".o_model_field_selector_popover",
        },
        {
            trigger: ".o_model_field_selector_popover_search input",
            run: "edit Related Partner",
        },
        {
            trigger: "[data-name=partner_id] > button.o_model_field_selector_popover_item_relation",
            run: "click",
        },
        {
            trigger: ".o_model_field_selector_popover_title:contains(Related Partner)",
        },
        {
            trigger: ".o_model_field_selector_popover_search input",
            run: "edit New File",
        },
        {
            trigger:
                ".o_model_field_selector_popover_item_name:contains(New File):not(:contains(filename))",
            run: "click",
        },
        {
            trigger: ".modal-footer .btn-primary:first",
            run: "click",
        },
        {
            trigger: ".o_web_studio_leave",
        },
    ],
});

registry.category("web_tour.tours").add("web_studio_test_undo_new_field", {
    steps: () => [
        {
            trigger: "a[data-menu-xmlid='web_studio.studio_test_partner_menu']",
            run: "click",
        },
        {
            trigger: ".o_form_view .o_form_editable",
            run: "click",
        },
        {
            trigger: ".o_web_studio_navbar_item button:enabled",
            run: "click",
        },
        {
            trigger: ".o_web_studio_sidebar .o_web_studio_new_fields .o_web_studio_field_integer",
            run: "drag_and_drop(.o_web_studio_form_view_editor .o_web_studio_hook:eq(1))",
        },
        {
            trigger: "button.o_web_studio_undo.o_web_studio_active",
            run: "click",
        },
        {
            trigger: ".o_web_studio_leave",
        },
    ],
});

registry.category("web_tour.tours").add("web_studio_test_change_lone_attr_modifier_form", {
    steps: () => [
        {
            trigger: "a[data-menu-xmlid='web_studio.studio_test_partner_menu']",
            run: "click",
        },
        {
            trigger: ".o_form_view",
        },
        {
            trigger: ".o_web_studio_navbar_item button:enabled",
            run: "click",
        },
        {
            trigger: ".o_web_studio_form_view_editor",
        },
        {
            trigger: ".o_field_widget[name='name']",
            run: "click",
        },
        {
            trigger: `.o_web_studio_sidebar input[name="required"]`,
        },
        {
            trigger: ".o_web_studio_sidebar",
            run() {
                const required = this.anchor.querySelector(`input[name="required"]`);
                assertEqual(required.checked, true);
            },
        },
        {
            trigger: '.o_web_studio_sidebar input[name="required"]',
            run: "click",
        },
        {
            trigger: ".o_web_studio_form_view_editor:not(:has(.o_required_modifier))",
        },
        {
            trigger: ".o_web_studio_sidebar",
            run() {
                const required = this.anchor.querySelector(`input[name="required"]`);
                assertEqual(required.checked, false);
            },
        },
    ],
});

registry.category("web_tour.tours").add("web_studio_test_new_field_rename_description", {
    steps: () => [
        {
            trigger: "a[data-menu-xmlid='web_studio.studio_test_partner_menu']",
            run: "click",
        },
        {
            trigger: ".o_form_view",
        },
        {
            trigger: ".o_web_studio_navbar_item button:enabled",
            run: "click",
        },
        {
            trigger: ".o_web_studio_form_view_editor",
        },
        {
            trigger: ".o_web_studio_sidebar .o_web_studio_component.o_web_studio_field_char",
            run: "drag_and_drop(.o_web_studio_form_view_editor .o_web_studio_hook:eq(1))",
        },
        {
            trigger: ".o_web_studio_sidebar input[name='string']",
            run: "edit my new field && click body",
        },
        {
            trigger:
                ".o_web_studio_form_view_editor label[for='x_studio_my_new_field_0']:contains(my new field)",
        },
    ],
});

registry.category("web_tour.tours").add("web_studio_test_edit_digits_option", {
    url: "/odoo",
    steps: () => [
        {
            trigger: "a[data-menu-xmlid='web_studio.studio_test_partner_menu']",
            run: "click",
        },
        {
            trigger: ".o_form_view .o_form_editable",
            run: "click",
        },

        {
            trigger: ".o_web_studio_navbar_item button:enabled",
            run: "click",
        },
        {
            trigger: ".o_web_studio_view_renderer",
        },
        {
            trigger: "[name=partner_latitude]",
            run: "click",
        },
        {
            trigger: "input#digits",
            run: "edit 2 && click body",
        },
        {
            trigger: ".o_web_studio_leave",
        },
    ],
});

registry.category("web_tour.tours").add("web_studio_no_fetch_subview", {
    steps: () => [
        {
            trigger: "a[data-menu-xmlid='web_studio.studio_test_partner_menu']",
            run: "click",
        },
        {
            trigger: "input#name_0",
            run: "edit value",
        },
        {
            trigger: "button.o_form_button_save",
            run: "click",
        },
        {
            trigger: ".o_form_view",
        },
        {
            trigger: ".o_web_studio_navbar_item button:enabled",
            run: "click",
        },
        {
            trigger: ".o_web_studio_sidebar .o_web_studio_new_fields .o_web_studio_field_many2many",
            run: "drag_and_drop(.o_web_studio_form_view_editor .o_web_studio_hook:eq(0))",
        },
        {
            trigger: ".o_record_selector input",
            run: "edit Contact",
        },
        {
            trigger: "a.dropdown-item:contains(Contact)",
            run: "click",
        },
        {
            trigger: ".modal-footer button.btn-primary",
            run: "click",
        },
        {
            trigger: ".o_wrap_field label:contains('New Many2Many')",
        },
    ],
});

registry.category("web_tour.tours").add("web_studio.test_button_rainbow_effect", {
    steps: () => [
        {
            trigger: "a[data-menu-xmlid='web_studio.studio_test_partner_menu']",
            run: "click",
        },
        {
            trigger: ".o_form_view .o_form_editable",
            run: "click",
        },
        {
            trigger: ".o_web_studio_navbar_item button:enabled",
            run: "click",
        },
        {
            trigger: `.o_web_studio_view_renderer button[name="open_commercial_entity"]`,
            run: "click",
        },
        {
            trigger: ".o_web_studio_sidebar #effect",
            run: "click",
        },
        {
            trigger: ".o_web_studio_sidebar #rainbow_message",
        },
        {
            trigger: ".o_web_studio_sidebar",
            run() {
                const blob = new Blob(
                    [
                        "iVBORw0KGgoAAAANSUhEUgAAAAIAAAACCAIAAAD91JpzAAAAF0lEQVR4nGJxKFrEwMDAxAAGgAAAAP//D+IBWx9K7TUAAAAASUVORK5CYII=",
                    ],
                    { type: "image/png" }
                );
                const file = new File([blob], "my_studio_image.png");

                const fileInput = document.querySelector(
                    ".o_web_studio_sidebar .o_file_input input"
                );
                const dataTransfer = new DataTransfer();
                dataTransfer.items.add(file);
                fileInput.files = dataTransfer.files;
                fileInput.dispatchEvent(new Event("change"));
            },
        },
        {
            trigger: ".o_web_studio_sidebar img[src^='/web/content']",
        },
    ],
});

registry.category("web_tour.tours").add("web_studio.test_res_users_fake_fields", {
    steps: () => [
        {
            trigger: ".o_web_studio_existing_fields_header",
            run: "click",
        },
        {
            trigger: ".o_web_studio_existing_fields",
            run() {
                const elements = [...document.querySelectorAll(".o_web_studio_component")];
                const fieldStrings = elements.map((el) => el.innerText.split("\n")[0]);
                assertEqual(fieldStrings.includes("Administration"), false);
                assertEqual(fieldStrings.includes("Multi Companies"), false);
            },
        },
    ],
});

registry.category("web_tour.tours").add("web_studio_test_reload_after_restoring_default_view", {
    steps: () => [
        {
            trigger: "a[data-menu-xmlid='web_studio.studio_test_partner_menu']",
            run: "click",
        },
        {
            trigger: ".o_form_view",
        },
        {
            trigger: ".o_web_studio_navbar_item button:enabled",
            run: "click",
        },
        {
            trigger: ".o_web_studio_form_view_editor .o_field_widget[name='name']",
            run: "click",
        },
        {
            trigger: ".o_web_studio_sidebar input[name='string']",
            run: "edit new name",
        },
        {
            trigger: ".o_web_studio_sidebar .o_web_studio_view",
            run: "click",
        },
        {
            trigger: ".o_web_studio_restore",
            run: "click",
        },
        {
            trigger: ".modal-footer .btn-primary",
            run: "click",
        },
        {
            trigger: ".o_web_studio_undo:not(.o_web_studio_active)",
        },
        {
            trigger:
                ".o_web_studio_form_view_editor .o_field_widget[name='name'] span:contains('Name')",
        },
    ],
});

registry.category("web_tour.tours").add("web_studio_test_edit_reified_field", {
    steps: () => [
        {
            trigger: "a[data-menu-xmlid='web_studio.studio_test_partner_menu']",
            run: "click",
        },
        {
            trigger: ".o_form_view",
        },
        {
            trigger: ".o_web_studio_navbar_item button:enabled",
            run: "click",
        },
        {
            trigger:
                ".o_web_studio_form_view_editor .o_field_widget[name^='sel_groups_'],.o_web_studio_form_view_editor .o_field_widget[name^='in_groups_']",
            run: "click",
        },
        {
            trigger: ".o_web_studio_sidebar input[name='string']",
            run: "edit new name && click body",
        },
        {
            trigger: ".o_web_studio_leave",
        },
    ],
});

registry.category("web_tour.tours").add("web_studio_test_add_all_types_fields_related", {
    steps: () => [
        {
            trigger: "a[data-menu-xmlid='web_studio.studio_test_user_menu']",
            run: "click",
        },
        {
            trigger: ".o_form_view",
        },
        {
            trigger: ".o_web_studio_navbar_item button:enabled",
            run: "click",
        },
        {
            trigger: ".o_web_studio_form_view_editor",
        },
        {
            trigger: ".o_web_studio_field_related",
            run: "drag_and_drop(.o_inner_group)",
        },
        {
            trigger: ".modal-dialog",
        },
        {
            trigger: ".o_model_field_selector_value",
            run: "click",
        },
        {
            trigger: ".o_model_field_selector_popover",
        },
        {
            trigger: ".o_model_field_selector_popover_search input",
            run: "edit Display Name",
        },
        {
            trigger: ".o_model_field_selector_popover_item_name:contains(Display Name)",
            run: "click",
        },
        {
            trigger: ".modal-footer .btn-primary:first",
            run: "click",
        },
        {
            trigger: ".o_web_studio_leave",
        },
    ],
});

registry.category("web_tour.tours").add("web_studio_add_one2many_no_related_many2one", {
    steps: () => [
        {
            trigger: ".o_home_menu_background",
        },
        {
            trigger: ".o_main_navbar .o_web_studio_navbar_item",
            run: "click",
        },
        {
            trigger: ".o_web_studio_new_app",
        },
        {
            trigger: ".o_app[data-menu-xmlid='web_studio.studio_app_menu']",
            run: "click",
        },
        {
            trigger: ".o_web_studio_sidebar .o_web_studio_field_one2many",
            run: "drag_and_drop .o_web_studio_form_view_editor .o_inner_group",
        },
        {
            trigger: "h4.modal-title",
            run() {
                assertEqual(this.anchor.textContent, "No related many2one fields found");
            },
        },
        {
            trigger: ".modal-footer .btn.btn-primary",
            run: "click",
        },
    ],
});

registry.category("web_tour.tours").add("web_studio_test_approval_button_xml_id", {
    steps: () => [
        {
            trigger: "a[data-menu-xmlid='web_studio.studio_test_partner_menu']",
            run: "click",
        },
        {
            trigger: ".o_form_view",
        },
        {
            trigger: ".o_web_studio_navbar_item button:enabled",
            run: "click",
        },
        {
            trigger: ".o_web_studio_form_view_editor button[name='base.action_model_data']",
            run: "click",
        },
        {
            trigger: ".o_web_studio_sidebar [name='create_approval_rule']",
            run: "click",
        },
        {
            trigger: ".o_web_studio_view_renderer .o_web_studio_approval_avatar",
        },
        {
            trigger: ".o_web_studio_sidebar .o_approval_group #approval_group_id",
        },
    ],
});

registry.category("web_tour.tours").add("web_studio_test_kanban_field_bold", {
    steps: () => [
        {
            trigger: "a[data-menu-xmlid='web_studio.studio_test_partner_menu']",
            run: "click",
        },
        {
            trigger: ".o_kanban_view",
        },
        {
            trigger: ".o_web_studio_navbar_item button:enabled",
            run: "click",
        },
        // first field has class fw-bold
        {
            trigger:
                ".o_web_studio_view_renderer .o_kanban_record .o-web-studio-editor--element-clickable",
            run: "click",
        },
        {
            trigger:
                ".o_web_studio_sidebar .o_web_studio_property input#class:value(fs-6 fw-bold whatever)",
        },
        {
            trigger:
                ".o_web_studio_sidebar .o_web_studio_property input[type=checkbox]#bold:checked",
        },
        {
            trigger: ".o_web_studio_sidebar .o_web_studio_property input[type=checkbox]#bold",
            run: "click",
        },
        {
            trigger:
                ".o_web_studio_sidebar .o_web_studio_property input#class:value(fs-6 whatever)",
        },
        {
            trigger:
                ".o_web_studio_sidebar .o_web_studio_property input[type=checkbox]#bold:not(:checked)",
        },
        // second field has class fw-bolder
        {
            trigger:
                ".o_web_studio_view_renderer .o_kanban_record .o-web-studio-editor--element-clickable:eq(1)",
            run: "click",
        },
        {
            trigger: ".o_web_studio_sidebar .o_web_studio_property input#class:value(fw-bolder)",
        },
        {
            trigger:
                ".o_web_studio_sidebar .o_web_studio_property input[type=checkbox]#bold:checked",
        },
        // third field isn't bold
        {
            trigger:
                ".o_web_studio_view_renderer .o_kanban_record .o-web-studio-editor--element-clickable:eq(2)",
            run: "click",
        },
        {
            trigger: ".o_web_studio_sidebar .o_web_studio_property input#class:value(text-muted)",
        },
        {
            trigger:
                ".o_web_studio_sidebar .o_web_studio_property input[type=checkbox]#bold:not(:checked)",
        },
        {
            trigger: ".o_web_studio_sidebar .o_web_studio_property input[type=checkbox]#bold",
            run: "click",
        },
        {
            trigger: ".o_web_studio_sidebar .o_web_studio_property input#class:value(fw-bold)",
        },
        {
            trigger:
                ".o_web_studio_sidebar .o_web_studio_property input[type=checkbox]#bold:checked",
        },
    ],
});

async function animationFrame(timeoutBefore) {
    await new Promise((resolve) => setTimeout(resolve, timeoutBefore));
    await new Promise(requestAnimationFrame);
}

registry.category("web_tour.tours").add("web_studio_test_kanban_menu_ribbon", {
    steps: () => [
        {
            trigger: "a[data-menu-xmlid='web_studio.studio_test_partner_menu']",
            run: "click",
        },
        {
            trigger: ".o_kanban_view",
        },
        {
            trigger: ".o_web_studio_navbar_item button:enabled",
            run: "click",
        },
        {
            trigger: ".o_web_studio_view_renderer .o_kanban_view",
        },
        {
            trigger: ".nav .o_web_studio_new",
            run: "click",
        },
        {
            trigger: ".nav .o_web_studio_new.active",
            run() {
                return waitFor(".o_web_studio_component.o_web_studio_field_menu", {
                    timeout: 3000,
                });
            },
        },
        {
            trigger: ".o_web_studio_view_renderer .o_web_studio_hook[data-type='t']",
        },
        {
            trigger: ".o_web_studio_component.o_web_studio_field_menu",
            async run() {
                await animationFrame();
                const { drop, moveTo } = await drag(this.anchor);
                await moveTo(".o_kanban_record:first");
                await animationFrame(500); // wait for animations to finish in under 500ms
                const target = await waitFor(".o_web_studio_hook_visible", {
                    visible: true,
                    timeout: 5000,
                });
                await moveTo(target, { interactive: false });
                await drop();
            },
        },
        {
            trigger: ".o_kanban_view .o_kanban_record:first() .o_dropdown_kanban",
        },
        {
            trigger: ".o_web_studio_component.o_web_studio_field_ribbon",
            run: "drag_and_drop(.o_web_studio_hook[data-type='ribbon'])",
        },
        {
            trigger:
                ".o_kanban_view .o_kanban_record:first() .o_widget_web_ribbon .ribbon:contains(demo)",
        },
    ],
});

registry.category("web_tour.tours").add("web_studio_test_create_related", {
    steps: () => [
        {
            trigger: "a[data-menu-xmlid='web_studio.studio_test_partner_menu']",
            run: "click",
        },
        {
            trigger: ".o_form_view",
        },
        {
            trigger: ".o_web_studio_navbar_item button:enabled",
            run: "click",
        },
        {
            trigger: ".o_web_studio_view_renderer .o_form_view",
        },
        {
            trigger: ".o_web_studio_component.o_web_studio_field_related",
            run: "drag_and_drop (.o_web_studio_hook:last())",
        },
        {
            trigger: ".modal .o_model_field_selector_value",
            run: "click",
        },
        {
            trigger: ".o_model_field_selector_popover_search input",
            run: "edit Related Company",
        },
        {
            trigger:
                ".o_model_field_selector_popover_item[data-name='parent_id'] .o_model_field_selector_popover_relation_icon",
            run: "click",
        },
        {
            trigger: ".o_model_field_selector_popover_title:contains(Related Company)",
        },
        {
            trigger: ".o_model_field_selector_popover_search input",
            run: "edit Contact",
        },
        {
            trigger:
                ".o_model_field_selector_popover_item[data-name='child_ids'] .o_model_field_selector_popover_item_name",
            run: "click",
        },
        {
            trigger: ".modal footer button.btn-primary",
            run: "click",
        },
        {
            trigger: ".o_web_studio_view_renderer .o_field_widget.o_field_one2many",
        },
    ],
});

registry.category("web_tour.tours").add("web_studio_test_negated_groups", {
    steps: () => [
        {
            trigger: "a[data-menu-xmlid='web_studio.studio_test_partner_menu']",
            run: "click",
        },
        {
            trigger: ".o_form_view",
        },
        {
            trigger: ".o_web_studio_navbar_item button:enabled",
            run: "click",
        },
        {
            trigger: ".o_web_studio_sidebar .o_web_studio_view",
            run: "click",
        },
        {
            trigger: ".o_web_studio_sidebar input#show_invisible",
            run: "click",
        },
        {
            trigger: ".o_web_studio_form_view_editor .o-web-studio-editor--element-clickable",
            run: "click",
        },
        {
            trigger:
                ".o_web_studio_sidebar [name='negated_groups_id'] .o_badge:contains(studio has group)",
        },
        {
            trigger: ".o_web_studio_sidebar [name='negated_groups_id'] .o_delete",
            run: "click",
        },
        {
            trigger:
                ".o_web_studio_sidebar [name='negated_groups_id']:not(:contains(studio has group))",
        },
        {
            trigger: ".o_web_studio_sidebar [name='negated_groups_id'] input",
            run: "edit Access Rights",
        },
        {
            trigger: "a.dropdown-item:contains(Administration / Access Rights)",
            run: "click",
        },
        {
            trigger:
                ".o_web_studio_sidebar [name='negated_groups_id'] .o_badge:contains(Administration / Access Rights)",
        },
    ],
});

registry.category("web_tour.tours").add("web_studio_test_use_action_domain", {
    steps: () => [
        {
            trigger: "a[data-menu-xmlid='web_studio.studio_test_partner_menu']",
            run: "click",
        },
        {
            trigger: ".o_list_view",
        },
        {
            trigger: ".o_web_studio_navbar_item button",
            run: "click",
        },
        {
            trigger: ".o_web_studio_sidebar",
        },
        {
            trigger: ".o_list_table",
            run() {
                const names = Array.from(
                    document.querySelectorAll(".o_list_table td[name=display_name]")
                ).map((e) => e.textContent);
                if (names.length !== 1 || names[0] !== "Michel") {
                    throw new Error("record with employee=false should not be matched");
                }
            },
        },
    ],
});

registry.category("web_tour.tours").add("web_studio_test_drag_before_sheet", {
    steps: () => [
        {
            trigger: "a[data-menu-xmlid='web_studio.studio_test_partner_menu']",
            run: "click",
        },
        {
            trigger: ".o_form_view .o_form_editable",
            run: "click",
        },
        {
            trigger: ".o_web_studio_navbar_item button",
            run: "click",
        },
        {
            trigger: ".o_web_studio_sidebar .o_web_studio_new_fields .o_web_studio_field_html",
            run: "drag_and_drop (.o_web_studio_form_view_editor .o_web_studio_hook:eq(0))",
        },
        {
            trigger: "button.o_web_studio_undo.o_web_studio_active",
            run() {},
        },
        {
            trigger: ".o_web_studio_leave",
            run() {},
        },
    ],
});

registry.category("web_tour.tours").add("web_studio_test_default_value_company", {
    steps: () => [
        {
            trigger: "a[data-menu-xmlid='web_studio.studio_test_partner_menu']",
            run: "click",
        },
        {
            trigger: ".o_form_view .o_form_editable",
            run: "click",
        },
        {
            trigger: ".o_web_studio_navbar_item button",
            run: "click",
        },
        {
            trigger: ".o_web_studio_view_renderer .o_form_view .o_field_widget[name='name']",
            run: "click",
        },
        {
            trigger: ".o_web_studio_sidebar input[id='default_value']",
            async run(helpers) {
                // in this flow, only the input's value is changing
                // We want to wait for the RPC to return. That will
                // "commit" the value in the input.
                // Since when the value of an input changes, there are no DOM
                // mutations, we need to use the waitFor from Hoot
                // instead of the macro.js machinery to assert that the value has changed
                // as a consequence of the RPC
                this.anchor.scrollIntoView();
                const cb = ({ detail }) => {
                    if (detail.url === "/web_studio/set_default_value") {
                        this.anchor.value = "";
                        rpcBus.removeEventListener("RPC:REQUEST", cb);
                    }
                };
                rpcBus.addEventListener("RPC:REQUEST", cb);
                await helpers.edit("from studio");
                await helpers.press("ENTER");
                return waitFor(
                    ".o_web_studio_sidebar input[id='default_value']:value(from studio)",
                    { timeout: 5000 }
                );
            },
        },
    ],
});

return __exports;
});
;

/*********************************************************************
*  Filepath: /website_event/static/tests/tours/tickets_questions.js  *
*  Lines: 92                                                         *
*********************************************************************/
odoo.define('@website_event/../tests/tours/tickets_questions', ['@web/core/registry'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { registry } = require("@web/core/registry");
registry.category("web_tour.tours").add("test_tickets_questions", {
    url: "/event",
    steps: () => [
        {
            content: "Click on the Design Fair event",
            trigger: 'article:contains("Design Fair New York")',
            run: "click",
        },
        {
            content: "Click on Register modal tickets button",
            trigger: 'button:contains("Register")',
            run: "click",
        },
        {
            content: "Check Register button is disabled when no ticket selected",
            trigger: 'button:disabled:contains("Register")',
        },
        {
            content: "Select 2 'Free' tickets to buy",
            trigger: 'div.o_wevent_ticket_selector:contains("Free") select.form-select',
            run: "select 2",
        },
        {
            content: "Click on Register (to fill tickets data) button",
            trigger: 'div.modal-footer button:contains("Register")',
            run: "click",
        },
        {
            content: "Wait the modal is shown before continue",
            trigger: ".modal.modal_shown.show form[id=attendee_registration]",
        },
        {
            trigger: 'div.o_wevent_registration_question_global select[name*="0-simple_choice"]',
            run: "selectByLabel A friend",
        },
        {
            trigger: 'div:contains("Ticket #1").modal-body input[name*="name"]',
            run: "edit Attendee A",
        },
        {
            trigger: 'div:contains("Ticket #1").modal-body input[name*="email"]',
            run: "edit attendee-a@gmail.com",
        },
        {
            trigger: 'div:contains("Ticket #1").modal-body input[name*="phone"]',
            run: "edit +32499123456",
        },
        {
            trigger: 'div:contains("Ticket #1").modal-body select[name*="1-simple_choice"]',
            run: "selectByLabel Vegetarian",
        },
        {
            trigger: 'div:contains("Ticket #1").modal-body textarea[name*="1-text_box"]',
            run: "edit Fish and Nuts",
        },
        {
            trigger: 'div:contains("Ticket #2").modal-body input[name*="name"]',
            run: "edit Attendee B",
        },
        {
            trigger: 'div:contains("Ticket #2").modal-body input[name*="email"]',
            run: "edit attendee-b@gmail.com",
        },
        {
            trigger: 'div:contains("Ticket #2").modal-body input[name*="company_name"]',
            run: "edit My Company",
        },
        {
            trigger: 'div:contains("Ticket #2").modal-body select[name*="2-simple_choice"]',
            run: "selectByLabel Pastafarian",
        },
        {
            trigger:
                ".modal#modal_attendees_registration:not(.o_inactive_modal) button[type=submit].btn-primary",
            run: "click",
        },
        {
            // The tour stops too early and the registration fails if we don't wait the confirmation.
            content: "Wait for confirmation",
            trigger: ".o_wereg_confirmed, .oe_cart",
        },
    ],
});

return __exports;
});
;

/*****************************************************************
*  Filepath: /website_event/static/tests/tours/website_event.js  *
*  Lines: 117                                                    *
*****************************************************************/
odoo.define('@website_event/../tests/tours/website_event', ['@website/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const {
    insertSnippet,
    registerWebsitePreviewTour,
    clickOnEditAndWaitEditMode,
    clickOnSave,
} = require('@website/js/tours/tour_utils');

function websiteCreateEventTourSteps() {
    return [
        {
            content: "Click here to add new content to your website.",
            trigger: ".o_menu_systray .o_new_content_container > a",
            tooltipPosition: "bottom",
            run: "click",
        }, {
            trigger: "a[data-module-xml-id='base.module_website_event']",
            content: "Click here to create a new event.",
            tooltipPosition: "bottom",
            run: "click",
        }, {
            trigger: ".modal-dialog div[name='name'] input",
            content: "Create a name for your new event and click Continue. e.g: Technical Training",
            run: "edit Technical Training",
            tooltipPosition: "left",
        }, {
            trigger: ".modal-dialog div[name=date_begin]",
            content: "Open date range picker. Pick a Start date for your event",
            run() {
                const el1 = document.querySelector("input[data-field='date_begin']");
                el1.value = "09/30/2020 08:00:00";
                el1.dispatchEvent(new Event("change", {bubbles: true, cancelable: true}));
                const el2 = document.querySelector("input[data-field='date_end']");
                el2.value = "10/02/2020 23:00:00";
                el2.dispatchEvent(new Event("change", {bubbles: true, cancelable: true}));
                el1.click();
            }
        },
        {
            trigger: ".modal-dialog input[type=text]:not(:value(''))",
        },
        {
            trigger: '.modal-footer button.btn-primary',
            content: "Click Continue to create the event.",
            tooltipPosition: "right",
            run: "click",
        },
        ...insertSnippet({
            id: "s_image_text",
            name: "Image - Text",
            groupName: "Content",
        }), {
            // Wait until the drag and drop is resolved (causing a history step)
            // before clicking save.
            trigger: ".o_we_external_history_buttons button.fa-undo:not([disabled])",
        }, {
            trigger: "button[data-action=save]",
            content: "Once you click on save, your event is updated.",
            tooltipPosition: "bottom",
            run: "click",
        },
        {
            trigger: ":iframe body:not(.editor_enable)",
        },
        {
            trigger: ".o_menu_systray_item.o_website_publish_container a",
            content: "Click to publish your event.",
            tooltipPosition: "top",
            run: "click",
        }, {
            trigger: ".o_website_edit_in_backend > a",
            content: "Click here to customize your event further.",
            tooltipPosition: "bottom",
        },
    ];
}

function websiteEditEventTourSteps() {
    return [
        {
            content: "Redirect to Event Page",
            trigger: ":iframe a[title='Back to All Events']",
            run: "click",
        },
        {
            content: "Wait for events list to load",
            trigger: ":iframe .opt_events_list_columns",
        },
        ...clickOnEditAndWaitEditMode(),
        {
            content: "edit the short description of the event",
            trigger: ":iframe .opt_events_list_columns small",
            run: function () {
                this.anchor.innerHTML = "new short description";
            }
        },
        ...clickOnSave(),
        {
            content: "is short description updated?",
            trigger: ":iframe .opt_events_list_columns small:contains('new short description')",
        },
    ];
}

registerWebsitePreviewTour(
    "website_event_tour", {
        url: "/",
    },
    () => [...websiteCreateEventTourSteps(), ...websiteEditEventTourSteps()]
);

return __exports;
});
;

/***************************************************************************
*  Filepath: /website_event/static/tests/tours/website_event_pages_seo.js  *
*  Lines: 49                                                               *
***************************************************************************/
odoo.define('@website_event/../tests/tours/website_event_pages_seo', ['@web/core/registry'], function (require) {
'use strict';
let __exports = {};
/** @odoo-modules */

const { registry } = require("@web/core/registry");

registry.category("web_tour.tours").add("website_event_pages_seo", {
    // The tour must start on an event's custom page (not register page)
    // url: `/event/openwood-collection-online-reveal-8/page/introduction-openwood-collection-online-reveal`,
    steps: () => [
        {
            trigger: ":iframe #o_wevent_event_submenu", // Ensure we landed on the event page
        },
        {
            content: "Open the site menu",
            trigger: '[data-menu-xmlid="website.menu_site"]',
            run: "click",
        },
        {
            content: "Open the optimize SEO dialog",
            trigger: '[data-menu-xmlid="website.menu_optimize_seo"]',
            run: "click",
        },
        {
            content: "Fill in the title input",
            trigger: '.modal [for="website_meta_title"] + input',
            run: "edit Hello, world!",
        },
        {
            content: "Save the dialog",
            trigger: ".modal .modal-footer .btn-primary",
            run: "click",
        },
        {
            trigger: "body:not(:has(.modal))",
        },
        {
            trigger: ":iframe head:has(title:contains(/^Hello, world!$/)):not(:visible)",
        },
        {
            content: "Check that the page title is adapted, inside and outside the iframe",
            trigger: "head:has(title:contains(/^Hello, world!$/)):not(:visible)",
        },
    ],
});

return __exports;
});
;

/********************************************************************************
*  Filepath: /project_todo/static/tests/tours/project_task_activities_split.js  *
*  Lines: 57                                                                    *
********************************************************************************/
odoo.define('@project_todo/../tests/tours/project_task_activities_split', ['@web/core/registry'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module */

const { registry } = require("@web/core/registry");

registry.category("web_tour.tours").add('project_task_activities_split', {
    url: '/odoo',
    steps: () => [
        {
            content: 'Open Activity Systray',
            trigger: '.o-mail-ActivityMenu-counter',
            run: "click",
        }, {
            content: 'Open Task Activities',
            trigger: '.o-mail-ActivityGroup:contains("Task")',
            run: "click",
        }, {
            content: 'Task "New Task!" is listed in the activity view',
            trigger: '.o_activity_record .d-block:contains("New Task!")',
        }, {
            content: 'Task "New Sub-Task!" is listed in the activity view',
            trigger: '.o_activity_record .d-block:contains("New Sub-Task!")',
            run: () => {
                const nodes = document.querySelectorAll(".o_activity_record .d-block");
                for (const node of nodes) {
                    if (node.textContent === "New To-do!") {
                        console.error('Private task records with no parent task should not appear in this view');
                    }
                }
            },
        }, {
            content: 'Open Activity Systray',
            trigger: '.o-mail-ActivityMenu-counter',
            run: "click",
        }, {
            content: 'Open To-Do Activities',
            trigger: '.o-mail-ActivityGroup:contains("To-Do")',
            run: "click",
        }, {
            content: 'Record "New To-Do!" is listed in the activity view',
            trigger: '.o_activity_record .d-block:contains("New To-Do!")',
            run: () => {
                const nodes = document.querySelectorAll(".o_activity_record .d-block");
                for (const node of nodes) {
                    if (node.textContent === "New Task!" || node.textContent === "New Sub-Task!") {
                        console.error('Tasks linked to a project should not appear in this view');
                    }
                }
            },
        }
    ],
});

return __exports;
});
;

/******************************************************************************
*  Filepath: /project_todo/static/tests/tours/project_todo_main_functions.js  *
*  Lines: 180                                                                 *
******************************************************************************/
odoo.define('@project_todo/../tests/tours/project_todo_main_functions', ['@odoo/owl', '@web/core/registry', '@web_tour/tour_service/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module */

const { markup } = require("@odoo/owl");
const { registry } = require("@web/core/registry");
const { stepUtils } = require("@web_tour/tour_service/tour_utils");

registry.category("web_tour.tours").add('project_todo_main_functions', {
    url: '/odoo',
    steps: () => [stepUtils.showAppsMenuItem(), {
    trigger: '.o_app[data-menu-xmlid="project_todo.menu_todo_todos"]',
    run: "click",
}, {
    trigger: ".o_project_task_kanban_view .o_column_quick_create .o_kanban_add_column",
    content: "Create a personal stage from the To-do kanban view",
    run: "click",
},
{
    trigger: ".o_kanban_group",
},
{
    trigger: ".o_project_task_kanban_view .o_column_quick_create .o_kanban_header input",
    content: "Create a personal stage from the To-do kanban view",
    run: "edit Stage 1",
}, {
    trigger: ".o_project_task_kanban_view .o_column_quick_create .o_kanban_add",
    content: "Save the personal stage",
    run: "click",
},
{
    trigger: ".o_kanban_group",
},
{
    trigger: ".o_project_task_kanban_view .o_column_quick_create .o_kanban_header input",
    content: "Create a second personal stage from the To-do kanban view",
    run: "edit Stage 2",
}, {
    trigger: ".o_project_task_kanban_view .o_column_quick_create .o_kanban_add",
    content: "Save the personal stage",
    run: "click",
},
{
    trigger: ".o_kanban_group:eq(1)",
},
{
    trigger: '.o-kanban-button-new',
    content: "Create a task in the first stage",
    run: "click",
},
{
    trigger: ".o_project_task_kanban_view",
},
{
    trigger: '.o_kanban_quick_create div.o_field_char[name=name] input',
    content: "Create a personal task from the To-do kanban view",
    run: "edit Personal Task 1",
},
{
    trigger: ".o_project_task_kanban_view",
},
{
    trigger: '.o_kanban_quick_create .o_kanban_add',
    content: "Save the personal task",
    run: "click",
},
{
    trigger: ".o_project_task_kanban_view",
},
{
    trigger: ".o_kanban_record",
    content: "Drag &amp; drop the card to change the personal task from personal stage.",
    run: "drag_and_drop(.o_kanban_group:eq(1))",
},
{
    trigger: ".o_project_task_kanban_view",
},
{
    content: "Click on invisible caret. Should hover on card to be visible",
    trigger: ".o_dropdown_kanban .btn.o-no-caret:not(:visible)",
    run: "click",
}, {
    trigger: "a:contains('Set Cover Image')",
}, {
    trigger: ".o_kanban_record:first",//:contains(Send message)
    content: "Open the first todo record",
    run: "click",
},
{
    trigger: ".o_todo_form_view",
},
{
    trigger: ".todo_toggle_chatter",
    content: "Clicking on the chatter button should toggle open the chatter",
    run: "click",
},
{
    trigger: ".o-mail-Chatter-topbar button.o-mail-Chatter-sendMessage",
    content: "A 'send message' button should be present in the chatter",
    run: "click",
},
{
    trigger: ".o_todo_form_view",
},
{
    trigger: ".o-mail-Chatter-topbar button.o-mail-Chatter-logNote",
    content: "A 'log note' button should be present in the chatter",
    run: "click",
},
{
    trigger: ".o_todo_form_view",
},
{
    trigger: ".o-mail-Chatter-topbar button.o-mail-Chatter-activity",
    content: "An 'Activities' button should be present in the chatter",
    run: "click",
}, {
    trigger: "button[name=action_schedule_activities]",
    content: "Schedule an activity",
    run: "click",
},
{
    trigger: ".o_todo_form_view",
},
{
    trigger: ".o_field_widget[name='user_ids'] input",
    content: "Assign a responsible to your task",
    run: "fill marc",
},
{
    isActive: ["auto"],
    trigger: ".ui-autocomplete > li > a:not(:has(i.fa))",
    run: "click",
}, {
    trigger: '.o_field_widget[name="name"] textarea',
    content: 'Edit the name of the personal task',
    run: "edit New name for the personal task",
}, {
    trigger: '.o_todo_done_button',
    content: 'Mark the task as done',
    run: "click",
},
{
    trigger: ".o_todo_form_view .o_form_dirty",
},
{
    trigger: ".o_form_button_save",
    content: "Save the record",
    run: "click",
}, {
    trigger: '.o_breadcrumb .o_control_panel_breadcrumbs_actions button:enabled',
    content: "Convert the Todo to a task belonging to a project:enabled",
    run: "click",
}, {
    trigger: '.o_menu_item:contains("Convert to Task")',
    content: "Click on the action menu 'Convert to task'",
    run: "click",
}, {
    trigger: '.o_todo_conversion_form_view .o_field_many2one[name=project_id] input',
    content: 'Create a new project that will be set to the task',
    run: "edit Project test 1",
}, {
    trigger: '.o_todo_conversion_form_view .o_field_many2one[name=project_id] li.o_m2o_dropdown_option_create a',
    content: 'Create the new project',
    run: "click",
}, {
    trigger: 'button[name="action_convert_to_task"]',
    content: 'Convert the todo to a task',
    run: "click",
}, {
    trigger: ".breadcrumb-item:nth-child(1)",
    content: markup("Let's go back to the <b>kanban view</b> to have an overview of your next tasks."),
    run: "click",
}, {
    trigger: ".o_kanban_view",
}]});

return __exports;
});
;

/*************************************************************
*  Filepath: /account_reports/static/tests/tours/account.js  *
*  Lines: 41                                                 *
*************************************************************/
odoo.define('@account_reports/../tests/tours/account', ['@web/core/l10n/translation', '@web/core/utils/patch', '@account/js/tours/account'], function (require) {
'use strict';
let __exports = {};
const { _t } = require("@web/core/l10n/translation");
const { patch } = require("@web/core/utils/patch");
const { accountTourSteps } = require("@account/js/tours/account");

patch(accountTourSteps, {
    onboarding() {
        return [
            {
                trigger: ".o_widget_account_onboarding .fa-circle",
            },
            {
                trigger: "a[data-method=action_open_step_fiscal_year]",
                content: _t("Set Periods"),
                run: "click",
            },
            {
                trigger: "button[name=action_save_onboarding_fiscal_year]",
                content: _t("Save Fiscal Year end"),
                run: "click",
            },
        ];
    },
    newInvoice() {
        return [
            {
                trigger: ".o_widget_account_onboarding .fa-check-circle",
            },
            {
                trigger: "button[name=action_create_new]",
                content: _t("Now, we'll create your first invoice (accountant)"),
                run: "click",
            },
        ];
    },
});

return __exports;
});
;

/*********************************************************************
*  Filepath: /account_reports/static/tests/tours/account_reports.js  *
*  Lines: 268                                                        *
*********************************************************************/
odoo.define('@account_reports/../tests/tours/account_reports', ['@account_reports/../tests/tours/asserts', '@web/core/registry'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { Asserts } = require("@account_reports/../tests/tours/asserts");
const { registry } = require("@web/core/registry");

registry.category("web_tour.tours").add("account_reports", {
    url: "/odoo/action-account_reports.action_account_report_bs",
    steps: () => [
        //--------------------------------------------------------------------------------------------------------------
        // Foldable
        //--------------------------------------------------------------------------------------------------------------
        {
            content: "Initial foldable",
            trigger: ".o_content",
            run: () => {
                Asserts.DOMContainsNumber("tbody > tr:not(.d-none):not(.empty)", 28);

                // Since the total line is not displayed (folded), the amount should be on the line
                Asserts.isEqual(
                    document.querySelector("tr:nth-child(4) td:nth-child(2)").textContent,
                    "75.00"
                );
            },
        },
        {
            content: "Click to unfold line",
            trigger: "tr:nth-child(4) td:first()",
            run: "click",
        },
        {
            content: "Line is unfolded",
            trigger: "tr:nth-child(5) .name:contains('101401')",
            run: () => {
                Asserts.DOMContainsNumber("tbody > tr:not(.d-none):not(.empty)", 30);

                // Since the total line is displayed (unfolded), the amount should not be on the line
                Asserts.isEqual(
                    document.querySelector("tr:nth-child(4) td:nth-child(2)").textContent,
                    ""
                );
            },
        },
        {
            content: "Click to fold line",
            trigger: "tr:nth-child(4) td:first()",
            run: "click",
        },
        {
            content: "Line is folded",
            trigger: ".o_content",
            run: () => {
                Asserts.DOMContainsNumber("tbody > tr:not(.d-none):not(.empty)", 28);
            },
        },
        //--------------------------------------------------------------------------------------------------------------
        // Sortable
        //--------------------------------------------------------------------------------------------------------------
        {
            content: "Unfold first line",
            trigger: "tr:nth-child(4) td:first()",
            run: "click",
        },
        {
            content: "Unfold second line",
            trigger: "tr:nth-child(7) td:first()",
            run: "click",
        },
        {
            content: "Unfold third line",
            trigger: "tr:nth-child(10) td:first()",
            run: "click",
        },
        {
            content: "Extra Trigger step",
            trigger: "tr:nth-child(12):not(.d-none) .name:contains('101404')",
        },
        {
            content: "Initial sortable",
            trigger: ".o_content",
            run: () => {
                // Bank and Cash Accounts
                Asserts.isEqual(
                    document.querySelector("tr:nth-child(5) td:nth-child(2)").textContent,
                    "75.00"
                );
                Asserts.isEqual(
                    document.querySelector("tr:nth-child(6) td:nth-child(2)").textContent,
                    "75.00"
                );

                // Receivables
                Asserts.isEqual(
                    document.querySelector("tr:nth-child(8) td:nth-child(2)").textContent,
                    "25.00"
                );
                Asserts.isEqual(
                    document.querySelector("tr:nth-child(9) td:nth-child(2)").textContent,
                    "25.00"
                );

                // Current Assets
                Asserts.isEqual(
                    document.querySelector("tr:nth-child(11) td:nth-child(2)").textContent,
                    "100.00"
                );
                Asserts.isEqual(
                    document.querySelector("tr:nth-child(12) td:nth-child(2)").textContent,
                    "50.00"
                );
                Asserts.isEqual(
                    document.querySelector("tr:nth-child(13) td:nth-child(2)").textContent,
                    "150.00"
                );
            },
        },
        {
            content: "Click sort",
            trigger: "th .btn_sortable",
            run: "click",
        },
        {
            trigger: "tr:nth-child(11) td:nth-child(2):contains('50.00')",
        },
        {
            content: "Unfold not previously unfolded line",
            trigger: "tr:nth-child(22):contains('Current Liabilities') td:first()",
            run: "click",
        },
        {
            content: "Line is unfolded",
            trigger: "tr:nth-child(23) .name:contains('251000')",
            run: "click",
        },
        {
            content: "Sortable (asc)",
            trigger: "tr:nth-child(11) td:nth-child(2):contains('50.00')",
            run: () => {
                // Bank and Cash Accounts
                Asserts.isEqual(
                    document.querySelector("tr:nth-child(5) td:nth-child(2)").textContent,
                    "75.00"
                );
                Asserts.isEqual(
                    document.querySelector("tr:nth-child(6) td:nth-child(2)").textContent,
                    "75.00"
                );

                // Receivables
                Asserts.isEqual(
                    document.querySelector("tr:nth-child(8) td:nth-child(2)").textContent,
                    "25.00"
                );
                Asserts.isEqual(
                    document.querySelector("tr:nth-child(9) td:nth-child(2)").textContent,
                    "25.00"
                );

                // Current Assets
                Asserts.isEqual(
                    document.querySelector("tr:nth-child(11) td:nth-child(2)").textContent,
                    "50.00"
                );
                Asserts.isEqual(
                    document.querySelector("tr:nth-child(12) td:nth-child(2)").textContent,
                    "100.00"
                );
                Asserts.isEqual(
                    document.querySelector("tr:nth-child(13) td:nth-child(2)").textContent,
                    "150.00"
                );
            },
        },
        {
            content: "Click sort",
            trigger: "th .btn_sortable",
            run: "click",
        },
        {
            content: "Sortable (desc)",
            trigger: "tr:nth-child(11) td:nth-child(2):contains('100.00')",
            run: () => {
                // Bank and Cash Accounts
                Asserts.isEqual(
                    document.querySelector("tr:nth-child(5) td:nth-child(2)").textContent,
                    "75.00"
                );
                Asserts.isEqual(
                    document.querySelector("tr:nth-child(6) td:nth-child(2)").textContent,
                    "75.00"
                );

                // Receivables
                Asserts.isEqual(
                    document.querySelector("tr:nth-child(8) td:nth-child(2)").textContent,
                    "25.00"
                );
                Asserts.isEqual(
                    document.querySelector("tr:nth-child(9) td:nth-child(2)").textContent,
                    "25.00"
                );

                // Current Assets
                Asserts.isEqual(
                    document.querySelector("tr:nth-child(11) td:nth-child(2)").textContent,
                    "100.00"
                );
                Asserts.isEqual(
                    document.querySelector("tr:nth-child(12) td:nth-child(2)").textContent,
                    "50.00"
                );
                Asserts.isEqual(
                    document.querySelector("tr:nth-child(13) td:nth-child(2)").textContent,
                    "150.00"
                );
            },
        },
        {
            content: "Click sort",
            trigger: "th .btn_sortable",
            run: "click",
        },
        {
            content: "Sortable (reset)",
            trigger: "tr:nth-child(5) td:nth-child(2):contains('75.00')",
            run: () => {
                // Bank and Cash Accounts
                Asserts.isEqual(
                    document.querySelector("tr:nth-child(5) td:nth-child(2)").textContent,
                    "75.00"
                );
                Asserts.isEqual(
                    document.querySelector("tr:nth-child(6) td:nth-child(2)").textContent,
                    "75.00"
                );

                // Receivables
                Asserts.isEqual(
                    document.querySelector("tr:nth-child(8) td:nth-child(2)").textContent,
                    "25.00"
                );
                Asserts.isEqual(
                    document.querySelector("tr:nth-child(9) td:nth-child(2)").textContent,
                    "25.00"
                );

                // Current Assets
                Asserts.isEqual(
                    document.querySelector("tr:nth-child(11) td:nth-child(2)").textContent,
                    "100.00"
                );
                Asserts.isEqual(
                    document.querySelector("tr:nth-child(12) td:nth-child(2)").textContent,
                    "50.00"
                );
                Asserts.isEqual(
                    document.querySelector("tr:nth-child(13) td:nth-child(2)").textContent,
                    "150.00"
                );
            },
        },
    ],
});

return __exports;
});
;

/*************************************************************************************
*  Filepath: /account_reports/static/tests/tours/account_reports_amount_rounding.js  *
*  Lines: 100                                                                        *
*************************************************************************************/
odoo.define('@account_reports/../tests/tours/account_reports_amount_rounding', ['@web/core/registry'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { registry } = require("@web/core/registry");

registry.category("web_tour.tours").add('account_reports_rounding_unit', {
    url: '/odoo/action-account_reports.action_account_report_bs',
    steps: () => [
        {
            content: 'Test the value of `Receivables` line in decimals',
            trigger: '.line_name:contains("Receivables") + .line_cell:contains("1,150,000.00")',
            run: "click",
        },
        // Units
        {
            content: "Open amounts rounding dropdown",
            trigger: "#filter_rounding_unit button",
            run: 'click',
        },
        {
            content: "Select the units filter",
            trigger: ".dropdown-item:contains('In $')",
            run: 'click',
        },
        {
            trigger:
                '.line_name:contains("Receivables") + .line_cell:not(:contains("1,150,000.00"))',
        },
        {
            content: 'test the value of `Receivables` line in units',
            // We wait for the value to change.
            // We check the new value.
            trigger: '.line_name:contains("Receivables") + .line_cell:contains("1,150,000")',
            run: "click",
        },
        // Thousands
        {
            content: "Open amounts rounding dropdown",
            trigger: "#filter_rounding_unit button",
            run: 'click',
        },
        {
            content: "Select the thousands filter",
            trigger: ".dropdown-item:contains('In K$')",
            run: 'click',
        },
        {
            trigger: '.line_name:contains("Receivables") + .line_cell:not(:contains("1,150,000"))',
        },
        {
            content: 'test the value of `Receivables` line in thousands',
            // We wait for the value to change.
            // We check the new value.
            trigger: '.line_name:contains("Receivables") + .line_cell:contains("1,150")',
            run: "click",
        },
        // Millions
        {
            content: "Open amounts rounding dropdown",
            trigger: "#filter_rounding_unit button",
            run: 'click',
        },
        {
            content: "Select the millions filter",
            trigger: ".dropdown-item:contains('In M$')",
            run: 'click',
        },
        {
            trigger: '.line_name:contains("Receivables") + .line_cell:not(:contains("1,150"))',
        },
        {
            content: 'test the value of `Receivables` line in millions',
            // We wait for the value to change.
            // We check the new value.
            trigger: '.line_name:contains("Receivables") + .line_cell:contains("1")',
            run: "click",
        },
        // Decimals
        {
            content: "Open amounts rounding dropdown",
            trigger: "#filter_rounding_unit button",
            run: 'click',
        },
        {
            content: "Select the decimals filter",
            trigger: ".dropdown-item:contains('In .$')",
            run: 'click',
        },
        {
            content: 'test the value of `Receivables` line in millions',
            trigger: '.line_name:contains("Receivables") + .line_cell:contains("1,150,000.00")',
            run: () => null,
        },
    ]
});

return __exports;
});
;

/**************************************************************************************
*  Filepath: /account_reports/static/tests/tours/account_reports_analytic_filters.js  *
*  Lines: 34                                                                          *
**************************************************************************************/
odoo.define('@account_reports/../tests/tours/account_reports_analytic_filters', ['@web/core/registry'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { registry } = require("@web/core/registry");

registry.category("web_tour.tours").add("account_reports_analytic_filters", {
    url: "/odoo/action-account_reports.action_account_report_general_ledger",
    steps: () => [
        {
            content: "click analytic filters",
            trigger: ".filter_analytic button",
            run: "click",
        },
        {
            content: "insert text in the searchbar",
            trigger: ".o_multi_record_selector input",
            run: "edit Time",
        },
        {
            content: "click on the item",
            trigger: '.o-autocomplete--dropdown-item:contains("Time Off")',
            run: "click",
        },
        {
            content: "Check the label of the badge",
            trigger: '.dropdown-menu .o_tag_badge_text:contains("Time Off")',
        },
    ],
});

return __exports;
});
;

/*********************************************************************************
*  Filepath: /account_reports/static/tests/tours/account_reports_annotations.js  *
*  Lines: 304                                                                    *
*********************************************************************************/
odoo.define('@account_reports/../tests/tours/account_reports_annotations', ['@account_reports/../tests/tours/asserts', '@web/core/registry'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { Asserts } = require("@account_reports/../tests/tours/asserts");
const { registry } = require("@web/core/registry");

registry.category("web_tour.tours").add("account_reports_annotations", {
    url: "/odoo/action-account_reports.action_account_report_bs",
    steps: () => [
        //--------------------------------------------------------------------------------------------------------------
        // Annotations
        //--------------------------------------------------------------------------------------------------------------
        // Test the initial status of annotations - There are 2 annotations to display
        {
            content: "Initial annotations",
            trigger: ".o_content",
            run: () => {
                Asserts.DOMContainsNone(".annotations");
            },
        },
        {
            content: "Unfold first line",
            trigger: "tr:nth-child(4) td:first()",
            run: "click",
        },
        {
            content: "Unfold second line",
            trigger: "tr:nth-child(7) td:first()",
            run: "click",
        },
        {
            content: "Unfold third line",
            trigger: "tr:nth-child(10) td:first()",
            run: "click",
        },
        {
            content: "Extra Trigger step",
            trigger: "tr:nth-child(12):not(.d-none) .name:contains('101404')",
        },
        {
            content: "Check there are two lines annotated initially",
            trigger: ".o_content",
            run: () => {
                const annotations = document.querySelectorAll(".btn_annotation .fa-commenting");

                // Check the number of annotated lines
                Asserts.isEqual(annotations.length, 2);

                // Check the annotations buttons are on the right lines
                Asserts.isTrue(
                    annotations[0] ===
                        document.querySelector("tr:nth-child(5)").querySelector(".fa-commenting")
                );
                Asserts.isTrue(
                    annotations[1] ===
                        document.querySelector("tr:nth-child(12)").querySelector(".fa-commenting")
                );
            },
        },
        // Test that we can add a new annotation
        {
            content: "Click to show caret option",
            trigger: "tr:nth-child(8) .dropdown-toggle",
            run: "click",
        },
        {
            content: "Caret option is displayed",
            trigger: "tr:nth-child(8)",
            run: () => {
                Asserts.hasClass("tr:nth-child(8) .o-dropdown", "show");
            },
        },
        {
            content: "Click on annotate",
            trigger: ".o-dropdown--menu .dropdown-item:last-of-type:contains('Annotate')",
            run: "click",
        },
        {
            content: "Add text to annotate",
            trigger: "textarea",
            run: "edit Annotation 121000",
        },
        {
            content: "Submit annotation by blurring",
            trigger: "textarea",
            run: function () {
                const annotation = this.anchor;
                annotation.dispatchEvent(new InputEvent("input"));
                annotation.dispatchEvent(new Event("change"));
            },
        },
        {
            content: "Wait for annotation created",
            trigger: "tr:nth-child(8) .btn_annotation .fa-commenting",
        },
        {
            content: "Close annotation",
            trigger: ".o_content",
            run: "click",
        },
        {
            content: "Check there are now three lines annotated",
            trigger: ".o_content",
            run: () => {
                const annotations = document.querySelectorAll(".btn_annotation .fa-commenting");

                // Check the number of annotated lines
                Asserts.isEqual(annotations.length, 3);

                // Check the annotations buttons are on the right lines
                Asserts.isTrue(
                    annotations[0] ===
                        document.querySelector("tr:nth-child(5)").querySelector(".fa-commenting")
                );
                Asserts.isTrue(
                    annotations[1] ===
                        document.querySelector("tr:nth-child(8)").querySelector(".fa-commenting")
                );
                Asserts.isTrue(
                    annotations[2] ===
                        document.querySelector("tr:nth-child(12)").querySelector(".fa-commenting")
                );
            },
        },
        // Test that we can edit an annotation
        {
            content: "Open second annotated line annotation popover",
            trigger: "tr:nth-child(8) .btn_annotation",
            run: "click",
        },
        {
            content: "Annotate contains previous text value",
            trigger: "textarea",
            run: () => {
                Asserts.isEqual(document.querySelector("textarea").value, "Annotation 121000");
            },
        },
        {
            content: "Add text to annotate",
            trigger: "textarea",
            run: "edit Annotation 121000 edited",
        },
        {
            content: "Annotation is edited",
            trigger: "tr:nth-child(8) .btn_annotation",
            run: () => {
                Asserts.isEqual(
                    document.querySelector(".annotation_popover_autoresize_textarea").value,
                    "Annotation 121000 edited"
                );
            },
        },
        // Test that we can delete an annotation by clicking the trash icon
        {
            content: "Click on trash can",
            trigger: ".btn_annotation_delete",
            run: "click",
        },
        {
            content: "Check there are now only two lines annotated",
            trigger: "tr:nth-child(8):not(:has(.fa-commenting))",
            run: () => {
                const annotations = document.querySelectorAll(".btn_annotation .fa-commenting");

                // Check the number of annotated lines
                Asserts.isEqual(annotations.length, 2);

                // Check the annotations buttons are on the right lines
                Asserts.isTrue(
                    annotations[0] ===
                        document.querySelector("tr:nth-child(5)").querySelector(".fa-commenting")
                );
                Asserts.isTrue(
                    annotations[1] ===
                        document.querySelector("tr:nth-child(12)").querySelector(".fa-commenting")
                );
            },
        },
        // Test that we can add an annotation by clicking on the "New" button inside the popover
        {
            content: "Open an annotated line annotation popover",
            trigger: "tr:nth-child(12) .btn_annotation",
            run: "click",
        },
        {
            content: "Click on the 'New' button",
            trigger: ".annotation_popover_line .oe_link",
            run: "click",
        },
        {
            content: "Add text to annotate",
            trigger: "textarea:last()",
            run: "edit Annotation 101404 bis",
        },
        {
            content: "Submit annotation by blurring",
            trigger: "textarea:last()",
            run: function () {
                const annotation = this.anchor;
                annotation.dispatchEvent(new InputEvent("input"));
                annotation.dispatchEvent(new Event("change"));
            },
        },
        // Check the current state of the annotations
        {
            content: "Check there are two annotated lines to end the test",
            trigger: ".o_content",
            run: () => {
                const annotations = document.querySelectorAll(".btn_annotation .fa-commenting");

                // Check there is only one annotated line
                Asserts.isEqual(annotations.length, 2);

                // Check the annotation buttons are on the right lines
                Asserts.isTrue(
                    annotations[0] ===
                        document.querySelector("tr:nth-child(5)").querySelector(".fa-commenting")
                );
                Asserts.isTrue(
                    annotations[1] ===
                        document.querySelector("tr:nth-child(12)").querySelector(".fa-commenting")
                );
            },
        },
        //--------------------------------------------------------------------------------------------------------------
        // Annotations dates
        //--------------------------------------------------------------------------------------------------------------
        {
            content:
                "Remove first annotation to only have one annotation on line 12 (required setup step)",
            trigger: ".annotation_popover tr:nth-child(2) .btn_annotation_delete",
            run: "click",
        },
        {
            content: "Verify that we still have one element",
            trigger: ".annotation_popover tr:nth-child(3):contains('Add a line')",
        },
        {
            content: "Modify the date of an annotation to a further period",
            trigger: ".annotation_popover tr:nth-child(2) input",
            run: "edit 01/01/2100",
        },
        {
            content: "Modify the date of an annotation to a further period",
            trigger: ".annotation_popover tr:nth-child(2) input",
            run: function () {
                // Since the t-on-change of the input is not triggered by the run: "edit" action,
                // we need to dispatch the event manually requiring a function.
                const input = this.anchor;
                input.dispatchEvent(new InputEvent("input"));
                input.dispatchEvent(new Event("change", { bubbles: true }));
            },
        },
        {
            content: "Check that there is no annotation anymore on line 12",
            trigger: "tr:nth-child(12):not(:has(.fa-commenting))",
        },
        {
            content: "change date filter",
            trigger: "#filter_date button",
            run: "click",
        },
        {
            content: "Open specific date button",
            trigger: ".dropdown-menu div.dropdown-item",
            run: "click",
        },
        {
            content: "Go to 15 January 2100",
            trigger: ".o_datetime_input",
            run: "edit 01/15/2100",
        },
        {
            content: "Apply filter by closing the dropdown",
            trigger: "#filter_date .btn:first()",
            run: "click",
        },
        {
            content: "wait refresh",
            trigger: `#filter_date button:not(:contains(${new Date().getFullYear()}))`,
        },
        {
            content: "Check there is one annotation on line 12",
            trigger: "tr:nth-child(12):has(.fa-commenting)",
            run: () => {
                const annotations = document.querySelectorAll(".btn_annotation .fa-commenting");

                // Check there is only one annotated line
                Asserts.isEqual(annotations.length, 1);

                // Check the annotation buttons are on the right lines
                Asserts.isTrue(
                    annotations[0] ===
                        document.querySelector("tr:nth-child(12)").querySelector(".fa-commenting")
                );
            }
        },
    ]
});

return __exports;
});
;

/**********************************************************************************
*  Filepath: /account_reports/static/tests/tours/account_reports_hide_0_lines.js  *
*  Lines: 113                                                                     *
**********************************************************************************/
odoo.define('@account_reports/../tests/tours/account_reports_hide_0_lines', ['@web/core/registry'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { registry } = require("@web/core/registry");

registry.category("web_tour.tours").add('account_reports_hide_0_lines', {
    url: '/odoo/action-account_reports.action_account_report_bs',
    steps: () => [
        {
            content: 'test if the Bank and Cash line is present (but the value is 0)',
            trigger: '.line_name:contains("Bank and Cash Accounts")',
            run: "click",
        },
        {
            content: 'test if the Current Year Unallocated Earnings line is present (but the value is 0)',
            trigger: '.line_name:contains("Current Year Unallocated Earnings")',
            run: "click",
        },
        {
            content: 'test if the Unallocated Earnings line is present (but value is different from 0 and so should be there after the hide_0_lines',
            trigger: '.line_name:contains("Unallocated Earnings")',
            run: "click",
        },
        {
            content: "Open options selector",
            trigger: "#filter_extra_options button",
            run: 'click',
        },
        {
            content: "Select the hide line at 0 option",
            trigger: ".dropdown-item:contains('Hide lines at 0')",
            run: 'click',
        },
        {
            content: 'test if the Unallocated Earnings line is still present',
            trigger: '.line_name:contains("Unallocated Earnings")',
            run: "click",
        },
        {
            content: 'test if the Bank and Cash line is not present',
            trigger: '.line_name:not(:contains("Bank and Cash Accounts"))',
            run: "click",
        },
        {
            content: 'test if the Current Year Unallocated Earnings line is not present',
            trigger: '.line_name:not(:contains("Current Year Unallocated Earnings"))',
            run: "click",
        },
        {
            content: "Click again to open the options selector",
            trigger: "#filter_extra_options button",
            run: 'click',
        },
        {
            content: "Select the hide lines at 0 option again",
            trigger: ".dropdown-item:contains('Hide lines at 0')",
            run: 'click',
        },
        {
            content: 'test again if the Bank and Cash line is present (but the value is 0)',
            trigger: '.line_name:contains("Bank and Cash Accounts")',
            run: () => null,
        },
    ]
});

registry.category("web_tour.tours").add('account_reports_hide_0_lines_with_string_columns', {
    url: '/odoo/action-account_reports.action_account_report_general_ledger',
    steps: () => [
        {
            content: "Check if the 211000 Account Payable line is present (but the value is 0)",
            trigger: ".name:contains('211000 Account Payable')",
            run: "click",
        },
        {
            content: "Check if the MISC item line is present with string values set up, but all amounts are at 0",
            trigger: ".name:contains('Coucou les biloutes')",
        },
        {
            content: "Open options selector",
            trigger: "#filter_extra_options button",
            run: 'click',
        },
        {
            content: "Select the hide line at 0 option",
            trigger: ".dropdown-item:contains('Hide lines at 0')",
            run: 'click',
        },
        {
            content: "Check if the MISC item line is hidden",
            trigger: ":not(:visible):contains('Coucou les biloutes')",
        },
        {
            content: "Click again to open the options selector",
            trigger: "#filter_extra_options button",
            run: 'click',
        },
        {
            content: "Select the hide lines at 0 option again",
            trigger: ".dropdown-item:contains('Hide lines at 0')",
            run: 'click',
        },
        {
            content: "Check again if the MISC item line is present (but the value is 0)",
            trigger: ".name:contains('Coucou les biloutes')",
        },
    ]
});

return __exports;
});
;

/****************************************************************************
*  Filepath: /account_reports/static/tests/tours/account_reports_search.js  *
*  Lines: 49                                                                *
****************************************************************************/
odoo.define('@account_reports/../tests/tours/account_reports_search', ['@web/core/registry'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { registry } = require("@web/core/registry");

registry.category("web_tour.tours").add('account_reports_search', {
    url: '/odoo/action-account_reports.action_account_report_general_ledger',
    steps: () => [
        {
            content: "click search",
            trigger: '.o_searchview_input',
            run: 'click',
        },
        {
            content: 'insert text in the searchbar',
            trigger: '.o_searchview_input',
            run: "edit 40",
        },
        {
            content: 'test if the product sale line is present',
            trigger: '.line_name:contains("400000 Product Sales")',
            run: "click",
        },
        {
            content: "click search",
            trigger: '.o_searchview_input',
            run: 'click',
        },
        {
            content: 'insert text in the search bar',
            trigger: '.o_searchview_input',
            run: "edit Account",
        },
        {
            content: 'test if the receivable line is present',
            trigger: '.line_name:contains("121000 Account Receivable")',
            run: 'click',
        },
        {
            content: 'check that the product sale line is not present',
            trigger: '.line_name:not(:contains("400000 Product Sales"))',
        },
    ]
});

return __exports;
});
;

/******************************************************************************
*  Filepath: /account_reports/static/tests/tours/account_reports_sections.js  *
*  Lines: 135                                                                 *
******************************************************************************/
odoo.define('@account_reports/../tests/tours/account_reports_sections', ['@account_reports/../tests/tours/asserts', '@web/core/registry'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { DateTime } = luxon;

const { Asserts } = require("@account_reports/../tests/tours/asserts");
const { registry } = require("@web/core/registry");

registry.category("web_tour.tours").add('account_reports_sections', {
    url: "/odoo/action-account_reports.action_account_report_gt",
    steps: () => [
        {
            content: "Open variant selector",
            trigger: "#filter_variant button",
            run: 'click',
        },
        {
            content: "Select the test variant using sections",
            trigger: ".dropdown-item:contains('Test Sections')",
            run: 'click',
        },
        {
            content: "Check the lines of section 1 are displayed",
            trigger: ".line_name:contains('Section 1 line')",
        },
        {
            content: "Check the columns of section 1 are displayed",
            trigger: "#table_header th:last():contains('Column 1')",
        },
        {
            content: "Check the export buttons belong to the composite report",
            trigger: ".btn:contains('composite_report_custom_button')",
        },
        {
            content: "Check the filters displayed belong to section 1 (journals filter is not enabled on section 2, nor the composite report)",
            trigger: "#filter_journal",
        },
        {
            content: "Check the date chosen by default",
            trigger: "#filter_date",
            run: (actionHelper) => {
                // Generic tax report opens on the previous period and in this case the period is one month.
                // And since we are using the generic tax report, we need to go back one month.
                const previousMonth = DateTime.now().minus({months: 1});

                Asserts.isTrue(actionHelper.anchor.getElementsByTagName('button')[0].innerText.includes(previousMonth.year));
            },
        },
        {
            content: "Switch to section 2",
            trigger: "#section_selector .btn:contains('Section 2')",
            run: 'click',
        },
        {
            content: "Check the lines of section 2 are displayed",
            trigger: ".line_name:contains('Section 2 line')",
        },
        {
            content: "Check the columns of section 2 are displayed",
            trigger: "#table_header th:last():contains('Column 2')",
        },
        {
            content: "Check the export buttons belong to the composite report",
            trigger: ".btn:contains('composite_report_custom_button')",
        },
        {
            content: "Check the filters displayed belong to section 2 (comparison filter is not enabled on section 1, nor the composite report)",
            trigger: "#filter_comparison",
        },
        {
            content: "Open date switcher",
            trigger: "#filter_date button",
            run: 'click',
        },
        {
            content: "Select another date in the future",
            trigger: ".dropdown-menu span.dropdown-item:nth-child(3) .btn_next_date",
            run: 'click'
        },
        {
            content: "Apply filter by closing the dropdown for the future date",
            trigger: "#filter_date .btn:first()",
            run: "click",
        },
        {
            content: "Check that the date has changed",
            trigger: `#filter_date button:not(:contains(${ DateTime.now().minus({months: 1}).year }))`, // We need to remove one month for the case where we are in january. It will impact the year.
            run: (actionHelper) => {
                const nextYear = DateTime.now().plus({years: 1}).year;

                Asserts.isTrue(actionHelper.anchor.innerText.includes(nextYear));
            },
        },
        {
            content: "Open date switcher",
            trigger: "#filter_date button",
            run: 'click',
        },
        {
            content: "Select another date first time",
            trigger: ".dropdown-menu span.dropdown-item:nth-child(3) .btn_previous_date",
            run: 'click'
        },
        {
            trigger: `.dropdown-menu span.dropdown-item:nth-child(3) time:contains(${ DateTime.now().year})`,
        },
        {
            content: "Select another date second time",
            trigger: ".dropdown-menu span.dropdown-item:nth-child(3) .btn_previous_date",
            run: 'click'
        },
        {
            trigger: `.dropdown-menu span.dropdown-item:nth-child(3) time:contains(${ DateTime.now().minus({years: 1}).year })`,
        },
        {
            content: "Apply filter by closing the dropdown",
            trigger: "#filter_date .btn:first()",
            run: "click",
        },
        {
            content: "Check that the date has changed",
            trigger: `#filter_date button:contains(${ DateTime.now().minus({years: 1}).year })`,
        },
        {
            content: "Switch back to section 1",
            trigger: "#section_selector .btn:contains('Section 1')",
            run: 'click',
        },
    ]
});

return __exports;
});
;

/*****************************************************************************
*  Filepath: /account_reports/static/tests/tours/account_reports_widgets.js  *
*  Lines: 88                                                                 *
*****************************************************************************/
odoo.define('@account_reports/../tests/tours/account_reports_widgets', ['@web/core/registry'], function (require) {
'use strict';
let __exports = {};
const { registry } = require("@web/core/registry");

registry.category("web_tour.tours").add("account_reports_widgets", {
    url: "/odoo/action-account_reports.action_account_report_pl",
    steps: () => [
        {
            content: "change date filter",
            trigger: "#filter_date button",
            run: "click",
        },
        {
            content: "Select another date in the future",
            trigger: ".dropdown-menu span.dropdown-item:nth-child(3) .btn_next_date",
            run: 'click'
        },
        {
            content: "Apply filter by closing the dropdown",
            trigger: "#filter_date .btn:first()",
            run: "click",
        },
        {
            content: "wait refresh",
            trigger: `#filter_date button:not(:contains(${ new Date().getFullYear() }))`,
        },
        {
            content: "change date filter for the second time",
            trigger: "#filter_date button",
            run: "click",
        },
        {
            content: "Select another date in the past first time",
            trigger: ".dropdown-menu span.dropdown-item:nth-child(3) .btn_previous_date",
            run: 'click'
        },
        {
            trigger: `.dropdown-menu span.dropdown-item:nth-child(3) time:contains(${new Date().getFullYear()})`,
        },
        {
            content: "Select another date in the past second time",
            trigger: ".dropdown-menu span.dropdown-item:nth-child(3) .btn_previous_date",
            run: 'click'
        },
        {
            trigger: `.dropdown-menu span.dropdown-item:nth-child(3) time:contains(${
                new Date().getFullYear() - 1
            })`,
        },
        {
            content: "Apply filter by closing the dropdown",
            trigger: "#filter_date .btn:first()",
            run: "click",
        },
        {
            content: "wait refresh",
            trigger: `#filter_date button:contains(${ new Date().getFullYear() - 1 })`,
        },
        {
            content: "change comparison filter",
            trigger: "#filter_comparison .btn:first()",
            run: "click",
        },
        {
            content: "change comparison filter",
            trigger: ".dropdown-item.period:first()",
            run: "click",
        },
        {
            content: "Apply filter by closing the dropdown",
            trigger: "#filter_comparison .btn:first()",
            run: "click",
        },
        {
            content: "wait refresh, report should have 4 columns",
            trigger: "th + th + th + th",
        },
        {
            content: "export xlsx",
            trigger: "button:contains('XLSX')",
            run: "click",
        },
    ],
});

return __exports;
});
;

/*************************************************************
*  Filepath: /account_reports/static/tests/tours/asserts.js  *
*  Lines: 121                                                *
*************************************************************/
odoo.define('@account_reports/../tests/tours/asserts', [], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

//----------------------------------------------------------------------------------------------------------------------
// This class provides some helpers function to do assertions on tours
//----------------------------------------------------------------------------------------------------------------------
const Asserts = __exports.Asserts = class Asserts {
    //------------------------------------------------------------------------------------------------------------------
    // Helpers
    //------------------------------------------------------------------------------------------------------------------
    // Gets the number of 'selector' element inside 'target' element
    static getCount(target, selector) {
        return document.querySelector(target).querySelectorAll(selector).length;
    }
    // Gets the number of 'selector' element inside DOM
    static getDOMCount(selector) {
        return document.querySelectorAll(selector).length;
    }
    static check(condition, success, error) {
        condition ? Asserts.success(success) : Asserts.error(error);
    }
    static success(message) {
        return console.info(`SUCCESS: ${message}`);
    }
    static error(message) {
        throw new Error(`FAIL: ${message}`);
    }

    //------------------------------------------------------------------------------------------------------------------
    // Asserts
    //------------------------------------------------------------------------------------------------------------------
    static isTrue(actual) {
        Asserts.check(actual, `${actual} is true`, `${actual} is not true`);
    }
    static isFalse(actual) {
        Asserts.check(!actual, `${actual} is false`, `${actual} is not false`);
    }
    // Assert that 'actual' and 'expected' are equal
    static isEqual(actual, expected) {
        Asserts.check(
            (actual == expected),
            `${actual} is equal to expected ${expected}`,
            `${actual} is not equal to expected ${expected}`
        );
    }
    // Asserts that 'actual' and 'expected' are strictly equal
    static isStrictEqual(actual, expected) {
        Asserts.check(
            (actual === expected),
            `${actual} is strictly equal to expected ${expected}`,
            `${actual} is not strictly equal to expected ${expected}`
        );
    }
    // Assert that 'target' element contains at least one 'selector' element
    static contains(target, selector) {
        const count = Asserts.getCount(target, selector);
        Asserts.check(
            (count > 0),
            `There is at least one ${selector} in ${target}`,
            `There should be at least one ${selector} in ${target} but there is ${count}`
        );
    }
    // Asserts there is no 'selector' element in 'target' element
    static containsNone(target, selector) {
        const count = Asserts.getCount(target, selector);
        Asserts.check(
            (count === 0),
            `There is no ${selector} in ${target}`,
            `There should be no ${selector} in ${target} but there is ${count}`
        );
    }
    // Asserts that 'target' element contains 'number' of 'selector' elements
    static containsNumber(target, selector, number) {
        const count = Asserts.getCount(target, selector);
        Asserts.check(
            (count === number),
            `There is the correct number (${number}) of ${selector} in ${target}`,
            `There should be at ${number} ${selector} in ${target} but there is ${count}`
        );
    }
    // Asserts that DOM contains at least one 'selector' element
    static DOMContains(selector) {
        const count = Asserts.getDOMCount(selector);
        Asserts.check(
            (count > 0),
            `There is at least one ${selector} in the DOM`,
            `There should be at least one ${selector} in the DOM but there is ${count}`
        );
    }
    // Asserts there is no 'selector' element in the DOM
    static DOMContainsNone(selector) {
        const count = Asserts.getDOMCount(selector);
        Asserts.check(
            (count === 0),
            `There is no ${selector} in the DOM`,
            `There should be 0 ${selector} in the DOM but there is ${count}`
        );
    }
    // Asserts that DOM contains 'number' of 'selector' element
    static DOMContainsNumber(selector, number) {
        const count = Asserts.getDOMCount(selector);
        Asserts.check(
            (Asserts.getDOMCount(selector) === number),
            `There is the correct number (${number}) of ${selector} in the DOM`,
            `There should be ${number} ${selector} in the DOM but there is ${count}`
        );
    }
    // Asserts that 'selector' element has class 'classname'
    static hasClass(selector, classname) {
        Asserts.check(
            document.querySelector(selector).classList.contains(classname),
            `${selector} has class ${classname}`,
            `${selector} should have class ${classname} but hasn't`
        );
    }
}

return __exports;
});
;

/***************************************************************************
*  Filepath: /account_reports/static/tests/tours/test_tour_bank_rec_ui.js  *
*  Lines: 31                                                               *
***************************************************************************/
odoo.define('@account_reports/../tests/tours/test_tour_bank_rec_ui', ['@web/core/utils/patch', '@account/js/tours/account'], function (require) {
'use strict';
let __exports = {};
const { patch } = require("@web/core/utils/patch");
const { accountTourSteps } = require("@account/js/tours/account");

patch(accountTourSteps, {
    bankRecUiReportSteps() {
        return [
            {
                trigger: ".o_bank_rec_selected_st_line:contains('line1')",
            },
            {
                content: "balance is 2100",
                trigger: ".btn-link:contains('$ 2,100.00')",
                run: "click",
            },
            {
                trigger: "span:contains('General Ledger')",
            },
            {
                content: "Breadcrumb back to Bank Reconciliation from the report",
                trigger: ".breadcrumb-item a:contains('Bank Reconciliation')",
                run: "click",
            },
        ];
    },
});

return __exports;
});
;

/*************************************************************
*  Filepath: /website_crm/static/tests/tours/website_crm.js  *
*  Lines: 98                                                 *
*************************************************************/
odoo.define('@website_crm/../tests/tours/website_crm', ['@web/core/registry', '@website/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { registry } = require("@web/core/registry");
const {
    clickOnSave,
    registerWebsitePreviewTour,
} = require('@website/js/tours/tour_utils');

registerWebsitePreviewTour('website_crm_pre_tour', {
    url: '/contactus',
    edition: true,
}, () => [{
    content: "Select contact form",
    trigger: ":iframe #wrap.o_editable section.s_website_form",
    run: "click",
},
{
    trigger: "#oe_snippets .o_we_customize_snippet_btn.active",
},
{
    content: "Open action select",
    trigger: "we-select:has(we-button:contains('Create an Opportunity')) we-toggler",
    run: "click",
}, {
    content: "Select 'Create an Opportunity' as form action",
    trigger: "we-select we-button:contains('Create an Opportunity')",
    run: "click",
},
...clickOnSave(),
{
    content: "Ensure form model has changed and page reload is done after save",
    trigger: ":iframe section.s_website_form form[data-model_name='crm.lead']",
}]);

registry.category("web_tour.tours").add('website_crm_tour', {
    url: '/contactus',
    steps: () => [{
    content: "Complete name",
    trigger: "input[name=contact_name]",
    run: "edit John Smith",
}, {
    content: "Complete phone number",
    trigger: "input[name=phone]",
    run: "edit +32 485 118.218",
}, {
    content: "Complete Email",
    trigger: "input[name=email_from]",
    run: "edit john@smith.com",
}, {
    content: "Complete Company",
    trigger: "input[name=partner_name]",
    run: "edit Odoo S.A.",
}, {
    content: "Complete Subject",
    trigger: "input[name=name]",
    run: "edit Useless message",
}, {
    content: "Complete Subject",
    trigger: "textarea[name=description]",
    run: "edit ### TOUR DATA ###",
}, {
    content: "Send the form",
    trigger: ".s_website_form_send",
    run: "click",
}, {
    content: "Check we were redirected to the success page",
    trigger: "#wrap:has(h1:contains('Thank You!'))",
}]});

registry.category("web_tour.tours").add('website_crm_catch_logged_partner_info_tour', {
    url: '/contactus',
    steps: () => [
{
    content: "Wait the form is patched with values before continue to edit it",
    trigger: "form#contactus_form input[name=partner_name]:value(yourcompany)",
},
{
    content: "Complete Subject",
    trigger: "input[name=name]",
    run: "edit Useless subject",
}, {
    content: "Complete Subject",
    trigger: "textarea[name=description]",
    run: "edit ### TOUR DATA PREFILL ###",
}, {
    content: "Send the form",
    trigger: ".s_website_form_send",
    run: "click",
}, {
    content: "Check we were redirected to the success page",
    trigger: "#wrap:has(h1:contains('Thank You!'))",
}]});

return __exports;
});
;

/***************************************************
*  Filepath: /auth_totp/static/tests/totp_flow.js  *
*  Lines: 387                                      *
***************************************************/
odoo.define('@auth_totp/../tests/totp_flow', ['@odoo/hoot-dom', '@web/core/network/rpc', '@web/core/registry', '@web_tour/tour_service/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { queryAll, waitFor } = require("@odoo/hoot-dom");
const { rpc } = require("@web/core/network/rpc");
const { registry } = require("@web/core/registry");
const { stepUtils } = require("@web_tour/tour_service/tour_utils");

function openRoot() {
    return [{
        content: "return to client root to avoid race condition",
        trigger: 'body',
        run() {
            document.querySelector("body").classList.add("wait");
            window.location = '/odoo';
        }
    }, {
        content: "wait for client reload",
        trigger: 'body:not(.wait)',
    }];
}
function openUserProfileAtSecurityTab() {
    return [{
        content: 'Open user account menu',
        trigger: '.o_user_menu .dropdown-toggle',
        run: 'click',
    }, {
        content: "Open preferences / profile screen",
        trigger: '[data-menu=settings]',
        run: 'click',
    }, {
        content: "Switch to security tab",
        trigger: 'a[role=tab]:contains("Account Security")',
        run: 'click',
    }];
}

/**
 * Checks that the TOTP button is in the specified state (true = enabled =
 * can disable, false = disabled = can enable), then closes the profile dialog
 * if it's one (= hr not installed).
 *
 * If no totp state is provided, just checks that the toggle exists.
 */
function closeProfileDialog({content, totp_state}) {
    let trigger;
    switch (totp_state) {
    case true: trigger = 'button[name=action_totp_disable]'; break;
    case false: trigger = 'button[name=action_totp_enable_wizard]'; break;
    case undefined: trigger = 'button.o_auth_2fa_btn'; break;
    default: throw new Error(`Invalid totp state ${totp_state}`)
    }

    return [{
        content,
        //TODO: remove when PIPU macro PR is merged: https://github.com/odoo/odoo/pull/194508
        trigger: 'a[role=tab]:contains("Account Security").active',
        async run(helpers) {
            await waitFor(trigger, { timeout: 5000 });
            const modal = document.querySelector(".o_dialog");
            if (modal) {
                modal.querySelector("button[name=preference_cancel]").click();
            }
        }
    }, {
        trigger: 'body',
        async run() {
            while (document.querySelector('.o_dialog')) {
                await Promise.resolve();
            }
            this.anchor.classList.add("dialog-closed");
        },
    }, {
        trigger: 'body.dialog-closed',
    }];
}

registry.category("web_tour.tours").add('totp_tour_setup', {
    url: '/odoo',
    steps: () => [...openUserProfileAtSecurityTab(), {
    content: "Open totp wizard",
    //TODO: remove when PIPU macro PR is merged: https://github.com/odoo/odoo/pull/194508
    trigger: 'a[role=tab]:contains("Account Security").active',
    async run(actions) {
        const el = await waitFor('button[name=action_totp_enable_wizard]', { timeout: 5000 });
        await actions.click(el);
    }
},
{
    trigger: ".modal div:contains(entering your password)",
},
{
    content: "Check that we have to enter enhanced security mode and input password",
    trigger: '[name=password] input',
    run: 'edit test_user',
}, {
    content: "Confirm",
    trigger: "button:contains(Confirm Password)",
    run: "click",
}, {
    content: "Check the wizard has opened",
    trigger: '.modal li:contains("When requested to do so")',
}, {
    content: "Get secret from collapsed div",
    trigger: `.modal a:contains("Cannot scan it?")`,
    async run(helpers) {
        const secret = this.anchor
            .closest("div")
            .querySelector("[name=secret] span:first-child");
        const copyBtn = secret.querySelector("button");
        if (copyBtn) {
            copyBtn.remove();
        }
        const token = await rpc('/totphook', {
            secret: secret.textContent
        });
        await helpers.edit(token, '[name=code] input');
        document.querySelector("body").classList.add("got-token");
    }
},
{
    trigger: ".modal button.btn-primary:contains(Activate)",
    run: "click",
},
{
    trigger: "body:not(:has(.modal))",
},
{
    content: 'wait for rpc',
    trigger: 'body.got-token',
},
...openRoot(),
...openUserProfileAtSecurityTab(),
...closeProfileDialog({
    content: "Check that the button has changed",
    totp_state: true,
}),
]});

registry.category("web_tour.tours").add('totp_login_enabled', {
    url: '/',
    steps: () => [{
    content: "check that we're on the login page or go to it",
    trigger: 'input#login, a:contains(Sign in)',
    run: "click",
}, {
    content: "input login",
    trigger: 'input#login',
    run: "edit test_user",
}, {
    content: 'input password',
    trigger: 'input#password',
    run: "edit test_user",
}, {
    content: "click da button",
    trigger: 'button:contains("Log in")',
    run: "click",
}, {
    content: "expect totp screen",
    trigger: 'label:contains(Authentication Code)',
    run: "click",
}, {
    content: "input code",
    trigger: 'input[name=totp_token]',
    async run(helpers) {
        const token = await rpc('/totphook');
        helpers.edit(token);
    }
},
{
    trigger: `button:contains("Log in")`,
    run: "click",
},
{
    content: "check we're logged in",
    trigger: ".o_user_menu .dropdown-toggle",
}]});

registry.category("web_tour.tours").add('totp_login_device', {
    url: '/',
    steps: () => [{
    content: "check that we're on the login page or go to it",
    trigger: 'input#login, a:contains(Sign in)',
    run: "click",
}, {
    content: "input login",
    trigger: 'input#login',
    run: "edit test_user",
}, {
    content: 'input password',
    trigger: 'input#password',
    run: "edit test_user",
}, {
    content: "click da button",
    trigger: 'button:contains("Log in")',
    run: "click",
}, {
    content: "expect totp screen",
    trigger: 'label:contains(Authentication Code)',
    run: "click",
}, {
    content: "check remember device box",
    trigger: 'label[for=switch-remember]',
    run: "click",
}, {
    content: "input code",
    trigger: 'input[name=totp_token]',
    async run(helpers) {
        const token = await rpc('/totphook')
        helpers.edit(token);
    }
},
{
    trigger: "button:contains(Log in)",
    run: "click",
},
{
    content: "check we're logged in",
    trigger: ".o_user_menu .dropdown-toggle",
    run: 'click',
}, {
    content: "click the Log out button",
    trigger: '.dropdown-item[data-menu=logout]',
    run: "click",
}, {
    content: "check that we're back on the login page or go to it",
    trigger: 'input#login, a:contains(Log in)',
    run: "edit Test",
}, {
    content: "input login again",
    trigger: 'input#login',
    run: "edit test_user",
}, {
    content: 'input password again',
    trigger: 'input#password',
    run: "edit test_user",
}, {
    content: "click da button again",
    trigger: 'button:contains("Log in")',
    run: "click",
},  {
    content: "check we're logged in without 2FA",
    trigger: ".o_user_menu .dropdown-toggle",
},
// now go and disable two-factor authentication would be annoying to do in a separate tour
// because we'd need to login & totp again as HttpCase.authenticate can't
// succeed w/ totp enabled
...openUserProfileAtSecurityTab(),
{
    content: "Open totp wizard",
    //TODO: remove when PIPU macro PR is merged: https://github.com/odoo/odoo/pull/194508
    trigger: 'a[role=tab]:contains("Account Security").active',
    async run(actions) {
        const el = await waitFor('button[name=action_totp_disable]', { timeout: 5000 });
        await actions.click(el);
    }
},
{
    trigger: ".modal div:contains(entering your password)",
},
{
    content: "Check that we have to enter enhanced security mode and input password",
    trigger: '.modal [name=password] input',
    run: "edit test_user",
}, {
    content: "Confirm",
    trigger: ".modal button:contains(Confirm Password)",
    run: "click",
},
{
    trigger: "body:not(:has(.modal))",
},
...openRoot(),
...openUserProfileAtSecurityTab(),
...closeProfileDialog({
    content: "Check that the button has changed",
    totp_state: false
}),
]});

registry.category("web_tour.tours").add('totp_login_disabled', {
    url: '/',
    steps: () => [{
    content: "check that we're on the login page or go to it",
    trigger: 'input#login, a:contains(Sign in)',
    run: "click",
}, {
    content: "input login",
    trigger: 'input#login',
    run: "edit test_user",
}, {
    content: 'input password',
    trigger: 'input#password',
    run: "edit test_user",
}, {
    content: "click da button",
    trigger: 'button:contains("Log in")',
    run: "click",
},
// normally we'd end the tour here as it's all we care about but there are a
// bunch of ongoing queries from the loading of the web client which cause
// issues, so go and open the preferences / profile screen to make sure
// everything settles down
...openUserProfileAtSecurityTab(),
// close the dialog if that makes sense
...closeProfileDialog({})
]});

const columns = {};
registry.category("web_tour.tours").add('totp_admin_disables', {
    url: '/odoo',
    steps: () => [stepUtils.showAppsMenuItem(), {
    content: 'Go to settings',
    trigger: '[data-menu-xmlid="base.menu_administration"]',
    run: "click",
}, {
    content: 'Wait for page',
    trigger: '.o_menu_brand:contains("Settings")',
}, {
    content: "Open Users menu",
    trigger: '[data-menu-xmlid="base.menu_users"]',
    run: "click",
}, {
    content: "Open Users view",
    trigger: '[data-menu-xmlid="base.menu_action_res_users"]',
    run: "click",
}, {
    content: "Find test_user User",
    trigger: 'td.o_data_cell:contains("test_user")',
    run(helpers) {
        const titles = queryAll("tr:first th", { root: this.anchor.closest("table") });
        titles.forEach((el, i) => {
            columns[el.getAttribute('data-name')] = i;
        })
        const row = this.anchor.closest('tr');
        const sel = row.querySelector('.o_list_record_selector input[type=checkbox]');
        helpers.click(sel);
    }
}, {
    content: "Open Actions menu",
    trigger: 'button.dropdown-toggle:contains("Action")',
    run: "click",
}, {
    content: "Select totp remover",
    trigger: 'span.dropdown-item:contains(Disable two-factor authentication)',
    run: "click",
},
{
    trigger: ".modal div:contains(entering your password)",
},
{ // enhanced security yo
    content: "Check that we have to enter enhanced security mode & input password",
    trigger: '.modal [name=password] input',
    run: "edit admin",
}, {
    content: "Confirm",
    trigger: ".modal button:contains(Confirm Password)",
    run: "click",
},
{
    content: "Wait the modal is closed",
    trigger: "body:not(:has(.modal))",
},
{
    content: "open the user's form",
    trigger: "td.o_data_cell:contains(test_user)",
    run: "click",
}, {
    content: "go to Account security Tab",
    trigger: "a.nav-link:contains(Account Security)",
    run: "click",
}, {
    content: "check 2FA button",
    trigger: 'body',
    run: () => {
        const button = document.querySelector('button[name=action_totp_enable_wizard]').disabled
        if (!button) {
            console.error("2FA button should be disabled.");
        }
    },
}
]})

return __exports;
});
;

/********************************************************
*  Filepath: /auth_totp_mail/static/tests/totp_flow.js  *
*  Lines: 84                                            *
********************************************************/
odoo.define('@auth_totp_mail/../tests/totp_flow', ['@web/core/registry', '@web_tour/tour_service/tour_utils', '@odoo/hoot-dom'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { registry } = require("@web/core/registry");
const { stepUtils } = require("@web_tour/tour_service/tour_utils");
const { queryFirst } = require("@odoo/hoot-dom");

function openAccountSettingsTab() {
    return [{
        content: 'Go to settings',
        trigger: '[data-menu-xmlid="base.menu_administration"]',
        run: "click",
    }, {
        content: 'Wait for page',
        trigger: '.o_menu_brand:contains("Settings")',
    }, {
        content: "Open Users menu",
        trigger: '[data-menu-xmlid="base.menu_users"]',
        run: "click",
    }, {
        content: "Open Users view",
        trigger: '[data-menu-xmlid="base.menu_action_res_users"]',
        run: function (helpers) {
            // funny story: the users view we're trying to reach, sometimes we're
            // already there, but if we re-click the next step executes before the
            // action has the time to re-load, the one after that doesn't, and our
            // selection get discarded by the action reloading, so here try to
            // see if we're already on the users action through the breadcrumb and
            // just close the menu if so
            const breadcrumb = document.querySelector('.breadcrumb');
            if (!breadcrumb || !breadcrumb.textContent.includes("Users")) {
                // on general settings page, click menu
                helpers.click();
            } else {
                // else close menu
                helpers.click('[data-menu-xmlid="base.menu_users"]');
            }
        }
    }];
}

registry.category("web_tour.tours").add('totp_admin_self_invite', {
    url: '/odoo',
    steps: () => [stepUtils.showAppsMenuItem(), ...openAccountSettingsTab(), {
    content: "open the user's form",
    trigger: "td.o_data_cell:contains(admin)",
    run: "click",
}, {
    content: "go to Account security Tab",
    trigger: "a.nav-link:contains(Account Security)",
    run: "click",
}, {
    content: "check that user cannot invite themselves to use 2FA.",
    trigger: "body",
    run: function () {
        const inviteBtn = queryFirst('button:contains(Invite to use 2FA)');
        if (!inviteBtn) {
            document.body.classList.add('CannotInviteYourself');
        }
    }
}, {
    content: "check that user cannot invite themself.",
    trigger: "body.CannotInviteYourself",
}]});

registry.category("web_tour.tours").add('totp_admin_invite', {
    url: '/odoo',
    steps: () => [stepUtils.showAppsMenuItem(), ...openAccountSettingsTab(), {
    content: "open the user's form",
    trigger: "td.o_data_cell:contains(test_user)",
    run: "click",
}, {
    content: "go to Account security Tab",
    trigger: "a.nav-link:contains(Account Security)",
    run: "click",
}, {
    content: "check that test_user user can be invited to use 2FA.",
    trigger: "button:contains(Invite to use 2FA)",
}]});

return __exports;
});
;

/************************************************************
*  Filepath: /auth_totp_portal/static/tests/totp_portal.js  *
*  Lines: 130                                               *
************************************************************/
odoo.define('@auth_totp_portal/../tests/totp_portal', ['@web/core/registry', '@web/core/network/rpc'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { registry } = require("@web/core/registry");
const { rpc } = require("@web/core/network/rpc");

registry.category("web_tour.tours").add('totportal_tour_setup', {
    url: '/my/security',
    steps: () => [{
    content: "Open totp wizard",
    trigger: 'button#auth_totp_portal_enable',
    run: "click",
}, {
    content: "Check that we have to enter enhanced security mode",
    trigger: ".modal div:contains(enter your password)",
}, {
    content: "Input password",
    trigger: '[name=password]',
    run: "edit portal", // FIXME: better way to do this?
}, {
    content: "Confirm",
    trigger: "button:contains(Confirm Password)",
    run: "click",
}, {
    content: "Check the wizard has opened",
    trigger: 'li:contains("scan the barcode below")',
}, {
    content: "Get secret from collapsed div",
    trigger: 'a:contains("Cannot scan it?")',
    run: async function(helpers) {
        const secret = this.anchor
            .closest("div")
            .querySelector('span[name="secret"]').textContent;
        const token = await rpc('/totphook', {
            secret
        });
        await helpers.edit(token, 'input[name="code"]');
        await helpers.click("button.btn-primary:contains(Activate)");
    }
}, {
    content: "Check that the button has changed",
    trigger: 'button:contains(Disable two-factor authentication)',
}]});

registry.category("web_tour.tours").add('totportal_login_enabled', {
    url: '/',
    steps: () => [{
    content: "check that we're on the login page or go to it",
    trigger: 'input#login, a:contains(Sign in)',
    run: "click",
}, {
    content: "input login",
    trigger: 'input#login',
    run: "edit portal",
}, {
    content: 'input password',
    trigger: 'input#password',
    run: "edit portal",
}, {
    content: "click da button",
    trigger: 'button:contains("Log in")',
    run: "click",
}, {
    content: "expect totp screen",
    trigger: 'label:contains(Authentication Code)',
    run: "click",
}, {
    content: "input code",
    trigger: 'input[name=totp_token]',
    run: async function (helpers) {
        const token = await rpc('/totphook');
        await helpers.edit(token);
        // FIXME: is there a way to put the button as its own step trigger without
        //        the tour straight blowing through and not waiting for this?
        await helpers.click('button:contains("Log in")');
    }
}, {
    content: "check we're logged in",
    trigger: "h3:contains(My account)",
}, {
    content: "go back to security",
    trigger: "a:contains(Security)",
    run: "click",
},{
    content: "Open totp wizard",
    trigger: 'button#auth_totp_portal_disable',
    run: "click",
}, {
    content: "Check that we have to enter enhanced security mode",
    trigger: ".modal div:contains(enter your password)",
}, {
    content: "Input password",
    trigger: '[name=password]',
    run: "edit portal", // FIXME: better way to do this?
}, {
    content: "Confirm",
    trigger: "button:contains(Confirm Password)",
    run: "click",
}, {
    content: "Check that the button has changed",
    trigger: 'button:contains(Enable two-factor authentication)',
}]});

registry.category("web_tour.tours").add('totportal_login_disabled', {
    url: '/',
    steps: () => [{
    content: "check that we're on the login page or go to it",
    trigger: 'input#login, a:contains(Sign in)',
    run: "click",
}, {
    content: "input login",
    trigger: 'input#login',
    run: "edit portal",
}, {
    content: 'input password',
    trigger: 'input#password',
    run: "edit portal",
}, {
    content: "click da button",
    trigger: 'button:contains("Log in")',
    run: "click",
}, {
    content: "check we're logged in",
    trigger: "h3:contains(My account)",
}]});

return __exports;
});
;

/**********************************************************************
*  Filepath: /event_sale/static/tests/tours/event_configurator_ui.js  *
*  Lines: 67                                                          *
**********************************************************************/
odoo.define('@event_sale/../tests/tours/event_configurator_ui', ['@web/core/registry', '@web_tour/tour_service/tour_utils', '@sale/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { registry } = require("@web/core/registry");
const { stepUtils } = require("@web_tour/tour_service/tour_utils");
const tourUtils = require("@sale/js/tours/tour_utils")[Symbol.for("default")];

registry.category("web_tour.tours").add("event_configurator_tour", {
    url: "/odoo",
    steps: () => [
        ...stepUtils.goToAppSteps("sale.sale_menu_root", "Go to the Sales App"),
        ...tourUtils.createNewSalesOrder(),
        ...tourUtils.selectCustomer("Azure"),
        ...tourUtils.addProduct("Event Registration"),
        {
            trigger: 'div[name="event_id"] input',
            run: "click",
        },
        {
            trigger: "ul.ui-autocomplete a:contains(Design)",
            run: "click",
        },
        {
            trigger: 'div[name="event_ticket_id"] input',
            run: "click",
        },
        {
            trigger: "ul.ui-autocomplete a:contains(VIP)",
            run: "click",
        },
        {
            trigger: ".modal .o_event_sale_js_event_configurator_ok",
            run: "click",
        },
        {
            content: "Wait the modal is closed",
            trigger: "body:not(:has(.modal))",
        },
        ...tourUtils.clickSomewhereElse(),
        tourUtils.editLineMatching("Event Registration", "VIP"),
        tourUtils.editConfiguration(),
        {
            trigger: 'div[name="event_ticket_id"] input',
            run: "click",
        },
        {
            trigger: "ul.ui-autocomplete a:contains(Standard)",
            run: "click",
        },
        {
            trigger: ".modal .o_event_sale_js_event_configurator_ok",
            run: "click",
        },
        {
            content: "Wait the modal is closed",
            trigger: "body:not(:has(.modal))",
        },
        ...tourUtils.clickSomewhereElse(),
        tourUtils.checkSOLDescriptionContains("Event Registration", "Standard"),
        ...stepUtils.saveForm(),
    ],
});

return __exports;
});
;

/*****************************************************************************
*  Filepath: /project_enterprise/static/tests/tours/task_gantt_tour_test.js  *
*  Lines: 47                                                                 *
*****************************************************************************/
odoo.define('@project_enterprise/../tests/tours/task_gantt_tour_test', ['@web/core/registry', '@project/../tests/tours/project_tour', '@web/core/utils/patch'], function (require) {
'use strict';
let __exports = {};
/**
 * Add custom steps to go to map and gantt view in Project app
 */
const { registry } = require("@web/core/registry");
require("@project/../tests/tours/project_tour");
const { patch } = require("@web/core/utils/patch");


patch(registry.category("web_tour.tours").get("project_test_tour"), {
    steps() {
        const originalSteps = super.steps();
        const taskCreationStepIndex = originalSteps.findIndex((step) => step.id === "quick_create_tasks");

        originalSteps.splice(taskCreationStepIndex + 1, 0, {
            trigger: '.o_switch_view.o_gantt',
            content: 'Open Gantt View',
            run: "click",
        }, {
            id: 'gantt_add_task',
            trigger: '.o_gantt_button_add',
            content: 'Add a task in gantt',
            run: "click",
        });

        originalSteps.splice(originalSteps.length, 0, {
            trigger: ".o_gantt_renderer_controls .dropdown:nth-child(2)",
            content: "Open range menu",
            run: "click",
        },
        {
            trigger: '.o_gantt_range_menu .dropdown-item:nth-child(3)',
            content: 'Select "This Month"',
            run: "click",
        },
        {
            trigger: ".o_gantt_progress_bar.o_gantt_group_danger",
            content: "See user progress bar",
        })
        return originalSteps;
    }
});

return __exports;
});
;

/*********************************************************************************************
*  Filepath: /sale_pdf_quote_builder/static/tests/tours/custom_content_kanban_like_tests.js  *
*  Lines: 30                                                                                 *
*********************************************************************************************/
odoo.define('@sale_pdf_quote_builder/../tests/tours/custom_content_kanban_like_tests', ['@web/core/registry', '@web_tour/tour_service/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { registry } = require("@web/core/registry");
const { stepUtils } = require("@web_tour/tour_service/tour_utils");

registry.category("web_tour.tours").add('custom_content_kanban_like_tour', {
    steps: () => [
        {
            trigger: "ul.nav a:contains(Quote Builder)",
            run: "click",
        },
        {
            trigger: "label:contains(Header)",
            run: "click",
        },
        {
            trigger: "h5:contains(custom_1) ~ div textarea",
            break: true,
            run: "edit Test",
        },
        ...stepUtils.saveForm(),
        // TODO VCR: Finish this
    ]
});

return __exports;
});
;

/**************************************************************************
*  Filepath: /sale_project/static/tests/tours/project_create_sol_tour.js  *
*  Lines: 64                                                              *
**************************************************************************/
odoo.define('@sale_project/../tests/tours/project_create_sol_tour', ['@web/core/registry', '@web_tour/tour_service/tour_utils'], function (require) {
'use strict';
let __exports = {};
const { registry } = require("@web/core/registry");
const { stepUtils } = require("@web_tour/tour_service/tour_utils");

registry.category("web_tour.tours").add('project_create_sol_tour', {
    url: "/odoo",
    steps: () => [
    stepUtils.showAppsMenuItem(), {
        trigger: ".o_app[data-menu-xmlid='project.menu_main_pm']",
        content: 'Select Project main menu.',
        run: "click",
    }, {
        trigger: ".o_kanban_record:contains(Test History Project):first",
        content: "Open the project dropdown of project name 'Test History Project'.",
        run: "hover && click .o_kanban_record:contains(Test History Project):first .o_dropdown_kanban .dropdown-toggle",
    }, {
        trigger: ".o_kanban_card_manage_settings a:contains('Settings')",
        content: 'Start editing the project.',
        run: "click",
    }, {
        trigger: ".o_field_widget[name='partner_id'] input",
        content: "Add the customer for this project",
        run: "click",
    }, {
        isActive: ["auto"],
        trigger: ".ui-autocomplete > li > a:not(:has(i.fa))",
        content: "Select the customer in the autocomplete dropdown",
        run: "click",
    },
    {
        trigger: 'div.o_notebook_headers',
    },
    {
        trigger: 'a.nav-link[name="settings"]',
        content: 'Click on Settings tab to configure this project.',
        run: "click",
    }, {
        id: "project_sale_timesheet_start",
        trigger: "div[name='sale_line_id'] input",
        content: 'Add the Sales Order Item',
        run: "fill New Sale order line",
    }, {
        trigger: ".o_field_widget[name=sale_line_id] .o-autocomplete--dropdown-menu .o_m2o_dropdown_option_create a",
        content: "Create an Sales Order Item in the autocomplete dropdown.",
        run: "click",
    },
    {
        trigger: "body:not(:has(.modal))",
    },
    {
        trigger: ".o_form_button_save:enabled",
        content: "Save project",
        run: "click",
    },
    // Those steps are currently needed in order to prevent the following issue:
    // "Form views in edition mode are automatically saved when the page is closed, which leads to stray network requests and inconsistencies."
    ...stepUtils.toggleHomeMenu(),
    ...stepUtils.goToAppSteps("project.menu_main_pm", 'Go to the Project app.'),
]});

return __exports;
});
;

/***************************************************************
*  Filepath: /sale_project/static/tests/tours/project_tour.js  *
*  Lines: 30                                                   *
***************************************************************/
odoo.define('@sale_project/../tests/tours/project_tour', ['@web/core/registry', '@project/../tests/tours/project_tour', '@web/core/utils/patch'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module */

/**
 * Add custom step to check allow_billable during project creation
 * to be able to set a partner on project/tasks.
 */
const { registry } = require("@web/core/registry");
require("@project/../tests/tours/project_tour");
const { patch } = require("@web/core/utils/patch");

patch(registry.category("web_tour.tours").get("project_test_tour"), {
    steps() {
        const originalSteps = super.steps();
        const projectCreationStepIndex = originalSteps.findIndex(
            (step) => step.id === "project_creation"
        );
        originalSteps.splice(projectCreationStepIndex, 0, {
            trigger: "div[name='allow_billable'] input",
            run: "edit Test",
        });

        return originalSteps;
    },
});

return __exports;
});
;

/***********************************************************************
*  Filepath: /sale_project/static/tests/tours/task_create_sol_tour.js  *
*  Lines: 88                                                           *
***********************************************************************/
odoo.define('@sale_project/../tests/tours/task_create_sol_tour', ['@web/core/registry', '@web_tour/tour_service/tour_utils'], function (require) {
'use strict';
let __exports = {};
const { registry } = require("@web/core/registry");
const { stepUtils } = require("@web_tour/tour_service/tour_utils");

registry.category("web_tour.tours").add("task_create_sol_tour", {
    url: "/odoo",
    steps: () => [
        stepUtils.showAppsMenuItem(),
        {
            content: "Select Project main menu.",
            trigger: ".o_app[data-menu-xmlid='project.menu_main_pm']",
            run: "click",
        },
        {
            content: "Open the project dropdown of project name 'Test History Project'.",
            trigger: ".o_kanban_record:contains(Test History Project):first",
            run: "click",
        },
        {
            content: "Open the task name 'Test History Project' from kanban view.",
            trigger: ".o_kanban_record:contains(Test History Task)",
            run: "click",
        },
        {
            content: "Add the customer for this task to select an SO and SOL.",
            trigger: ".o_field_widget[name='partner_id'] input",
            run: "click",
        },
        {
            content: "Select the customer in the autocomplete dropdown",
            trigger: ".ui-autocomplete > li > a:not(:has(i.fa))",
            run: "click",
        },
        {
            content: "Add the Sales Order Item",
            trigger: "div[name='sale_line_id'] input",
            run: "fill New Sale order line",
        },
        {
            content: "Create an Sales Order Item in the autocomplete dropdown.",
            trigger:
                ".o_field_widget[name=sale_line_id] .o-autocomplete--dropdown-menu .o_m2o_dropdown_option_create_edit a",
            run: "click",
        },
        {
            content: "Create an product in the autocomplete dropdown.",
            trigger: "div[name='product_id'] input",
            run: "click",
        },
        {
            content: "Select the product in the autocomplete dropdown",
            trigger: ".ui-autocomplete > li > a:not(:has(i.fa))",
            run: "click",
        },
        {
            content: "Save Sales Order Item",
            trigger: ".modal .o_form_button_save",
            run: "click",
        },
        {
            content: "wait the modal is closed before save the form",
            trigger: "body:not(:has(.modal))",
        },
        {
            content: "Save task",
            trigger: ".o_form_button_save:enabled",
            run: "click",
        },
        {
            content: "Check if the Sales Order Item is saved correctly.",
            trigger: ".o_field_widget[name='sale_line_id'] input",
            run() {
                if (!this.anchor.value) {
                    console.error("Sales Order Item is not saved correctly.");
                }
            },
        },
        // Those steps are currently needed in order to prevent the following issue:
        // "Form views in edition mode are automatically saved when the page is closed, which leads to stray network requests and inconsistencies."
        ...stepUtils.toggleHomeMenu(),
        ...stepUtils.goToAppSteps("project.menu_main_pm", "Go to the Project app."),
    ],
});

return __exports;
});
;

/********************************************************************************************
*  Filepath: /website_event_sale/static/tests/tours/helpers/WebsiteEventSaleTourMethods.js  *
*  Lines: 90                                                                                *
********************************************************************************************/
odoo.define('@website_event_sale/../tests/tours/helpers/WebsiteEventSaleTourMethods', ['@website_sale/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/
const wsTourUtils = require('@website_sale/js/tours/tour_utils');

const closeModal = {
    content: "Close the ticket picking modal",
    trigger: `.modal.modal_shown .modal-content button:contains("Close")`,
    run: "click",
};

__exports.changePricelist = changePricelist; function changePricelist(pricelistName) {
    return [
        {
            content: "Go to page Shop",
            trigger: '.nav-link:contains("Shop")',
            run: "click",
        },
        {
            content: "Toggle Pricelist",
            trigger: '.o_pricelist_dropdown > .dropdown-toggle',
            run: 'click',
        },
        {
            content: `Activate Pricelist ${pricelistName}`,
            trigger: `.dropdown-item:contains(${pricelistName})`,
            run: 'click',
        },
        {
            content: 'Wait for pricelist to load',
            trigger: `.dropdown-toggle:contains(${pricelistName})`,
        },
    ];
}
function checkPriceEvent(eventName, price, close = true) {
    const steps = [
        {
            content: "Go to page Event",
            trigger: '.nav-link:contains("Event")',
            run: "click",
        },
        {
            content: "Open the Pycon event",
            trigger: `.o_wevent_events_list a:contains(${eventName})`,
            run: "click",
        },
        {
            content: "Open the ticket picking modal",
            trigger: `button:contains("Register")`,
            run: "click",
        },
        {
            content: "Verify Price",
            trigger: `.oe_currency_value:contains(${price})`,
        },
    ];
    if (close) {
        steps.push(closeModal);
    }
    return steps;
}
function checkPriceDiscountEvent(eventName, price, discount) {
    return [
        ...checkPriceEvent(eventName, price, false),
        {
            content: "Verify Price before discount",
            trigger: `del:contains(${discount})`,
        },
        closeModal,
    ];
}
__exports.checkPriceCart = checkPriceCart; function checkPriceCart(price) {
    return [
        wsTourUtils.goToCart(),
        ...wsTourUtils.assertCartAmounts({total: price}),
    ]
}
const getPriceListChecksSteps = __exports.getPriceListChecksSteps = function ({pricelistName, eventName, price, priceBeforeDiscount=false}) {
    const checkPriceSteps = priceBeforeDiscount ? checkPriceDiscountEvent(eventName, price, priceBeforeDiscount) : checkPriceEvent(eventName, price);
    return [
        ...changePricelist(pricelistName),
        ...checkPriceSteps,
        ...checkPriceCart(price),
    ]
}
__exports[Symbol.for("default")] = { getPriceListChecksSteps, changePricelist, checkPriceCart }

return __exports;
});
;

/***************************************************************************
*  Filepath: /website_event_sale/static/tests/tours/website_event_sale.js  *
*  Lines: 108                                                              *
***************************************************************************/
odoo.define('@website_event_sale/../tests/tours/website_event_sale', ['@web/core/registry', '@website_sale/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { registry } = require("@web/core/registry");
const wsTourUtils = require("@website_sale/js/tours/tour_utils");

registry.category("web_tour.tours").add("event_buy_tickets", {
    url: "/event",
    steps: () => [
        {
            content: "Go to the `Events` page",
            trigger: 'a[href*="/event"]:contains("Conference for Architects TEST"):first',
            run: "click",
        },
        {
            content: "Open the register modal",
            trigger: 'button:contains("Register")',
            run: "click",
        },
        {
            trigger: '#wrap:not(:has(a[href*="/event"]:contains("Conference for Architects")))',
        },
        {
            content: "Select 1 unit of `Standard` ticket type",
            trigger: ".modal select:eq(0)",
            run: "select 1",
        },
        {
            trigger: ".modal select:eq(0):has(option:contains(1):selected)",
        },
        {
            content: "Select 2 units of `VIP` ticket type",
            trigger: ".modal select:eq(1)",
            run: "select 2",
        },
        {
            trigger: ".modal select:eq(1):has(option:contains(2):selected)",
        },
        {
            content: "Click on `Order Now` button",
            trigger: '.modal .btn-primary:contains("Register")',
            run: "click",
        },
        {
            content: "Wait the modal is shown before continue",
            trigger: ".modal.modal_shown.show form[id=attendee_registration]",
        },
        {
            trigger: ".modal#modal_attendees_registration input[name*='1-email']",
            run: "edit att1@example.com",
        },
        {
            trigger: ".modal#modal_attendees_registration input[name*='1-phone']",
            run: "edit 111 111",
        },
        {
            trigger: ".modal#modal_attendees_registration input[name*='2-name']",
            run: "edit Att2",
        },
        {
            trigger: ".modal#modal_attendees_registration input[name*='2-phone']",
            run: "edit 222 222",
        },
        {
            trigger: ".modal#modal_attendees_registration input[name*='2-email']",
            run: "edit att2@example.com",
        },
        {
            trigger: ".modal#modal_attendees_registration input[name*='1-name']",
            run: "edit Att1",
        },
        {
            trigger: ".modal#modal_attendees_registration input[name*='3-name']",
            run: "edit Att3",
        },
        {
            trigger: ".modal#modal_attendees_registration input[name*='3-phone']",
            run: "edit 333 333",
        },
        {
            trigger: ".modal#modal_attendees_registration input[name*='3-email']",
            run: "edit att3@example.com",
        },
        {
            trigger:
                ".modal#modal_attendees_registration input[name*='1-name'], .modal#modal_attendees_registration input[name*='2-name'], .modal#modal_attendees_registration input[name*='3-name']",
        },
        {
            trigger: "input[name*='1-name'], input[name*='2-name'], input[name*='3-name']",
        },
        {
            content: "Validate attendees details",
            trigger: ".modal#modal_attendees_registration button[type=submit]",
            run: "click",
        },
        wsTourUtils.goToCart({ quantity: 3 }),
        wsTourUtils.goToCheckout(),
        ...wsTourUtils.assertCartAmounts({
            untaxed: "4,000.00",
        }),
        ...wsTourUtils.payWithTransfer(),
    ],
});

return __exports;
});
;

/***************************************************************************************
*  Filepath: /website_event_sale/static/tests/tours/website_event_sale_last_ticket.js  *
*  Lines: 75                                                                           *
***************************************************************************************/
odoo.define('@website_event_sale/../tests/tours/website_event_sale_last_ticket', ['@web/core/registry', '@website_sale/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { registry } = require("@web/core/registry");
const wsTourUtils = require("@website_sale/js/tours/tour_utils");

registry.category("web_tour.tours").add('event_buy_last_ticket', {
    url: '/event',
    steps: () => [{
        content: "Open the Last ticket test event page",
        trigger: '.o_wevent_events_list a:contains("Last ticket test")',
        run: "click",
    },
    {
        content: "Open Registration Modal",
        trigger: ".btn-primary:contains(Register)",
        run: "click",
    },
    {
        content: "Check the modal Tickets is opened",
        trigger: "body:has(.modal:contains(Tickets))",
    },
    {
        trigger: '#wrap:not(:has(a[href*="/event"]:contains("Last ticket test")))',
    },
    {
        content: "Select 2 units of `VIP` ticket type",
        trigger: ".modal select:eq(0)",
        run: "select 2",
    },
    {
        trigger: ".modal select:eq(0):has(option:contains(2):selected)",
    },
    {
        content: "Click on `Register` button",
        trigger: ".modal .modal-footer button.btn-primary.a-submit:contains(Register)",
        run: "click",
    },
    {
        content: "Check the modal Attendees is opened",
        trigger: ".modal:contains(Attendees):contains(Ticket #1):contains(Ticket #2)",
    },
    {
        content: "Fill attendees details",
        trigger: 'form[id="attendee_registration"] .btn[type=submit]',
        run: function () {
            document.querySelector("input[name*='1-name']").value = "Att1";
            document.querySelector("input[name*='1-phone']").value = "111 111";
            document.querySelector("input[name*='1-email']").value = "att1@example.com";
            document.querySelector("input[name*='2-name']").value = "Att2";
            document.querySelector("input[name*='2-phone']").value = "222 222";
            document.querySelector("input[name*='2-email']").value = "att2@example.com";
        },
    },
    {
        content: "Validate attendees details",
        trigger: ".modal:contains(Attendees) button[type=submit]:contains(Go to Payment)",
        run: "click",
    },
    ...wsTourUtils.fillAdressForm({
        name: "test1",
        phone: "111 111",
        email: "test@example.com",
        street: "street test 1",
        city: "testCity",
        zip: "123",
    }),
    ...wsTourUtils.payWithTransfer(true),
    ],
});

return __exports;
});
;

/**************************************************************************************
*  Filepath: /website_event_sale/static/tests/tours/website_event_sale_pricelists.js  *
*  Lines: 79                                                                          *
**************************************************************************************/
odoo.define('@website_event_sale/../tests/tours/website_event_sale_pricelists', ['@web/core/registry', '@website_event_sale/../tests/tours/helpers/WebsiteEventSaleTourMethods'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { registry } = require("@web/core/registry");
const { getPriceListChecksSteps } = require("@website_event_sale/../tests/tours/helpers/WebsiteEventSaleTourMethods");

registry.category("web_tour.tours").add("event_sale_pricelists_different_currencies", {
    url: "/event",
    steps: () => [
        // Register for tickets
        {
            content: "Open the Pycon event",
            trigger: '.o_wevent_events_list a:contains("Pycon")',
            run: "click",
        },
        {
            content: "Open the register modal",
            trigger: 'button:contains("Register")',
            run: "click",
        },
        {
            content: "Click on Register button inside modal",
            trigger: '.modal .modal-footer button:contains("Register")',
            run: "click",
        },
        {
            content: "Wait the modal is shown before continue",
            trigger: ".modal.modal_shown.show form[id=attendee_registration]",
        },
        {
            trigger:
                ".modal#modal_attendees_registration:not(.o_inactive_modal) input[name*='1-name']",
            run: "edit Great Name",
        },
        {
            trigger:
                ".modal#modal_attendees_registration:not(.o_inactive_modal) input[name*='1-phone']",
            run: "edit 111 111",
        },
        {
            trigger:
                ".modal#modal_attendees_registration:not(.o_inactive_modal) input[name*='1-email']",
            run: "edit great@name.com",
        },
        {
            trigger:
                ".modal#modal_attendees_registration input[name*='1-name'], .modal#modal_attendees_registration input[name*='2-name']",
        },
        {
            trigger: "input[name*='1-name'], input[name*='2-name']",
        },
        {
            content: "Validate attendees details",
            trigger:
                ".modal#modal_attendees_registration:not(.o_inactive_modal) button[type=submit]",
            run: "click",
        },
        {
            trigger: "body:not(:has(.modal#modal_attendees_registration))",
        },
        ...getPriceListChecksSteps({
            pricelistName: "EUR Without Discount Included",
            eventName: "Pycon",
            price: "90.00",
            priceBeforeDiscount: "100.00",
        }),
        ...getPriceListChecksSteps({
            pricelistName: "EX Without Discount Included",
            eventName: "Pycon",
            price: "900.00",
            priceBeforeDiscount: "1,000.00",
        }),
    ],
});

return __exports;
});
;

/**************************************************************************************
*  Filepath: /website_profile/static/tests/tours/tour_website_profile_description.js  *
*  Lines: 33                                                                          *
**************************************************************************************/
odoo.define('@website_profile/../tests/tours/tour_website_profile_description', ['@web/core/registry'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module */

const { registry } = require("@web/core/registry");

registry.category("web_tour.tours").add('website_profile_description', {
    url: "/profile/users",
    steps: () => [{
        content: "Click on one user profile card",
        trigger: "div[onclick]:contains(\"test_user\")",
        run: "click",
    }, {
        content: "Edit profile",
        trigger: "a:contains('EDIT PROFILE')",
        run: "click",
    }, {
        content: "Add some content",
        trigger: ".odoo-editor-editable p",
        run: "editor content <p>code here</p>",
    }, {
        content: "Save changes",
        trigger: "button:contains('Update')",
        run: "click",
    }, {
        content: "Check the content is saved",
        trigger: "span[data-oe-field='website_description']:contains('content <p>code here</p>')",
    }]
})

return __exports;
});
;

/***************************************************************************
*  Filepath: /website_sale_autocomplete/static/tests/autocomplete_tour.js  *
*  Lines: 49                                                               *
***************************************************************************/
odoo.define('@website_sale_autocomplete/../tests/autocomplete_tour', ['@web/core/registry', '@website_sale/js/tours/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module */

const { registry } = require("@web/core/registry");
const tourUtils = require('@website_sale/js/tours/tour_utils');


registry.category("web_tour.tours").add('autocomplete_tour', {
    url: '/shop', // /shop/address is redirected if no sales order
    steps: () => [
    ...tourUtils.addToCart({productName: "A test product"}),
    tourUtils.goToCart(),
    tourUtils.goToCheckout(),
{ // Actual test
    content: 'Input in Street & Number field',
    trigger: 'input[name="street"]',
    run: "edit This is a test",
}, {
    content: 'Check if results have appeared',
    trigger: '.js_autocomplete_result',
}, {
    content: 'Input again in street field',
    trigger: 'input[name="street"]',
    run: "fill add more",
}, {
    content: 'Click on the first result',
    trigger: ".dropdown-menu .js_autocomplete_result:first:contains(result 0)",
    run: "click",
},
// TODO: Make this step work in headless mode
// {
//     content: "Verify the autocomplete box disappeared",
//     trigger: `body:not(:has(.dropdown-menu .js_autocomplete_result))`,
// },
{ // Verify test data has been input
    content: 'Check Street & number have been set',
    trigger: "input[name=street]:value(/^42 A fictional Street$/)",
}, {
    content: 'Check City is not empty anymore',
    trigger: 'input[name="city"]:value(/^A Fictional City$/)',
}, {
    content: 'Check Zip code is not empty anymore',
    trigger: 'input[name="zip"]:value(/^12345$/)',
}]});

return __exports;
});
;

/******************************************************************************
*  Filepath: /website_studio/static/tests/tours/website_studio_main_tours.js  *
*  Lines: 170                                                                 *
******************************************************************************/
odoo.define('@website_studio/../tests/tours/website_studio_main_tours', ['@web/core/registry', '@web_studio/../tests/tours/tour_helpers'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module */

const { registry } = require("@web/core/registry");
const { assertEqual } = require("@web_studio/../tests/tours/tour_helpers");

registry.category("web_tour.tours").add("website_studio_listing_and_page", {
    url: "/odoo/action-studio?debug=1&mode=home_menu",
    steps: () => [
        {
            trigger: "a.o_menuitem:contains('StudioApp')",
            run: "click",
        },
        {
            trigger: ".o_menu_sections a:contains('Model Pages')",
            run: "click",
        },
        {
            content: "Create a listing page",
            trigger: ".o-kanban-button-new",
            run: "click",
        },
        {
            content: "Set the name of the page",
            trigger: "div[name='name'] input",
            run: "edit MyCustom Name && press Tab",
        },
        {
            trigger: "div[name='name_slugified'] input:value(mycustom-name)",
        },
        {
            content: "listing is displayed in the menu by default",
            trigger: "div[name='use_menu'] input:checked",
        },
        {
            content:
                "creating a listing automatically creates a detailed page for each record to be consulted separately",
            trigger: "div[name='auto_single_page'] input:checked",
        },
        {
            trigger: ".o_form_button_save",
            run: "click",
        },
        {
            trigger: ".o_back_button",
            run: "click",
        },
        {
            trigger: ".o_kanban_view",
            run() {
                const pages = this.anchor.querySelectorAll(".o_kanban_record:not(.o_kanban_ghost)");
                assertEqual(pages.length, 1);
                assertEqual(pages[0].querySelector("[data-section='title']").textContent, "MyCustom Name");
            },
        },
    ],
});

registry.category("web_tour.tours").add("website_studio_listing_without_page", {
    url: "/odoo/action-studio?debug=1&mode=home_menu",
    steps: () => [
        {
            trigger: "a.o_menuitem:contains('StudioApp')",
            run: "click",
        },
        {
            trigger: ".o_menu_sections a:contains('Model Pages')",
            run: "click",
        },
        {
            content: "Create a listing page",
            trigger: ".o-kanban-button-new",
            run: "click",
        },
        {
            content: "Set the name of the page",
            trigger: "div[name='name'] input",
            run: "edit MyCustom Name && press Tab",
        },
        {
            trigger: "div[name='name_slugified'] input:value(mycustom-name)",
        },
        {
            content: "listing is displayed in the menu by default",
            trigger: "div[name='use_menu'] input:checked",
        },
        {
            content:
                "creating a listing automatically creates a detailed page for each record to be consulted separately",
            trigger: "div[name='auto_single_page'] input:checked",
        },
        {
            content: "Uncheck the toggle and only create the listing",
            trigger: "div[name='auto_single_page'] input",
            run: "click",
        },
        {
            trigger: ".o_form_button_save",
            run: "click",
        },
        {
            trigger: ".o_back_button",
            run: "click",
        },
        {
            trigger: ".o_kanban_view",
            run() {
                const pages = this.anchor.querySelectorAll(".o_kanban_record:not(.o_kanban_ghost)");
                assertEqual(pages.length, 1);
                assertEqual(pages[0].querySelector("[data-section='title']").textContent, "MyCustom Name");
            },
        },
    ],
});

registry.category("web_tour.tours").add("website_studio_website_form", {
    steps: () => [
        {
            trigger: ".o_edit_website_container .o-website-btn-custo-primary",
            run: "click",
        },
        {
            trigger: "#snippet_groups",
        },
        {
            trigger: ":iframe .odoo-editor-editable .s_website_form .o_default_snippet_text",
            run: "click",
        },
        {
            trigger: ".snippet-option-WebsiteFormEditor we-select:eq(0)",
            run: "click",
        },
        {
            trigger: ".snippet-option-WebsiteFormEditor we-select:eq(0).o_we_widget_opened"
        },
        {
            trigger: ".snippet-option-WebsiteFormEditor we-button[data-select-action='website_studio.form_more_model']",
            run: "click",
        },
        {
            trigger: ".modal .o_list_view"
        },
        {
            trigger: ".modal .o_searchview_input",
            run: "edit x_test_model && press Enter"
        },
        {
            trigger: ".modal .o_data_row:contains(x_test_model) .o_data_cell",
            run: "click",
        },
        {
            trigger: "body:not(:has(.modal)) .o_we_user_value_widget[data-name='enable_website_form_access'].active"
        },
        {
            trigger: ":iframe form[data-model_name='x_test_model']",
        },
        {
            trigger: ".o_we_website_top_actions button[data-action='save']",
            run: "click",
        },
        {
            trigger: ".o_website_preview:not(.editor_enable) :iframe form[data-model_name='x_test_model']",
        },
    ]
});

return __exports;
});
;

/************************************************************************
*  Filepath: /website_blog/static/tests/tours/blog_search_with_date.js  *
*  Lines: 39                                                            *
************************************************************************/
odoo.define('@website_blog/../tests/tours/blog_search_with_date', ['@web/core/registry'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const { registry } = require("@web/core/registry");

/**
 * Makes sure that blog search can be used with the date filtering.
 */
registry.category("web_tour.tours").add("blog_autocomplete_with_date", {
    url: '/blog',
    steps: () => [{
    content: "Select first month",
    trigger: 'select[name=archive]',
    run: "selectByIndex 1",
},
{
    trigger: '#o_wblog_posts_loop span:has(i.fa-calendar-o):has(a[href="/blog"])',
},
{
    content: "Enter search term",
    trigger: '.o_searchbar_form input',
    run: "edit a",
},
{
    trigger: ".o_searchbar_form .o_dropdown_menu .o_search_result_item",
},
{
    content: "Wait for suggestions then click on search icon",
    trigger: '.o_searchbar_form button:has(i.oi-search)',
    run: "click",
}, {
    content: "Ensure both filters are applied",
    trigger: `#o_wblog_posts_loop:has(span a[href="/blog?search=a"]):has(span i.fa-calendar-o):has(span a[href^="/blog?date_begin"]):has(span i.fa-search)`,
}]});

return __exports;
});
;

/*****************************************************************
*  Filepath: /website_blog/static/tests/tours/blog_tags_tour.js  *
*  Lines: 83                                                     *
*****************************************************************/
odoo.define('@website_blog/../tests/tours/blog_tags_tour', ['@website/js/tours/tour_utils', '@web_tour/tour_service/tour_utils'], function (require) {
'use strict';
let __exports = {};
/** @odoo-module **/

const {
    clickOnEditAndWaitEditMode,
    clickOnSave,
    clickOnSnippet,
    registerWebsitePreviewTour,
} = require('@website/js/tours/tour_utils');
const { stepUtils } = require("@web_tour/tour_service/tour_utils");


/**
 * Makes sure that blog tags can be created and removed.
 */
registerWebsitePreviewTour('blog_tags', {
    url: '/blog',
}, () => [
    stepUtils.waitIframeIsReady(),
    {
        content: "Go to the 'Post Test' blog",
        trigger: ":iframe article[name=blog_post] a:contains('Post Test')",
        run: "click",
    },
    ...clickOnEditAndWaitEditMode(),
    ...clickOnSnippet('#o_wblog_post_top .o_wblog_post_page_cover'),
    {
        content: "Open tag dropdown",
        trigger: "we-customizeblock-option:contains(Tags) .o_we_m2m we-toggler",
        run: "click",
    }, {
        content: "Enter tag name",
        trigger: "we-customizeblock-option:contains(Tags) we-selection-items .o_we_m2o_create input",
        run: "edit testtag && click we-customizeblock-option:contains(Tags) we-selection-items .o_we_m2o_create we-button",
    }, {
        content: "Verify tag appears in options",
        trigger: "we-customizeblock-option:contains(Tags) we-list input[data-name=testtag]",
    },
    ...clickOnSave(),
    {
        content: "Verify tag appears in blog post",
        trigger: ":iframe #o_wblog_post_content .badge:contains(testtag)",
    },
    ...clickOnEditAndWaitEditMode(),
    ...clickOnSnippet('#o_wblog_post_top .o_wblog_post_page_cover'),
    {
        content: "Remove tag",
        trigger: "we-customizeblock-option:contains(Tags) we-list tr:has(input[data-name=testtag]) we-button.fa-minus",
        run: "click",
    }, {
        content: "Verify tag does not appear in options anymore",
        trigger: "we-customizeblock-option:contains(Tags) we-list:not(:has(input[data-name=testtag]))",
    },
    ...clickOnSave(),
    {
        content: "Verify tag does not appear in blog post anymore",
        trigger: ":iframe #o_wblog_post_content div:has(.badge):not(:contains(testtag))",
    },
    {
        trigger: ":iframe .o_wblog_post_title:contains(post test)",
    },
    {
        content: "Go back to /blog",
        trigger: ":iframe a:contains(all blogs)",
        run: "click",
    },
    {
        trigger: ":iframe .h1:contains(our latest posts)",
    },
    {
        content: "Click on the adventure tag",
        trigger: ":iframe a[href^='/blog/tag/adventure'].o_post_link_js_loaded",
        run: "click",
    }, {
        content: "Verify we are still on the backend",
        trigger: ":iframe span:contains(adventure) i.fa-tag",
    }]
);

return __exports;
});


//# sourceMappingURL=/web/assets/1/7d69c33/web.assets_tests.js.map